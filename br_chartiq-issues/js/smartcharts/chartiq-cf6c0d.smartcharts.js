(window.webpackJsonpsmartcharts=window.webpackJsonpsmartcharts||[]).push([[0],{324:function(t,e,i){"use strict";i.r(e),i.d(e,"createEngine",(function(){return a.e})),i.d(e,"customCharts",(function(){return a.f})),i.d(e,"drawing",(function(){return a.g})),i.d(e,"easeMachine",(function(){return a.h})),i.d(e,"equations",(function(){return a.i})),i.d(e,"i18n",(function(){return a.j})),i.d(e,"interaction",(function(){return a.k})),i.d(e,"markers",(function(){return a.l})),i.d(e,"market",(function(){return a.m})),i.d(e,"movement",(function(){return a.n})),i.d(e,"nameValueStore",(function(){return a.o})),i.d(e,"quoteFeed",(function(){return a.p})),i.d(e,"series",(function(){return a.q})),i.d(e,"share",(function(){return a.r})),i.d(e,"span",(function(){return a.s})),i.d(e,"storage",(function(){return a.t})),i.d(e,"studies",(function(){return a.u})),i.d(e,"symbolLookupBase",(function(){return a.v})),i.d(e,"theme",(function(){return a.w})),i.d(e,"timezone",(function(){return a.x})),i.d(e,"touch",(function(){return a.z})),i.d(e,"visualization",(function(){return a.A})),i.d(e,"CIQ",(function(){return a.c})),i.d(e,"SplinePlotter",(function(){return a.d})),i.d(e,"timezoneJS",(function(){return a.y})),i.d(e,"$$",(function(){return a.a})),i.d(e,"$$$",(function(){return a.b})),i.d(e,"aggregations",(function(){return u})),i.d(e,"drawingAdvanced",(function(){return d})),i.d(e,"equationsAdvanced",(function(){return p})),i.d(e,"highPerformanceMarkers",(function(){return f})),i.d(e,"renderersAdvanced",(function(){return m})),i.d(e,"studiesAdvanced",(function(){return g})),i.d(e,"animation",(function(){return T})),i.d(e,"continuousZoom",(function(){return A})),i.d(e,"extendedHours",(function(){return M})),i.d(e,"fullScreen",(function(){return P})),i.d(e,"inactivityTimer",(function(){return F})),i.d(e,"outliers",(function(){return _})),i.d(e,"plotComplementer",(function(){return E})),i.d(e,"rangeSlider",(function(){return L})),i.d(e,"tooltip",(function(){return I}));var a=i(326);function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],a=!0,r=!1,n=void 0;try{for(var s,o=t[Symbol.iterator]();!(a=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);a=!0);}catch(t){r=!0,n=t}finally{try{a||null==o.return||o.return()}finally{if(r)throw n}}return i}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h,c,u,d=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ,i="undefined"!=typeof _timezoneJS?_timezoneJS:t.timezoneJS;e.Drawing?(e.Drawing.ray=function(){this.name="ray"},e.inheritsFrom(e.Drawing.ray,e.Drawing.line),e.Drawing.ray.prototype.calculateOuterSet=function(t){if(this.p0[0]!=this.p1[0]&&this.p0[1]!=this.p1[1]&&!e.ChartEngine.isDailyInterval(this.stx.layout.interval)){var i={x0:this.p0[0],y0:this.p0[1],x1:this.p1[0],y1:this.p1[1]},a=i.x1+1e3;i.x0>i.x1&&(a=i.x1-1e3),this.v0B=this.v0,this.v1B=e.yIntersection(i,a),this.d0B=this.d0,this.d1B=this.stx.dateFromTick(a,t.chart)}},e.Drawing.ray.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),e.ChartEngine.isDailyInterval(this.stx.layout.interval)&&this.d0B&&this.setPoint(1,this.d1B,this.v1B,t.chart))},e.Drawing.continuous=function(){this.name="continuous",this.dragToDraw=!1,this.maxSegments=null},e.inheritsFrom(e.Drawing.continuous,e.Drawing.segment),e.Drawing.continuous.prototype.click=function(t,i,a){var r=this.stx.panels[this.panelName];if(r){if(this.copyConfig(),!this.penDown)return this.setPoint(0,i,a,r.chart),this.penDown=!0,!1;if(this.accidentalClick(i,a))return this.stx.undo(),!0;this.setPoint(1,i,a,r.chart);var n=new(0,e.Drawing.segment),s=this.serialize(this.stx);return n.reconstruct(this.stx,s),this.stx.addDrawing(n),this.stx.changeOccurred("vector"),this.stx.draw(),this.segment++,this.maxSegments&&this.segment>this.maxSegments?!0:(this.setPoint(0,i,a,r.chart),!1)}},e.Drawing.ellipse=function(){this.name="ellipse"},e.inheritsFrom(e.Drawing.ellipse,e.Drawing.BaseTwoPoint),e.Drawing.ellipse.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=a-(r-a),l=r,h=n,c=s,u=n-(s-n),d=(c-u)/6,p=this.lineWidth;p||(p=1.1);var f=this.color;("auto"==f||e.isTransparent(f))&&(f=this.stx.defaultColor),this.highlighted&&(f=this.stx.getCanvasColor("stx_highlight_vector"),.1==p&&(p=1.1));var m=this.fillColor;if(t.beginPath(),t.moveTo(o,h),t.bezierCurveTo(o,c+d,l,c+d,l,h),t.bezierCurveTo(l,u-d,o,u-d,o,h),m&&!e.isTransparent(m)&&"auto"!=m&&(t.fillStyle=m,t.globalAlpha=.2,t.fill(),t.globalAlpha=1),f&&"none"!=this.pattern&&(t.strokeStyle=f,t.lineWidth=p,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(p,this.pattern)),t.lineDashOffset=0),t.stroke()),t.closePath(),this.highlighted){var g="p1"==this.highlighted;this.littleCircle(t,r,s,g)}}},e.Drawing.ellipse.prototype.intersected=function(t,i,a){if(!this.p0||!this.p1)return null;if(this.pointIntersection(this.p1[0],this.p1[1],a))return this.highlighted="p1",{action:"drag",point:"p1"};var r=this.p0[0]-(this.p1[0]-this.p0[0]),n=this.p1[0],s=this.p1[1],o=this.p0[1]-(this.p1[1]-this.p0[1]);return!(a.x0>Math.max(r,n)||a.x1<Math.min(r,n))&&(!(a.y1>Math.max(o,s)||a.y0<Math.min(o,s))&&(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}))},e.Drawing.ellipse.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.ellipse.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.ellipse.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.channel=function(){this.name="channel",this.dragToDraw=!1,this.p2=null},e.inheritsFrom(e.Drawing.channel,e.Drawing.segment),e.Drawing.channel.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.channel.prototype.move=function(t,e,i){if(this.penDown){if(this.copyConfig(),null===this.p2)this.p1=[e,i];else{var a=i-(this.p1[1]-this.p0[1])/(this.p1[0]-this.p0[0])*(e-this.p1[0]);this.p2=[this.p1[0],a]}this.render(t)}},e.Drawing.channel.prototype.click=function(t,e,i){var a=this.stx.panels[this.panelName];if(a)return this.copyConfig(),this.penDown?this.accidentalClick(e,i)?(this.stx.undo(),!0):null!==this.p2?(this.setPoint(2,this.p2[0],this.p2[1],a.chart),this.penDown=!1,!0):(this.setPoint(1,e,i,a.chart),this.p0[0]==this.p1[0]?(this.p1=null,!1):(this.p2=[this.p1[0],this.p1[1]],!1)):(this.setPoint(0,e,i,a.chart),this.penDown=!0,!1)},e.Drawing.channel.prototype.boxIntersection=function(t,e,i){var a=this.p0,r=this.p1,n=this.p2;return!!(a&&r&&n)&&(!(i.x0>Math.max(a[0],r[0])||i.x1<Math.min(a[0],r[0]))&&((r[0]-a[0])*((n[1]<a[1]?i.y1:i.y0)-a[1])-(r[1]-a[1])*(t-a[0]))*((n[0]-a[0])*((n[1]>a[1]?i.y1:i.y0)-(a[1]+n[1]-r[1]))-(r[1]-a[1])*(t-a[0]))<0)},e.Drawing.channel.prototype.intersected=function(t,i,a){if(!this.p0||!this.p1||!this.p2)return null;var r={0:this.p0,1:this.p1,2:this.p2};for(var n in r)if(this.pointIntersection(r[n][0],r[n][1],a))return this.highlighted="p"+n,{action:"drag",point:"p"+n};return this.boxIntersection(t,i,a)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),p2:e.clone(this.p2),tick:t,value:i}):null},e.Drawing.channel.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=null;this.p2&&(o=this.stx.pixelFromValueAdjusted(i,this.p2[0],this.p2[1]));var l=this.lineWidth,h=this.getLineColor(),c=this.fillColor;this.p2&&c&&!e.isTransparent(c)&&"auto"!=c&&(t.beginPath(),t.moveTo(a,n),t.lineTo(r,s),t.lineTo(r,o),t.lineTo(a,n+(o-s)),t.closePath(),t.globalAlpha=.2,t.fillStyle=c,t.fill(),t.globalAlpha=1);var u={pattern:this.pattern,lineWidth:l};if((this.penDown||this.highlighted)&&"none"==this.pattern&&(u.pattern="dotted"),this.stx.plotLine(a,r,n,s,h,"segment",t,i,u),this.p2&&this.stx.plotLine(a,r,n+(o-s),o,h,"segment",t,i,u),this.highlighted){var d="p0"==this.highlighted,p="p1"==this.highlighted,f="p2"==this.highlighted;this.littleCircle(t,a,n,d),this.littleCircle(t,r,s,p),this.littleCircle(t,r,o,f)}}},e.Drawing.channel.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i,s=e.value-a;"move"==e.action?(this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.setPoint(1,e.p1[0]-n,e.p1[1]-s,r.chart),this.setPoint(2,e.p2[0]-n,e.p2[1]-s,r.chart),this.render(t)):"drag"==e.action&&(this[e.point]=[i,a],this.setPoint(0,this.p0[0],this.p0[1],r.chart),this.setPoint(1,this.p1[0],this.p1[1],r.chart),this.setPoint(2,this.p2[0],this.p2[1],r.chart),this.render(t))}},e.Drawing.channel.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setPoint(2,this.d1,this.v2,t.chart))},e.Drawing.channel.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.v2=e.v2,this.adjust()},e.Drawing.channel.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,v2:this.v2}},e.Drawing.pitchfork=function(){this.name="pitchfork",this.dragToDraw=!1,this.p2=null},e.inheritsFrom(e.Drawing.pitchfork,e.Drawing.channel),e.Drawing.pitchfork.prototype.configs=["color","lineWidth","pattern"],e.Drawing.pitchfork.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),null===this.p2?this.p1=[e,i]:this.p2=[e,i],this.render(t))},e.Drawing.pitchfork.prototype.intersected=function(t,i,a){if(!this.p0||!this.p1||!this.p2)return null;var r={0:this.p0,1:this.p1,2:this.p2};for(var n in r)if(this.pointIntersection(r[n][0],r[n][1],a))return this.highlighted="p"+n,{action:"drag",point:"p"+n};for(var s=this.rays,o=0;o<s.length;o++)if(this.lineIntersection(t,i,a,o?"ray":"segment",s[o][0],s[o][1],!0))return this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),p2:e.clone(this.p2),tick:t,value:i};return null},e.Drawing.pitchfork.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.stx,a=this.p2;a||(a=this.p1);var r=i.pixelFromTick(this.p0[0],e.chart),n=i.pixelFromTick(this.p1[0],e.chart),s=i.pixelFromTick(a[0],e.chart),o=i.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]),l=i.pixelFromValueAdjusted(e,this.p1[0],this.p1[1]),h=i.pixelFromValueAdjusted(e,a[0],a[1]),c=this.lineWidth,u=this.getLineColor(),d={pattern:this.pattern,lineWidth:c},p=50,f=2*o-l-h,m=2*r-n-s;m<0&&(p*=-1),f*=p/m,this.rays=[[[n,l],[s,h]],[[r,o],[(n+s)/2,(l+h)/2]]],n==s&&l==h||this.rays.push([[n,l],[n-p,l-f]],[[s,h],[s-p,h-f]]);for(var g=0;g<this.rays.length;g++){var v=this.rays[g],y=g?"ray":"segment";i.plotLine(v[0][0],v[1][0],v[0][1],v[1][1],u,y,t,e,d)}if(this.highlighted){var x="p0"==this.highlighted,b="p1"==this.highlighted,S="p2"==this.highlighted;this.littleCircle(t,r,o,x),this.littleCircle(t,n,l,b),this.littleCircle(t,s,h,S)}}},e.Drawing.pitchfork.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setPoint(2,this.d2,this.v2,t.chart))},e.Drawing.pitchfork.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.d2=e.d2,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.tzo2=e.tzo2,this.v0=e.v0,this.v1=e.v1,this.v2=e.v2,this.adjust()},e.Drawing.pitchfork.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,d2:this.d2,tzo0:this.tzo0,tzo1:this.tzo1,tzo2:this.tzo2,v0:this.v0,v1:this.v1,v2:this.v2}},e.Drawing.gartley=function(){this.name="gartley",this.dragToDraw=!1,this.maxSegments=4,this.shape=null,this.points=[]},e.inheritsFrom(e.Drawing.gartley,e.Drawing.continuous),e.Drawing.gartley.prototype.check=function(t,e){if(!e)return!0;if(t[0]>=e[0]||t[1]==e[1])return!1;if(1==this.segment)t[1]<e[1]?this.shape="M":this.shape="W";else if(2==this.segment){if("M"==this.shape&&t[1]<e[1])return!1;if("W"==this.shape&&t[1]>e[1])return!1;if((e[1]-t[1])/(this.points[0][1]-t[1])<.618)return!1;if((e[1]-t[1])/(this.points[0][1]-t[1])>=.786)return!1}else if(3==this.segment){if("M"==this.shape&&t[1]>e[1])return!1;if("W"==this.shape&&t[1]<e[1])return!1;if((e[1]-t[1])/(this.points[1][1]-t[1])<.618)return!1;if((e[1]-t[1])/(this.points[1][1]-t[1])>=.786)return!1}else if(4==this.segment){if("M"==this.shape&&(t[1]<e[1]||e[1]<this.points[0][1]))return!1;if("W"==this.shape&&(t[1]>e[1]||e[1]>this.points[0][1]))return!1;if((this.points[1][1]-e[1])/(this.points[1][1]-this.points[2][1])<1.27)return!1;if((this.points[1][1]-e[1])/(this.points[1][1]-this.points[2][1])>=1.618)return!1}return!0},e.Drawing.gartley.prototype.click=function(t,e,i){var a=this.stx.panels[this.panelName];if(a){if(this.copyConfig(),!this.penDown)return this.setPoint(0,e,i,a.chart),this.pts=[],this.penDown=!0,this.segment=1,!1;if(this.accidentalClick(e,i))return this.penDown=!0,!1;if(this.check(this.p0,this.p1)){if(1==this.segment&&this.points.push(this.p0),this.points.push(this.p1),this.setPoint(1,e,i,a.chart),this.segment++,this.segment>this.maxSegments)return this.setPoint(0,this.points[0][0],this.points[0][1],a.chart),this.penDown=!1,!0;this.pts.push(this.d1,this.tzo1,this.v1),this.setPoint(0,e,i,a.chart)}return!1}},e.Drawing.gartley.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);if(2==this.segment)this.drawDropZone(t,.618*this.points[0][1]+.382*this.p0[1],.786*this.points[0][1]+.214*this.p0[1],this.p0[0]);else if(3==this.segment)this.drawDropZone(t,.618*this.points[1][1]+.382*this.p0[1],.786*this.points[1][1]+.214*this.p0[1],this.p0[0]);else if(4==this.segment){var o=1.618*this.points[2][1]-.618*this.points[1][1];o="M"==this.shape?Math.max(o,this.points[0][1]):Math.min(o,this.points[0][1]),this.drawDropZone(t,o,1.27*this.points[2][1]-.27*this.points[1][1],this.p0[0])}var l=this.lineWidth,h=this.getLineColor(),c={pattern:this.pattern,lineWidth:l};(this.penDown||this.highlighted)&&"none"==this.pattern&&(c.pattern="dotted"),this.segment<=this.maxSegments&&this.stx.plotLine(a,r,n,s,h,this.name,t,i,c);var u=this.fillColor,d=[];if(this.points.length){t.beginPath();for(var p=1;p<this.points.length&&p<=4;p++){var f=this.stx.pixelFromTick(this.points[p-1][0],i.chart),m=this.stx.pixelFromTick(this.points[p][0],i.chart),g=this.stx.pixelFromValueAdjusted(i,this.points[p-1][0],this.points[p-1][1]),v=this.stx.pixelFromValueAdjusted(i,this.points[p][0],this.points[p][1]);1==p&&d.push(f,g),d.push(m,v),this.stx.plotLine(f,m,g,v,h,this.name,t,i,c)}if(2!=this.points.length&&4!=this.points.length||d.push(r,s),this.points[2]&&d.push(this.stx.pixelFromTick(this.points[2][0],i.chart),this.stx.pixelFromValueAdjusted(i,this.points[2][0],this.points[2][1])),u&&"auto"!=u&&!e.isTransparent(u)){for(var y=0;y<d.length;y+=2)0===y&&t.moveTo(d[0],d[1]),t.lineTo(d[y],d[y+1]);t.fillStyle=u,t.globalAlpha=.2,t.closePath(),t.fill(),t.globalAlpha=1}}}},e.Drawing.gartley.prototype.lineIntersection=function(t,i,a,r){var n=this.points,s=this.stx.panels[this.panelName];if(n.length!=this.maxSegments+1||!s)return!1;for(var o=0;o<n.length-1;o++)if(e.Drawing.BaseTwoPoint.prototype.lineIntersection.call(this,t,i,a,"segment",n[o],n[o+1]))return!0;return!1},e.Drawing.gartley.prototype.boxIntersection=function(t,e,i){if(!this.p0||!this.p1)return!1;if(i.x0>Math.max(this.p0[0],this.p1[0])||i.x1<Math.min(this.p0[0],this.p1[0]))return!1;for(var a=Math.min(this.p0[1],this.p1[1]),r=Math.max(this.p0[1],this.p1[1]),n=0;n<this.points.length;n++)a=Math.min(a,this.points[n][1]),r=Math.max(r,this.points[n][1]);return!(i.y1>r||i.y0<a)},e.Drawing.gartley.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i;e.tick=i;var s=e.value-a;if(e.value=a,"move"==e.action){this.pts=[];for(var o=0;o<this.points.length;o++)this.points[o][0]-=n,this.points[o][1]-=s,this.setPoint(1,this.points[o][0],this.points[o][1],r.chart),o&&o<this.points.length-1&&this.pts.push(this.d1,this.tzo1,this.v1),this.points[o]=this.p1;this.setPoint(0,this.points[0][0],this.points[0][1],r.chart),this.render(t)}}},e.Drawing.gartley.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.gartley.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.reconstructPoints(),this.setPoint(0,this.d0,this.v0,t.chart),this.points.unshift(this.p0),this.setPoint(1,this.d1,this.v1,t.chart),this.points.push(this.p1))},e.Drawing.gartley.prototype.reconstructPoints=function(){var t=this.stx.panels[this.panelName];if(t){this.points=[];for(var i=0;i<this.pts.length;i+=3){var a=e.strToDateTime(this.pts[i]);a.setMinutes(a.getMinutes()+Number(this.pts[i+1])-a.getTimezoneOffset()),this.points.push([this.stx.tickFromDate(e.yyyymmddhhmmssmmm(a),t.chart),this.pts[i+2]])}}},e.Drawing.gartley.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.pts=e.pts.split(","),this.adjust()},e.Drawing.gartley.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,pts:this.pts.join(",")}},e.Drawing.freeform=function(){this.name="freeform",this.splineTension=.3,this.dragToDraw=!0},e.inheritsFrom(e.Drawing.freeform,e.Drawing.segment),e.Drawing.freeform.prototype.measure=function(){},e.Drawing.freeform.prototype.intersected=function(t,i,a){return a.x0>this.hiX||a.x1<this.lowX||a.y1>this.hiY||a.y0<this.lowY?null:(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),tick:t,value:i})},e.Drawing.freeform.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i,s=e.value-a;"move"==e.action&&(this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.adjust(),this.render(t))}},e.Drawing.freeform.prototype.click=function(t,i,a){var r=this.stx.panels[this.panelName];if(r){if(!1===this.penDown){this.copyConfig(),this.startX=Math.round(this.stx.resolveX(this.stx.pixelFromTick(i,r.chart))),this.startY=Math.round(this.stx.resolveY(this.stx.pixelFromValueAdjusted(r,i,a)));var n=this.stx.dateFromTick(i,r.chart,!0);return this.d0=e.yyyymmddhhmmssmmm(n),this.tzo0=n.getTimezoneOffset(),this.v0=a,this.p0=[e.ChartEngine.crosshairX-this.startX,e.ChartEngine.crosshairY-this.startY],this.nodes=[this.p0[0],this.p0[1]],this.pNodes=[this.p0],this.candleWidth=this.stx.layout.candleWidth,this.multiplier=r.yAxis.multiplier,this.interval=this.stx.layout.interval,this.periodicity=this.stx.layout.periodicity,this.tempSplineTension=this.splineTension,this.splineTension=-1,document.body.style.cursor="pointer",this.penDown=!0,!1}return this.penDown=!1,this.splineTension=this.tempSplineTension,document.body.style.cursor="auto",!0}},e.Drawing.freeform.prototype.move=function(t,i,a){if(this.penDown){var r=this.stx.panels[this.panelName],n=this.stx.dateFromTick(i,r.chart,!0);return this.d1=e.yyyymmddhhmmssmmm(n),this.tzo1=n.getTimezoneOffset(),this.v1=a,this.p1=[e.ChartEngine.crosshairX-this.startX,r.yAxis.flipped?this.startY-e.ChartEngine.crosshairY:e.ChartEngine.crosshairY-this.startY],this.pNodes.length>2&&(this.p1[0]==this.pNodes[this.pNodes.length-2][0]&&this.p1[0]==this.pNodes[this.pNodes.length-1][0]||this.p1[1]==this.pNodes[this.pNodes.length-2][1]&&this.p1[1]==this.pNodes[this.pNodes.length-1][1])&&(this.pNodes.length--,this.nodes.length-=2),this.nodes.push(this.p1[0],this.p1[1]),this.pNodes.push(this.p1),this.render(t),!1}},e.Drawing.freeform.prototype.intervalRatio=function(t,i,a,r,n,s){function o(t,i){return e.Market.Symbology.isForexSymbol(i)?1440:390}var l=0;return t==i?l=1:isNaN(t)||isNaN(i)?isNaN(t)?"month"==t?"week"==i?l=5:"day"==i?l=30:isNaN(i)||(l=30*o(0,s)/i):"week"==t?("month"==i&&(l=.2),"day"==i?l=5:isNaN(i)||(l=5*o(0,s)/i)):"day"==t&&("week"==i?l=.2:"month"==i?l=1/30:isNaN(i)||(l=o(0,s)/i)):isNaN(t)||("month"==i?l=t/(30*o(0,s)):"week"==i?l=t/(5*o(0,s)):"day"==i&&(l=t/o(0,s))):l=t/i,l*=a/r},e.Drawing.freeform.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.intervalRatio(this.interval,this.stx.layout.interval,this.periodicity,this.stx.layout.periodicity,this.d0,e.chart.symbol);if(0!==i){var a=this.stx.layout.candleWidth/this.candleWidth,r=e.yAxis.multiplier/this.multiplier;this.setPoint(0,this.d0,this.v0,e.chart);for(var n=this.stx.pixelFromTick(this.p0[0],e.chart),s=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]),o=[],l=this.lineWidth,h=this.getLineColor(),c={pattern:this.pattern,lineWidth:l},u=0;u<this.pNodes.length;u++){var d=i*a*this.pNodes[u][0]+n,p=r*this.pNodes[u][1];e.yAxis.flipped?p=s-p:p+=s,o.push(d,p)}o.length&&(this.splineTension<0?this.stx.connectTheDots(o,h,this.name,t,e,c):this.stx.plotSpline(o,this.splineTension,h,this.name,t,!0,c))}}},e.Drawing.freeform.prototype.adjust=function(){var t=this.stx.panels[this.panelName];if(t){var e=[this.nodes[0],this.nodes[1]];this.pNodes=[e],this.lowX=this.nodes[0],this.hiX=this.nodes[0],this.lowY=this.nodes[1],this.hiY=this.nodes[1];for(var i=2;i<this.nodes.length;i+=2){var a=[this.nodes[i],this.nodes[i+1]];this.pNodes.push(a),this.lowX=Math.min(this.lowX,a[0]),this.hiX=Math.max(this.hiX,a[0]),this.lowY=Math.max(this.lowY,a[1]),this.hiY=Math.min(this.hiY,a[1])}var r=this.intervalRatio(this.interval,this.stx.layout.interval,this.periodicity,this.stx.layout.periodicity,this.d0,t.chart.symbol);if(0!==r){var n=this.stx.layout.candleWidth/this.candleWidth,s=t.yAxis.multiplier/this.multiplier;this.setPoint(0,this.d0,this.v0,t.chart);var o=this.stx.pixelFromTick(this.p0[0],t.chart),l=this.stx.pixelFromValueAdjusted(t,this.p0[0],this.p0[1]);this.lowX=this.stx.tickFromPixel(Math.floor(r*n*this.lowX)+o,t.chart),this.hiX=this.stx.tickFromPixel(Math.ceil(r*n*this.hiX)+o,t.chart),t.yAxis.flipped?(this.lowY=this.stx.valueFromPixel(l-Math.floor(s*this.lowY),t),this.hiY=this.stx.valueFromPixel(l-Math.ceil(s*this.hiY),t)):(this.lowY=this.stx.valueFromPixel(Math.floor(s*this.lowY)+l,t),this.hiY=this.stx.valueFromPixel(Math.ceil(s*this.hiY)+l,t))}}},e.Drawing.freeform.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,cw:Number(this.candleWidth.toFixed(4)),mlt:Number(this.multiplier.toFixed(4)),d0:this.d0,tzo0:this.tzo0,v0:this.v0,inter:this.interval,pd:this.periodicity,nodes:this.nodes}},e.Drawing.freeform.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.candleWidth=e.cw,this.multiplier=e.mlt,this.d0=e.d0,this.tzo0=e.tzo0,this.v0=e.v0,this.interval=e.inter,this.periodicity=e.pd,this.nodes=e.nodes,this.adjust()},e.Drawing.callout=function(){this.name="callout",this.arr=[],this.w=0,this.h=0,this.padding=4,this.text="",this.ta=null,this.fontSize=0,this.font={},this.stemEntry="",this.defaultWidth=50,this.defaultHeight=10},e.inheritsFrom(e.Drawing.callout,e.Drawing.annotation),e.Drawing.callout.prototype.configs=["color","fillColor","lineWidth","pattern","font"],e.Drawing.callout.prototype.copyConfig=function(t){e.Drawing.copyConfig(this,t),this.borderColor=this.color},e.Drawing.callout.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),this.p0=[e,i],this.render(t))},e.Drawing.callout.prototype.onChange=function(t){if(this.stx.panels[this.panelName]){var i=t.target;this.w=i.clientWidth,this.h=i.clientHeight;var a=this.context||this.stx.chart.tempCanvas.context;e.clearCanvas(a.canvas,this.stx),this.render(a),this.edit(a)}},e.Drawing.callout.prototype.render=function(t){this.context=t;var i=this.stx.panels[this.panelName];if(i){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]);if(!isNaN(r)){t.font=this.fontString,t.textBaseline="top";var n=a,s=r,o=this.w/2,l=this.h/2;this.penDown&&(o=this.defaultWidth,(l=this.defaultHeight)||(l=this.fontSize));var h=this.lineWidth;h||(h=1.1);var c=this.color;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor);var u,d,p,f,m=this.borderColor;("auto"==m||e.isTransparent(m))&&(m=this.stx.defaultColor),this.highlighted&&(m=this.stx.getCanvasColor("stx_highlight_vector"));var g=Math.min(Math.min(o,l)/2,8);if(this.stem){this.stem.t?(u=this.stx.pixelFromTick(this.stem.t),p=this.stx.pixelFromValueAdjusted(i,this.stem.t,this.stem.v)):this.stem.x&&(u=n,p=s,n+=this.stem.x,s+=this.stem.y);var v="";u>=n+o?(d=n+o,v="r"):u>n-o&&u<n+o?(d=n,v="c"):u<=n-o&&(d=n-o,v="l"),p>=s+l?(f=s+l,v+="b"):p>s-l&&p<s+l?(f=s,v+="m"):p<=s-l&&(f=s-l,v+="t"),this.stemEntry=v,"cm"!=v&&(u=Math.round(u),d=Math.round(d),p=Math.round(p),f=Math.round(f))}if(this.highlighted?this.stx.canvasColor("stx_annotation_highlight_bg",t):this.fillColor?(t.fillStyle=this.fillColor,t.globalAlpha=.4):this.stem&&(t.fillStyle=this.stx.containerColor),t.strokeStyle=m,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(h,this.pattern)),t.lineDashOffset=0),m&&(t.beginPath(),t.lineWidth=h,t.moveTo(n+o-g,s-l),"rt"!=this.stemEntry?t.quadraticCurveTo(n+o,s-l,n+o,s-l+g):(t.lineTo(u,p),t.lineTo(n+o,s-l+g)),t.lineTo(n+o,s-g/2),"rm"==this.stemEntry&&t.lineTo(u,p),t.lineTo(n+o,s+g/2),t.lineTo(n+o,s+l-g),"rb"!=this.stemEntry?t.quadraticCurveTo(n+o,s+l,n+o-g,s+l):(t.lineTo(u,p),t.lineTo(n+o-g,s+l)),t.lineTo(n+g/2,s+l),"cb"==this.stemEntry&&t.lineTo(u,p),t.lineTo(n-g/2,s+l),t.lineTo(n-o+g,s+l),"lb"!=this.stemEntry?t.quadraticCurveTo(n-o,s+l,n-o,s+l-g):(t.lineTo(u,p),t.lineTo(n-o,s+l-g)),t.lineTo(n-o,s+g/2),"lm"==this.stemEntry&&t.lineTo(u,p),t.lineTo(n-o,s-g/2),t.lineTo(n-o,s-l+g),"lt"!=this.stemEntry?t.quadraticCurveTo(n-o,s-l,n-o+g,s-l):(t.lineTo(u,p),t.lineTo(n-o+g,s-l)),t.lineTo(n-g/2,s-l),"ct"==this.stemEntry&&t.lineTo(u,p),t.lineTo(n+g/2,s-l),t.lineTo(n+o-g,s-l),t.fill(),t.globalAlpha=1,"none"!=this.pattern&&t.stroke()),this.highlighted?this.stx.canvasColor("stx_annotation_highlight",t):t.fillStyle=c,s+=this.padding,!this.ta)for(var y=0;y<this.arr.length;y++)t.fillText(this.arr[y],n-o+this.padding,s-l),s+=this.fontSize;if(t.textBaseline="alphabetic",this.highlighted&&!this.noHandles){var x="p0"==this.highlighted;this.littleCircle(t,u,p,x)}}}},e.Drawing.callout.prototype.click=function(t,e,i){if(!this.stx.overXAxis&&!this.stx.overYAxis){var a=this.stx.panels[this.panelName];return this.copyConfig(),this.setPoint(0,e,i,a.chart),this.penDown?(this.adjust(),this.edit(t),this.penDown=!1,!1):(this.stem={d:this.d0,v:this.v0},this.penDown=!0,this.adjust(),!1)}},e.Drawing.callout.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i,s=e.value-a;e.stem?("drag"==e.action?this.stem={d:this.stx.dateFromTick(i,r.chart,!0),v:a}:"move"==e.action&&(this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.stem={d:this.stx.dateFromTick(this.stx.tickFromDate(e.stem.d,r.chart)-n),v:e.stem.v-s}),this.adjust()):this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.render(t)}},e.Drawing.callout.prototype.lineIntersection=function(t,i,a,r){var n=this.stx.panels[this.panelName],s=this.stem,o=this.p0,l=this.stx;if(!o||!s||!n)return!1;var h=s.t||this.stx.tickFromDate(s.d,n.chart),c={x0:o[0],x1:h,y0:o[1],y1:s.v},u=e.convertBoxToPixels(l,this.panelName,c),d=u.x0,p=u.y0,f=u.x1,m=u.y1;"string"==typeof this.stemEntry&&(this.stemEntry.indexOf("l")>-1?d-=this.w/2:this.stemEntry.indexOf("r")>-1&&(d+=this.w/2),this.stemEntry.indexOf("t")>-1?p-=this.h/2:this.stemEntry.indexOf("b")>-1&&(p+=this.h/2));var g=e.convertBoxToPixels(l,this.panelName,a);return e.boxIntersects(g.x0,g.y0,g.x1,g.y1,d,p,f,m,r)},e.Drawing.callout.prototype.intersected=function(t,i,a){var r=this.stx.panels[this.panelName];if(!this.p0)return null;if(this.pointIntersection(this.stem.t,this.stem.v,a))return this.highlighted="p0",{action:"drag",stem:!0};var n=this.stx.pixelFromTick(this.p0[0],r.chart)-this.w/2,s=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1])-this.h/2,o=n+this.w,l=s+this.h;this.stem&&this.stem.x&&(n+=this.stem.x,o+=this.stem.x,s+=this.stem.y,l+=this.stem.y);var h=this.stx.pixelFromTick(t,r.chart),c=this.stx.pixelFromValueAdjusted(r,t,i);return h+a.r>=n&&h-a.r<=o&&c+a.r>=s&&c-a.r<=l?(this.highlighted=!0,{p0:e.clone(this.p0),tick:t,value:i}):this.lineIntersection(t,i,a,"segment")?(this.highlighted=!0,{action:"move",stem:e.clone(this.stem),p0:e.clone(this.p0),tick:t,value:i}):null},e.Drawing.fibonacci=function(){this.name="fibonacci",this.configurator="fibonacci"},e.inheritsFrom(e.Drawing.fibonacci,e.Drawing.BaseTwoPoint),e.Drawing.fibonacci.mapping={trend:"t",color:"c",parameters:"p",pattern:"pt",opacity:"o",lineWidth:"lw",level:"l",extendLeft:"e",printLevels:"pl",printValues:"pv",timezone:"tz",display:"d"},e.Drawing.fibonacci.prototype.recommendedLevels=[-.618,-.382,0,.382,.5,.618,1,1.382,1.618],e.Drawing.fibonacci.prototype.configs=["color","fillColor","lineWidth","pattern","parameters"],e.Drawing.fibonacci.prototype.initializeSettings=function(t){var e=this.recommendedLevels;if(e&&!t.currentVectorParameters.fibonacci.fibsAlreadySet)for(var i=t.currentVectorParameters.fibonacci.fibs,a=0;a<i.length;a++){delete i[a].display;for(var r=0;r<e.length;r++)i[a].level==e[r]&&(i[a].display=!0)}},e.Drawing.fibonacci.prototype.setOuter=function(){var t=this.stx,i=t.panels[this.panelName];if(i){var a=Math.max(this.p0[1],this.p1[1]),r=Math.min(this.p0[1],this.p1[1]),n=a-r;this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};for(var s=t.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=t.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),l=t.pixelFromTick(this.p0[0],i.chart),h=t.pixelFromTick(this.p1[0],i.chart),c=0,u=1,d=0;d<this.parameters.fibs.length;d++){var p=this.parameters.fibs[d];if(!(p.level>=c&&p.level<=u)&&p.display){var f=t.pixelFromValueAdjusted(i,this.p0[0],o<s?a-n*p.level:r+n*p.level),m=e.xIntersection({x0:l,x1:h,y0:s,y1:o},f);p.level<c?(c=p.level,this.outer.p1[1]=t.valueFromPixel(f,i),this.outer.p1[0]=t.tickFromPixel(m,i.chart)):p.level>u&&(u=p.level,this.outer.p0[1]=t.valueFromPixel(f,i),this.outer.p0[0]=t.tickFromPixel(m,i.chart))}}}},e.Drawing.fibonacci.prototype.click=function(t,i,a){var r=this.stx.panels[this.panelName];if(r)return this.copyConfig(),this.penDown?this.accidentalClick(i,a)?this.dragToDraw:(this.setPoint(1,i,a,r.chart),this.setOuter(),this.parameters=e.clone(this.parameters),this.penDown=!1,!0):(this.setPoint(0,i,a,r.chart),this.penDown=!0,!1)},e.Drawing.fibonacci.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=i.yAxis;if(this.p1){var r=Math.max(this.p0[1],this.p1[1]),n=Math.min(this.p0[1],this.p1[1]),s=a.flipped?n-r:r-n,o=this.stx.pixelFromTick(this.p0[0],i.chart),l=this.stx.pixelFromTick(this.p1[0],i.chart),h=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),c=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),u=Math.min(c,h),d=Math.max(c,h),p=d-u,f=(c-h)/(l-o)>0;this.parameters.trend||(this.parameters.trend={color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}});var m=this.getLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var g=t.measureText("161.8%").width+10,v=Number.MAX_VALUE,y=Number.MAX_VALUE,x=-1*Number.MAX_VALUE,b=-1*Number.MAX_VALUE,S=this.color;("auto"==S||e.isTransparent(S))&&(S=this.stx.defaultColor),this.rays=[];for(var C=0;C<this.parameters.fibs.length;C++){t.textAlign="left",t.fillStyle=S;var w=this.parameters.fibs[C];if(w.display){var k=this.stx.pixelFromValueAdjusted(i,this.p0[0],c<h?r-s*w.level:n+s*w.level),D=e.xIntersection({x0:o,x1:l,y0:h,y1:c},k),T=this.parameters.extendLeft?0:D,A=i.left+i.width;if(this.parameters.printLevels){var M=Math.round(1e3*w.level)/10+"%";A-=g,this.parameters.printValues&&(t.fillStyle=S,this.stx.canvasFont("stx_yaxis",t)),A<T&&(t.textAlign="right"),t.fillText(M,A,k),A<T?A+=5:A-=5}if(this.parameters.printValues&&D<i.width){var P=this.stx.transformedPriceFromPixel(k,i);P=a.priceFormatter?a.priceFormatter(this.stx,i,P):this.stx.formatYAxisPrice(P,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,P,k,S,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var F=w.color;("auto"==F||e.isTransparent(F))&&(F=this.color),("auto"==F||e.isTransparent(F))&&(F=this.stx.defaultColor);var _=w.color;("auto"==_||e.isTransparent(_))&&(_=this.fillColor),("auto"==_||e.isTransparent(_))&&(_=this.stx.defaultColor),t.fillStyle=_;var E=e.clone(w.parameters);this.highlighted&&(E.opacity=1),this.stx.plotLine(T,A,k,k,this.highlighted?m:F,"segment",t,i,E),this.rays.push([[T,k],[A,k]]),t.globalAlpha=.05,t.beginPath(),t.moveTo(A,k),t.lineTo(T,k),T?t.lineTo(l,c):t.lineTo(T,c),t.lineTo(A,c),void 0!==_&&t.fill(),t.globalAlpha=1,k<y&&(v=D,y=k),k>b&&(x=D,b=k)}}for(var L=0;L<=1;L++){var I=f?d-p*L:u+p*L;(I=Math.round(I))<y&&(v=e.xIntersection({x0:o,x1:l,y0:h,y1:c},I),y=I),I>b&&(x=e.xIntersection({x0:o,x1:l,y0:h,y1:c},I),b=I)}var O=e.clone(this.parameters.trend.parameters);if(this.highlighted&&(O.opacity=1),this.stx.plotLine(v,x,y,b,m,"segment",t,i,O),this.highlighted){var N="p0"==this.highlighted,H="p1"==this.highlighted;this.littleCircle(t,o,h,N),this.littleCircle(t,l,c,H)}}}},e.Drawing.fibonacci.prototype.reposition=function(t,i,a,r){i&&(e.Drawing.BaseTwoPoint.prototype.reposition.apply(this,arguments),this.adjust())},e.Drawing.fibonacci.prototype.intersected=function(t,i,a){var r=this.p0,n=this.p1;if(!r||!n)return null;var s={0:r,1:n};for(var o in s)if(this.pointIntersection(s[o][0],s[o][1],a))return this.highlighted="p"+o,{action:"drag",point:"p"+o};var l=this.outer,h=this.rays,c=l&&this.lineIntersection(t,i,a,"segment",l.p0,l.p1);if(!c)for(var u=0;u<h.length;u++)if(this.lineIntersection(t,i,a,"ray",h[u][0],h[u][1],!0)){c=!0;break}return c?(this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(n),tick:t,value:i}):null},e.Drawing.fibonacci.prototype.reconstruct=function(t,i){i=e.replaceFields(i,e.reverseObject(e.Drawing.fibonacci.mapping)),this.stx=t,this.parameters=i.parameters,this.parameters||(this.parameters=e.clone(this.stx.currentVectorParameters.fibonacci)),this.color=i.col,this.fillColor=i.fc,this.panelName=i.pnl,this.d0=i.d0,this.d1=i.d1,this.d2=i.d2,this.tzo0=i.tzo0,this.tzo1=i.tzo1,this.tzo2=i.tzo2,this.v0=i.v0,this.v1=i.v1,this.v2=i.v2,this.adjust()},e.Drawing.fibonacci.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setOuter())},e.Drawing.fibonacci.prototype.serialize=function(){var t={name:this.name,parameters:this.parameters,pnl:this.panelName,col:this.color,fc:this.fillColor,d0:this.d0,d1:this.d1,d2:this.d2,tzo0:this.tzo0,tzo1:this.tzo1,tzo2:this.tzo2,v0:this.v0,v1:this.v1,v2:this.v2};return e.replaceFields(t,e.Drawing.fibonacci.mapping)},e.Drawing.retracement=function(){this.name="retracement"},e.inheritsFrom(e.Drawing.retracement,e.Drawing.fibonacci),e.Drawing.fibprojection=function(){this.name="fibprojection",this.dragToDraw=!1,this.p2=null},e.inheritsFrom(e.Drawing.fibprojection,e.Drawing.fibonacci),e.Drawing.fibprojection.prototype.recommendedLevels=[0,.618,1,1.272,1.618,2.618,4.236],e.Drawing.fibprojection.prototype.click=function(t,i,a){var r=this.stx.panels[this.panelName];if(r)return this.copyConfig(),this.penDown?this.accidentalClick(i,a)?(this.stx.undo(),!0):null!==this.p2?(this.setPoint(2,this.p2[0],this.p2[1],r.chart),this.parameters=e.clone(this.parameters),!0):(this.setPoint(1,i,a,r.chart),this.p2=[this.p1[0],this.p1[1]],!1):(this.setPoint(0,i,a,r.chart),this.penDown=!0,!1)},e.Drawing.fibprojection.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=i.yAxis;if(this.p1){var r=this.p1[1]-this.p0[1],n=this.stx.pixelFromTick(this.p0[0],i.chart),s=this.stx.pixelFromTick(this.p1[0],i.chart),o=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),l=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),h=null,c=null;this.p2&&(h=this.stx.pixelFromTick(this.p2[0],i.chart),c=this.stx.pixelFromValueAdjusted(i,this.p2[0],this.p2[1]));this.parameters.trend||(this.parameters.trend={color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}});var u=this.getLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var d=t.measureText("161.8%").width+10,p=this.color;if(("auto"==p||e.isTransparent(p))&&(p=this.stx.defaultColor),this.p2){this.rays=[];for(var f=0;f<this.parameters.fibs.length;f++){t.textAlign="left",t.fillStyle=p;var m=this.parameters.fibs[f];if(m.display){var g=this.stx.pixelFromValueAdjusted(i,this.p2[0],this.p2[1]+r*m.level),v=e.xIntersection({x0:n,x1:s,y0:o,y1:l},g),y=this.parameters.extendLeft?0:n,x=i.left+i.width;if(this.parameters.printLevels){var b=Math.round(1e3*m.level)/10+"%";x-=d,this.parameters.printValues&&(t.fillStyle=p,this.stx.canvasFont("stx_yaxis",t)),x<y&&(t.textAlign="right"),t.fillText(b,x,g),x<y?x+=5:x-=5}if(this.parameters.printValues&&v<i.width){var S=this.stx.transformedPriceFromPixel(g,i);S=a.priceFormatter?a.priceFormatter(this.stx,i,S):this.stx.formatYAxisPrice(S,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,S,g,p,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var C=m.color;("auto"==C||e.isTransparent(C))&&(C=this.color),("auto"==C||e.isTransparent(C))&&(C=this.stx.defaultColor);var w=m.color;("auto"==w||e.isTransparent(w))&&(w=this.fillColor),("auto"==w||e.isTransparent(w))&&(w=this.stx.defaultColor),t.fillStyle=w;var k=e.clone(m.parameters);this.highlighted&&(k.opacity=1),this.stx.plotLine(y,x,g,g,this.highlighted?u:C,"segment",t,i,k),this.rays.push([[y,g],[x,g]]),t.globalAlpha=.05,t.beginPath(),t.moveTo(x,g),t.lineTo(y,g),y?t.lineTo(n,c):t.lineTo(y,c),t.lineTo(x,c),void 0!==w&&t.fill(),t.globalAlpha=1}}}var D=e.clone(this.parameters.trend.parameters);if(this.highlighted&&(D.opacity=1),this.stx.plotLine(n,s,o,l,u,"segment",t,i,D),this.p2&&this.stx.plotLine(s,h,l,c,u,"segment",t,i,D),this.highlighted){var T="p0"==this.highlighted,A="p1"==this.highlighted,M="p2"==this.highlighted;this.littleCircle(t,n,o,T),this.littleCircle(t,s,l,A),this.littleCircle(t,h,c,M)}}}},e.Drawing.fibprojection.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),null===this.p2?this.p1=[e,i]:this.p2=[e,i],this.render(t))},e.Drawing.fibprojection.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i,s=e.value-a;"move"==e.action?(this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.setPoint(1,e.p1[0]-n,e.p1[1]-s,r.chart),this.setPoint(2,e.p2[0]-n,e.p2[1]-s,r.chart),this.render(t)):"drag"==e.action&&(this[e.point]=[i,a],this.setPoint(0,this.p0[0],this.p0[1],r.chart),this.setPoint(1,this.p1[0],this.p1[1],r.chart),this.setPoint(2,this.p2[0],this.p2[1],r.chart),this.render(t))}},e.Drawing.fibprojection.prototype.intersected=function(t,i,a){var r=this.p0,n=this.p1,s=this.p2;if(!r||!n||!s)return null;var o={0:r,1:n,2:s};for(var l in o)if(this.pointIntersection(o[l][0],o[l][1],a))return this.highlighted="p"+l,{action:"drag",point:"p"+l};var h=this.rays,c=this.lineIntersection(t,i,a,"segment",r,n)||this.lineIntersection(t,i,a,"segment",n,s);if(!c)for(var u=0;u<h.length;u++)if(this.lineIntersection(t,i,a,"ray",h[u][0],h[u][1],!0)){c=!0;break}return c?(this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(n),p2:e.clone(s),tick:t,value:i}):null},e.Drawing.fibprojection.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setPoint(2,this.d2,this.v2,t.chart))},e.Drawing.fibarc=function(){this.name="fibarc"},e.inheritsFrom(e.Drawing.fibarc,e.Drawing.fibonacci),e.Drawing.fibarc.prototype.recommendedLevels=[.382,.5,.618,1],e.Drawing.fibarc.prototype.setOuter=function(){var t=this.stx.panels[this.panelName];if(t){this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};var i=this.stx.pixelFromValueAdjusted(t,this.p0[0],this.p0[1]),a=this.stx.pixelFromValueAdjusted(t,this.p1[0],this.p1[1]),r=this.stx.pixelFromTick(this.p0[0],t.chart),n=this.stx.pixelFromTick(this.p1[0],t.chart),s=2*i-a,o=e.xIntersection({x0:r,x1:n,y0:i,y1:a},s);this.outer.p0[1]=this.stx.valueFromPixel(s,t),this.outer.p0[0]=this.stx.tickFromPixel(o,t.chart)}},e.Drawing.fibarc.prototype.intersected=function(t,i,a){var r=this.stx.panels[this.panelName];if(r){var n=this.p0,s=this.p1,o=this.outer;if(!n||!s)return null;var l={0:n,1:s};for(var h in l)if(this.pointIntersection(l[h][0],l[h][1],a))return this.highlighted="p"+h,{action:"drag",point:"p"+h};if(this.lineIntersection(t,i,a,"segment",o.p0,o.p1))return this.highlighted=!0,{action:"move",p0:e.clone(n),p1:e.clone(s),tick:t,value:i};var c={x0:n[0],x1:s[0],y0:n[1],y1:s[1]},u=e.convertBoxToPixels(this.stx,this.panelName,c),d=Math.abs(Math.sqrt(2)*(u.x1-u.x0)),p=Math.abs(Math.sqrt(2)*(u.y1-u.y0)),f=this.stx.pixelFromTick(t,r.chart),m=this.stx.pixelFromValueAdjusted(r,t,i);return f+a.r<u.x1-d||f-a.r>u.x1+d||(m+a.r<u.y1-p||m-a.r>u.y1+p||u.y0<u.y1&&m-a.r>u.y1||u.y0>u.y1&&m+a.r<u.y1)?null:(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i})}},e.Drawing.fibarc.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=i.yAxis;if(this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),l=o<s,h=Math.abs((o-s)/(n-r)),c=this.getLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var u=this.color;("auto"==u||e.isTransparent(u))&&(u=this.stx.defaultColor);for(var d=0;d<this.parameters.fibs.length;d++){t.fillStyle=u;var p=this.parameters.fibs[d];if(!(p.level<0)&&p.display){var f=Math.abs(this.p1[1]-this.p0[1])*Math.sqrt(2)*p.level,m=this.p1[1]+f*(l?-1:1)*(a.flipped?-1:1),g=this.stx.pixelFromValueAdjusted(i,this.p0[0],m),v=e.xIntersection({x0:r,x1:n,y0:s,y1:o},g);if(this.parameters.printLevels){t.textAlign="center";var y=Math.round(1e3*p.level)/10+"%";this.parameters.printValues&&(t.fillStyle=u,this.stx.canvasFont("stx_yaxis",t)),t.fillText(y,n,Math.round(g-5))}if(t.textAlign="left",this.parameters.printValues&&v<i.width){var x=m;x=a.priceFormatter?a.priceFormatter(this.stx,i,x):this.stx.formatYAxisPrice(x,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,x,g,u,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var b=p.color;("auto"==b||e.isTransparent(b))&&(b=this.color),("auto"==b||e.isTransparent(b))&&(b=this.stx.defaultColor),t.strokeStyle=this.highlight?c:b;var S=p.color;("auto"==S||e.isTransparent(S))&&(S=this.fillColor),("auto"==S||e.isTransparent(S))&&(S=this.stx.defaultColor),t.fillStyle=S,t.globalAlpha=this.highlighted?1:p.parameters.opacity,t.lineWidth=p.parameters.lineWidth,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(t.lineWidth,p.parameters.pattern)),t.lineDashOffset=0),t.save(),t.beginPath(),t.scale(1/h,1),t.arc(n*h,o,Math.abs(g-o),0,Math.PI,!l),"none"!=this.pattern&&t.stroke(),t.globalAlpha=.05,t.fill(),t.restore(),t.setLineDash&&t.setLineDash([]),t.globalAlpha=1}}t.textAlign="left";var C=e.clone(this.parameters.trend.parameters);if(this.highlighted&&(C.opacity=1),this.stx.plotLine(n,2*r-n,o,2*s-o,c,"segment",t,i,C),this.highlighted){var w="p0"==this.highlighted,k="p1"==this.highlighted;this.littleCircle(t,r,s,w),this.littleCircle(t,n,o,k)}}}},e.Drawing.fibfan=function(){this.name="fibfan"},e.inheritsFrom(e.Drawing.fibfan,e.Drawing.fibonacci),e.Drawing.fibfan.prototype.recommendedLevels=[0,.382,.5,.618,1],e.Drawing.fibfan.prototype.setOuter=function(){},e.Drawing.fibfan.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=i.yAxis;if(this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),l=Math.min(o,s),h=Math.max(o,s),c=h-l,u=(o-s)/(n-r)>0,d=this.getLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var p=t.measureText("161.8%").width+10,f=Number.MAX_VALUE,m=-1*Number.MAX_VALUE,g=this.color;("auto"==g||e.isTransparent(g))&&(g=this.stx.defaultColor),this.rays=[];for(var v=0;v<this.parameters.fibs.length;v++){t.fillStyle=g;var y=this.parameters.fibs[v];if(y.display){var x=this.stx.pixelFromValueAdjusted(i,this.p0[0],(this.p0[1]-this.p1[1])*y.level+this.p1[1]),b=e.xIntersection({x0:n,x1:n,y0:s,y1:o},x),S=i.left;n>r&&(S+=i.width);var C=(S-r)*(x-s)/(b-r)+s;if(!(r>S-(this.parameters.printLevels?p+5:0)&&n>r||r<S+(this.parameters.printLevels?p+5:0)&&n<r)){if(this.parameters.printLevels){var w=Math.round(1e3*y.level)/10+"%";n>r?(S-=p,t.textAlign="left"):(S+=p,t.textAlign="right"),this.parameters.printValues&&(t.fillStyle=g,this.stx.canvasFont("stx_yaxis",t)),C=(S-r)*(x-s)/(b-r)+s,t.fillText(w,S,C),n>r?S-=5:S+=5}if(t.textAlign="left",this.parameters.printValues&&b<i.width){var k=this.stx.transformedPriceFromPixel(x,i);k=a.priceFormatter?a.priceFormatter(this.stx,i,k):this.stx.formatYAxisPrice(k,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,k,x,g,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var D=y.color;("auto"==D||e.isTransparent(D))&&(D=this.color),("auto"==D||e.isTransparent(D))&&(D=this.stx.defaultColor);var T=y.color;("auto"==T||e.isTransparent(T))&&(T=this.fillColor),("auto"==T||e.isTransparent(T))&&(T=this.stx.defaultColor),t.fillStyle=T,this.parameters.printLevels&&(C=(S-r)*(x-s)/(b-r)+s);var A=e.clone(y.parameters);this.highlighted&&(A.opacity=1),this.stx.plotLine(r,S,s,C,this.highlighted?d:D,"segment",t,i,A),this.rays.push([[r,s],[S,C]]),t.globalAlpha=.05,t.beginPath(),t.moveTo(S,C),t.lineTo(r,s),t.lineTo(S,s),t.fill(),t.globalAlpha=1,x<f&&(f=x),x>m&&(m=x)}}}for(var M=0;M<=1;M++){var P=u?h-c*M:l+c*M;(P=Math.round(P))<f&&(f=P),P>m&&(m=P)}if(this.highlighted){var F="p0"==this.highlighted,_="p1"==this.highlighted;this.littleCircle(t,r,s,F),this.littleCircle(t,n,o,_)}}}},e.Drawing.fibtimezone=function(){this.name="fibtimezone"},e.inheritsFrom(e.Drawing.fibtimezone,e.Drawing.fibonacci),e.Drawing.fibtimezone.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=[1,0],l=this.getLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var h=this.p1[0]-this.p0[0],c=this.color;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor),t.textAlign="center";var u=a,d=i.yAxis.top,p=i.yAxis.bottom,f=0,m=this.parameters.timezone.color;("auto"==m||e.isTransparent(m))&&(m=this.color),("auto"==m||e.isTransparent(m))&&(m=this.stx.defaultColor);var g=this.parameters.timezone.color;("auto"==g||e.isTransparent(g))&&(g=this.fillColor),("auto"==g||e.isTransparent(g))&&(g=this.stx.defaultColor),this.parameters.printLevels&&(p-=13);var v=e.clone(this.parameters.timezone.parameters);this.highlighted&&(v.opacity=1);do{if(u=this.stx.pixelFromTick(this.p0[0]+f*h,i.chart),a<r&&u>i.left+i.width)break;if(a>r&&u<i.left)break;this.parameters.printLevels&&(t.fillStyle=c,t.fillText(r>a?f:-1*f,u,p+7)),t.fillStyle=g,this.stx.plotLine(u,u,0,p,this.highlighted?l:m,"segment",t,i,v),t.globalAlpha=.05,t.beginPath(),t.moveTo(a,d),t.lineTo(u,d),t.lineTo(u,p),t.lineTo(a,p),t.fill(),t.globalAlpha=1,f=o[0]+o[1],o.unshift(f)}while(h);if(t.textAlign="left",this.stx.plotLine(a,r,n,s,l,"segment",t,i,v),this.highlighted){var y="p0"==this.highlighted,x="p1"==this.highlighted;this.littleCircle(t,a,n,y),this.littleCircle(t,r,s,x)}else{var b=this.stx.valueFromPixel(i.height/2,i);this.setPoint(0,this.p0[0],b,i.chart),this.setPoint(1,this.p1[0],b,i.chart)}}},e.Drawing.fibtimezone.prototype.intersected=function(t,i,a){var r=this.p0,n=this.p1,s=this.stx.panels[this.panelName];if(!r||!n||!s)return null;var o={0:r,1:n};for(var l in o)if(this.pointIntersection(o[l][0],o[l][1],a))return this.highlighted="p"+l,{action:"drag",point:"p"+l};return this.lineIntersection(t,i,a,"segment")||a.x0<=this.p0[0]&&a.x1>=r[0]?(this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(n),tick:t,value:i}):null},e.Drawing.arrow_v0=function(){this.name="arrow",this.dimension=[11,11],this.points=[["M",3,0,"L",7,0,"L",7,5,"L",10,5,"L",5,10,"L",0,5,"L",3,5,"L",3,0]]},e.inheritsFrom(e.Drawing.arrow_v0,e.Drawing.shape),e.Drawing.xcross=function(){this.name="xcross",this.dimension=[7,7],this.points=[["M",1,0,"L",3,2,"L",5,0,"L",6,1,"L",4,3,"L",6,5,"L",5,6,"L",3,4,"L",1,6,"L",0,5,"L",2,3,"L",0,1,"L",1,0]]},e.inheritsFrom(e.Drawing.xcross,e.Drawing.shape),e.Drawing.check=function(){this.name="check",this.dimension=[8,9],this.points=[["M",1,5,"L",0,6,"L",2,8,"L",7,1,"L",6,0,"L",2,6,"L",1,5]]},e.inheritsFrom(e.Drawing.check,e.Drawing.shape),e.Drawing.star=function(){this.name="star",this.dimension=[12,12],this.points=[["M",0,4,"L",4,4,"L",5.5,0,"L",7,4,"L",11,4,"L",8,7,"L",9,11,"L",5.5,9,"L",2,11,"L",3,7,"L",0,4]]},e.inheritsFrom(e.Drawing.star,e.Drawing.shape),e.Drawing.heart=function(){this.name="heart",this.dimension=[23,20],this.points=[["M",11,3,"B",11,2.4,10,0,6,0,"B",0,0,0,7.5,0,7.5,"B",0,11,4,15.4,11,19,"B",18,15.4,22,11,22,7.5,"B",22,7.5,22,0,16,0,"B",13,0,11,2.4,11,3]]},e.inheritsFrom(e.Drawing.heart,e.Drawing.shape),e.Drawing.focusarrow=function(){this.name="focusarrow",this.dimension=[7,5],this.points=[["M",0,0,"L",2,2,"L",0,4,"L",0,0],["M",6,0,"L",4,2,"L",6,4,"L",6,0]]},e.inheritsFrom(e.Drawing.focusarrow,e.Drawing.shape),e.Drawing.crossline=function(){this.name="crossline"},e.inheritsFrom(e.Drawing.crossline,e.Drawing.horizontal),e.extend(e.Drawing.crossline.prototype,{measure:function(){},accidentalClick:function(t,e){return!1},adjust:function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=e.clone(this.p0))},intersected:function(t,i,a){if(!this.p0||!this.p1)return null;this.p1[0]+=1;var r=this.lineIntersection(t,i,a,"line");return this.p1=e.clone(this.p0),r||(this.p1[1]+=1,r=this.lineIntersection(t,i,a,"line"),this.p1=e.clone(this.p0),r)?(this.highlighted=!0,this.pointIntersection(this.p0[0],this.p0[1],a)&&(this.highlighted="p0"),{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},render:function(t){var a=this.stx.panels[this.panelName];if(a){var r=this.stx.pixelFromTick(this.p0[0],a.chart),n=this.stx.pixelFromValueAdjusted(a,this.p0[0],this.p0[1]),s=this.getLineColor(),o={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(r,r+100,n,n,s,"horizontal",t,a,o),this.stx.plotLine(r,r,n,n+100,s,"vertical",t,a,o),this.axisLabel&&!this.repositioner){this.stx.endClip();var l=this.p0[1];if(a.chart.transformFunc&&(l=a.chart.transformFunc(this.stx,a.chart,l)),l=a.yAxis.priceFormatter?a.yAxis.priceFormatter(this.stx,a,l):this.stx.formatYAxisPrice(l,a),this.stx.createYAxisLabel(a,l,n,s),this.stx.startClip(a.name),this.p0[0]>=0&&!this.stx.chart.xAxis.noDraw){var h,c;if(h=this.stx.dateFromTick(this.p0[0],a.chart,!0),e.ChartEngine.isDailyInterval(this.stx.layout.interval))h.setHours(0,0,0,0);else{var u=1e3*h.getSeconds()+h.getMilliseconds();i.Date&&this.stx.displayZone&&(c=new i.Date(h.getTime(),this.stx.displayZone),h=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes()),h=new Date(h.getTime()+u))}var d=e.mmddhhmm(e.yyyymmddhhmm(h));if(a.chart.xAxis.formatter)d=a.chart.xAxis.formatter(h,this.name,null,null,d);else if(this.stx.internationalizer){var p;0!==h.getHours()||0!==h.getMinutes()?(p=this.stx.internationalizer.monthDay.format(h),p+=" "+this.stx.internationalizer.hourMinute.format(h)):p=this.stx.internationalizer.yearMonthDay.format(h),d=p}this.stx.endClip(),this.stx.createXAxisLabel(a,d,r,s,null,!0),this.stx.startClip(a.name)}}if(this.highlighted){var f="p0"==this.highlighted;this.littleCircle(t,r,n,f)}}}},!0),e.Drawing.speedarc=function(){this.name="speedarc",this.printLevels=!0},e.inheritsFrom(e.Drawing.speedarc,e.Drawing.segment),e.extend(e.Drawing.speedarc.prototype,{defaultOpacity:.25,configs:["color","fillColor","lineWidth","pattern"],copyConfig:function(){this.color=this.stx.currentVectorParameters.currentColor,this.fillColor=this.stx.currentVectorParameters.fillColor,this.lineWidth=this.stx.currentVectorParameters.lineWidth,this.pattern=this.stx.currentVectorParameters.pattern},intersected:function(t,i,a){if(!this.p0||!this.p1)return null;var r={0:this.p0,1:this.p1};for(var n in r)if(this.pointIntersection(r[n][0],r[n][1],a))return this.highlighted="p"+n,{action:"drag",point:"p"+n};if(this.lineIntersection(t,i,a,this.name))return this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i};var s=this.p1[0]-(this.p0[0]-this.p1[0]),o=this.p0[0],l=this.p1[1],h=this.p0[1];return t>Math.max(s,o)||t<Math.min(s,o)||i>Math.max(h,l)||i<Math.min(h,l)?null:(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i})},render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=s<n,l=Math.abs((s-n)/(r-a)),h=this.getLineColor();t.strokeStyle=h;var c=this.fillColor;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor),t.fillStyle=c,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(this.lineWidth,this.pattern)),t.lineDashOffset=0),this.stx.canvasFont("stx_yaxis",t);for(var u=1;u<3;u++){var d=Math.abs(this.p1[1]-this.p0[1])*Math.sqrt(2)*u/3,p=this.p1[1]+d*(o?-1:1)*(i.yAxis.flipped?-1:1),f=this.stx.pixelFromValueAdjusted(i,this.p0[0],p);if(t.save(),t.beginPath(),t.scale(1/l,1),t.arc(r*l,s,Math.abs(f-s),0,Math.PI,!o),t.globalAlpha=this.highlighted?1:this.defaultOpacity,"none"!=this.pattern&&t.stroke(),t.globalAlpha=.1,t.fill(),t.restore(),t.globalAlpha=1,this.printLevels){t.fillStyle=h,t.textAlign="center";var m=u+"/3";t.fillText(m,r,Math.round(f-5)),t.fillStyle=c}}t.textAlign="left";var g={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.highlighted?1:this.defaultOpacity};if(this.stx.plotLine(a,r,n,s,h,"segment",t,i,g),t.setLineDash&&t.setLineDash([]),this.highlighted){var v="p0"==this.highlighted,y="p1"==this.highlighted;this.littleCircle(t,a,n,v),this.littleCircle(t,r,s,y)}}},reconstruct:function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},serialize:function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}}},!0),e.Drawing.speedline=function(){this.name="speedline",this.printLevels=!0},e.inheritsFrom(e.Drawing.speedline,e.Drawing.speedarc),e.extend(e.Drawing.speedline.prototype,{intersected:function(t,i,a){var r=this.p0,n=this.p1;if(!r||!n)return null;var s={0:r,1:n};for(var o in s)if(this.pointIntersection(s[o][0],s[o][1],a))return this.highlighted="p"+o,{action:"drag",point:"p"+o};for(var l=this.rays,h=0;h<l.length;h++)if(this.lineIntersection(t,i,a,"ray",l[h][0],l[h][1],!0))return this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(n),tick:t,value:i};return null},render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);this.stx.canvasFont("stx_yaxis",t);var o=this.getLineColor(),l=this.color;("auto"==l||e.isTransparent(l))&&(l=this.stx.defaultColor),t.strokeStyle=l;var h=this.fillColor;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.fillStyle=h;var c,u,d={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.highlighted?1:this.defaultOpacity},p=["1","2/3","1/3","3/2","3"],f=[1,2/3,1/3,1.5,3],m=[];this.rays=[];for(var g=0;g<f.length;g++){var v=f[g];if(!(v>1)||this.extension){var y,x=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]-(this.p0[1]-this.p1[1])*v);v>1?(y=e.xIntersection({x0:a,x1:r,y0:n,y1:x},s),m.push(y)):(y=e.xIntersection({x0:r,x1:r,y0:n,y1:s},x),m.push(x));var b=v>1?y:r,S=v>1?s:x;if(this.confineToGrid||(b=i.left,r>a&&(b+=i.width),S=(b-a)*(x-n)/(r-a)+n),this.printLevels&&(1!=v||this.extension)){t.fillStyle=l;var C=0,w=0;n>s?(w=-5,t.textBaseline="bottom"):(w=5,t.textBaseline="top"),a>r?(C=5,t.textAlign="right"):(C=-5,t.textAlign="left"),v>1?t.fillText(p[g],y+(this.confineToGrid?0:C),s):t.fillText(p[g],r,x+(this.confineToGrid?0:w)),t.fillStyle=h}this.stx.plotLine(a,b,n,S,this.highlighted?o:l,"segment",t,i,d),1==v&&(c=b,u=S),this.rays.push([[a,n],[b,S]]),t.globalAlpha=.1,t.beginPath(),t.moveTo(b,S),t.lineTo(a,n),t.lineTo(c,u),t.fill(),t.globalAlpha=1}}if(t.textAlign="left",t.textBaseline="middle",this.confineToGrid&&(t.globalAlpha=.3,t.beginPath(),t.strokeRect(a,n,r-a,s-n),t.moveTo(a,m[1]),t.lineTo(r,m[1]),t.moveTo(a,m[2]),t.lineTo(r,m[2]),this.extension&&(t.moveTo(m[3],n),t.lineTo(m[3],s),t.moveTo(m[4],n),t.lineTo(m[4],s)),t.stroke(),t.globalAlpha=1),this.highlighted){var k="p0"==this.highlighted,D="p1"==this.highlighted;this.littleCircle(t,a,n,k),this.littleCircle(t,r,s,D)}}}},!0),e.Drawing.gannfan=function(){this.name="gannfan",this.printLevels=!0},e.inheritsFrom(e.Drawing.gannfan,e.Drawing.speedline),e.extend(e.Drawing.gannfan.prototype,{render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);this.stx.canvasFont("stx_yaxis",t);var o=this.getLineColor(),l=this.color;("auto"==l||e.isTransparent(l))&&(l=this.stx.defaultColor),t.strokeStyle=l;var h=this.fillColor;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.fillStyle=h;var c,u,d={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.highlighted?1:this.defaultOpacity},p=[1,2,3,4,8,.5,1/3,1/4,1/8];this.rays=[];for(var f=0;f<p.length;f++){var m=p[f],g=a+(r-a)/m,v=n-m*(n-s),y=i.left;r>a&&(y+=i.width);var x=(y-a)*(v-n)/(r-a)+n;if(this.printLevels){t.fillStyle=l;var b=0,S=0;n>s?(S=5,t.textBaseline="top"):(S=-5,t.textBaseline="bottom"),a>r?(b=5,t.textAlign="left"):(b=-5,t.textAlign="right"),m>1?t.fillText(m+"x1",g+b,s):t.fillText("1x"+1/m,r,v+S),t.fillStyle=h}this.stx.plotLine(a,y,n,x,this.highlighted?o:l,"segment",t,i,d),this.rays.push([[a,n],[y,x]]),1==m&&(c=y,u=x),t.globalAlpha=.1,t.beginPath(),t.moveTo(y,x),t.lineTo(a,n),t.lineTo(c,u),t.fill(),t.globalAlpha=1}if(t.textAlign="left",t.textBaseline="middle",this.highlighted){var C="p0"==this.highlighted,w="p1"==this.highlighted;this.littleCircle(t,a,n,C),this.littleCircle(t,r,s,w)}}}},!0),e.Drawing.timecycle=function(){this.name="timecycle",this.printLevels=!0},e.inheritsFrom(e.Drawing.timecycle,e.Drawing.speedarc),e.extend(e.Drawing.timecycle.prototype,{intersected:function(t,i,a){var r=this.p0,n=this.p1,s=this.stx.panels[this.panelName];if(!r||!n||!s)return null;var o={0:r,1:n};for(var l in o)if(this.pointIntersection(o[l][0],o[l][1],a))return this.highlighted="p"+l,{action:"drag",point:"p"+l};return this.lineIntersection(t,i,a,"segment")||a.x0<=this.p0[0]&&a.x1>=r[0]?(this.highlighted=!0,{action:"move",p0:e.clone(r),p1:e.clone(n),tick:t,value:i}):null},render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=0,l=this.getLineColor();t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var h=this.p1[0]-this.p0[0];t.textAlign="center";var c=a,u=i.yAxis.top,d=i.yAxis.bottom,p=this.color;("auto"==p||e.isTransparent(p))&&(p=this.stx.defaultColor);var f=this.fillColor;("auto"==f||e.isTransparent(f))&&(f=this.stx.defaultColor),this.printLevels&&(d-=13);var m={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.highlighted?1:this.defaultOpacity},g=[];t.save(),t.fillStyle=f,t.globalAlpha=.05;do{if(c=this.stx.pixelFromTick(this.p0[0]+o*h,i.chart),o++,a<r&&c>i.left+i.width)break;if(a>r&&c<i.left)break;c<i.left||c>i.left+i.width||(t.beginPath(),t.moveTo(a,u),t.lineTo(c,u),t.lineTo(c,d),t.lineTo(a,d),t.fill(),g.push({c:o,x:c}))}while(h);t.globalAlpha=1;for(var v=0,y=0;y<g.length;y++){if(this.stx.plotLine(g[y].x,g[y].x,0,d,this.highlighted?l:p,"segment",t,i,m),this.printLevels)t.fillStyle=p,this.stx.chart.context.measureText(g[y].c).width+3<this.stx.layout.candleWidth+v?(t.fillText(g[y].c,g[y].x,d+7),v=0):v+=this.stx.layout.candleWidth}if(t.restore(),t.textAlign="left",this.stx.plotLine(a,r,n,s,l,"segment",t,i,m),this.highlighted){var x="p0"==this.highlighted,b="p1"==this.highlighted;this.littleCircle(t,a,n,x),this.littleCircle(t,r,s,b)}else{var S=this.stx.valueFromPixel(i.height/2,i);this.setPoint(0,this.p0[0],S,i.chart),this.setPoint(1,this.p1[0],S,i.chart)}}}},!0),e.Drawing.regression=function(){this.name="regression"},e.inheritsFrom(e.Drawing.regression,e.Drawing.segment),e.extend(e.Drawing.regression.prototype,{configs:["color","lineWidth","pattern","active1","color1","lineWidth1","pattern1","active2","color2","lineWidth2","pattern2","active3","color3","lineWidth3","pattern3"],copyConfig:function(t){e.Drawing.copyConfig(this,t);var i=this.stx.currentVectorParameters;this.active1=!!i.active1,this.active2=!!i.active2,this.active3=!!i.active3,this.color1=i.color1||"auto",this.color2=i.color2||"auto",this.color3=i.color3||"auto",this.lineWidth1=i.lineWidth1,this.lineWidth2=i.lineWidth2,this.lineWidth3=i.lineWidth3,this.pattern1=i.pattern1,this.pattern2=i.pattern2,this.pattern3=i.pattern3},$controls:['cq-cvp-controller[cq-cvp-header="1"]','cq-cvp-controller[cq-cvp-header="2"]','cq-cvp-controller[cq-cvp-header="3"]'],click:function(t,e,i){if(!(e<0)){this.copyConfig();var a=this.stx.panels[this.panelName];if(!this.penDown){this.setPoint(0,e,i,a.chart),this.penDown=!0;var r=this.stx;if(this.field=r.highlightedDataSetField,!this.field&&a!=r.chart.panel){for(var n in r.chart.seriesRenderers){var s=r.chart.seriesRenderers[n];if(s.params.panel==a.name){this.field=s.seriesParams[0].field;break}}for(var o in r.layout.studies){var l=r.layout.studies[o];if(l.panel==a.name){this.field=Object.keys(l.outputMap)[0];break}}}return!1}return this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,a.chart),this.penDown=!1,!0)}},getYValue:function(t){var i=this.stx.chart.dataSet[t],a=this.stx.chart.dataSet[t];if(!i)return null;var r=this.stx.panels[this.panelName],n=this.stx.getYAxisByField(r,this.field)||r.yAxis;if(this.stx.charts[r.name]&&r.chart.transformFunc&&n==r.yAxis&&(a=i.transform),!a)return null;var s=null,o=null,h=this.stx.defaultPlotField||"Close";if(this.field){if(!(o=e.existsInObjectChain(a,this.field)))return null;s=o=o.obj[o.member],i!=a&&(s=(s=e.existsInObjectChain(i,this.field)).obj[s.member]),"object"==l(o)&&(o=o[h],s=s[h])}else o=a[h],s=i[h];return{transformed:o,untransformed:s}},render:function(t){var e=this.stx.panels[this.panelName];if(e&&this.p1&&!(this.p0[0]<0||this.p1[0]<0)){var i=this.stx.pixelFromTick(this.p0[0],e.chart),a=this.stx.pixelFromTick(this.p1[0],e.chart);if(!(i<e.left&&a<e.left||i>e.right&&a>e.right)){for(var r=this.stx.getYAxisByField(e,this.field),n=[],s=[],o=0,l=0,h=0,c=0,u=Math.min(this.p1[0],this.p0[0]),d=Math.max(this.p1[0],this.p0[0])+1,p=d-u,f=u;f<d;f++){var m=this.getYValue(f);m&&(n.push(m.transformed),s.push(m.untransformed))}var g=n.length,v=g*(g+1)/2,y=Math.pow(v,2),x=v*(2*g+1)/3;for(f=0;f<g;f++)h+=g*n[f]-o,o+=n[f],c+=g*s[f]-l,l+=s[f];var b,S,C=(g*h-v*o)/(g*x-y),w=(o-C*v)/g,k=(g*c-v*l)/(g*x-y),D=(l-C*v)/g;this.p0[0]<this.p1[0]?(b=w,S=C*p+w,this.p0[1]=D,this.p1[1]=k*p+D):(b=C*p+w,S=w,this.p0[1]=k*p+D,this.p1[1]=D);var T=this.stx.pixelFromTransformedValue(b,e,r),A=this.stx.pixelFromTransformedValue(S,e,r),M=this.getLineColor(),P={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(i,a,T,A,M,"segment",t,e,P),this.stx.plotLine(i,i,T-20,T+20,M,"segment",t,e,P),this.stx.plotLine(a,a,A-20,A+20,M,"segment",t,e,P),this.active1||this.active2||this.active3){var F=o/g,_=0;for(f=0;f<g;f++)_+=Math.pow(n[f]-F,2);var E={context:t,panel:e,points:{0:{x:i,v:b},1:{x:a,v:S}},stddev:Math.sqrt(_/g),yAxis:r};this.lines={},this.active1&&(this.renderStddev("1","p",E),this.renderStddev("1","n",E)),this.active2&&(this.renderStddev("2","p",E),this.renderStddev("2","n",E)),this.active3&&(this.renderStddev("3","p",E),this.renderStddev("3","n",E))}if(this.highlighted){var L="p0"==this.highlighted,I="p1"==this.highlighted;this.littleCircle(t,i,T,L),this.littleCircle(t,a,A,I)}else this.pixelX=[i,a],this.pixelY=[T,A]}}},renderStddev:function(t,e,i){var a="stddev"+t+e,r="color"+t,n="pattern"+t,s="lineWidth"+t,o=i.points,l=o[0].v,h=o[1].v,c=i.stddev,u="n"===e?-1*t:1*t,d=this.stx,p=i.panel,f=i.yAxis,m={name:a,color:this.getLineColor(this[r]),type:"segment",y0:d.pixelFromTransformedValue(l+c*u,p,f),y1:d.pixelFromTransformedValue(h+c*u,p,f),params:{pattern:this[n],lineWidth:this[s]}};this.lines&&(this.lines[a]=m);var g=i.context,v=o[0].x,y=o[1].x;d.plotLine(v,y,m.y0,m.y1,m.color,m.type,g,p,m.params),d.plotLine(v,v,m.y0-10,m.y0+10,m.color,m.type,g,p,m.params),d.plotLine(y,y,m.y1-10,m.y1+10,m.color,m.type,g,p,m.params);var x=t+"σ",b=Math.max(v,y)+5,S=v<y?m.y1:m.y0;if(g.fillStyle=m.color,g.save(),g.textBaseline="middle",g.fillText(x,b,S),g.restore(),i.formatPrice&&this.axisLabel&&!this.highlighted&&!this.penDown&&(v>=p.chart.left&&v<=p.chart.right||y>=p.chart.left&&y<=p.chart.right)){var C=(v<y?h:l)+c*u;d.endClip(),d.createYAxisLabel(p,i.formatPrice(C,f),S,m.color,null,g,f),d.startClip(p.name)}},intersected:function(t,i,a){if(!this.pixelX||!this.pixelY)return null;var r=this.repositionIntersection(t,i);if(r)return r;for(var n={0:this.pixelX,1:this.pixelY},s=0;s<2;s++)if(this.pointIntersection(n[0][s],n[1][s],a,!0))return this.highlighted="p"+s,{action:"drag",point:"p"+s};var o=this,l=this.pixelX[0],h=this.pixelX[1],c=function(e){var r=[l,e.y0],n=[h,e.y1];return o.lineIntersection(t,i,a,o.name,r,n,!0)},u=c({y0:this.pixelY[0],y1:this.pixelY[1]});if(!u&&this.lines)for(var d in this.lines)if(c(this.lines[d])){u=!0;break}return u?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},repositionIntersection:function(t,i){return!(!this.p0||!this.p1)&&(!(this!=this.stx.repositioningDrawing||!this.highlighted)&&(!0===this.highlighted?{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}:{action:"drag",point:this.highlighted}))},lineIntersection:function(t,i,a,r,n,s,o){if(!o)return console.log(r+" lineIntersection must accept p0 and p1 in pixels.  Please verify and set isPixels=true."),!1;if(n||(n=this.p0),s||(s=this.p1),!n||!s)return!1;var l=this.stx,h=e.convertBoxToPixels(l,this.panelName,a);if(void 0===h.x0)return!1;var c={x0:n[0],x1:s[0],y0:n[1],y1:s[1]};return e.boxIntersects(h.x0,h.y0,h.x1,h.y1,c.x0,c.y0,c.x1,c.y1)},boxIntersection:function(t,e,i){return!(i.cx0>Math.max(this.pixelX[0],this.pixelX[1])||i.cx1<Math.min(this.pixelX[0],this.pixelX[1]))&&!(!this.stx.repositioningDrawing&&(i.cy1<this.pixelY[0]||i.cy0>this.pixelY[1]))},reconstruct:function(t,e){this.stx=t,this.color=e.col,this.color1=e.col1,this.color2=e.col2,this.color3=e.col3,this.active1=e.dev1,this.active2=e.dev2,this.active3=e.dev3,this.panelName=e.pnl,this.pattern=e.ptrn,this.pattern1=e.ptrn1,this.pattern2=e.ptrn2,this.pattern3=e.ptrn3,this.lineWidth=e.lw,this.lineWidth1=e.lw1,this.lineWidth2=e.lw2,this.lineWidth3=e.lw3,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.field=e.fld,this.adjust()},serialize:function(){return{name:this.name,pnl:this.panelName,dev1:this.active1,dev2:this.active2,dev3:this.active3,col:this.color,col1:this.color1,col2:this.color2,col3:this.color3,ptrn:this.pattern,ptrn1:this.pattern1,ptrn2:this.pattern2,ptrn3:this.pattern3,lw:this.lineWidth,lw1:this.lineWidth1,lw2:this.lineWidth2,lw3:this.lineWidth3,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,fld:this.field}}},!0),e.Drawing.trendline=function(){this.name="trendline"},e.inheritsFrom(e.Drawing.trendline,e.Drawing.segment),e.Drawing.trendline.prototype.configs=["color","fillColor","lineWidth","pattern","font"],e.Drawing.trendline.prototype.measure=function(){},e.Drawing.trendline.prototype.reconstruct=function(t,i){e.Drawing.segment.prototype.reconstruct.call(this,t,i),this.callout=new e.Drawing.callout,this.callout.reconstruct(t,i.callout)},e.Drawing.trendline.prototype.serialize=function(){var t=e.Drawing.segment.prototype.serialize.call(this);return t.callout=this.callout.serialize(),t},e.Drawing.trendline.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){if(e.Drawing.segment.prototype.render.call(this,t),!this.callout){this.callout=new e.Drawing.callout;var a=e.Drawing.segment.prototype.serialize.call(this);this.callout.reconstruct(this.stx,a)}this.callout.p0=e.clone(this.p0);var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);if(isFinite(s)&&isFinite(o)){var l=(r+n)/2,h=(s+o)/2;this.fontSize=e.stripPX(this.font&&this.font.size||13);var c=1.2*this.callout.w+("c"==this.callout.stemEntry[0]?0:50),u=c/(Math.sqrt(Math.pow(n-r,2)+Math.pow(o-s,2))||c)*(this.p1[1]<this.p0[1]?1:-1),d=-(o-h)*u+l,p=(n-l)*u+h;this.callout.p0[0]=this.stx.tickFromPixel(d,i.chart),this.callout.p0[1]=this.stx.priceFromPixel(p,i),this.callout.v0=this.callout.p0[1],this.callout.p1=e.clone(this.p0),this.callout.stx=this.stx,this.callout.fillColor=this.fillColor||this.callout.fillColor,this.callout.borderColor=this.color,this.callout.font=this.font||this.callout.font,this.callout.noHandles=!0;var f=this.p1[1]-this.p0[1];this.callout.text=Number(f).toFixed(2)+(0===this.p0[1]?"":" ("+Number(100*f/this.p0[1]).toFixed(2)+"%) ")+Math.abs(this.p1[0]-this.p0[0])+" Bars";var m,g=Math.floor((this.p0[0]+this.p1[0])/2);if(Math.abs(this.p0[0]-this.p1[0])>1&&Math.abs(this.p0[0]-this.p1[0])<20){var v=s+(o-s)/(n-r)*(this.stx.pixelFromTick(g,i.chart)-r);m=this.stx.priceFromPixel(v,i)||h}else m=this.stx.priceFromPixel(h,i);if(this.callout.stem={t:g,v:m},this.callout.renderText(),this.callout.render(t),this.highlighted){var y="p0"==this.highlighted,x="p1"==this.highlighted;this.littleCircle(t,r,s,y),this.littleCircle(t,n,o,x)}}}},e.Drawing.trendline.prototype.lineIntersection=function(t,i,a,r){return e.Drawing.BaseTwoPoint.prototype.lineIntersection.call(this,t,i,a,"segment")},e.Drawing.trendline.prototype.intersected=function(t,i,a){if(!this.p0||!this.p1)return null;var r=this.callout.intersected(t,i,a),n=e.Drawing.segment.prototype.intersected.call(this,t,i,a);return this.callout.highlighted=!(!r&&!n),n||(r?{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}:null)},e.Drawing.average=function(){this.name="average"},e.inheritsFrom(e.Drawing.average,e.Drawing.regression),e.extend(e.Drawing.average.prototype,{configs:e.Drawing.regression.prototype.configs.concat("axisLabel"),measure:function(){if(this.p0&&this.p1){this.stx.setMeasure(0,!1,this.p0[0],this.p1[0],!0,this.name);var t=[],i="";this.active1&&t.push("1"),this.active2&&t.push("2"),this.active3&&t.push("3"),t.length&&(i="&ensp;"+t.join(", ")+" &sigma;");var a=(this.stx.drawingContainer||document).querySelector(".mMeasure"),r=this.stx.controls.mSticky,n=r&&r.querySelector(".mStickyInterior");if(a&&(a.innerHTML+=i),n){var s=[];s.push(e.capitalize(this.name)),s.push(this.field||this.stx.defaultPlotField||"Close"),s.push(n.innerHTML+i),n.innerHTML=s.join("<br>")}}},render:function(t){var e=this.stx.panels[this.panelName];if(e&&this.p1&&!(this.p0[0]<0||this.p1[0]<0)){var i=this.stx.pixelFromTick(this.p0[0],e.chart),a=this.stx.pixelFromTick(this.p1[0],e.chart);if(!(i<e.left&&a<e.left||i>e.right&&a>e.right)){var r,n,s=this.stx.getYAxisByField(e,this.field),o=this.stx,l=Math.min(this.p1[0],this.p0[0]),h=Math.max(this.p1[0],this.p0[0])+1,c=0,u=[];for(r=l;r<h;r++)null!==(n=this.getYValue(r))&&(c+=n.transformed,u.push(n));var d=u.length;if(d){var p=c/d,f=o.pixelFromTransformedValue(p,e,s),m=this.getLineColor(),g={pattern:this.pattern,lineWidth:this.lineWidth};if(o.plotLine(i,a,f,f,m,"segment",t,e,g),o.plotLine(i,i,f-20,f+20,m,"segment",t,e,g),o.plotLine(a,a,f-20,f+20,m,"segment",t,e,g),!this.axisLabel||this.highlighted||this.penDown||(i>=e.chart.left&&i<=e.chart.right||a>=e.chart.left&&a<=e.chart.right)&&(o.endClip(),o.createYAxisLabel(e,C(p,s),f,m,null,t,s),o.startClip(e.name)),this.active1||this.active2||this.active3){var v=0;for(r=0;r<d;r++)n=u[r],v+=Math.pow(n.transformed-p,2);var y=Math.sqrt(v/d),x={context:t,formatPrice:C,panel:e,points:{0:{x:i,v:p},1:{x:a,v:p}},stddev:y,yAxis:s};this.lines={},this.active1&&(this.renderStddev("1","p",x),this.renderStddev("1","n",x)),this.active2&&(this.renderStddev("2","p",x),this.renderStddev("2","n",x)),this.active3&&(this.renderStddev("3","p",x),this.renderStddev("3","n",x))}if(this.highlighted){var b="p0"==this.highlighted,S="p1"==this.highlighted;this.littleCircle(t,i,f,b),this.littleCircle(t,a,f,S)}else this.pixelX=[i,a],this.pixelY=[f,f]}}}function C(t,i){return t=i&&i.priceFormatter?i.priceFormatter(o,e,t):o.formatYAxisPrice(t,e,null,i)}},reconstruct:function(t,i){this.axisLabel=i.al,e.Drawing.regression.prototype.reconstruct.call(this,t,i)},serialize:function(){var t=e.Drawing.regression.prototype.serialize.call(this);return t.al=this.axisLabel,t}},!0),e.Drawing.quadrant=function(){this.name="quadrant"},e.inheritsFrom(e.Drawing.quadrant,e.Drawing.regression),e.extend(e.Drawing.quadrant.prototype,{configs:["color","fillColor","lineWidth","pattern"],copyConfig:function(){this.color=this.stx.currentVectorParameters.currentColor,this.fillColor=this.stx.currentVectorParameters.fillColor,this.lineWidth=this.stx.currentVectorParameters.lineWidth,this.pattern=this.stx.currentVectorParameters.pattern},$controls:[],render:function(t){var i=this.stx,a=i.panels[this.panelName];if(a&&this.p1){var r=i.pixelFromTick(this.p0[0],a.chart),n=i.pixelFromTick(this.p1[0],a.chart);if(!(r<a.left&&n<a.left||r>a.right&&n>a.right)){for(var s=this.stx.getYAxisByField(a,this.field),o=null,l=null,h=Math.min(this.p1[0],this.p0[0]);h<=Math.max(this.p1[0],this.p0[0]);h++){var c=this.getYValue(h);null!==c&&((null===o||c.transformed>o)&&(o=c.transformed),(null===l||c.transformed<l)&&(l=c.transformed))}var u=i.pixelFromTransformedValue(o,a,s),d=i.pixelFromTransformedValue((3*o+l)/4,a,s),p=i.pixelFromTransformedValue((2*o+l)/3,a,s),f=i.pixelFromTransformedValue((o+l)/2,a,s),m=i.pixelFromTransformedValue((o+2*l)/3,a,s),g=i.pixelFromTransformedValue((o+3*l)/4,a,s),v=i.pixelFromTransformedValue(l,a,s);this.p0[1]=0,this.p1[1]=!1;var y=this.getLineColor(),x=this.fillColor;("auto"==x||e.isTransparent(x))&&(x=i.defaultColor),t.fillStyle=x;var b={pattern:this.pattern,lineWidth:this.lineWidth};if(i.plotLine(r,n,u,u,y,"segment",t,a,b),i.plotLine(r,n,v,v,y,"segment",t,a,b),"quadrant"==this.name?(i.plotLine(r,n,d,d,y,"segment",t,a,b),i.plotLine(r,n,g,g,y,"segment",t,a,b)):"tirone"==this.name&&(i.plotLine(r,n,p,p,y,"segment",t,a,b),i.plotLine(r,n,m,m,y,"segment",t,a,b)),i.plotLine(r,r,u,v,y,"segment",t,a,b),i.plotLine(n,n,u,v,y,"segment",t,a,b),i.plotLine(r,n,f,f,y,"segment",t,a,e.extend(b,{opacity:"tirone"==this.name?.2:1})),t.globalAlpha=.1,t.beginPath(),t.fillRect(r,u,n-r,v-u),"quadrant"==this.name?t.fillRect(r,d,n-r,g-d):"tirone"==this.name&&t.fillRect(r,p,n-r,m-p),t.globalAlpha=1,this.highlighted){var S="p0"==this.highlighted,C="p1"==this.highlighted;this.littleCircle(t,r,f,S),this.littleCircle(t,n,f,C)}else this.pixelX=[r,n],this.pixelY=[u,v],a.yAxis.flipped&&this.pixelY.reverse(),this.pixelY.push(f)}}},intersected:function(t,i,a){if(!this.pixelX||!this.pixelY)return null;var r=this.repositionIntersection(t,i);if(r)return r;for(var n=0;n<2;n++)if(this.pointIntersection(this.pixelX[n],this.pixelY[2],a,!0))return this.highlighted="p"+n,{action:"drag",point:"p"+n};return this.boxIntersection(null,null,a)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},reconstruct:function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.field=e.fld,this.adjust()},serialize:function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,fld:this.field}}},!0),e.Drawing.tirone=function(){this.name="tirone"},e.inheritsFrom(e.Drawing.tirone,e.Drawing.quadrant),e.Drawing.elliottwave=function(){this.name="elliottwave",this.lastPoint=0,this.points=[],this.pts=[],this.dx=0,this.dy=-20,this.dragToDraw=!1,this.annotationPoints=[],this.edit=null},e.inheritsFrom(e.Drawing.elliottwave,e.Drawing.annotation),e.Drawing.elliottwave.defaultTemplate={impulse:["I","II","III","IV","V"],corrective:["A","B","C"],decoration:"enclosed",showLines:!0},e.Drawing.elliottwave.prototype.initializeSettings=function(t){t.currentVectorParameters.waveParameters=e.clone(e.Drawing.elliottwave.defaultTemplate)},e.Drawing.elliottwave.prototype.configs=["color","lineWidth","lineColor","pattern","font","waveParameters"],e.Drawing.elliottwave.prototype.$controls=["br[cq-wave-parameters]","cq-wave-parameters"],e.Drawing.elliottwave.prototype.construct=function(t,e){this.stx=t,this.panelName=e.name;var i=t.currentVectorParameters;Object.assign(this,i.waveParameters)},e.Drawing.elliottwave.prototype.serialize=function(){for(var t={},i=0;i<this.points.length;i++)t["d"+i]=this["d"+i],t["tzo"+i]=this["tzo"+i],t["v"+i]=this["v"+i];return t.annotations=this.annotationPoints.join(","),Object.assign({name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,mxSeg:this.maxSegments,show:this.showLines,decor:this.decoration,dx:this.dx,dy:this.dy,trend:this.trend,fnt:e.removeNullValues(e.replaceFields(this.font,{style:"st",size:"sz",weight:"wt",family:"fl"}))},t)},e.Drawing.elliottwave.prototype.reconstruct=function(t,i){this.stx=t,this.color=i.col,this.panelName=i.pnl,this.pattern=i.ptrn,this.lineWidth=i.lw,this.font=e.replaceFields(i.fnt,{st:"style",sz:"size",wt:"weight",fl:"family"}),this.decoration=i.decor,this.showLines=i.show,this.dx=i.dx,this.dy=i.dy,this.trend=i.trend,this.annotationPoints=i.annotations.split(","),"enclosed"===i.decor&&this.calculateRadius(t.chart.tempCanvas.context),this.maxSegments=i.mxSeg,this.reconstructPoints(i),this.adjust()},e.Drawing.elliottwave.prototype.reconstructPoints=function(t){var i=this.stx.panels[this.panelName];if(i)for(var a=0;a<this.annotationPoints.length;a++){this["d"+a]=t["d"+a],this["v"+a]=t["v"+a],this["tzo"+a]=t["tzo"+a];var r=e.strToDateTime(t["d"+a]),n=this.stx.tickFromDate(r,i.chart);this.points.push([n,t["v"+a]])}},e.Drawing.elliottwave.prototype.calculateRadius=function(t){this.getFontString(),t.font=this.fontString;for(var e=0,i=0;i<this.annotationPoints.length;i++){var a=t.measureText(this.annotationPoints[i]).width;e<a&&(e=a)}this.enclosedRadius=e},e.Drawing.elliottwave.prototype.check=function(t,e,i){if(1===i&&2===this.points.length)return!0;var a=this.points[i-1];if(a&&t<=a[0])return!1;var r=this.points[i+1];return!(r&&t>=r[0])&&!!function(t){for(var e=2;e<t.length;e++)if(Math.sign(t[e][1]-t[e-1][1])==Math.sign(t[e-1][1]-t[e-2][1]))return!1;return!0}(this.points)},e.Drawing.elliottwave.prototype.move=function(t,e,i){this.copyConfig(),this.points[this.lastPoint+1]=[e,i],this.render(t)},e.Drawing.elliottwave.prototype.adjust=function(){var t=this.stx.panels[this.panelName];if(t)for(var i=0;this.maxSegments+1>i;i++){var a=this["d"+i];this.setPoint(i,a,this["v"+i],t.chart),this.points[i][0]=this.stx.tickFromDate(e.strToDateTime(a),t.chart),this.points[i][1]=this["v"+i]}},e.Drawing.elliottwave.prototype.click=function(t,e,i){var a=this.stx.panels[this.panelName];if(a)return this.copyConfig(),this.penDown?this.accidentalClick(e,i)?(this.penDown=!0,!1):!!(this.check(e,i,this.lastPoint+1)&&(this.lastPoint++,this.setPoint(this.lastPoint,e,i,a.chart),1===this.lastPoint&&(this.trend=Math.sign(this.v1-this.v0)),this.segment++,this.segment>=this.maxSegments))&&(this.penDown=!1,!0):(this.setPoint(0,e,i,a.chart),this.points.push(this.p0),this.penDown=!0,this.segment=0,this.lastPoint=0,this.impulse&&(this.annotationPoints=this.annotationPoints.concat(this.impulse)),this.corrective&&(this.annotationPoints=this.annotationPoints.concat(this.corrective)),this.annotationPoints.unshift("0"),"enclosed"===this.decoration&&this.calculateRadius(t),this.maxSegments=this.annotationPoints.length-1,this.trend=1,!1)},e.Drawing.elliottwave.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=this.stx,r=this.annotationPoints,n=this.pattern?e.borderPatternToArray(this.lineWidth,this.pattern):[];this.getFontString(),t.font=this.fontString,t.textAlign="center",t.textBaseline="middle",t.lineWidth=this.lineWidth,this.fontString!==this.lastFontString&&this.calculateRadius(t),this.lastFontString=this.fontString;var s=this.getLineColor();t.fillStyle=t.strokeStyle=s,t.save(),t.setLineDash(n);var o,l=this.dx,h=this.dy,c=this.points,u=this.pts,d=!this.showLines&&this.highlighted,p=c.length;if(this.penDown&&this.segment)o=this.trend*(p%2-.5)<0,i.yAxis.flipped&&(o=!o),this.drawDropZone(t,c[p-2][1],this.stx.priceFromPixel(i.yAxis[o?"top":"bottom"]),c[p-2][0]);else if("string"==typeof this.highlighted&&this.stx.repositioningDrawing){var f=parseInt(this.highlighted.substring(1,this.highlighted.length),10);o=this.trend*(f%2-.5)>0;var m=c[f-1],g=c[f+1],v=f>0?m[1]:g[1];g&&(v=Math[o?"max":"min"](v,g[1])),i.yAxis.flipped&&(o=!o),this.drawDropZone(t,v,this.stx.priceFromPixel(i.yAxis[o?"top":"bottom"]),m?m[0]:null,g?g[0]:null)}for(var y=0;y<p;y++){var x=c[y],b=a.pixelFromTick(x[0],i.chart),S=a.pixelFromValueAdjusted(i,x[0],x[1]);u[y]=[b,S]}if(y=0,this.showLines||d){for(t.beginPath(),d&&(t.globalAlpha=.3);y<u.length;y++)t.lineTo(u[y][0],u[y][1]);t.stroke(),y=0}for(t.restore();y<p;y++){var C=y%2?l:-l,w=y%2?h:-h;C*=this.trend,w*=this.trend,i.yAxis.flipped&&(C*=-1,w*=-1);var k=u[y],D=k[2]=k[0]+C,T=k[3]=k[1]+w,A=this.enclosedRadius||8,M=r[y];"parentheses"===this.decoration&&(M="("+M+")"),t.fillText(M,D,T),"enclosed"===this.decoration&&(t.beginPath(),t.arc(D,T,A,0,2*Math.PI,!1),t.stroke()),this.highlighted&&(t.save(),this.littleCircle(t,this.pts[y][0],this.pts[y][1],this.highlighted==="p"+y),t.restore())}}},e.Drawing.elliottwave.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i,s=e.value-a;if("move"===e.action)for(var o=0;e.points.length>o;o++){var l=e.points[o];this.setPoint(o,l[0]-n,l[1]-s,r.chart),this.points[o]=[l[0]-n,l[1]-s]}if("drag"===e.action){var h=e.point;this.points[h]=[i,a],this.check(i,a,h)&&this.setPoint(h,i,a,r.chart)}this.render(t)}},e.Drawing.elliottwave.prototype.intersected=function(t,i,a){if(!this.p0||!this.p1)return null;for(var r,n=0;this.points.length>n;n++){var s=this.points[n];if(this.pointIntersection(s[0],s[1],a))return this.highlighted="p"+n,{action:"drag",point:n,tick:t,value:i};this.points[n+1]&&this.lineIntersection(t,i,a,"segment",s,this.points[n+1])&&(this.highlighted=!0,r={action:"move",points:e.clone(this.points),tick:t,value:i})}return r},e.Drawing.elliottwave.prototype.measure=function(){if(this.points.length>=2){var t=this.points;this.stx.setMeasure(t[0][1],t[t.length-1][1],t[0][0],t[t.length-1][0],!0);var i=this.stx.controls.mSticky,a=i&&i.querySelector(".mStickyInterior");if(a){var r=[];r.push(e.capitalize("Elliott Wave")),this.getYValue&&r.push(this.field||this.stx.defaultPlotField||"Close"),r.push(a.innerHTML),a.innerHTML=r.join("<br>")}}},e.Drawing.printProjection=function(t,i,a){var r=i.arr;if(r.length>1)for(var n=r[0][0],s=Math.round(.75*t.chart.maxTicks),o=1;o<r.length;o++){for(var l=r[o-1][0],h=r[o][0],c=e.strToDateTime(l),u=e.strToDateTime(h).getTime(),d=t.standardMarketIterator(c),p=0;c.getTime()<u;)c=d.next(),p+=1;var f,m=e.strToDateTime(l).getTime();if(m>e.strToDateTime(a[a.length-1].Date).getTime())f=a.length-1,p+=1;else for(f=a.length-1;f>=0&&!(m<=e.strToDateTime(a[f].Date).getTime());f--);var g={x0:0,x1:p,y0:a[f].Close,y1:r[o][1]};n=e.strToDateTime(l),d=t.standardMarketIterator(n);for(var v=!1,y=0;y<=p;y++)if(v?n=d.next():v=!0,!(n.getTime()<=a[a.length-1].DT.getTime())){var x=e.yIntersection(g,y);x||(x=0);var b=Math.round(1e4*x)/1e4;0===b&&(b=r[o][1]);var S={Date:e.yyyymmddhhmmssmmm(n),DT:n,Open:b,Close:b,High:b,Low:b,Volume:0,Adj_Close:b,Split_Close:b,projection:!0};if("minute"==t.layout.interval&&s--<0)break;a[a.length]=S}}}):console.error("drawingAdvanced feature requires first activating drawing feature.")},p=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.computeEquationChart?(e.formatEquation=function(t){for(var e="",i=[],a="",r=!1,n=1;n<t.length;n++){var s=t[n].toUpperCase();"["!=s||r?"]"==s&&r?(r=!1,""!==a&&(i.push(a),e+="["+a+"]"),a=""):r?a+=s:"+"==s||"-"==s||"*"==s||"/"==s||":"==s||"%"==s||"("==s||")"==s?(""!==a&&isNaN(a)?(i.push(a),e+="["+a+"]"):e+=a,":"==s&&(s="/"),e+=s,a=""):" "!=s&&(a+=s):r=!0}return""!==a&&isNaN(a)?(i.push(a),e+="["+a+"]"):e+=a,{equation:e,symbols:i}},e.fetchEquationChart=function(t,i){var a=e.formatEquation(t.symbol),r=a.symbols,n=[],s=t.stx;t.stx=null;for(var o=0;o<r.length;o++){var l=e.shallowClone(t);l.stx=s,l.symbol=r[o],l.symbolObject={symbol:r[o]},n.push(l)}t.stx=s,s.quoteDriver.multiFetch(n,(function(r){var s={};t.loadMoreReplace=!0;for(var o={charge:0},l=0;l<r.length;l++){var h=r[l];if(h.dataCallback.error)return void i({error:h.dataCallback.error});s[h.params.symbol]=h.dataCallback.quotes,t.loadMoreReplace=t.loadMoreReplace&&h.params.loadMoreReplace,t.moreToLoad=t.moreToLoad||h.dataCallback.moreAvailable;var c=h.dataCallback.attribution;c&&(c.charge&&(o.charge+=c.charge),o.source=c.source,void 0===o.exchange?o.exchange=c.exchange:o.exchange!=c.exchange&&(o.exchange=""))}if(n.length||!t.loadMore&&!t.update)try{var u=e.computeEquationChart(a.equation,s);i({quotes:u,moreAvailable:t.moreToLoad,attribution:o})}catch(t){var d={error:"Invalid equation: "+a.equation};t.name&&"NoException"==t.name&&(d.suppressAlert=!0),i(d)}}))}):console.error("equationsAdvanced feature requires first activating equations feature.")},f=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.Marker?(e.ChartEngine.prototype.removeDOMMarker=function(t){console.warn("CIQ.ChartEngine#removeDOMMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance#remove instead."),e.Marker.Performance.prototype.removeDOMMarker.call(t.params.node,t)},e.ChartEngine.prototype.drawMarkers=function(){console.warn("CIQ.ChartEngine#drawMarkers is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawMarkers instead."),e.Marker.Performance.drawMarkers(this)},e.ChartEngine.prototype.calculateMarkerStyles=function(t,i){console.warn("CIQ.ChartEngine#calculateMarkerStyles is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.calculateStyles instead."),e.Marker.Performance.calculateMarkerStyles(this,t,i)},e.ChartEngine.prototype.drawCircleMarker=function(t,i,a){console.warn("CIQ.ChartEngine#drawCircleMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawCircleMarker instead."),e.Marker.Performance.drawCircleMarker(t,i,a)},e.ChartEngine.prototype.drawSquareMarker=function(t,i,a){console.warn("CIQ.ChartEngine#drawSquareMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawSquareMarker instead."),e.Marker.Performance.drawSquareMarker(t,i,a)},e.ChartEngine.prototype.drawCalloutMarker=function(t,i,a){console.warn("CIQ.ChartEngine#drawCalloutMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawCalloutMarker instead."),e.Marker.Performance.drawCalloutMarker(t,i,a)},e.ChartEngine.prototype.drawMarkerStem=function(t,i,a){console.warn("CIQ.ChartEngine#drawMarkerStem is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawMarkerStem instead."),e.Marker.Performance.drawMarkerStem(t,i,a)},e.ChartEngine.prototype.positionDOMMarkers=function(){console.warn("CIQ.ChartEngine#positionDOMMarkers is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawMarkers instead."),e.Marker.Performance.drawMarkers(this)},e.Marker.Performance=function(t){this.params={displayCategory:!0,displayStem:!0,invert:!1,story:"",headline:""},e.extend(this.params,t);var i=this.template=document.createElement("TEMPLATE");i.innerHTML='<div class="stx-marker highlight"><div class="stx-visual"><div class="stx-marker-content"><div class="stx-marker stx-performance-marker stx-marker-expand"><h4></h4><p></p></div></div></div><div class="stx-stem"></div></div>';var a=this.template.content.cloneNode(!0),r=a.querySelector(".stx-marker",i);r.classList.add(t.type),r.classList.add(t.category);var n=a.querySelector(".stx-visual",i),s=a.querySelector(".stx-marker-expand"),o=a.querySelector("h4",i),l=a.querySelector("p",i);if(o.innerText=this.params.headline,l.innerText=this.params.story,this.hasText=!!t.headline||!!t.story,this.deferAttach=!0,this.node=a.firstChild,this.node.params=this.params,this.visual=n,this.expand=s,"callout"===t.type){var h=s.removeChild(o);a.querySelector(".stx-marker-content",i).insertBefore(h,s)}},e.inheritsFrom(e.Marker.Performance,e.Marker.NodeCreator,!1),e.Marker.Performance.consolidateExpanded=function(t){var e=t.markerHelper.highlighted;if(e.length){var i,a,r=e[e.length-1],n=r.params.node;r.consolidated||(r.consolidated=[]);for(var s=e.length-2;s>=0;s--){var o=(i=e[s],a=void 0,(a=i.params.node.expand)&&"none"!==a.style.display?a.innerHTML:""),l="<consolidated>"+o+"</consolidated>";o.length&&(n.expand.innerHTML+=l)}r.stxNodeCreator.quickCache(r)}},e.Marker.Performance.reconstituteExpanded=function(t){var e=t.markerHelper.highlighted;if(e.length&&t.activeMarker)for(var i=(e=[t.activeMarker]).length-1;i>=0;i--)for(var a=e[i].params.node.expand;"CONSOLIDATED"===a.lastElementChild.nodeName;)a.removeChild(a.lastElementChild)},e.Marker.Performance.drawMarkers=function(t){for(var e=t.getMarkerArray("all"),i=t.chart,a=0;a<e.length;a++){var r=e[a],n=r.stxNodeCreator,s=i.dataSegment[0].tick,o=i.dataSegment[i.dataSegment.length-1].tick;s<=r.tick<=o&&n&&n.drawMarker&&n.drawMarker(r)}},e.Marker.Performance.calculateMarkerStyles=function(t,e,i){var a=document.querySelector(".stx-marker-templates");a||((a=document.createElement("DIV")).style.visibility="hidden",a.style.left="-1000px",document.body.append(a)),a.appendChild(e.node);var r=getComputedStyle(e.stxNodeCreator.visual);if(!t.styles.stx_marker_stem){var n=getComputedStyle(document.querySelector(".stx-stem",e.node));t.styles.stx_marker_stem=t.cloneStyle(n)}t.styles[i]=t.cloneStyle(r),a.removeChild(e.node)},e.Marker.Performance.drawCircleMarker=function(t,i,a){var r=t.params.stx.chart.context,n=a.x,s=a.y,o=a.radius,l=a.label,h=a.color?a.color:i.backgroundColor;r.beginPath(),r.setLineDash([]),r.lineWidth=1,r.fillStyle=h,r.strokeStyle=h,r.font="normal bold 12px Roboto, Helvetica, sans-serif",r.arc(n,s,o,0,2*Math.PI,!1),r.fill(),r.stroke(),r.closePath(),l&&(r.fillStyle=e.colorsEqual("white",r.fillStyle)?"black":"white",r.fillText(l.charAt(0).toUpperCase(),n-4,s+1)),(t.highlight||t.active)&&(r.beginPath(),r.arc(n,s,o+4,0,2*Math.PI,!1),r.stroke(),r.closePath())},e.Marker.Performance.drawSquareMarker=function(t,i,a){var r=t.params.stx.chart.context,n=a.x,s=a.y,o=a.half,l=a.label,h=a.color?a.color:i.backgroundColor,c=2*o;r.beginPath(),r.setLineDash([]),r.lineWidth=1,r.fillStyle=h,r.strokeStyle=h,r.font="normal bold 12px Roboto, Helvetica, sans-serif",r.rect(n-o,s-o,c,c),r.fill(),(t.highlight||t.active)&&r.rect(n-o-4,s-o-4,c+8,c+8),r.stroke(),r.closePath(),l&&(r.fillStyle=e.colorsEqual("white",r.fillStyle)?"black":"white",r.fillText(l.charAt(0).toUpperCase(),n-4,s+1))},e.Marker.Performance.drawCalloutMarker=function(t,e,i){var a=t.params.stx.chart.context,r=t.params,n=(i.x,i.y),s=i.half,o=i.midWidth,l=i.headline,h=i.color?i.color:e.backgroundColor,c=2*s||25,u=Math.round(a.measureText(l).width),d=o?2*o:u+8;a.beginPath(),a.setLineDash([]),a.lineWidth=1,a.fillStyle=h,a.strokeStyle=h,a.font="normal bold 12px Roboto, Helvetica, sans-serif",a.rect(r.box.x0,r.box.y0,d,c),a.fill(),a.stroke(),a.closePath(),a.beginPath(),a.fillStyle=t.highlight||t.active?"rgba(255,255,255,0.8)":"rgba(255,255,255,0.65)";var p=(d-(u+20))/2;a.rect(r.box.x0+p,n-s,u+40,22),a.fill(),a.stroke(),a.closePath(),a.fillStyle="black",a.fillText(l,r.box.x0+p+10,n)},e.Marker.Performance.drawMarkerStem=function(t,i,a){var r=t.params.stx.chart.context,n=a.x;a.y;r.beginPath(),r.strokeStyle=i.borderLeftColor,r.setLineDash([1,1]);var s=e.stripPX(i.height),o=a.invert?t.params.box.y0:t.params.box.y1,l=a.invert?t.params.box.y0-s:t.params.box.y1+s;r.moveTo(n,o),r.lineTo(n,l),r.stroke(),r.closePath()},e.Marker.Performance.prototype.drawMarker=function(t){var i=t.params,a=t.params.stx;if(a&&a.chart.dataSegment.length){var r=a.panels[t.params.panelName],n=t.stxNodeCreator.params,s=n.type,o=n.category,l=n.headline,h=n.displayCategory,c=n.color,u=n.invert,d="stx_marker_"+s+"_"+o;a.styles[d]||e.Marker.Performance.calculateMarkerStyles(a,t,d);var p=t.style=a.styles[d],f=a.styles.stx_marker_stem,m=parseInt(p.height,10)/2,g=parseInt(p.width,10)/2,v=n.displayStem?parseInt(f.height,10)+parseInt(f.marginBottom,10):0,y=v+parseInt(p.height,10),x=v?v+m:0,b=a.pixelFromDate(i.x),S=i.node.calculateYPosition({marker:t,panel:r,height:y,half:m,offset:x,inverted:u});(t.tick||0===t.tick)&&(i.box={x0:b-(g||m),y0:S-m,x1:b+(g||m),y1:S+m,midY:m,midX:g||m,stemHeight:v},h||(o=h),a.startClip(r.name),"circle"===s?e.Marker.Performance.drawCircleMarker(t,p,{x:b,y:S,radius:m,label:o,color:c}):"square"===s?e.Marker.Performance.drawSquareMarker(t,p,{x:b,y:S,half:m,label:o,color:c}):"callout"===s?e.Marker.Performance.drawCalloutMarker(t,p,{x:b,y:S,half:m,midWidth:g,headline:l,color:c}):console.warn("Marker type: "+s+" is unsupported with canvas markers!\nSupported Styles are Square, Circle, and Callout."),n.displayStem&&e.Marker.Performance.drawMarkerStem(t,f,{x:b,y:S,invert:u}),a.endClip(),t.attached&&this.positionPopUpNode(t))}},e.Marker.Performance.prototype.positionPopUpNode=function(t){if(t.attached&&t.params.box){var e,i=t.params,a=i.stx,r=i.box,n=t.params.node.expand,s=a.chart.dataSet,o=a.chart.dataSegment;if(t.tick){var l=[s[o[0]&&o[0].tick-1],s[o[0]&&o[0].tick-2]],h=a.getFirstLastDataRecord(l.concat(o),"Date"),c=[s[o[o.length-1].tick+1],s[o[o.length-1].tick+2]],u=a.getFirstLastDataRecord(o.concat(c),"Date",!0);e=h.DT<=s[t.tick].DT&&s[t.tick].DT<=u.DT}else e=!1;if(t.highlight||t.active||(e=!1),n.style.visibility=e?"":"hidden",e){var d,p=a.panels[i.panelName],f=n.rects,m=f.height/2,g=t.node.params.infoOffset||0;d=t.node.params.infoOnLeft?r.x0-f.width-g<p.left?r.x1+g:r.x0-f.width-g:r.x0+f.width>p.right?r.x0-f.width-g:r.x1+g,d-=a.chart.left;var v=r.y0-m>=p.top?r.y0+r.midY-m:r.y0;!i.avoidFlush&&r.y1+r.stemHeight===p.yAxis.bottom&&f.height>r.y1-r.y0+r.stemHeight&&(v=r.y1-f.height+r.stemHeight),v-=a.chart.panel.top;var y="translateX("+Math.floor(d)+"px) translateY("+Math.floor(v)+"px) translateZ(0)";n.style.transform=y,n.transform={translateX:d,translateY:v}}}},e.Marker.Performance.prototype.quickCache=function(t){var i=t.params.node.expand,a=t.style,r=e.stripPX(a.marginLeft)+e.stripPX(a.marginRight)+e.stripPX(a.borderRight)+e.stripPX(a.borderLeft);i.rects=i.getBoundingClientRect(),i.scrollBarWidth=i.rects.width-i.clientWidth-r},e.Marker.Performance.prototype.calculateYPosition=function(t){var e=t.marker,i=t.panel,a=t.height,r=t.half,n=t.offset,s=t.inverted,o=e.params.stx,l=o.chart,h=o.chart.highLowBars,c=l.dataSet[e.tick];if(c){var u,d=h?c.High:c.Close;switch(e.params.yPositioner){case"value":u=e.params.y||0===e.params.y?o.pixelFromPrice(e.params.y,i)-.5*a+r:o.pixelFromPrice(d,i)-n;break;case"above_candle":u=o.pixelFromPrice(d,i)-n;break;case"below_candle":u=o.pixelFromPrice(c.Low||d,i),u+=s&&n?n:r;break;case"on_candle":var p=c.High||c.Close,f=c.Low||0===c.Low||c.Close;u=o.pixelFromPrice((p+f)/2,i)-.5*a+r;break;case"top":u=o.pixelFromPrice(i.yAxis.high,i),u+=s&&n?n:r;break;case"bottom":u=o.pixelFromPrice(i.yAxis.low,i)-(n||r)}return u}},e.Marker.Performance.prototype.prepareForHolder=function(t){var e=this.expand,i=t.params.stx;return e.classList.add(this.params.type),i.markerHelper.domMarkers.push(t),e},e.Marker.Performance.prototype.addToHolder=function(t){var i=this.expand,a=t.params.stx;function r(e){a.activeMarker=t,a.activeMarker.click({cx:e.clientX,cy:e.clientY,panel:a.currentPanel}),e.stopPropagation()}e.Marker.Performance.reconstituteExpanded(a),e.Marker.Performance.consolidateExpanded(a),this.quickCache(t),i.clickClosure||(i.addEventListener("mousedown",r),i.addEventListener("touchstart",r),i.clickClosure=r)},e.Marker.Performance.prototype.remove=function(t){var e=t.params.stx;if(e&&e.markerHelper.domMarkers){var i=e.markerHelper.domMarkers.indexOf(t);if(-1!=i&&e.markerHelper.domMarkers.splice(i,1),t.attached){var a=e.panels[t.params.panelName],r=t.params.node.expand;r.parentNode===a.subholder&&a.subholder.removeChild(r),r.removeEventListener("click",r.clickClosure)}}},e.Marker.Performance.prototype.click=function(t){if(this.hasText){"number"==typeof arguments[0]&&(t={cx:arguments[0],cy:arguments[1],marker:arguments[2],panel:arguments[3]});var e,i=t,a=i.cx,r=(i.cy,i.marker),n=(i.panel,r.params.stx);if(r.attached){var s=this.expand;if(s.rects.width-s.scrollBarWidth+s.transform.translateX<n.backOutX(a)&&n.backOutX(a)<s.rects.width+s.transform.translateX)return;this.remove(r)}else n.addToHolder(r),e=!0;r.attached=!r.attached,r.active=!r.active,e&&r.stxNodeCreator.positionPopUpNode(r)}}):console.error("highPerformanceMarkers feature requires first activating markers feature.")},m=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.Renderer.OHLC.requestNew=function(t,i){for(var a=null,r=i.hlc,n=i.colored,s=i.hollow,o=i.volume,l=i.histogram,h=0;h<t.length;h++){var c=t[h];switch(c){case"bar":case"candle":a=c;break;case"volume":o=!0;break;case"hollow":s=!0;break;case"colored":n=!0;break;case"histogram":l=!0,a="candle";break;case"hlc":r=!0,a="bar";break;default:return null}}return null===a?null:new e.Renderer.OHLC({params:e.extend(i,{type:a,hlc:r,colored:n,hollow:s,volume:o,histogram:l})})},e.Renderer.OHLC.getChartParts=function(t,e){return[{type:"histogram",drawType:"histogram",style:"stx_histogram_up",condition:8,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0,useBorderStyleProp:!0},{type:"histogram",drawType:"histogram",style:"stx_histogram_down",condition:16,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0,useBorderStyleProp:!0},{type:"histogram",drawType:"histogram",style:"stx_histogram_even",condition:32,fill:"fill_color_even",border:"border_color_even",skipIfPass:!0,useColorInMap:!0,useBorderStyleProp:!0},{type:"bar",drawType:"bar",style:t||"stx_bar_chart",border:"border_color",useColorInMap:!0},{type:"bar",drawType:"bar",style:"stx_bar_up",condition:e?8:1,border:"border_color_up",useColorInMap:!0},{type:"bar",drawType:"bar",style:"stx_bar_down",condition:e?16:2,border:"border_color_down",useColorInMap:!0},{type:"bar",drawType:"bar",style:"stx_bar_even",condition:e?32:4,border:"border_color_even",skipIfPass:!0,useColorInMap:!0},{type:"candle",drawType:"shadow",style:"stx_candle_shadow",border:"border_color_up"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_up",condition:8,border:"border_color_up"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_down",condition:16,border:"border_color_down"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_even",condition:32,border:"border_color_even",skipIfPass:!0},{type:"candle",drawType:"candle",style:"stx_candle_up",condition:8,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0,useBorderStyleProp:!0},{type:"candle",drawType:"candle",style:"stx_candle_down",condition:16,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0,useBorderStyleProp:!0},{type:"hollow",drawType:"shadow",style:"stx_hollow_candle_up",condition:1,border:"border_color_up"},{type:"hollow",drawType:"shadow",style:"stx_hollow_candle_down",condition:2,border:"border_color_down"},{type:"hollow",drawType:"shadow",style:"stx_hollow_candle_even",condition:4,border:"border_color_even",skipIfPass:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_up",condition:17,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_down",condition:18,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_even",condition:20,fill:"fill_color_even",border:"border_color_even",skipIfPass:!0,useColorInMap:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_up",condition:9,fill:"fill_color_up",border:"border_color_up"},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_down",condition:10,fill:"fill_color_down",border:"border_color_down"},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_even",condition:12,fill:"fill_color_even",border:"border_color_even"}]},e.Renderer.Bars=function(t){this.construct(t);var e=this.params;e.type="bar",this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.hlc=e.volume=e.hollow=e.histogram=!1},e.inheritsFrom(e.Renderer.Bars,e.Renderer.OHLC,!1),e.Renderer.HLC=function(t){this.construct(t);var e=this.params;e.type="bar",e.hlc=!0,this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.volume=e.hollow=e.histogram=!1},e.inheritsFrom(e.Renderer.HLC,e.Renderer.Bars,!1),e.Renderer.Shading=function(t){this.construct(t),this.beenSetup=!1,this.errTimeout=null,this.params.useChartLegend=!1,this.shading=[],"rangechannel"==this.params.type&&(this.highLowBars=!0)},e.inheritsFrom(e.Renderer.Shading,e.Renderer.Lines,!1),e.Renderer.Shading.requestNew=function(t,i){for(var a=null,r=0;r<t.length;r++){"rangechannel"==t[r]&&(a="rangechannel")}return null===a?null:new e.Renderer.Shading({params:e.extend(i,{type:a})})},e.Renderer.Shading.prototype.setShading=function(t){t.constructor!=Array&&(t=[t]),this.shading=t},e.Renderer.Shading.prototype.draw=function(){var t=this.stx,i=t.panels[this.params.panel].chart;if("rangechannel"==this.params.type)if(this.beenSetup)this.seriesParams.length>2&&this.removeSeries(this.seriesParams[2].id);else{this.beenSetup=!0,this.params.display=this.seriesParams[0].display,this.params.yAxis=this.seriesParams[0].yAxis;var a=this.seriesParams[0].color||"auto",r=this.seriesParams[0].symbol;r&&r+".",this.removeAllSeries(!0);var n=this.params.name;t.addSeries(null,{symbol:r,loadData:!!r,field:"High",renderer:"Shading",name:n,style:"stx_line_up",display:this.params.display}),t.addSeries(null,{symbol:r,loadData:!!r,field:"Low",renderer:"Shading",name:n,style:"stx_line_down",display:this.params.display}),this.setShading({primary:this.seriesParams[0].id,secondary:this.seriesParams[1].id,color:a})}if(!this.shading&&!this.errTimeout){console.log("Warning: no shading scheme set.  Use myRenderer.setShading(scheme) to set.");var s=this;this.errTimeout=setTimeout((function(){s.errTimeout=null}),1e4)}var o,l={};for(o=0;o<this.seriesParams.length;o++){var h={};i.series[this.seriesParams[o].id]&&(h=e.clone(i.series[this.seriesParams[o].id].parameters)),l[this.seriesParams[o].id]={parameters:e.extend(e.extend(h,this.params),this.seriesParams[o]),yValueCache:this.caches[this.seriesParams[o].id]}}if(t.drawSeries(i,l,this.params.yAxis,this),i.legend&&"rangechannel"==this.params.type){i.legend.colorMap||(i.legend.colorMap={});var c=this.params.display,u=[t.getCanvasColor("stx_line_up"),t.getCanvasColor("stx_line_down")];i.legend.colorMap[c]={color:u,display:c,isBase:this==t.mainSeriesRenderer}}for(o in l)this.caches[o]=l[o].yValueCache;function d(t){var e=l[t];if(e){var i=e.parameters.field,a=e.parameters.subField;return i+(a?"."+a:"")}return t}for(o=0;o<this.shading.length;o++){var p=this.shading[o],f=p.color;if("auto"==p.color&&(f=t.defaultColor),p.primary||(p.primary="Close"),!p.secondary&&this.seriesParams[0]&&(p.secondary=this.seriesParams[0].field),p.secondary&&(l[p.primary]||"Close"==p.primary)&&l[p.secondary]&&("Close"!=p.primary||!this.params.yAxis||this.params.yAxis==i.yAxis)){var m=d(p.primary).split("."),g=d(p.secondary).split("."),v={topBand:m[0],topSubBand:m[1],topColor:p.greater||f||t.containerColor,topAxis:this.params.yAxis,bottomBand:g[0],bottomSubBand:g[1],bottomColor:p.lesser||f||t.containerColor,bottomAxis:"Close"==p.primary?null:this.params.yAxis,tension:this.params.tension||i.tension,opacity:.1};(v.topColor||v.bottomColor)&&(!this.params.highlight&&t.highlightedDraggable&&(v.opacity*=.3),e.fillIntersecting(t,this.params.panel,v))}}},e.Renderer.Histogram=function(t){this.construct(t),this.params.type="histogram",this.barsHaveWidth=this.standaloneBars=!0,this.params.yAxis&&(this.params.bindToYAxis=!0,"number"==typeof this.params.yAxis.baseline&&(this.params.yAxis.baseline={value:this.params.yAxis.baseline}))},e.inheritsFrom(e.Renderer.Histogram,e.Renderer,!1),e.Renderer.Histogram.prototype.adjustYAxis=function(){var t=this.params.yAxis;t&&!t.baseline&&(t.min=0,t.highValue/=this.params.heightPercentage||1)},e.Renderer.Histogram.prototype.draw=function(){var t=e.clone(this.params);t.type=t.subtype,this.useSum="stacked"==t.subtype,t.yAxis&&t.yAxis!=this.stx.chart.yAxis||(t.bindToYAxis=!0),this.stx.drawHistogram(t,this.seriesParams);var i=t.yAxis&&t.yAxis.baseline;if(i&&i.color){var a=this.stx.panels[this.params.panel],r=this.stx.pixelFromPrice(i.value,a,this.params.yAxis)-.5;this.stx.plotLine({x0:a.left,x1:a.right,y0:r,y1:r,color:i.color,type:"line",context:a.chart.context,confineToPanel:a,pattern:i.pattern||"solid",lineWidth:i.lineWidth||1,opacity:i.opacity||.8,globalCompositeOperation:"destination-over"})}},e.Renderer.Histogram.prototype.getBasis=function(t,e,i){var a=0;if(t&&this.useSum)for(var r=0;r<this.seriesParams.length;r++){var n=this.seriesParams[r].field;if(n===e)break;var s=t[n];s&&"object"===l(s)&&(s=s[i||this.seriesParams[r].subField||this.stx.chart.defaultPlotField||"Close"]),s&&(a+=s)}return a},e.Renderer.Heatmap=function(t){this.construct(t),this.params.type="heatmap",this.params.highlightable=!1,this.barsHaveWidth=this.standaloneBars=!0},e.inheritsFrom(e.Renderer.Heatmap,e.Renderer,!1),e.Renderer.Heatmap.requestNew=function(t,i){for(var a=null,r=0;r<t.length;r++){"heatmap"==t[r]&&(a="heatmap")}return null===a?null:new e.Renderer.Heatmap({params:e.extend(i,{type:a})})},e.Renderer.Heatmap.prototype.draw=function(){this.stx.drawHeatmap(e.clone(this.params),this.seriesParams)},e.Renderer.Scatter=function(t){this.construct(t),this.standaloneBars=this.barsHaveWidth=!0,this.bounded=!0},e.inheritsFrom(e.Renderer.Scatter,e.Renderer.Lines,!1),e.Renderer.Scatter.requestNew=function(t,i){for(var a=null,r=0;r<t.length;r++){"scatterplot"==t[r]&&(a="scatter")}return null===a?null:new e.Renderer.Scatter({params:e.extend(i,{type:a})})},e.Renderer.Scatter.prototype.drawIndividualSeries=function(t,e){var i=this.stx.panels[e.panel]||t.panel,a={colors:[]};return this.stx.scatter?a=this.stx.scatter(i,e):console.warn("Error, Scatter renderer requires customChart.js"),a}},g=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.Studies?(e.Studies.calculateRSI=function(t,e){var i=e.chart.scrubbed,a=e.inputs.Field;function r(t,e){return 0===e?100:100-100/(1+t/e)}if(a&&"field"!=a||(a="Close"),i.length<e.days+1)e.error=!0;else{for(var n=e.startFrom;n<i.length;n++)if(n){var s=i[n],o=i[n-1];if((s[a]||0===s[a])&&(o[a]||0===o[a])){var l=s[a]-o[a],h=Math.min(n,e.days),c=o["_avgG "+e.name];c||(c=0),c-=c/h;var u=o["_avgL "+e.name];if(u||(u=0),u-=u/h,l>0)c+=l/h;else{if(!(l<=0))continue;u-=l/h}n>=e.days&&(!c&&0===c||!u&&0===u||(s["RSI "+e.name]=r(c,u))),s["_avgG "+e.name]=c,s["_avgL "+e.name]=u}}e.zoneOutput="RSI"}},e.Studies.calculateValuationLines=function(t,e,i){for(var a="field"==e.inputs.Field?"Close":e.inputs.Field,r=e.inputs["Average Type"],n=e.inputs["Display Average"],s=e.inputs["Display 1 Standard Deviation (1σ)"],o=e.inputs["Display 2 Standard Deviation (2σ)"],l=e.inputs["Display 3 Standard Deviation (3σ)"],h=[],c=0;c<i.length;++c)i[c]&&!isNaN(i[c][a])&&h.push(i[c][a]);var u=function(t,e){var i=t.length,a=0,r=0,n=0;switch(e){case"mean":for(r=i;n<i;++n)a+=t[n];break;case"harmonic":for(a=i;n<i;++n)r+=1/t[n];break;case"median":var s=Math.floor(i/2),o=t.slice().sort((function(t,e){return t>e?1:t<e?-1:0}));i%2==0?(a=o[s]+o[s-1],r=2):(a=o[s],r=1)}return a/r}(h,r),d=!(s||o||l)||function(t,e){for(var i=t.length,a=0,r=0;r<i;++r)a+=Math.pow(t[r]-e,2);return Math.sqrt(a/i)}(h,u);e.data={Average:n?[u]:null,"1 Standard Deviation (1σ)":s?[u+d,u-d]:null,"2 Standard Deviation (2σ)":o?[u+2*d,u-2*d]:null,"3 Standard Deviation (3σ)":l?[u+3*d,u-3*d]:null};var p=d;if(e.parameters||(e.parameters={}),l?e.parameters.range=[u-3*d-p,u+3*d+p]:o?e.parameters.range=[u-2*d-p,u+2*d+p]:s?e.parameters.range=[u-d-p,u+d+p]:n&&(e.parameters.range=[u-p,u+p]),e.panel){var f=t.panels[e.panel],m=t.getYAxisByName(f,e.name);if(m){m.decimalPlaces=f.chart.yAxis.printDecimalPlaces;var g={yAxis:m};t.calculateYAxisRange(f,m,e.parameters.range[0],e.parameters.range[1]),t.createYAxis(f,g),t.drawYAxis(f,g)}}},e.Studies.displayValuationLines=function(t,i){var a,r,n,s,o,l,h,c,u,d=t.panels[i.panel],p=i.getYAxis(t),f=i.getContext(t),m=i.data,g=i.parameters.labels,v=i.inputs["Average Type"],y={mean:"AVG",median:"MED",harmonic:"HAVG"},x=t.canvasStyle("ciq-valuation-average-line"),b=t.canvasStyle("ciq-valuation-deviation-line"),S=t.getCanvasFontSize("stx_yaxis")+6;for(var C in m)if(m[C])for(a="Average"==C,r=e.Studies.determineColor(i.outputs[C]),n=m[C],s=0;s<n.length;++s)if(o=n[s],!((l=t.pixelFromPrice(o,d,p))<=d.top||l>=d.yAxis.bottom))if(u=a?{pattern:"none"!=x.borderStyle&&x.borderStyle||"solid",lineWidth:parseFloat(x.borderWidth)||1,opacity:parseFloat(x.opacity)||1,yAxis:p}:{pattern:"none"!=b.borderStyle&&b.borderStyle||"dashed",lineWidth:parseFloat(b.borderWidth)||1,opacity:parseFloat(b.opacity)||1,yAxis:p},t.plotLine(d.left,d.right,l,l,r,"line",f,d,u),"yaxis"!==g){if(!((l+=Math.floor(u.lineWidth/2))+S>=d.yAxis.bottom)){h=(a?y[v]+": ":C[0]+"σ: ")+t.formatYAxisPrice(o,d),c=f.measureText(h).width;var w=d.right-c-3;p&&"left"==p.position&&(w=d.left+3),f.strokeText(h,w,l+S/2+.5)}}else t.createYAxisLabel(d,t.formatYAxisPrice(o,d),l,r,null,f,p)},e.Studies.calculateCorrelationCoefficient=function(t,e){var i=e.chart.scrubbed,a=e.days;if(i.length<a+1)e.error=!0;else{if(e.compare=e.inputs["Compare To"],e.compare)e.compare=[e.compare];else for(var r in e.compare=[],e.outputs={},e.outputMap={},t.chart.series){var n=t.chart.series[r];n.parameters.color&&(e.compare.push(n.display),e.outputs["Result "+n.display]=n.parameters.color,e.outputMap["Result "+n.display+" "+e.name]="Result "+n.display)}if(e.compare.length){for(var s=0;s<e.compare.length;s++)for(var o=0,h=0,c=0,u=0,d=0,p=e.compare[s],f=0,m=e.startFrom-a;m<i.length;m++)if(i[m]){var g=i[m][p];if(g&&"object"==l(g)&&(g=g.Close),g||0===g||(g=m>0&&i[m-1]&&i[m-1]["_temps "+e.name]&&i[m-1]["_temps "+e.name].c?i[m-1]["_temps "+e.name].c:0),g&&"object"==l(g)&&(g=g.Close),i[m]["_temps "+e.name]={},o+=i[m]["_temps "+e.name].b=i[m].Close,h+=i[m]["_temps "+e.name].c=g,c+=i[m]["_temps "+e.name].b2=Math.pow(i[m].Close,2),u+=i[m]["_temps "+e.name].c2=Math.pow(g,2),d+=i[m]["_temps "+e.name].bc=i[m].Close*g,f>=a){o-=i[m-a]["_temps "+e.name].b,h-=i[m-a]["_temps "+e.name].c,c-=i[m-a]["_temps "+e.name].b2,u-=i[m-a]["_temps "+e.name].c2,d-=i[m-a]["_temps "+e.name].bc;var v=c/a-Math.pow(o/a,2),y=u/a-Math.pow(h/a,2),x=(d/a-o*h/Math.pow(a,2))/Math.sqrt(v*y);i[m]["Result "+p+" "+e.name]=x}f++}}else e.error="Correlation Coefficient requires at least one comparison symbol"}},e.Studies.prettify=e.extend({"2-exponential":"dema","3-exponential":"tema",hull:"hma"},e.Studies.prettify),e.extend(e.Studies.movingAverage,{conversions:{hma:"hull",dema:"2-exponential",tema:"3-exponential"},translations:{hull:"Hull","2-exponential":"Double Exponential","3-exponential":"Triple Exponential"},typeMap:{hma:"Hull",hull:"Hull",dema:"DoubleExponential","2-exponential":"DoubleExponential",tema:"TripleExponential","3-exponential":"TripleExponential"}}),e.Studies.calculateMovingAverageHull=function(t,i){var a,r,n=i.chart.scrubbed,s=i.inputs.Field;for(s&&"field"!=s||(s="Close"),e.Studies.MA("wma",i.days,s,0,"_WMA1",t,i),e.Studies.MA("wma",Math.ceil(i.days/2),s,0,"_WMA2",t,i),a=i.startFrom-1;a>=0&&((r=n[a][s])&&"object"==l(r)&&(r=r[i.subField]),!r&&0!==r);a--);for(a++;a<n.length;a++){var o=n[a];o["_MMA "+i.name]=2*o["_WMA2 "+i.name]-o["_WMA1 "+i.name]}var h=parseInt(i.inputs.Offset,10);isNaN(h)&&(h=0);var c=Math.floor(Math.sqrt(i.days));e.Studies.MA("wma",c,"_MMA "+i.name,h,"_HMA",t,i);var u=i.name;for(var d in i.outputs)u=d+" "+u;for(a=Math.max(i.days+c-1,i.startFrom);a<n.length;a++)n[a][u]=n[a]["_HMA "+i.name]},e.Studies.calculateMovingAverageDoubleExponential=function(t,i){var a=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("ema",i.days,r,0,"_EMA1",t,i),e.Studies.MA("ema",i.days,"_EMA1 "+i.name,0,"_EMA2",t,i);var n,s,o=parseInt(i.inputs.Offset,10);isNaN(o)&&(o=0);var h=o;for(n=i.startFrom-1;n>=0;n--)if((s=a[n][r])&&"object"==l(s)&&(s=s[i.subField]),s||0===s){if(!(h>0))break;h--}var c=i.name;for(var u in i.outputs)c=u+" "+c;var d=[];for(n++;n<a.length;n++)if(!(n<2*(i.days-1))){var p=a[n],f=2*p["_EMA1 "+i.name]-p["_EMA2 "+i.name];if(n+o>=0)if(n+o<a.length)a[n+o][c]=f;else{var m={};m[c]=f,d.push(m)}}i.appendFutureTicks(t,d)},e.Studies.calculateMovingAverageTripleExponential=function(t,i){var a=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("ema",i.days,r,0,"_EMA1",t,i),e.Studies.MA("ema",i.days,"_EMA1 "+i.name,0,"_EMA2",t,i),e.Studies.MA("ema",i.days,"_EMA2 "+i.name,0,"_EMA3",t,i);var n,s,o=parseInt(i.inputs.Offset,10);isNaN(o)&&(o=0);var h=o;for(n=i.startFrom-1;n>=0;n--)if((s=a[n][r])&&"object"==l(s)&&(s=s[i.subField]),s||0===s){if(!(h>0))break;h--}var c=i.name;for(var u in i.outputs)c=u+" "+c;var d=[];for(n++;n<a.length;n++)if(!(n<3*(i.days-1))){var p=a[n],f=3*p["_EMA1 "+i.name]-3*p["_EMA2 "+i.name]+p["_EMA3 "+i.name];if(n+o>=0)if(n+o<a.length)a[n+o][c]=f;else{var m={};m[c]=f,d.push(m)}}i.appendFutureTicks(t,d)},e.Studies.calculateATRBands=function(t,i){e.Studies.calculateStudyATR(t,i);var a=i.inputs.Field;a&&"field"!=a||(a="Close"),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Shift,a,"ATR "+i.name)},e.Studies.calculateSTARCBands=function(t,i){e.Studies.calculateStudyATR(t,i),e.Studies.MA("simple",i.inputs["MA Period"],"Close",0,"_MA",t,i),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Multiplier,"_MA "+i.name,"ATR "+i.name)},e.Studies.calculateATRStops=function(t,i){var a=i.chart.scrubbed;if(a){e.Studies.calculateStudyATR(t,i);for(var r=i.inputs.HighLow,n=Math.max(i.startFrom-1,1);n<a.length-1;n++){var s=a[n],o=a[n-1],l=s["Buy Stops "+i.name];if(l||(l=s["Sell Stops "+i.name]),l||(l=0),s&&o){var h=s.Close,c=h,u=s["ATR "+i.name]*i.inputs.Multiplier;s.Close>l&&o.Close>l?(r&&(h=s.High),c=Math.max(l,h-u)):s.Close<=l&&o.Close<=l?(r&&(h=s.Low),c=Math.min(l,h+u)):s.Close>l?(r&&(h=s.High),c=h-u):s.Close<=l&&(r&&(h=s.Low),c=h+u),h<=c?(a[n+1]["Buy Stops "+i.name]=c,delete a[n+1]["Sell Stops "+i.name]):h>c&&(a[n+1]["Sell Stops "+i.name]=c,delete a[n+1]["Buy Stops "+i.name]),a[n+1]["All Stops "+i.name]=c}}i.referenceOutput="All Stops",i.outputMap={},i.outputMap["All Stops "+i.name]=""}},e.Studies.calculateAwesomeOscillator=function(t,i){var a=i.chart.scrubbed;if(a.length<33)i.error=!0;else{e.Studies.MA("simple",5,"hl/2",0,"_MA5",t,i),e.Studies.MA("simple",34,"hl/2",0,"_MA34",t,i);for(var r=Math.max(i.startFrom,33);r<a.length;r++)a[r]&&(a[r][i.name+"_hist"]=a[r]["_MA5 "+i.name]-a[r]["_MA34 "+i.name]);i.outputMap={},i.outputMap[i.name+"_hist"]=""}},e.Studies.calculateRelativeVolatility=function(t,i){i.days=Number(i.inputs["Smoothing Period"]);var a=Number(i.inputs["STD Period"]),r=i.chart.scrubbed;if(r.length<i.days+a)i.error=!0;else{var n=i.inputs.Field;n&&"field"!=n||(n="Close"),i.std=new e.Studies.StudyDescriptor(i.name,"sdev",i.panel),i.std.chart=i.chart,i.std.days=a,i.std.startFrom=i.startFrom,i.std.inputs={Field:n,"Standard Deviations":1,Type:"ma"},i.std.outputs={_STD:null},e.Studies.calculateStandardDeviation(t,i.std);var s=0,o=0;i.startFrom>1&&(s=r[i.startFrom-1]["_avgG "+i.name]||0,o=r[i.startFrom-1]["_avgL "+i.name]||0);for(var l=Math.max(i.startFrom,i.days);l<r.length;l++){var h=r[l],c=r[l-1];(h[n]||0===h[n])&&((c[n]||0===c[n])&&(h["_STD "+i.name]||0===h["_STD "+i.name])&&(h[n]>c[n]?(s=(s*(i.days-1)+h["_STD "+i.name])/i.days,o=o*(i.days-1)/i.days):(o=(o*(i.days-1)+h["_STD "+i.name])/i.days,s=s*(i.days-1)/i.days),h["Rel Vol "+i.name]=u(s,o),h["_avgG "+i.name]=s,h["_avgL "+i.name]=o))}i.zoneOutput="Rel Vol"}function u(t,e){return t+e===0?100:100*t/(t+e)}},e.Studies.calculatePMO=function(t,i){var a={Smooth:Number(i.inputs["Smoothing Period"])-1,Double:Number(i.inputs["Double Smoothing Period"])-1,Signal:Number(i.inputs["Signal Period"])},r=i.chart.scrubbed;if(r.length<a.Smooth+a.Double)i.error=!0;else{var n,s=i.inputs.Field;for(s&&"field"!=s||(s="Close"),n=i.startFrom;n<r.length;n++)if(r[n]&&r[n-1]){var o=r[n-1][s];o&&(r[n]["_ROCx10 "+i.name]=1e3*(r[n][s]/o-1))}e.Studies.MA("exponential",a.Smooth,"_ROCx10 "+i.name,0,"_EMAx10",t,i),e.Studies.MA("exponential",a.Double,"_EMAx10 "+i.name,0,"PMO",t,i),e.Studies.MA("exponential",a.Signal,"PMO "+i.name,0,"PMOSignal",t,i),i.zoneOutput="PMO"}},e.Studies.calculateElderImpulse=function(t,i){var a,r=i.chart.scrubbed,n=i.outputs.Bullish,s=i.outputs.Bearish,o=i.outputs.Neutral;e.Studies.MA("exponential",13,"Close",0,"_MA",t,i),i.macd=new e.Studies.StudyDescriptor("_"+i.name,"macd",i.panel),i.macd.chart=i.chart,i.macd.days=i.days,i.macd.startFrom=i.startFrom,i.macd.inputs={"Fast MA Period":12,"Slow MA Period":26,"Signal Period":9},i.macd.outputs={_MACD:null,_Signal:null},e.Studies.calculateMACD(t,i.macd);for(var l=i.startFrom;l<r.length;l++)a=0===l?o:r[l]["_MA "+i.name]>r[l-1]["_MA "+i.name]&&r[l]["_"+i.name+"_hist"]>r[l-1]["_"+i.name+"_hist"]?n:r[l]["_MA "+i.name]<r[l-1]["_MA "+i.name]&&r[l]["_"+i.name+"_hist"]<r[l-1]["_"+i.name+"_hist"]?s:o,r[l]["Result "+i.name]=a},e.Studies.calculatePivotPoints=function(t,i){var a=i.chart.scrubbed,r="day";if("day"==t.layout.interval)r="month";else if(e.ChartEngine.isDailyInterval(t.layout.interval))r="year";else if("second"==t.layout.interval||"millisecond"==t.layout.interval||"second"==t.layout.timeUnit||"millisecond"==t.layout.timeUnit)r="15min";else{var n=t.layout.periodicity;"minute"!=t.layout.interval&&(n*=t.layout.interval),n>=30&&(r="week")}var s=e.Market.Symbology.isForexSymbol(t.chart.symbol),o=e.Market.Symbology.isForexMetal(t.chart.symbol),l=null,h={pivotPoint:NaN,high:0,low:0,prevHigh:0,prevLow:0,hlSpread:0};function c(){h.pivotPoint=(h.high+h.low+a[u-1].Close)/3,h.prevHigh=h.high,h.prevLow=h.low,h.hlSpread=h.high-h.low,h.high=h.low=0}i.startFrom>1&&a[i.startFrom-1]["_pointers "+i.name]&&(h=e.clone(a[i.startFrom-1]["_pointers "+i.name]));for(var u=Math.max(1,i.startFrom);u<a.length;u++)if(a[u-1]){if(h.high=Math.max(h.high,a[u-1].High),h.low=Math.min(h.low>0?h.low:a[u-1].Low,a[u-1].Low),i.inputs.Continuous)c();else if("year"==r&&a[u].DT.getYear()!=a[u-1].DT.getYear())c();else if("month"==r&&a[u].DT.getMonth()!=a[u-1].DT.getMonth())c();else if("week"==r&&a[u].DT.getDay()<a[u-1].DT.getDay())c();else if("day"==r){null===l&&(l=e.Studies.getMarketOffset(t,a[u].DT,s),s&&(l+=60*(o?6:7)*60*1e3));var d=new Date(new Date(+a[u].DT).setMilliseconds(a[u].DT.getMilliseconds()+l)),p=new Date(new Date(+a[u-1].DT).setMilliseconds(a[u-1].DT.getMilliseconds()+l));p.getDate()!==d.getDate()&&0!==p.getDay()&&t.chart.market.isMarketDate(d)&&(l=null,c())}else"15min"!=r||a[u].DT.getHours()==a[u-1].DT.getHours()&&Math.floor(a[u].DT.getMinutes()/15)==Math.floor(a[u-1].DT.getMinutes()/15)||c();a[u]["Pivot "+i.name]=h.pivotPoint,"fibonacci"==i.inputs.Type.toLowerCase()?(a[u]["Resistance 1 "+i.name]=h.pivotPoint+.382*h.hlSpread,a[u]["Resistance 2 "+i.name]=h.pivotPoint+.618*h.hlSpread,a[u]["Resistance 3 "+i.name]=h.pivotPoint+h.hlSpread,a[u]["Support 1 "+i.name]=h.pivotPoint-.382*h.hlSpread,a[u]["Support 2 "+i.name]=h.pivotPoint-.618*h.hlSpread,a[u]["Support 3 "+i.name]=h.pivotPoint-h.hlSpread):(a[u]["Resistance 1 "+i.name]=2*h.pivotPoint-h.prevLow,a[u]["Resistance 2 "+i.name]=h.pivotPoint+h.hlSpread,a[u]["Resistance 3 "+i.name]=h.prevHigh+2*(h.pivotPoint-h.prevLow),a[u]["Support 1 "+i.name]=2*h.pivotPoint-h.prevHigh,a[u]["Support 2 "+i.name]=h.pivotPoint-h.hlSpread,a[u]["Support 3 "+i.name]=h.prevLow-2*(h.prevHigh-h.pivotPoint)),a[u]["_pointers "+i.name]=e.clone(h)}},e.Studies.calculateMFI=function(t,e){var i,a=e.chart.scrubbed,r=0,n=e.inputs["Scale Factor"];n||(n=e.study.inputs["Scale Factor"]);var s,o=Math.pow(10,Number(n));for(e.startFrom>1&&(r=a[e.startFrom-1]["_high "+e.name]),s=e.startFrom;s<a.length;s++)a[s]&&a[s].Volume&&(a[s][e.name+"_hist"]=i=o*(a[s].High-a[s].Low)/a[s].Volume,a[s]["_high "+e.name]=r=Math.max(r,i));e.outputMap={},e.outputMap[e.name+"_hist"]=""},e.Studies.calculateAlligator=function(t,i){var a={J:Number(i.inputs["Jaw Period"]),T:Number(i.inputs["Teeth Period"]),L:Number(i.inputs["Lips Period"])},r=i.chart.scrubbed;if(r.length<Math.max(a.J,a.T,a.L)+1)i.error=!0;else{("Gator"===i.type||i.inputs["Show Lines"])&&(e.Studies.MA("welles wilder",a.J,"hl/2",i.inputs["Jaw Offset"],"Jaw",t,i),e.Studies.MA("welles wilder",a.T,"hl/2",i.inputs["Teeth Offset"],"Teeth",t,i),e.Studies.MA("welles wilder",a.L,"hl/2",i.inputs["Lips Offset"],"Lips",t,i));for(var n=i.startFrom;n<r.length;n++)if(r[n]){if("Gator"==i.type){var s=r[n]["Jaw "+i.name],o=r[n]["Lips "+i.name],l=r[n]["Teeth "+i.name];(l||0===l)&&((s||0===s)&&(r[n][i.name+"_hist1"]=Math.abs(s-l)),(o||0===o)&&(r[n][i.name+"_hist2"]=-Math.abs(l-o))),i.outputMap={},i.outputMap[i.name+"_hist1"]="",i.outputMap[i.name+"_hist2"]=""}if(i.inputs["Show Fractals"]){if(!(r[n-2]&&r[n-1]&&r[n]&&r[n+1]&&r[n+2]))continue;r[n-2].High&&r[n-1].High&&r[n].High&&r[n+1].High&&r[n+2].High&&r[n].High>r[n-1].High&&r[n].High>r[n-2].High&&r[n].High>r[n+1].High&&r[n].High>r[n+2].High&&(r[n]["Fractal High "+i.name]=1),r[n-2].Low&&r[n-1].Low&&r[n].Low&&r[n+1].Low&&r[n+2].Low&&r[n].Low<r[n-1].Low&&r[n].Low<r[n-2].Low&&r[n].Low<r[n+1].Low&&r[n].Low<r[n+2].Low&&(r[n]["Fractal Low "+i.name]=1)}}}},e.Studies.calculateRelativeVigor=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r;for(r=i.startFrom;r<a.length;r++){var n=a[r];isNaN(n.Close)||isNaN(n.Open)||(n["_Change "+i.name]=n.Close-n.Open),isNaN(n.High)||isNaN(n.Low)||(n["_Range "+i.name]=n.High-n.Low)}e.Studies.MA("triangular",4,"_Change "+i.name,0,"_Numer",t,i),e.Studies.MA("triangular",4,"_Range "+i.name,0,"_Denom",t,i);var s=[],o=[];for(r=Math.max(i.startFrom-i.days,0);r<a.length&&!a[r].futureTick;r++)if(null!==a[r]["_Numer "+i.name]||null!==a[r]["_Denom "+i.name]){s.push(a[r]["_Numer "+i.name]),o.push(a[r]["_Denom "+i.name]),s.length>i.days&&(s.shift(),o.shift());var l,h=0,c=0;for(l=0;l<s.length;l++)h+=s[l];for(l=0;l<o.length;l++)c+=o[l];0===c&&(c=1e-8),r<i.startFrom||(a[r]["Rel Vig "+i.name]=h/c)}for(e.Studies.MA("triangular",4,"Rel Vig "+i.name,0,"RelVigSignal",t,i),r=i.startFrom;r<a.length;r++)a[r][i.name+"_hist"]=a[r]["Rel Vig "+i.name]-a[r]["RelVigSignal "+i.name];i.outputMap[i.name+"_hist"]=""}},e.Studies.calculateUlcerIndex=function(t,i){var a=i.chart.scrubbed;if(a.length<2*i.days-1)i.error=!0;else{var r,n=i.inputs.Field;for(n&&"field"!=n||(n="Close"),r=Math.max(i.startFrom,i.days-1);r<a.length;r++)a[r]["_PD2 "+i.name]=Math.pow(100*(a[r][n]/o(i.days,r,n)-1),2);for(e.Studies.MA("simple",i.days,"_PD2 "+i.name,0,"_MA",t,i),r=Math.max(i.startFrom,2*(i.days-1));r<a.length;r++){var s=a[r]["_MA "+i.name];(s||0===s)&&(a[r]["Result "+i.name]=Math.sqrt(s))}}function o(t,e,i){for(var r=null,n=e-t+1;n<=e;n++)n<0||(r=null===r?a[n][i]:Math.max(r,a[n][i]));return r}},e.Studies.calculateChoppiness=function(t,i){e.Studies.calculateStudyATR(t,i);var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else for(var r=Math.max(i.startFrom,i.days);r<a.length;r++){var n=a[r];if(n){if(n.futureTick)break;var s=o(i.days,r);n["Sum True Range "+i.name]?n["Result "+i.name]=100*Math.log(n["Sum True Range "+i.name]/Math.max(1e-6,s[1]-s[0]))/Math.log(i.days):isNaN(n)||(n["Result "+i.name]=0)}}function o(t,e){for(var i=-1*Number.MAX_VALUE,r=Number.MAX_VALUE,n=e-t+1;n<=e;n++)n<0||(i=Math.max(i,a[n].High),r=Math.min(r,a[n].Low));return[r,i]}},e.Studies.calculateDisparity=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,r,0,"_MA",t,i);for(var n=Math.max(i.startFrom,i.days-1);n<a.length;n++)if(a[n]){var s=a[n]["_MA "+i.name];s&&(a[n]["Result "+i.name]=100*(a[n][r]/s-1))}}},e.Studies.calculateRainbow=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r=i.inputs.Field;r&&"field"!=r||(r="Close");for(var n=r,s=1;s<=10;s++)e.Studies.MA("simple",i.days,n,0,"SMA"+s,t,i),n="SMA"+s+" "+i.name;for(var o=Math.max(i.startFrom,10);o<a.length;o++)if(a[o]){if(a[o].futureTick)break;var l=0,h=0,c=-1*Number.MAX_VALUE,u=Number.MAX_VALUE;for(s=1;s<=10;s++){var d=a[o]["SMA"+s+" "+i.name];(d||0===d)&&(l+=d,h++,c=Math.max(c,d),u=Math.min(u,d))}if(i.name.indexOf("Osc")>-1){var p=f(i.inputs["HHV/LLV Lookback"],o);h&&(a[o][i.name+"_hist"]=100*(a[o][r]-l/h)/Math.max(1e-6,p[1]-p[0]),a[o]["Over "+i.name]=100*(c-u)/Math.max(1e-6,p[1]-p[0]),a[o]["Under "+i.name]=-a[o]["Over "+i.name],a[o]["Zero "+i.name]=0)}}i.name.indexOf("Osc")>-1&&(i.outputMap={},i.outputMap["Over "+i.name]="Positive Bar",i.outputMap["Under "+i.name]="Negative Bar",i.outputMap["Zero "+i.name]="",i.outputMap[i.name+"_hist"]="")}function f(t,e){for(var i=-1*Number.MAX_VALUE,r=Number.MAX_VALUE,n=e-t+1;n<=e;n++)n<0||(i=Math.max(i,a[n].Close),r=Math.min(r,a[n].Close));return[r,i]}},e.Studies.calculateKST=function(t,i){var a=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var n={},s={};n[1]=Number(i.inputs["Lightest Rate of Change Period"]),n[2]=Number(i.inputs["Light Rate of Change Period"]),n[3]=Number(i.inputs["Heavy Rate of Change Period"]),n[4]=Number(i.inputs["Heaviest Rate of Change Period"]),s[1]=Number(i.inputs["Lightest SMA Period"]),s[2]=Number(i.inputs["Light SMA Period"]),s[3]=Number(i.inputs["Heavy SMA Period"]),s[4]=Number(i.inputs["Heaviest SMA Period"]);var o,l,h=Number(i.inputs["Signal Period"]);for(o=i.startFrom;o<a.length;o++)if(a[o])for(l=1;l<=4;l++)o>=n[l]&&a[o-n[l]]&&a[o-n[l]][r]&&(a[o]["_ROC"+l+" "+i.name]=100*(a[o][r]/a[o-n[l]][r]-1));for(l=1;l<=4;l++)e.Studies.MA("simple",s[l],"_ROC"+l+" "+i.name,0,"_SMA"+l,t,i);for(o=i.startFrom;o<a.length;o++)for(a[o]["KST "+i.name]=null,l=1;l<=4;l++){var c=a[o]["_SMA"+l+" "+i.name];(c||0===c)&&(a[o]["KST "+i.name]+=l*c)}e.Studies.MA("simple",h,"KST "+i.name,0,"KSTSignal",t,i)},e.Studies.calculateSpecialK=function(t,i){var a=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var n=i.inputs.Interval;n||(n="daily");var s,o,l={daily:[10,15,20,30,50,65,75,100,195,265,390,530],weekly:[4,5,6,8,10,13,15,20,39,52,78,104]},h={daily:[10,10,10,15,50,65,75,100,130,130,130,195],weekly:[4,5,6,8,10,13,15,20,26,26,26,39]};for(s=i.startFrom;s<a.length;s++)if(a[s])for(o=0;o<l[n].length;o++)s>=l[n][o]&&a[s-l[n][o]]&&a[s-l[n][o]][r]&&(a[s]["_ROC"+o+" "+i.name]=100*(a[s][r]/a[s-l[n][o]][r]-1));for(o=0;o<h[n].length;o++)e.Studies.MA("daily"==n?"simple":"exponential",h[n][o],"_ROC"+o+" "+i.name,0,"_MA"+o,t,i);for(s=i.startFrom;s<a.length;s++)for(a[s]["Result "+i.name]=null,o=0;o<h[n].length;o++){var c=a[s]["_MA"+o+" "+i.name];(c||0===c)&&(a[s]["Result "+i.name]+=(o%4+1)*c)}},e.Studies.calculateDarvas=function(t,i){var a=i.chart.scrubbed,r=0,n=parseInt(i.inputs["ATH Lookback Period"],10);i.inputs["Volume Spike"]&&e.Studies.MA("simple",n,"Volume",0,"ADV",t,i);var s,o=parseFloat(i.inputs["Volume % of Avg"])/100,l="none",h={},c=null,u=null,d=null,p=parseFloat(i.inputs["Level Offset"]);var f={};for(["Darvas","Ghost","Profit","Loss","ATH","ADV","Spike"].forEach((function(t){f[t]=t+" "+i.name})),s=i.startFrom-1;s>0;s--){var m=a[s];if(!m[f.Darvas]&&!m[f.Ghost]){r=m[f.ATH]||0,u=m[f.Profit],d=m[f.Loss];break}for(var g in f)m[g]=null}for(;s<a.length;s++){var v=a[s];if(v){if(parseFloat(i.inputs["Price Minimum"])<=a[r].Close){if(!c||c.End&&s!=c.End+1||(a[s-1].Close>h.High?h={State:1,High:2*h.High-h.Low,Low:h.High,Start:s,End:2*h.End-h.Start+1}:c=null,c&&(v[f.Ghost]=e.clone(h),h.State=0,a[h.End]&&(a[h.End][f.Ghost]=e.clone(h)),c={Start:h.Start,End:h.End},u=h.High+p,(!d||d<h.Low-p)&&(d=h.Low-p))),v[f.Profit]=u,v[f.Loss]=d,(v.Close>=u||"high/low"==i.inputs["Exit Field"]&&v.High>=u)&&(u=null),"none"==l&&s==r+3&&!a[r+2][f.Darvas]&&!a[r+1][f.Darvas]&&!a[r][f.Darvas]&&a[r].High>v.High&&(l="high"),"high"==l&&(v.High>a[r].High?l="none":a[s-3].Low<a[s-2].Low&&a[s-3].Low<a[s-1].Low&&a[s-3].Low<v.Low&&(h={State:1,High:a[r].High,Low:a[s-3].Low,Start:r},a[r][f.Darvas]=e.clone(h),l="darvas",c&&(c.End>s&&a[c.Start]&&(v[f.Ghost]=e.clone(a[c.Start][f.Ghost]),v[f.Ghost].End=s,a[c.End]&&delete a[c.End][f.Ghost]),v[f.Ghost].State=0,a[c.Start][f.Ghost].End=s,c=null),u=h.High+p,(!d||d<h.Low-p)&&(d=h.Low-p))),"darvas"==l&&(v.Close>h.High||"high/low"==i.inputs["Exit Field"]&&v.High>h.High?c={}:(v.Close<h.Low||"high/low"==i.inputs["Exit Field"]&&v.Low<h.Low)&&(l="none"),c?l="none":"none"==l&&(u=null,d=null),i.inputs["Ghost Boxes"]||(c=null),"none"==l)){for(var y=h.Start+1;y<s;y++)a[y][f.Darvas]=e.clone(h);h.State=0,h.End=s,v[f.Darvas]=e.clone(h),v[f.ATH]=r;continue}d&&(v.Close<h.Low||"high/low"==i.inputs["Exit Field"]&&v.Low<h.Low)&&("darvas"==l&&(l="none"),(v.Close<d||"high/low"==i.inputs["Exit Field"]&&v.Low<d)&&(u=null,d=null),c&&(c.End>s&&a[c.Start]&&(v[f.Ghost]=e.clone(a[c.Start][f.Ghost]),v[f.Ghost].End=s,a[c.End]&&delete a[c.End][f.Ghost]),v[f.Ghost].State=0,a[c.Start][f.Ghost].End=s,c=null))}if(v.High>=a[r].High&&(r=s),(s<3||v.High>=a[s-1].High&&v.High>=a[s-2].High&&v.High>=a[s-3].High)&&s-r>=n){r=s;for(var x=0;x<n&&!(s-x<0);x++)a[s-x].High>a[r].High&&(r=s-x);0}i.inputs["Volume Spike"]&&s>n&&s==r&&v[f.ADV]*o<v.Volume&&(v[f.Spike]=1),v[f.ATH]=r}}},e.Studies.calculateSupertrend=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{e.Studies.calculateStudyATR(t,i);for(var r=i.startFrom;r<a.length;r++){var n=a[r];if(n){var s=(n.High+n.Low)/2,o=i.inputs.Multiplier*n["ATR "+i.name],l=s-o,h=s+o;r&&(a[r-1]&&a[r-1].Close&&a[r-1].Close>a[r-1]["_Uptrend "+i.name]&&a[r-1]["_Uptrend "+i.name]>l&&(l=a[r-1]["_Uptrend "+i.name]),a[r-1]&&a[r-1].Close&&a[r-1].Close<a[r-1]["_Downtrend "+i.name]&&a[r-1]["_Downtrend "+i.name]<h&&(h=a[r-1]["_Downtrend "+i.name])),n["_Direction "+i.name]=1,r&&(n["_Direction "+i.name]=a[r-1]["_Direction "+i.name],n.Close>a[r-1]["_Downtrend "+i.name]?n["_Direction "+i.name]=1:n.Close<a[r-1]["_Uptrend "+i.name]&&(n["_Direction "+i.name]=-1)),n["_Uptrend "+i.name]=l,n["_Downtrend "+i.name]=h,n["Trend "+i.name]=n["_Direction "+i.name]>0?l:h}}i.outputMap={},i.outputMap["Trend "+i.name]=""}},e.Studies.calculatePriceRelative=function(t,i){var a=i.chart.scrubbed,r=i.inputs["Comparison Symbol"].toUpperCase();r||(r=i.study.inputs["Comparison Symbol"]);var n={},s=t.chart.symbol||"";if(n[s=s.replace(/[=+\-*\\%]/g,"")]=a.slice(i.startFrom),n[s].length){s!=r&&(n[r]=null);for(var o=e.computeEquationChart("["+s+"]/["+r+"]",n),l=0,h=i.startFrom;h<a.length&&l<o.length;h++){for(;l<o.length&&a[h].DT.getTime()>o[l].DT.getTime();)l++;a[h].DT.getTime()<o[l].DT.getTime()||(a[h]["Result "+i.name]=o[l].Close,l++)}}},e.Studies.calculatePerformance=function(t,i){var a=i.chart.scrubbed,r=i.inputs["Comparison Symbol"].toUpperCase();if(r||(r=i.study.inputs["Comparison Symbol"]),i.days||(i.days=i.study.inputs.Period),a.length<i.days+1)i.error=!0;else{e.Studies.MA("ma",i.days,"Close",0,"_MA Base",t,i),e.Studies.MA("ma",i.days,r,0,"_MA Comp",t,i);for(var n=i.startFrom;n<a.length;n++){var s=a[n][r];s&&(s.Close||0===s.Close)&&(s=s.Close),a[n]["Result "+i.name]=a[n].Close/s*(a[n]["_MA Comp "+i.name]/a[n]["_MA Base "+i.name])}}},e.Studies.calculateBeta=function(t,i){var a=i.chart.scrubbed,r=i.inputs["Comparison Symbol"].toUpperCase();if(r||(r=i.study.inputs["Comparison Symbol"]),i.days||(i.days=i.study.inputs.Period),a.length<i.days+1)i.error=!0;else{for(var n=Math.max(i.startFrom,1);n<a.length;n++){a[n]["_BaseChange "+i.name]=a[n].Close/a[n-1].Close-1;var s=a[n][r];s&&(s.Close||0===s.Close)&&(s=s.Close);var o=a[n-1][r];o&&(o.Close||0===o.Close)&&(o=o.Close),a[n]["_CompChange "+i.name]=s/o-1}for(e.Studies.MA("ma",i.days,"_BaseChange "+i.name,0,"_MA Base",t,i),e.Studies.MA("ma",i.days,"_CompChange "+i.name,0,"_MA Comp",t,i),n=Math.max(i.startFrom,i.days);n<a.length;n++)a[n]["_COVARn "+i.name]=(a[n]["_BaseChange "+i.name]-a[n]["_MA Base "+i.name])*(a[n]["_CompChange "+i.name]-a[n]["_MA Comp "+i.name]),a[n]["_VARn "+i.name]=Math.pow(a[n]["_CompChange "+i.name]-a[n]["_MA Comp "+i.name],2);for(e.Studies.MA("ma",i.days,"_COVARn "+i.name,0,"_COVAR",t,i),e.Studies.MA("ma",i.days,"_VARn "+i.name,0,"_VAR",t,i),n=Math.max(i.startFrom,2*i.days-1);n<a.length;n++)a[n]["Result "+i.name]=a[n]["_COVAR "+i.name]/a[n]["_VAR "+i.name]}},e.Studies.calculateVortex=function(t,i){var a=i.chart.scrubbed,r=i.days;if(a.length<r+1)i.error=!0;else{var n={tr:0,vmPlus:0,vmMinus:0};i.startFrom>1&&(n=e.clone(a[i.startFrom-1]["_totals "+i.name]));for(var s=Math.max(i.startFrom,1);s<a.length;s++){var o=a[s],l=a[s-1],h=Math.abs(o.High-l.Low),c=Math.abs(o.Low-l.High),u=Math.max(o.High,l.Close)-Math.min(o.Low,l.Close);n.tr+=u,n.vmPlus+=h,n.vmMinus+=c,s>r&&(n.tr-=a[s-r]["_True Range "+i.name],n.vmPlus-=a[s-r]["_VMPlus "+i.name],n.vmMinus-=a[s-r]["_VMMinus "+i.name]),o["_True Range "+i.name]=u,o["_VMPlus "+i.name]=h,o["_VMMinus "+i.name]=c,s>=r&&(o["+VI "+i.name]=n.vmPlus/n.tr,o["-VI "+i.name]=n.vmMinus/n.tr),o["_totals "+i.name]=e.clone(n)}}},e.Studies.calculateBalanceOfPower=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{for(var r=i.startFrom;r<a.length;r++){var n=a[r];n["_Ratio "+i.name]=n.Close-n.Open,n.High-n.Low!=0&&(n["_Ratio "+i.name]/=n.High-n.Low)}e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_Ratio "+i.name,0,"Result",t,i)}},e.Studies.calculateTrendIntensity=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("ma",i.days,r,0,"_SMA",t,i);var n,s,o=0,l=0,h=[],c=Math.ceil(i.days/2);for(n=Math.max(0,i.startFrom-c);n<a.length;n++)(a[n]["_SMA "+i.name]||0===a[n]["_SMA "+i.name])&&((s=a[n][r]-a[n]["_SMA "+i.name])<0?l+=-1*s:o+=s,h.push(s),h.length>c&&((s=h.shift())<0?l-=-1*s:o-=s),n<i.startFrom||(a[n]["TII "+i.name]=u(o,l)));e.Studies.MA("ema",i.inputs["Signal Period"],"TII "+i.name,0,"Signal",t,i)}function u(t,e){return Math.abs(e)<1e-8?100:100-100/(1+t/e)}},e.Studies.calculateZigZag=function(t,e){var i=e.chart.scrubbed;if(i&&i.length){for(var a=e.highLowChart,r=null,n=null,s=e.inputs["Distance(%)"],o=0,l=0,h=0,c=null,u=null,d=0,p=Math.min(i.length-1,e.startFrom);p>=0;p--)if(d=p,i[p]["_state "+e.name]){var f=i[p]["_state "+e.name];r=f[0],n=f[1],o=f[2],l=f[3],h=f[4],c=f[5],u=f[6];break}for(var m=d;m<i.length;m++){var g=i[m][a?"High":"Close"],v=i[m][a?"Low":"Close"];if(null===n||n<g)if(o<0&&(r=v),c=(1-s/100)*(n=g),o>-1){if(null!==u&&n>u){i[l]["Result "+e.name]=i[l][a?"Low":"Close"],x(h,l),o=-1,r=v,h=l,l=m;continue}}else l=m;if(null===r||r>v)if(o>0&&(n=g),u=(1+s/100)*(r=v),o<1){if(null!==c&&r<c){i[l]["Result "+e.name]=i[l][a?"High":"Close"],x(h,l),o=1,n=g,h=l,l=m;continue}}else l=m}i[l]["Result "+e.name]=i[l][a?1==o?"Low":"High":"Close"],i[l]["_state "+e.name]=[r,n,o,l,h,c,u],x(h,l);for(var y=i.length-1;y>l;){if(i[y].Close||0===i[y].Close){i[y]["Result "+e.name]=i[y][a?1==o?"High":"Low":"Close"];break}y--}x(l,y)}function x(t,a){for(var r=t+1;r<a;r++)i[r]["ShadowResult "+e.name]=(i[a]["Result "+e.name]-i[t]["Result "+e.name])*(r-t)/(a-t)+i[t]["Result "+e.name],delete i[r]["Result "+e.name]}},e.Studies.calculatePsychologicalLine=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else for(var a=[],r=100/e.days,n=0,s=Math.max(e.startFrom-e.days,1);s<i.length&&!i[s].futureTick;s++){var o=Number(i[s].Close>i[s-1].Close);o&&(n+=r),a.push(o),a.length>e.days&&(n-=a.shift()*r),s<e.startFrom||isNaN(i[s].Close)||(i[s]["Result "+e.name]=n)}},e.Studies.calculateMADev=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r=i.inputs.Field;r&&"field"!=r||(r="Close");var n=i.inputs["Points Or Percent"];n||(n="Points");var s=i.inputs["Moving Average Type"];s||(s="exponential"),e.Studies.MA(s,i.days,r,0,"_MA",t,i);for(var o=i.name+"_hist",h=Math.max(i.startFrom,i.days-1);h<a.length;h++){var c=a[h],u=c[r];u&&"object"==l(u)&&(u=u[i.subField]);var d=c["_MA "+i.name];(d||0===d)&&(c[o]="Points"==n?u-d:100*(u/d-1))}i.outputMap={},i.outputMap[i.name+"_hist"]=""}},e.Studies.calculateShinohara=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r={weakNum:0,weakDen:0,strongNum:0,strongDen:0};i.startFrom>1&&(r=e.clone(a[i.startFrom-1]["_accums "+i.name]));for(var n=i.startFrom;n<a.length;n++)r.weakNum+=a[n].High-a[n].Close,r.weakDen+=a[n].Close-a[n].Low,n>0&&(r.strongNum+=a[n].High-a[n-1].Close,r.strongDen+=a[n-1].Close-a[n].Low),n>=i.days&&(r.weakNum-=a[n-i.days].High-a[n-i.days].Close,r.weakDen-=a[n-i.days].Close-a[n-i.days].Low,a[n]["Weak Ratio "+i.name]=100*r.weakNum/r.weakDen,n>i.days&&(r.strongNum-=a[n-i.days].High-a[n-i.days-1].Close,r.strongDen-=a[n-i.days-1].Close-a[n-i.days].Low,a[n]["Strong Ratio "+i.name]=100*r.strongNum/r.strongDen)),a[n]["_accums "+i.name]=e.clone(r)}},e.Studies.calculateAccumulationDistribution=function(t,e){for(var i=e.chart.scrubbed,a=e.startFrom;a<i.length;a++)if(a){var r=i[a];if(r.futureTick)break;var n=i[a-1],s=0;r.Close>n.Close?s=r.Close-Math.min(r.Low,n.Close):r.Close<n.Close&&(s=r.Close-Math.max(r.High,n.Close)),e.inputs["Use Volume"]&&(s*=r.Volume);var o=n["Result "+e.name];o||(o=0),o+=s,isNaN(r.Close)||(r["Result "+e.name]=o)}},e.Studies.calculateADX=function(t,i){e.Studies.calculateStudyATR(t,i);var a=i.chart.scrubbed,r=i.days,n=parseInt(i.inputs["Smoothing Period"],10);if(n||0===n||(n=r),a.length<i.days+1)i.error=!0;else for(var s,o=0,l=0,h=0,c=0,u=Math.max(1,i.startFrom);u<a.length;u++){s=a[u];var d=Math.max(0,s.High-a[u-1].High),p=Math.max(0,a[u-1].Low-s.Low);if(d>p?p=0:d=p>d?0:p=0,u<=r?(l+=d,h+=p,o+=s["True Range "+i.name]):(l=a[u-1]["_sm+DM "+i.name]*(r-1)/r+d,h=a[u-1]["_sm-DM "+i.name]*(r-1)/r+p,o=a[u-1]["_smTR "+i.name]*(r-1)/r+s["True Range "+i.name]),s["_sm+DM "+i.name]=l,s["_sm-DM "+i.name]=h,s["_smTR "+i.name]=o,!(u<r)){var f=100*l/o,m=100*h/o,g=100*Math.abs(f-m)/(f+m);if(s["+DI "+i.name]=f,s["-DI "+i.name]=m,!1!==i.inputs.Series&&n)if(u<r+n-1){if(u==i.startFrom)for(var v=r;v<i.startFrom;v++)c+=100*Math.abs(a[v]["+DI "+i.name]-a[v]["-DI "+i.name])/(a[v]["+DI "+i.name]+a[v]["-DI "+i.name]);c+=g}else s["ADX "+i.name]=u==r+n-1?c/n:(a[u-1]["ADX "+i.name]*(n-1)+g)/n;if(i.inputs.Histogram){var y=i.name+"_hist";if(!s["+DI "+i.name]&&0!==s["+DI "+i.name])continue;if(!s["-DI "+i.name]&&0!==s["-DI "+i.name])continue;s[y]=s["+DI "+i.name]-s["-DI "+i.name],!1===i.inputs.Series&&(s["+DI "+i.name]=null,s["-DI "+i.name]=null),i.outputMap[y]=""}}}},e.Studies.calculateAroon=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else{var a,r=0,n=0,s=null,o=null;if(e.startFrom>0){var l=i[e.startFrom-1]["_state "+e.name];l&&(r=l[0],n=l[1],s=l[2],o=l[3])}for(var h=e.startFrom;h<i.length;h++){var c=i[h];if(c.futureTick)break;if(null===s&&(s=c.High),null===o&&(o=c.Low),(s=Math.max(s,c.High))==c.High)r=0;else if(++r>e.days)for(s=c.High,r=0,a=1;a<=e.days;a++)(s=Math.max(s,i[h-a].High))==i[h-a].High&&(r=a);if((o=Math.min(o,c.Low))==c.Low)n=0;else if(++n>e.days)for(o=c.Low,n=0,a=1;a<=e.days;a++)(o=Math.min(o,i[h-a].Low))==i[h-a].Low&&(n=a);var u=!isNaN(c.High),d=!isNaN(c.Low),p=100*(1-r/e.days);u&&(c["Aroon Up "+e.name]=p);var f=100*(1-n/e.days);d&&(c["Aroon Down "+e.name]=f),u&&d&&(c["Aroon Oscillator "+e.name]=c["Aroon Up "+e.name]-c["Aroon Down "+e.name]),c["_state "+e.name]=[r,n,s,o]}}},e.Studies.calculateBollinger=function(t,i){var a=i.inputs.Field;a&&"field"!=a||(a="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,a,0,"_MA",t,i),i.std=new e.Studies.StudyDescriptor(i.name,"STD Dev",i.panel),i.std.chart=i.chart,i.std.startFrom=i.startFrom,i.std.days=i.days,i.std.inputs={Field:a,"Standard Deviations":1,Type:i.inputs["Moving Average Type"]},i.std.outputs={"_STD Dev":null},e.Studies.calculateStandardDeviation(t,i.std),e.Studies.calculateGenericEnvelope(t,i,i.inputs["Standard Deviations"],"_MA "+i.name,"_STD Dev "+i.name),"Boll %b"==i.type&&(i.zoneOutput="%b")},e.Studies.calculateCCI=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{e.Studies.MA("simple",i.days,"hlc/3",0,"MA",t,i);for(var r=Math.max(i.startFrom,i.days-1);r<a.length;r++){var n=a[r];if(n){for(var s=0,o=0;o<i.days;o++)s+=Math.abs(a[r-o]["hlc/3"]-n["MA "+i.name]);s/=i.days,Math.abs(s)<1e-8?n["Result "+i.name]=0:n["Result "+i.name]=(n["hlc/3"]-n["MA "+i.name])/(.015*s)}}}},e.Studies.calculateCenterOfGravity=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)e.error=!0;else{var a=e.inputs.Field;a&&"field"!=a||(a="Close");for(var r=Math.max(e.startFrom,e.days-1);r<i.length;r++){for(var n=0,s=0,o=0;o<e.days;o++){var l=i[r-o][a];n-=(o+1)*l,s+=l}s&&(i[r]["Result "+e.name]=n/s)}}},e.Studies.calculateChaikinMoneyFlow=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)e.error=!0;else{var a=0,r=0,n=i[e.startFrom-1];n&&(n["_sumMF "+e.name]&&(a=n["_sumMF "+e.name]),n["_sumV "+e.name]&&(r=n["_sumV "+e.name]));for(var s=e.startFrom;s<i.length;s++)i[s].High==i[s].Low?i[s]["_MFV "+e.name]=0:i[s]["_MFV "+e.name]=i[s].Volume*(2*i[s].Close-i[s].High-i[s].Low)/(i[s].High-i[s].Low),a+=i[s]["_MFV "+e.name],r+=i[s].Volume,s>e.days-1&&(a-=i[s-e.days]["_MFV "+e.name],(r-=i[s-e.days].Volume)&&(i[s]["Result "+e.name]=a/r)),i[s]["_sumMF "+e.name]=a,i[s]["_sumV "+e.name]=r}},e.Studies.calculateChaikinVolatility=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days)i.error=!0;else{var r;for(r=i.startFrom;r<a.length&&!a[r].futureTick;r++)a[r]["_High-Low "+i.name]=a[r].High-a[r].Low;e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_High-Low "+i.name,0,"_MA",t,i);var n=i.inputs["Rate Of Change"];for(n||(n=i.days),r=Math.max(i.startFrom,n);r<a.length;r++)if(a[r-n]["_MA "+i.name]){if(a[r].futureTick)break;a[r]["Result "+i.name]=100*(a[r]["_MA "+i.name]/a[r-n]["_MA "+i.name]-1)}}},e.Studies.calculateChandeForecast=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA("time series",i.days,r,0,"MA",t,i);for(var n=Math.max(1,i.startFrom);n<a.length;n++){var s=a[n][r];s&&"object"==l(s)&&(s=s[i.subField]),a[n]["Result "+i.name]=100*(1-a[n]["MA "+i.name]/s)}}},e.Studies.calculateCoppock=function(t,i){var a=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var n=parseInt(i.inputs["Long RoC"],10);n||(n=14);var s=parseInt(i.inputs["Short RoC"],10);s||(s=11);var o=i.days;if(o||(o=10),!(n<s))if(a.length<Math.max(s,n,o)+1)i.error=!0;else{for(var l=Math.max(i.startFrom,n);l<a.length;l++){var h=a[l-s][r],c=a[l-n][r];h&&c&&(a[l]["_Sum "+i.name]=100*(a[l][r]/h+a[l][r]/c-2))}e.Studies.MA("weighted",o,"_Sum "+i.name,0,"Result",t,i)}},e.Studies.calculateDetrendedPrice=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var r=i.inputs.Field;r&&"field"!=r||(r="Close");var n=Math.floor(i.days/2+1);e.Studies.MA(i.inputs["Moving Average Type"],i.days,r,-n,"MA",t,i);for(var s=Math.max(i.days-n-1,i.startFrom-n);s<a.length-n;s++){var o=a[s][r];o&&"object"==l(o)&&(o=o[i.subField]);var h=a[s]["MA "+i.name];!o&&0!==o||!h&&0!==h||(a[s]["Result "+i.name]=o-h)}}},e.Studies.calculateEaseOfMovement=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days)i.error=!0;else{for(var r=Math.max(1,i.startFrom);r<a.length;r++){var n=((a[r].High+a[r].Low)/2-(a[r-1].High+a[r-1].Low)/2)/(a[r].Volume/1e8/(a[r].High-a[r].Low));isFinite(n)?a[r]["_EOM1 "+i.name]=n:a[r]["_EOM1 "+i.name]=NaN}e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_EOM1 "+i.name,0,"Result",t,i)}},e.Studies.calculateElderRay=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days)i.error=!0;else{e.Studies.MA("exponential",i.days,"Close",0,"_EMA",t,i);for(var r=Math.max(i.startFrom,i.days-1);r<a.length;r++)a[r][i.name+"_hist1"]=a[r].High-a[r]["_EMA "+i.name],a[r][i.name+"_hist2"]=a[r].Low-a[r]["_EMA "+i.name];i.outputMap={},i.outputMap[i.name+"_hist1"]="",i.outputMap[i.name+"_hist2"]=""}},e.Studies.calculateElderForce=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days)i.error=!0;else{for(var r=Math.max(1,i.startFrom);r<a.length;r++)a[r]["_EF1 "+i.name]=a[r].Volume*(a[r].Close-a[r-1].Close);e.Studies.MA("exponential",i.days,"_EF1 "+i.name,0,"Result",t,i)}},e.Studies.calculateEhlerFisher=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else{var a=0;e.startFrom>1&&(a=i[e.startFrom-1]["_n "+e.name]);for(var r=e.startFrom;r<i.length;r++){var n=i[r];if(n.futureTick)break;if(r<e.days-1)n["EF "+e.name]=n["EF Trigger "+e.name]=a;else{var s=l(e.days,r);(a=.66*(((i[r].High+i[r].Low)/2-s[0])/Math.max(1e-6,s[1]-s[0])-.5)+.67*a)>0?a=Math.min(a,.9999):a<0&&(a=Math.max(a,-.9999));var o=r?i[r-1]["EF "+e.name]:0;n["EF "+e.name]=.5*Math.log((1+a)/(1-a))+.5*o,n["EF Trigger "+e.name]=o,n["_n "+e.name]=a}}}function l(t,e){for(var a=Number.MAX_VALUE,r=-1*Number.MAX_VALUE,n=e-t+1;n<=e;n++){var s=(i[n].High+i[n].Low)/2;a=Math.min(a,s),r=Math.max(r,s)}return[a,r]}},e.Studies.calculateFractalChaos=function(t,e){var i=e.chart.scrubbed,a=0,r=0,n=0;e.startFrom&&"Fractal Chaos Bands"==e.type&&(a=i[e.startFrom-1]["Fractal High "+e.name],r=i[e.startFrom-1]["Fractal Low "+e.name]);for(var s=Math.max(4,e.startFrom);s<i.length&&!i[s].futureTick;s++){var o,l=!isNaN(i[s].High),h=!isNaN(i[s].Low);for((l||h)&&(i[s]["Result "+e.name]=0),n=0,o=0;o<=s&&i[s-o]&&!(i[s-o].High>i[s-2].High)&&!(o<2&&i[s-o].High==i[s-2].High);o++)if(i[s-o].High<i[s-2].High&&n++,4==n){a=i[s-2].High;break}for("Fractal Chaos Bands"==e.type?l&&(i[s]["Fractal High "+e.name]=a>0?a:null):4==n&&(i[s]["Result "+e.name]=1),n=0,o=0;o<=s&&i[s-o]&&!(i[s-o].Low<i[s-2].Low)&&!(o<2&&i[s-o].Low==i[s-2].Low);o++)if(i[s-o].Low>i[s-2].Low&&n++,4==n){r=i[s-2].Low;break}"Fractal Chaos Bands"==e.type?h&&(i[s]["Fractal Low "+e.name]=r>0?r:null):4==n&&(i[s]["Result "+e.name]=-1)}},e.Studies.calculateGenericEnvelope=function(t,e,i,a,r,n){i||(i=0),n||(n=0),a&&"field"!=a||(a="Close"),r||(r=a);var s=e.chart.scrubbed,o=e.inputs.Field;o&&"field"!==o||(o="Close");for(var h=e.startFrom;s&&h<s.length;h++){var c=s[h];if(c&&c[a]){var u=c[o];u&&"object"==l(u)&&(u=u.Close);var d=c[a];d&&"object"==l(d)&&(d=d[e.subField]);var p=c[r];p&&"object"==l(p)&&(p=p[e.subField]);var f=i*p+n;c[e.type+" Top "+e.name]=d+f,c[e.type+" Bottom "+e.name]=d-f,c[e.type+" Median "+e.name]=d,c["Bandwidth "+e.name]=d?200*f/d:0,c["%b "+e.name]=50*((u-d)/f+1)}}},e.Studies.calculateHistoricalVolatility=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else{var a=e.inputs.Field;a&&"field"!=a||(a="Close");var r=e.inputs["Standard Deviations"];r<0&&(r=1);var n,s=100*Math.sqrt((n=e.inputs["Days Per Year"],isNaN(n)&&(n=365),"day"==t.layout.interval?n:"week"==t.layout.interval?52:"month"==t.layout.interval?12:n))*r,o=[],l=0;e.startFrom>1&&(l=i[e.startFrom-1]["_state "+e.name][0],o=i[e.startFrom-1]["_state "+e.name][1].slice());for(var h=Math.max(1,e.startFrom);h<i.length;h++){var c=i[h-1][a];if(c){var u=Math.log(i[h][a]/c);if(o.push(u),l+=u,h>=e.days){var d=0;l/=e.days;for(var p=0;p<o.length;p++)d+=Math.pow(o[p]-l,2);l*=e.days,l-=o.shift(),i[h]["Result "+e.name]=Math.sqrt(d/e.days)*s}}i[h]["_state "+e.name]=[l,o.slice()]}}},e.Studies.calculateIchimoku=function(t,e){var i,a,r=e.chart.scrubbed,n={Base:Number(e.inputs["Base Line Period"]),Conv:Number(e.inputs["Conversion Line Period"]),LeadB:Number(e.inputs["Leading Span B Period"]),Lag:Number(e.inputs["Lagging Span Period"])};function s(t,e){for(var i=Number.MAX_VALUE,a=-1*Number.MAX_VALUE,n=e-t+1;n<=e;n++)n<0||(i=Math.min(i,r[n].Low),a=Math.max(a,r[n].High));return[i,a]}for(i=e.startFrom;i<r.length;i++)r[i]&&(a=s(n.Conv,i),r[i]["Conversion Line "+e.name]=(a[1]+a[0])/2,a=s(n.Base,i),r[i]["Base Line "+e.name]=(a[1]+a[0])/2,i<n.Lag||(r[i-n.Lag]["Lagging Span "+e.name]=r[i].Close));var o=[];for(i=Math.max(0,e.startFrom-n.Base);i<r.length;i++){a=s(n.LeadB,i);var l=(r[i]["Conversion Line "+e.name]+r[i]["Base Line "+e.name])/2,h=(a[1]+a[0])/2;if(r[i+n.Base])r[i+n.Base]["Leading Span A "+e.name]=l,r[i+n.Base]["Leading Span B "+e.name]=h;else{var c={};c["Leading Span A "+e.name]=l,c["Leading Span B "+e.name]=h,o.push(c)}}e.appendFutureTicks(t,o)},e.Studies.calculateKlinger=function(t,i){var a=i.chart.scrubbed,r=Number(i.inputs["Short Cycle"]),n=Number(i.inputs["Long Cycle"]);if(a.length<Math.max(r,n)+1)i.error=!0;else{var s,o=i.name+"_hist",l="Klinger "+i.name,h="KlingerSignal "+i.name,c="_SV "+i.name,u="_EMA-S "+i.name,d="_EMA-L "+i.name;for(s=Math.max(1,i.startFrom);s<a.length;s++){var p=a[s].Volume;a[s]["hlc/3"]<a[s-1]["hlc/3"]&&(p*=-1),p&&(a[s][c]=p)}for(e.Studies.MA("exponential",r,c,0,"_EMA-S",t,i),e.Studies.MA("exponential",n,c,0,"_EMA-L",t,i),s=Math.max(n,i.startFrom);s<a.length&&(!a[s].futureTick&&null!==a[s][u]&&null!==a[s][d]);s++)a[s][l]=a[s][u]-a[s][d];for(e.Studies.MA("exponential",Number(i.inputs["Signal Periods"]),l,0,"KlingerSignal",t,i),s=i.startFrom;s<a.length;s++)a[s][o]=a[s][l]-a[s][h];i.outputMap[o]=""}},e.Studies.calculateKeltner=function(t,i){e.Studies.MA(i.inputs["Moving Average Type"],i.days,"Close",0,"MA",t,i),e.Studies.calculateStudyATR(t,i),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Shift,"MA "+i.name,"ATR "+i.name)},e.Studies.calculateMACD=function(t,i){var a=i.chart.scrubbed,r=i.inputs,n=i.name;if(i.macd1Days||(i.macd1Days=parseFloat(r["Fast MA Period"])),i.macd2Days||(i.macd2Days=parseFloat(r["Slow MA Period"])),i.signalDays||(i.signalDays=parseFloat(r["Signal Period"])),i.days||(i.days=Math.max(i.macd1Days,i.macd2Days,i.signalDays)),a.length<i.days+1)i.error=!0;else{var s=i.inputs.Field;s&&"field"!=s||(s="Close");var o=r["Moving Average Type"];o||(o="exponential"),e.Studies.MA(o,i.macd1Days,s,0,"_MACD1",t,i),e.Studies.MA(o,i.macd2Days,s,0,"_MACD2",t,i);var l,h,c=Math.max(i.startFrom,i.days-1);for(l=c;l<a.length;l++)!(h=a[l])["_MACD1 "+n]&&0!==h["_MACD1 "+n]||!h["_MACD2 "+n]&&0!==h["_MACD2 "+n]||(h["MACD "+n]=h["_MACD1 "+n]-h["_MACD2 "+n]);var u=r["Signal MA Type"];u||(u="exponential"),e.Studies.MA(u,i.signalDays,"MACD "+n,0,"Signal",t,i);var d=n+"_hist";for(l=c;l<a.length;l++){var p=(h=a[l])["Signal "+n];(p||0===p)&&(h[d]=h["MACD "+n]-h["Signal "+n])}i.outputMap[d]=""}},e.Studies.calculateMAEnvelope=function(t,i){var a=i.inputs.Field;a&&"field"!=a||(a="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,a,0,"MA",t,i);var r=i.inputs["Shift Type"],n=i.inputs.Shift;r||(r="percent",n=i.inputs["Shift Percentage"]),"percent"==r?e.Studies.calculateGenericEnvelope(t,i,n/100,"MA "+i.name):"points"==r&&e.Studies.calculateGenericEnvelope(t,i,null,"MA "+i.name,null,Number(n))},e.Studies.calculateMassIndex=function(t,i){var a=i.chart.scrubbed;if(a.length<Math.max(9,i.days+1))i.error=!0;else{for(var r=i.startFrom;r<a.length;r++)a[r]["_High-Low "+i.name]=a[r].High-a[r].Low;e.Studies.MA("exponential",9,"_High-Low "+i.name,0,"_EMA",t,i),e.Studies.MA("exponential",9,"_EMA "+i.name,0,"_EMA2",t,i);var n=0;a[i.startFrom-1]&&a[i.startFrom-1]["_total "+i.name]&&(n=a[i.startFrom-1]["_total "+i.name]);for(var s=Math.max(17,i.startFrom);s<a.length;s++)n+=a[s]["_EMA "+i.name]/a[s]["_EMA2 "+i.name],s>=17+i.days-1&&(a[s]["Result "+i.name]=n,n-=a[s-i.days+1]["_EMA "+i.name]/a[s-i.days+1]["_EMA2 "+i.name]),a[s]["_total "+i.name]=n}},e.Studies.calculateMaxHighMinLow=function(t,e){var i=e.chart.scrubbed,a=e.days,r=e.days;if(e.inputs["High Period"]&&(a=e.inputs["High Period"]),e.inputs["Low Period"]&&(r=e.inputs["Low Period"]),i.length<Math.max(a,r)+1)e.error=!0;else{var n,s=Number.MAX_VALUE,o=-1*Number.MAX_VALUE;if(e.startFrom>1){for(n=1;n<a;n++)o=Math.max(o,i[e.startFrom-n].High);for(n=1;n<r;n++)s=Math.min(s,i[e.startFrom-n].Low)}for(var l=Math.max(0,e.startFrom-1);l<i.length;l++){if(o=Math.max(o,i[l].High),s=Math.min(s,i[l].Low),l>=a&&i[l-a].High==o)for(o=i[l].High,n=1;n<a;n++)o=Math.max(o,i[l-n].High);if(l>=r&&i[l-r].Low==s)for(s=i[l].Low,n=1;n<r;n++)s=Math.min(s,i[l-n].Low);var h=0;if("HHV"==e.type)h=o;else if("LLV"==e.type)h=s;else if("Donchian Width"==e.type)h=o-s;else if("GAPO"==e.type||"Gopala"==e.type)h=Math.log(o-s)/Math.log(r);else{if("VT HZ Filter"==e.type){h=o-s,i[l]["_MHML "+e.name]=h;continue}if("Williams %R"==e.type){h=-100*(o-i[l].Close)/(o-s),i[l]["Result "+e.name]=h;continue}}if(l==i.length-1)break;i[l+1].futureTick||("Donchian Channel"==e.type?(i[l+1]["Donchian High "+e.name]=o,i[l+1]["Donchian Low "+e.name]=s,i[l+1]["Donchian Median "+e.name]=(o+s)/2):i[l+1]["Result "+e.name]=h)}}},e.Studies.calculateMoneyFlowIndex=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else{var a=0,r=0,n=i[e.startFrom-1],s="_rawMF "+e.name,o="_cumMF "+e.name,l="Result "+e.name;n&&n[o]&&(a=n[o][0],r=n[o][1]);for(var h=e.startFrom;h<i.length;h++){var c=i[h]["hlc/3"];if(h>0&&!i[h].futureTick){var u=i[h-1]["hlc/3"],d=c*i[h].Volume;if(c>u?a+=d:c<u?r-=d*=-1:d=0,h>e.days){var p=i[h-e.days][s];p>0?a-=p:r+=p,0===r?i[h][l]=100:i[h].Volume&&(i[h][l]=100-100/(1+a/r))}i[h][s]=d,i[h][o]=[a,r]}}}},e.Studies.calculateOnBalanceVolume=function(t,e){var i=e.inputs.Field;i&&"field"!=i||(i="Close");var a=e.inputs["Min Tick Value"],r=!1;a||0===a||(r=!0,a=0);for(var n,s,o=e.chart.scrubbed,l=0,h=e.startFrom;h<o.length;h++)if(n=o[h],h&&n[i]&&(o[h-1][i]&&(s=o[h-1]),s)){n[i]-s[i]>a?l=1:s[i]-n[i]>a?l=-1:r&&(l=0);var c=s["Result "+e.name];c||(c=0),c+=n.Volume*l,n["Result "+e.name]=c}},e.Studies.calculatePrettyGoodOscillator=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{e.Studies.MA("exponential",i.days,"trueRange",0,"_EMA",t,i),e.Studies.MA("simple",i.days,"Close",0,"_SMA",t,i);for(var r=Math.max(1,i.startFrom);r<a.length;r++)a[r]["_SMA "+i.name]&&a[r]["_EMA "+i.name]&&(a[r]["Result "+i.name]=(a[r].Close-a[r]["_SMA "+i.name])/a[r]["_EMA "+i.name])}},e.Studies.calculatePriceOscillator=function(t,i){var a=i.chart.scrubbed,r=Number(i.inputs["Short Cycle"]),n=Number(i.inputs["Long Cycle"]);if(a.length<Math.max(r,n)+1)i.error=!0;else{var s=i.inputs.Field,o=i.inputs["Moving Average Type"];o||(o="simple"),s&&"field"!=s||(s="Close"),i.parameters.isVolume&&(s="Volume",o="exponential");var l=i.inputs["Points Or Percent"];l||(l="Percent"),e.Studies.MA(o,r,s,0,"_Short MA",t,i),e.Studies.MA(o,n,s,0,"_Long MA",t,i);for(var h=Math.max(n,i.startFrom);h<a.length;h++){var c=a[h];if(c){var u=c["_Short MA "+i.name],d=c["_Long MA "+i.name];!u&&0!==u||!d&&0!==d||(c["Result "+i.name]="Points"==l?u-d:100*(u/d-1),i.outputs["Increasing Bar"]&&(c[i.name+"_hist"]=c["Result "+i.name],i.outputMap={},i.outputMap[i.name+"_hist"]=""))}}}},e.Studies.calculatePriceVolumeTrend=function(t,e){var i=e.inputs.Field;i&&"field"!=i||(i="Close");var a=e.chart.scrubbed,r=0;e.startFrom>1&&(r=a[e.startFrom-1]["Result "+e.name]);for(var n=Math.max(1,e.startFrom);n<a.length;n++)a[n][i]&&a[n-1][i]&&(r+=a[n].Volume*(a[n][i]-a[n-1][i])/a[n-1][i],a[n]["Result "+e.name]=r)},e.Studies.calculatePrimeNumber=function(t,e){var i=[];function a(t){if(t<=0)return!1;if(t!=Math.floor(t))return!1;if(!0===i[t]||!1===i[t])return i[t];for(var e=parseInt(Math.sqrt(t),10),a=2;a<=e;a++)if(t%a==0)return i[t]=!1,!1;return i[t]=!0,!0}for(var r=e.chart.scrubbed,n=e.startFrom;n<r.length;n++){var s=r[n];if(s){var o=s.High;if(!isNaN(o)){for(var l=0;o>0&&o<=10;l++)o*=10;for(a(o)&&(o+=2),(o=Math.ceil(o))%2==0&&o++;!a(o);)o+=2;o/=Math.pow(10,l)}var h=s.Low;if(!isNaN(h)){for(var c=0;h>0&&h<=10;c++)h*=10;if(a(h)&&(h-=2),(h=Math.floor(h))%2==0&&h--,h>0){for(;!a(h);)h-=2;h/=Math.pow(10,c)}}if("Prime Number Bands"==e.type)isNaN(o)||(s["Prime Bands Top "+e.name]=o),isNaN(h)||(s["Prime Bands Bottom "+e.name]=Math.max(0,h));else{var u=0,d=e.inputs["Tolerance Percentage"]*(o-h)/100,p=o+h-2*s.Close;p<d?u=1:p>d&&(u=-1),u&&(s["Result "+e.name]=u)}}}},e.Studies.calculatePSAR=function(t,e){var i=e.chart.scrubbed,a=0,r=null,n=!1,s=0,o=parseFloat(e.inputs["Minimum AF"]),l=parseFloat(e.inputs["Maximum AF"]);function h(){a=0,r=null,n=!n}if(e.startFrom>0){s=i[e.startFrom-1]["Result "+e.name];var c=i[e.startFrom-1]["_state "+e.name];c&&3==c.length&&(a=c[0],r=c[1],n=c[2])}for(var u=e.startFrom-1;u<i.length-1;u++)if(!(u<0)){if(i[u].futureTick)break;var d=s;if(n){(!r||r<i[u].High)&&(r=i[u].High,a=Math.min(a+o,l)),s=d+a*(r-d);var p=Math.min(i[Math.max(1,u)-1].Low,i[u].Low);s>i[u+1].Low?(s=r,h()):s>p&&(s=p)}else{(!r||r>i[u].Low)&&(r=i[u].Low,a=Math.min(a+o,l)),s=d+a*(r-d);var f=Math.max(i[Math.max(1,u)-1].High,i[u].High);s<i[u+1].High?(s=r,h()):s<f&&(s=f)}i[u+1]["_state "+e.name]=[a,r,n],isNaN(i[u].High)&&isNaN(i[u].Low)||(i[u+1]["Result "+e.name]=s)}},e.Studies.calculateQStick=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{for(var r=i.startFrom;r<a.length;r++)a[r]["_Close-Open "+i.name]=a[r].Close-a[r].Open;e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_Close-Open "+i.name,0,"Result",t,i)}},e.Studies.calculateRandomWalk=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else for(var a=Math.max(2,e.startFrom);a<i.length;a++){for(var r=0,n=i[a].High,s=i[a].Low,o=0,l=0,h=1;h<=e.days&&!i[a].futureTick;h++){if(a<=h){o=l=0;break}var c=(r+=i[a-h].trueRange)/h*Math.sqrt(h);if(c){var u=(n-i[a-h].Low)/c,d=(i[a-h].High-s)/c;o=Math.max(o,u),l=Math.max(l,d)}}i[a].futureTick||isNaN(n)&&isNaN(s)||(i[a]["Random Walk High "+e.name]=o,i[a]["Random Walk Low "+e.name]=l)}},e.Studies.calculateSchaff=function(t,i){var a=i.chart.scrubbed,r=i.days,n=Number(i.inputs["Short Cycle"]),s=Number(i.inputs["Long Cycle"]);if(a.length<Math.max(r,n,s)+1)i.error=!0;else{var o=i.inputs.Field;o&&"field"!=o||(o="Close");e.Studies.MA(i.inputs["Moving Average Type"],n,o,0,"_MACD1",t,i),e.Studies.MA(i.inputs["Moving Average Type"],s,o,0,"_MACD2",t,i);for(var l=0,h=0,c=i.startFrom;c<a.length;c++){var u=a[c];if(!(c<s-1)){var d=u["_MACD1 "+i.name],p=u["_MACD2 "+i.name];(d||0===d||p||0===p)&&(u["_MACD "+i.name]=d-p);var f=u["_MACD "+i.name];if(!(c<s+(r-1))){var m=v(r,c,"_MACD");l=m[1]>m[0]?100*(f-m[0])/(m[1]-m[0]):l,(f||0===f)&&(u["_PF "+i.name]=a[c-1]["_PF "+i.name]?a[c-1]["_PF "+i.name]+.5*(l-a[c-1]["_PF "+i.name]):l);var g=u["_PF "+i.name];c<s+2*(r-1)||(h=(m=v(r,c,"_PF"))[1]>m[0]?100*(g-m[0])/(m[1]-m[0]):h,(g||0===g)&&(u["Result "+i.name]=a[c-1]["Result "+i.name]?a[c-1]["Result "+i.name]+.5*(h-a[c-1]["Result "+i.name]):h))}}}}function v(t,e,r){for(var n=null,s=null,o=e-t+1;o<=e;o++){var l=a[o][r+" "+i.name];l&&(n=null===n?l:Math.min(n,l),s=null===s?l:Math.max(s,l))}return[n,s]}},e.Studies.calculateStochastics=function(t,i){i.smooth||(i.smooth=i.inputs.Smooth);var a=i.inputs.Field;a&&"field"!=a||(a="Close");var r=i.inputs["%K Periods"];r||(r=i.days);var n=i.chart.scrubbed;if(n.length<Math.max(r,i.days)+1)i.error=!0;else{var s=i.inputs["%K Smoothing Periods"];s?i.smooth=!0:i.smooth&&(s=3);var o=i.inputs["%D Periods"];o||(o=3),i.outputMap={},i.outputMap["%K "+i.name]="Fast",i.outputMap["%D "+i.name]="Slow";for(var l=Math.max(r,i.startFrom);l<n.length;l++){null!==h(l,a,r)&&(n[l][i.name]=h(l,a,r))}e.Studies.MA("simple",i.smooth?s:1,i.name,0,"%K",t,i),e.Studies.MA("simple",o,"%K "+i.name,0,"%D",t,i)}function h(t,e,i){for(var a=t-i+1,r=-1*Number.MAX_VALUE,s=Number.MAX_VALUE,o=a;o<=t;o++){var l=n[o]["Close"==e?"Low":e],h=n[o]["Close"==e?"High":e];(l||0===l)&&((h||0===h)&&(s=Math.min(s,l),r=Math.max(r,h)))}return r==-1*Number.MAX_VALUE||s==Number.MAX_VALUE?null:r==s?0:(n[t][e]-s)/(r-s)*100}},e.Studies.calculateStochMomentum=function(t,i){var a=Number(i.inputs["%K Periods"]),r=Number(i.inputs["%K Smoothing Periods"]),n=Number(i.inputs["%K Double Smoothing Periods"]),s=Number(i.inputs["%D Periods"]),o=i.chart.scrubbed;if(o.length<a+r+n-1||o.length<s)i.error=!0;else{var l;for(l=Math.max(a,i.startFrom)-1;l<o.length;l++){var h=o[l],c=u(a,l);h["_H "+i.name]=h.Close-(c[0]+c[1])/2,h["_DHL "+i.name]=c[1]-c[0]}for(e.Studies.MA("exponential",r,"_H "+i.name,0,"_HS1",t,i),e.Studies.MA("exponential",n,"_HS1 "+i.name,0,"_HS2",t,i),e.Studies.MA("exponential",r,"_DHL "+i.name,0,"_DHL1",t,i),e.Studies.MA("exponential",n,"_DHL1 "+i.name,0,"_DHL2",t,i),l=a-1;l<o.length;l++)o[l]["%K "+i.name]=o[l]["_HS2 "+i.name]/(.5*o[l]["_DHL2 "+i.name])*100;e.Studies.MA(i.inputs["%D Moving Average Type"],s,"%K "+i.name,0,"%D",t,i),i.zoneOutput="%K"}function u(t,e){for(var i=null,a=null,r=e-t+1;r<=e;r++)i=null===i?o[r].Low:Math.min(i,o[r].Low),a=null===a?o[r].High:Math.max(a,o[r].High);return[i,a]}},e.Studies.calculateSwingIndex=function(t,e){var i=e.inputs["Limit Move Value"];(null===i||isNaN(i))&&(i=99999);var a=e.chart.scrubbed,r=0;e.startFrom>1&&(r=a[e.startFrom-1]["Result "+e.name]);for(var n=Math.max(1,e.startFrom);n<a.length;n++){var s=Math.abs(a[n].High-a[n-1].Close),o=Math.abs(a[n].Low-a[n-1].Close),l=Math.abs(a[n].High-a[n].Low),h=Math.abs(a[n-1].Close-a[n-1].Open),c=Math.max(s,o),u=Math.max(l,c),d=u+.25*h;u==s?d-=.5*o:u==o&&(d-=.5*s);var p=50*(a[n].Close-a[n-1].Close+.5*(a[n].Close-a[n].Open)+.25*(a[n-1].Close-a[n-1].Open))/d*(c/i);0!==d&&0!==i||(p=0),"Swing"==e.type&&(r=0),r+=p,a[n]["Result "+e.name]=r}},e.Studies.calculateTRIX=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{for(var r=i.name,n=["Close","_MA1 "+r,"_MA2 "+r,"_MA3 "+r],s=0;s<n.length-1;s++)e.Studies.MA("exponential",i.days,n[s],0,"_MA"+(s+1).toString(),t,i);for(var o=n[3],l=Math.max(1,i.startFrom);l<a.length;l++){var h=a[l-1][o];if(h){var c=a[l][o];(c||0===c)&&(a[l]["Result "+r]=100*(c/h-1))}}}},e.Studies.calculateTwiggsMoneyFlow=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)e.error=!0;else{var a=0,r=0,n=i[e.startFrom-1];n&&(n["_sumMF "+e.name]&&(a=n["_sumMF "+e.name]),n["_sumV "+e.name]&&(r=n["_sumV "+e.name]));for(var s=Math.max(1,e.startFrom);s<i.length;s++){var o=Math.max(i[s-1].Close,i[s].High),l=Math.min(i[s-1].Close,i[s].Low);i[s]["_MFV "+e.name]=i[s].Volume*(2*i[s].Close-o-l)/(o-l==0?999999:o-l),s>e.days-1&&(a*=(e.days-1)/e.days,r*=(e.days-1)/e.days),a+=i[s]["_MFV "+e.name],r+=i[s].Volume,s>e.days-1&&r&&(i[s]["Result "+e.name]=a/(r>0?r:999999)),i[s]["_sumMF "+e.name]=a,i[s]["_sumV "+e.name]=r}}},e.Studies.calculateUltimateOscillator=function(t,e){var i=e.chart.scrubbed,a=[e.inputs["Cycle 1"],e.inputs["Cycle 2"],e.inputs["Cycle 3"]],r=Math.max(a[0],a[1],a[2]);if(i.length<r+1)e.error=!0;else{var n=a[0]*a[1],s=a[0]*a[2],o=a[1]*a[2],l=[0,0,0],h=[0,0,0];e.startFrom&&(i[e.startFrom-1]["_accbp "+e.name]&&(l=i[e.startFrom-1]["_accbp "+e.name].slice()),i[e.startFrom-1]["_acctr "+e.name]&&(h=i[e.startFrom-1]["_acctr "+e.name].slice()));for(var c=Math.max(1,e.startFrom);c<i.length;c++){for(var u=Math.min(i[c].Low,i[c-1].Close),d=i[c].Close-u,p=Math.max(i[c].High,i[c-1].Close)-u,f=0;f<a.length;f++)if(l[f]+=d,h[f]+=p,c>a[f]){var m=Math.min(i[c-a[f]].Low,i[c-a[f]-1].Close),g=i[c-a[f]].Close-m,v=Math.max(i[c-a[f]].High,i[c-a[f]-1].Close)-m;l[f]-=g,h[f]-=v}if(i[c]["_accbp "+e.name]=l.slice(),i[c]["_acctr "+e.name]=h.slice(),!(c<r)){var y=o*l[0]/h[0]+s*l[1]/h[1]+n*l[2]/h[2],x=o+s+n;i[c]["Result "+e.name]=100*y/x}}}},e.Studies.calculateVerticalHorizontalFilter=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{i.mhml=new e.Studies.StudyDescriptor(i.name,i.type,i.panel),i.mhml.chart=i.chart,i.mhml.days=i.days,i.mhml.startFrom=i.startFrom,i.mhml.inputs={},i.mhml.outputs={_MHML:null},e.Studies.calculateMaxHighMinLow(t,i.mhml);for(var r=0,n=[],s=Math.max(1,i.startFrom-i.days);s<a.length;s++){var o=Math.abs(a[s].Close-a[s-1].Close);n.push(o),r+=o,n.length==i.days&&(a[s]["Result "+i.name]=a[s]["_MHML "+i.name]/r,r-=n.shift())}}},e.Studies.calculateVolumeIndex=function(t,i){var a=i.inputs.Field;a&&"field"!=a||(a="Close");var r=i.chart.scrubbed;if(r.length<i.days+1)i.error=!0;else{var n=100;i.startFrom>1&&(n=r[i.startFrom-1]["Index "+i.name]);for(var s=Math.max(1,i.startFrom);s<r.length;s++){var o=r[s][a],h=r[s].Volume;o&&"object"==l(o)&&(h=o.Volume,o=o[i.subField]);var c=r[s-1][a],u=r[s-1].Volume;c&&"object"==l(c)&&(u=c.Volume,c=c[i.subField]),o&&(c&&(("Pos Vol"==i.type&&h>u||"Neg Vol"==i.type&&h<u)&&(n*=o/c),r[s]["Index "+i.name]=n))}e.Studies.MA(i.inputs["Moving Average Type"],i.days,"Index "+i.name,0,"MA",t,i)}},e.Studies.validateProjectedVolumeLookback=function(t,e){var i=t.layout,a=i.interval,r=i.periodicity;return e.inputs["Lookback Days"]/(a*r)<=10},e.Studies.calculateProjectedVolume=function(t,i){var a=t.layout,s=a.interval,o=a.timeUnit,l=a.aggregationType,h=t.chart,c=h.symbol,u=h.scroll,d=h.scrubbed,p=h.market,f="PAV"===i.type,m=i.inputs,g=m["Lookback Days"],v=n(m["Anchor Time"].split(":"),3),y=v[0],x=v[1],b=v[2],S=void 0===b?0:b,C=i.study?i.study.name:i.type;if(e.ChartEngine.isDailyInterval(s)?i.error="".concat(C," is Intraday Only"):"tick"===o?i.error="Tick mode not supported for ".concat(C):"minute"!==o?i.error="Sub-minute periodicities not supported for ".concat(C):l&&["ohlc","heikinashi"].includes(l)?e.Studies.validateProjectedVolumeLookback(t,i)||(i.error="Selected lookback/periodicity combo not supported for ".concat(C)):i.error="Aggregation type not supported for ".concat(C),!i.error){var w,k=e.Market.Symbology.isForexSymbol(c),D=e.Market.Symbology.isForexMetal(c),T=i.getDependents(t),A=0,M=[];T.forEach((function(t){var e=t.inputs,i=t.outputMap;e.Period&&(A=Math.max(parseInt(e.Period),A),M.push.apply(M,r(Object.keys(i))))})),i.dependentsOutputMap=M;var P=Et(d.length-1,!0),F=Et(Math.ceil(d.length-1-u)-A);w=!k&&i.startFrom>F&&d[F]&&void 0!==d[F]["V "+i.name]&&M.every((function(t){return![void 0,null].includes(d[F][t])}))&&!1!==P?P:F;var _=Pt(_t(F),g),E=Et(0,!0),L=(E||0===E)&&Ft(Pt(d[E].DT,g,!0));if(d[0].DT>_){if(!t.quoteDriver)return i.error="Not enough data to calculate ".concat(C);if(t.quoteDriver.extendHistoricalData({from:_}),!(L>0))return;w=L}if(!(w<0||w>d.length-1)){var I,O,N,H=d.length-i.startFrom==1&&i.cachedFutureTicks&&i.cachedLastProjection&&+i.cachedLastProjection.DT==+d[d.length-1].DT&&d[w]["PV "+i.name];if(H)d[d.length-1]["PV "+i.name]=i.cachedLastProjection.projectedValue,i.appendFutureTicks(t,i.cachedFutureTicks),w=i.startFrom;else{i.cachedFutureTicks=null,i.cachedLastProjection=null;for(var R=[P],z=[],j=0;j<g;j++){var V=Et(R[0]-1);R.unshift(V)}for(;R[g]>=w;){var B=R.pop();if(!d[B])return At(B);var W=Mt(d[B].DT),U=W.hours,Y=W.minutes,Q=p.getClose(d[B].DT),q=void 0;if(Q){for(var X=p.getNextClose(d[B].DT);Q.getDate()===X.getDate();)Q=X,X=p.getNextClose(X);0===(q=Mt(Q)).hours&&(q.hours=24)}else q={hours:24,minutes:0};for(var Z=R.slice(),G=0;G<Z.length;G++){var K=Z[G];if(!d[K])return At(K);var J=Mt(d[K].DT),$=J.hours,tt=J.minutes;if($<U||$===U&&tt<Y)do{K++;var et=Mt(d[K].DT);$=et.hours,tt=et.minutes}while($!==U||tt!==Y);Z[G]=K}for(;U<q.hours||U===q.hours&&Y<q.minutes;){for(var it=!1,at=void 0,rt=void 0,nt=0,st=0,ot=0;ot<Z.length;ot++){var lt=Z[ot];if(null!==lt){var ht=d[lt];if(!ht)return At(lt);var ct=Mt(ht.DT),ut=ct.hours,dt=ct.minutes,pt=ht.DT.getDate();if(ut===U&&dt===Y)if(nt+=ht.Volume,st++,Z[ot]++,d[Z[ot]].DT.getDate()!==pt)Z[ot]=null;else if(!it){var ft=Mt(d[Z[ot]].DT);at=ft.hours,rt=ft.minutes,it=!0}}}if(U=at,Y=rt,0===st)break;var mt=nt/st;d[B]?d[B]["PV "+i.name]=mt:z.push((I={},O="PV "+i.name,N=mt,O in I?Object.defineProperty(I,O,{value:N,enumerable:!0,configurable:!0,writable:!0}):I[O]=N,I)),B++}R.unshift(Et(R[0]-1))}i.cachedLastProjection={DT:d[d.length-1].DT,projectedValue:d[d.length-1]["PV "+i.name]},i.cachedFutureTicks=z,i.appendFutureTicks(t,z)}var gt,vt=null,yt=0,xt=0;if(H&&f)for(;w>0;){var bt=d[w-1]["V "+i.name];if(bt||0===bt){yt=bt;break}w--}for(var St=w;St<d.length;St++){var Ct=d[St],wt=Ct.Volume,kt=Ct["PV "+i.name];Ct.futureTick||(gt=St),null===vt&&(vt=e.Studies.getMarketOffset(t,d[St].DT,k),k&&(vt+=60*(D?6:7)*60*1e3));var Dt=new Date(Ct.DT.getTime()+vt);if(d[St-1]&&d[St-1].DT)new Date(d[St-1].DT.getTime()+vt).getDate()!==Dt.getDate()&&t.chart.market.isMarketDate(Dt)&&(vt=null,yt=0,xt=0);var Tt=new Date(Dt);if(Tt.setHours(y,x,S),Dt<Tt)Ct["V "+i.name]=0,Ct["PV "+i.name]=0;else if(f?(yt+=wt,xt+=kt):(yt=wt,xt=kt),Ct["V "+i.name]=yt,H||(Ct["PV "+i.name]=xt),[NaN,null,void 0].includes(yt)&&!Ct.futureTick)return void(i.error="".concat(C," requires volume"))}i.cachedLastProjection.projectedValue=d[gt]["PV "+i.name],i.outputMap={},i.outputMap["V "+i.name]="",i.outputMap["PV "+i.name]="Average Line",T.forEach((function(e){e.startFrom=w,e.study.calculateFN(t,e)}))}}function At(t){console.error("Expected data for ".concat(_t(t).toDateString()," but found none. This may be caused by gaps in your data or an improperly configured market definition."))}function Mt(t){return{hours:t.getHours(),minutes:t.getMinutes()}}function Pt(t,e,i){for(;e;)t=new Date(new Date(t).setDate(t.getDate()+(i?1:-1))),p.isMarketDate(t)&&e--;return t}function Ft(e){return t.tickFromDate(e,null,null,!0,"scrubbed")}function _t(e){return t.dateFromTick(e,null,!0,"scrubbed")}function Et(i,a){var r=_t(i),n=p.getOpen(r)||function(i){i.setHours(0),i.setMinutes(0);var a=e.Studies.getMarketOffset(t,i,k);return new Date(i.getTime()+a)}(r),s=Ft(n);return a?(s<0&&(s=Ft(Pt(n,1,!0))),!(s>=d.length)&&s):s}},e.Studies.displayIchimoku=function(t,i,a){var r="Leading Span A "+i.name,n="Leading Span B "+i.name,s=e.Studies.determineColor(i.outputs[i.outputMap[r]]),o=e.Studies.determineColor(i.outputs[i.outputMap[n]]),l=t.panels[i.panel],h=i.getYAxis(t),c={topBand:r,bottomBand:n,topColor:s,bottomColor:o,skipTransform:l.name!=i.chart.name,topAxis:h,bottomAxis:h,opacity:.3};!i.highlight&&t.highlightedDraggable&&(c.opacity*=.3),e.fillIntersecting(t,i.panel,c),e.Studies.displaySeriesAsLine(t,i,a)},e.Studies.displayDarvas=function(t,i,a){var r=e.Studies.determineColor(i.outputs.Levels);r&&"auto"!=r&&!e.isTransparent(r)||(r=t.defaultColor);var n=e.Studies.determineColor(i.outputs.Darvas);n&&"auto"!=n&&!e.isTransparent(n)||(n=t.defaultColor);var s=e.Studies.determineColor(i.outputs.Ghost);s&&"auto"!=s&&!e.isTransparent(s)||(s=t.defaultColor);var o,l,h,c=t.panels[i.panel],u=i.getContext(t),d=t.layout.candleWidth-2;if(d<2&&(d=1),t.startClip(i.panel),i.inputs["Stop Levels"]){for(u.setLineDash&&u.setLineDash([2,2]),u.lineWidth=2,u.strokeStyle=r,u.beginPath(),o=0;o<a.length;o++){l=a[o];var p=a[o-1];if(l){h=l["Loss "+i.name]?Math.floor(t.pixelFromPrice(l["Loss "+i.name],c)):null;var f=p&&p["Loss "+i.name]?Math.floor(t.pixelFromPrice(p["Loss "+i.name],c)):null;if(h){l.candleWidth&&(d=Math.floor(Math.max(1,l.candleWidth)));var m=Math.floor(t.pixelFromBar(o,c.chart)+d/2),g=Math.floor(t.pixelFromBar(o,c.chart)-d/2);f&&f>=h?u.lineTo(g,h):0===o?u.moveTo(t.chart.left,h):u.moveTo(g,h),u.lineTo(m,h)}}}u.stroke(),u.setLineDash&&u.setLineDash([]),u.lineWidth=1}var v,y,x,b,S=-10,C=0,w=-10,k=0,D=!1,T=!1,A=u.measureText("▲").width/2,M=0;for(o=0;o<a.length;o++)if(a[o]){if((a[o].Close||0===a[o].Close)&&(M=o),a[o]["Spike "+i.name]){u.fillStyle=n,u.textBaseline="bottom";var P=t.pixelFromPrice(a[o].High,t.chart.panel);u.fillText("▼",t.pixelFromBar(o)-A,P-5)}a[o].candleWidth&&(d=Math.floor(Math.max(1,a[o].candleWidth))),a[o]["Darvas "+i.name]&&(1!=(l=a[o]["Darvas "+i.name]).State||D?0===l.State&&(C=Math.floor(t.pixelFromBar(o,c.chart)+d/2)-S,v=Math.floor(t.pixelFromPrice(l.High,c)),y=Math.floor(t.pixelFromPrice(l.Low,c))-v,u.strokeStyle=n,u.fillStyle=n,i.inputs["Stop Levels"]?u.globalAlpha=.3:(u.strokeRect(S,v,C,y),u.globalAlpha=.2),u.fillRect(S,v,C,y),u.globalAlpha=1,D=!1):(S=Math.floor(t.pixelFromBar(o,c.chart)-d/2),v=Math.floor(t.pixelFromPrice(l.High,c)),y=Math.floor(t.pixelFromPrice(l.Low,c))-v,D=!0)),a[o]["Ghost "+i.name]&&i.inputs["Ghost Boxes"]&&(1!=(l=a[o]["Ghost "+i.name]).State||T?0===l.State&&(l.Start==l.End&&(w=Math.floor(t.pixelFromBar(o,c.chart)-d/2)),k=Math.floor(t.pixelFromBar(o,c.chart)+d/2)-w,x=Math.floor(t.pixelFromPrice(l.High,c)),b=Math.floor(t.pixelFromPrice(l.Low,c))-x,u.strokeStyle=s,u.fillStyle=s,i.inputs["Stop Levels"]?u.globalAlpha=.3:(u.strokeRect(w,x,k,b),u.globalAlpha=.2),u.fillRect(w,x,k,b),u.globalAlpha=1,T=!1):(w=Math.floor(t.pixelFromBar(o,c.chart)-d/2),x=Math.floor(t.pixelFromPrice(l.High,c)),k=Math.floor((l.End-l.Start+1)*t.layout.candleWidth+d/2),b=Math.floor(t.pixelFromPrice(l.Low,c))-x,T=!0))}if(D&&(C=Math.floor(t.pixelFromBar(M,c.chart)+d/2)-S,u.strokeStyle=n,u.fillStyle=n,i.inputs["Stop Levels"]?u.globalAlpha=.3:(u.beginPath(),u.moveTo(S+2*C,v),u.lineTo(S,v),u.lineTo(S,v+y),u.lineTo(S+2*C,v+y),u.stroke(),u.globalAlpha=.2),u.fillRect(S,v,2*C,y),u.globalAlpha=1),T&&(u.strokeStyle=s,u.fillStyle=s,i.inputs["Stop Levels"]?u.globalAlpha=.3:(u.strokeRect(w,x,k,b),u.globalAlpha=.2),u.fillRect(w,x,k,b),u.globalAlpha=1),D||T){if(i.inputs["Stop Levels"]){u.setLineDash&&u.setLineDash([2,2]),u.lineWidth=2,u.strokeStyle=r;var F=Math.floor(t.pixelFromBar(M-1,c.chart)+d/2);void 0,h&&(u.beginPath(),u.moveTo(F,h),u.lineTo(D?S+2*C:w+k,h),u.stroke()),u.setLineDash&&u.setLineDash([]),u.lineWidth=1}D=!1,T=!1}t.endClip()},e.Studies.displaySupertrend=function(t,e,i){var a=t.panels[e.panel],r=e.getContext(t),n=e.getYAxis(t);function s(t,i,a){return i&&i["_Direction "+e.name]<0?e.outputs.Downtrend:e.outputs.Uptrend}var o={skipTransform:a.name!=e.chart.name,skipProjections:!0,label:t.preferences.labels,yAxis:n,highlight:e.highlight};r.strokeStyle=s(0,i[i.length-1]),r.lineWidth=2,e.highlight&&(r.lineWidth=1.5);for(var l="Trend "+e.name,h=0;a.chart.transformFunc&&n!=a.chart.yAxis&&h<i.length;h++){var c=i[h];c&&c.transform&&(c.transform[l]=a.chart.transformFunc(t,a.chart,c[l]))}t.plotDataSegmentAsLine(l,a,o,s),r.lineWidth=1,r.globalAlpha=1,t.startClip(e.panel),!e.highlight&&t.highlightedDraggable&&(r.globalAlpha*=.3);var u,d=r.measureText("▲").width/2;for(u=0;u<i.length;u++)if(i[u]&&i[u-1])if(i[u-1]["_Direction "+e.name]>i[u]["_Direction "+e.name]){r.fillStyle=e.outputs.Downtrend,r.textBaseline="bottom";for(var p=t.pixelFromPrice(i[u].High,a,n),f=5;f<=45;f+=10)n.flipped?r.fillText("▲",t.pixelFromBar(u)-d,p+f):r.fillText("▼",t.pixelFromBar(u)-d,p-f)}else if(i[u-1]["_Direction "+e.name]<i[u]["_Direction "+e.name]){r.fillStyle=e.outputs.Uptrend,r.textBaseline="top";for(var m=t.pixelFromPrice(i[u].Low,a,n),g=5;g<=45;g+=10)n.flipped?r.fillText("▼",t.pixelFromBar(u)-d,m-g):r.fillText("▲",t.pixelFromBar(u)-d,m+g)}t.endClip()},e.Studies.displayMFI=function(t,i,a){var r=t.panels[i.panel],n=i.getContext(t),s=i.getYAxis(t),o=s.flipped?s.top:s.bottom,l=t.layout.candleWidth-2;l<2&&(l=1);var h=e.Studies.determineColor(i.outputs.Green),c=e.Studies.determineColor(i.outputs.Fade),u=e.Studies.determineColor(i.outputs.Fake),d=e.Studies.determineColor(i.outputs.Squat);t.canvasColor("stx_histogram"),i.underlay||(n.globalAlpha=1),n.fillStyle="#CCCCCC",t.startClip(i.panel),!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3);for(var p=0;p<a.length;p++){var f=a[p],m=a[p-1];m||(m=t.getPreviousBar(t.chart,i.name+"_hist",p)),f&&(m&&(m[i.name+"_hist"]<f[i.name+"_hist"]?m.Volume<f.Volume?n.fillStyle=h:m.Volume>f.Volume&&(n.fillStyle=u):m[i.name+"_hist"]>f[i.name+"_hist"]&&(m.Volume<f.Volume?n.fillStyle=d:m.Volume>f.Volume&&(n.fillStyle=c))),f.candleWidth&&(l=Math.floor(Math.max(1,f.candleWidth-2))),n.fillRect(Math.floor(t.pixelFromBar(p,r.chart)-l/2),Math.floor(o),Math.floor(l),Math.floor(t.pixelFromPrice(f[i.name+"_hist"],r,s)-o)))}t.endClip()},e.Studies.displayAwesomeOscillator=function(t,i,a){var r=t.panels[i.panel],n=i.getContext(t),s=i.getYAxis(t),o=t.pixelFromPrice(0,r,s),l=t.layout.candleWidth-2;l<2&&(l=1);var h=e.Studies.determineColor(i.outputs["Increasing Bar"]),c=e.Studies.determineColor(i.outputs["Decreasing Bar"]);t.canvasColor("stx_histogram"),i.underlay||(n.globalAlpha=1),n.fillStyle="#CCCCCC",t.startClip(i.panel),!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3);for(var u=0;u<a.length;u++){var d=a[u],p=a[u-1];p||(p=t.getPreviousBar(t.chart,i.name+"_hist",u)),d&&(p&&(p[i.name+"_hist"]<d[i.name+"_hist"]?n.fillStyle=h:p[i.name+"_hist"]>d[i.name+"_hist"]&&(n.fillStyle=c)),d.candleWidth&&(l=Math.floor(Math.max(1,d.candleWidth-2))),n.fillRect(Math.floor(t.pixelFromBar(u,r.chart)-l/2),Math.floor(o),Math.floor(l),Math.floor(t.pixelFromPrice(d[i.name+"_hist"],r,s)-o)))}t.endClip()},e.Studies.displayGator=function(t,i,a){var r=t.panels[i.panel],n=i.getContext(t),s=i.getYAxis(t),o=t.pixelFromPrice(0,r,s),l=t.layout.candleWidth-2;l<2&&(l=1);var h=e.Studies.determineColor(i.outputs["Increasing Bar"]),c=e.Studies.determineColor(i.outputs["Decreasing Bar"]);t.canvasColor("stx_histogram"),i.underlay||(n.globalAlpha=1),n.fillStyle="#CCCCCC",t.startClip(i.panel),!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3);for(var u=0;u<a.length;u++){var d=a[u],p=a[u-1];if(d)for(var f=1;f<=2;f++)p||(p=t.getPreviousBar(t.chart,i.name+"_hist"+f,u)),p?Math.abs(p[i.name+"_hist"+f])<Math.abs(d[i.name+"_hist"+f])?n.fillStyle=h:Math.abs(p[i.name+"_hist"+f])>Math.abs(d[i.name+"_hist"+f])&&(n.fillStyle=c):n.fillStyle="#CCCCCC",d.candleWidth&&(l=Math.floor(Math.max(1,d.candleWidth-2))),n.fillRect(Math.floor(t.pixelFromBar(u,r.chart)-l/2),Math.floor(o),Math.floor(l),Math.floor(t.pixelFromPrice(d[i.name+"_hist"+f],r,s)-o))}t.endClip()},e.Studies.initElderImpulse=function(t,i,a,r,n,s){var o=e.Studies.initializeFN(t,i,a,r,n,s);return n.calculateOnly||(t.chart.customChart={chartType:"colored_bar",colorFunction:function(t,e,i){var a=e["Result "+o.name];return a&&"object"==l(a)&&(a=a.color),a}},t.setMainSeriesRenderer()),o},e.Studies.displayPivotPoints=function(t,i,a){if(i.noSlopes=!i.inputs.Continuous,e.Studies.displaySeriesAsLine(t,i,a),i.inputs.Shading){var r=t.panels[i.panel],n={noSlopes:i.noSlopes,opacity:i.parameters.opacity?i.parameters.opacity:.2,skipTransform:r.name!=i.chart.name,yAxis:i.getYAxis(t)};!i.highlight&&t.highlightedDraggable&&(n.opacity*=.3),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 3 "+i.name,bottomBand:"Resistance 2 "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 3"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 2 "+i.name,bottomBand:"Resistance 1 "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 2"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 1 "+i.name,bottomBand:"Pivot "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 1"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 1 "+i.name,bottomBand:"Pivot "+i.name,color:e.Studies.determineColor(i.outputs["Support 1"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 2 "+i.name,bottomBand:"Support 1 "+i.name,color:e.Studies.determineColor(i.outputs["Support 2"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 3 "+i.name,bottomBand:"Support 2 "+i.name,color:e.Studies.determineColor(i.outputs["Support 3"])},n))}},e.Studies.displayVWAP=function(t,i,a){e.Studies.displaySeriesAsLine(t,i,a);var r=i.inputs["Display 1 Standard Deviation (1σ)"],n=i.inputs["Display 2 Standard Deviation (2σ)"],s=i.inputs["Display 3 Standard Deviation (3σ)"];if((r||n||s)&&i.inputs.Shading){var o=t.panels[i.panel],l={opacity:i.parameters.opacity?i.parameters.opacity:.2,skipTransform:o.name!=i.chart.name,yAxis:i.getYAxis(t)};!i.highlight&&t.highlightedDraggable&&(l.opacity*=.3);var h="VWAP "+i.name,c="VWAP "+i.name;r&&(e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP1+ "+i.name,bottomBand:h,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP1+ "+i.name]])},l)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP1- "+i.name,bottomBand:c,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP1- "+i.name]])},l)),h="SDVWAP1+ "+i.name,c="SDVWAP1- "+i.name),n&&(e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP2+ "+i.name,bottomBand:h,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP2+ "+i.name]])},l)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP2- "+i.name,bottomBand:c,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP2- "+i.name]])},l)),h="SDVWAP2+ "+i.name,c="SDVWAP2- "+i.name),s&&(e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP3+ "+i.name,bottomBand:h,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP3+ "+i.name]])},l)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP3- "+i.name,bottomBand:c,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP3- "+i.name]])},l)))}},e.Studies.displayADX=function(t,i,a){var r=i.underlay?.3:i.inputs.Series?.4:1;if(i.inputs.Series&&i.inputs.Shading){var n="+DI "+i.name,s="-DI "+i.name,o=e.Studies.determineColor(i.outputs[i.outputMap[n]]),l=e.Studies.determineColor(i.outputs[i.outputMap[s]]),h=i.getYAxis(t),c={topBand:n,bottomBand:s,topColor:o,bottomColor:l,skipTransform:t.panels[i.panel].name!=i.chart.name,topAxis:h,bottomAxis:h,opacity:.3};!i.highlight&&t.highlightedDraggable&&(c.opacity*=.3),e.fillIntersecting(t,i.panel,c)}i.inputs.Histogram&&e.Studies.createHistogram(t,i,a,!1,r),!1!==i.inputs.Series?e.Studies.displaySeriesAsLine(t,i,a):i.inputs.Series||i.inputs.Histogram||t.displayErrorAsWatermark(i.panel,t.translateIf(i.name)+": "+t.translateIf("Nothing to display"))},e.Studies.displayAlligator=function(t,i,a){function r(e,i){var r,o=t.chart.panel.yAxis.flipped;"high"==e?(n.fillStyle=t.defaultColor,n.textBaseline=o?"top":"bottom",r=t.pixelFromPrice(a[i].High),n.fillText(o?"▼":"▲",t.pixelFromBar(s,t.chart)-n.measureText("▲").width/2+1,o?r+5:r-5)):"low"==e&&(n.fillStyle=t.defaultColor,n.textBaseline=o?"bottom":"top",r=t.pixelFromPrice(a[i].Low),n.fillText(o?"▲":"▼",t.pixelFromBar(s,t.chart)-n.measureText("▼").width/2+1,o?r-5:r+5))}var n=i.getContext(t);if(i.inputs["Show Lines"]&&e.Studies.displaySeriesAsLine(t,i,a),i.inputs["Show Fractals"]){t.startClip(),n.globalAlpha=i.underlay?.3:1,!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3);for(var s=2;s<a.length-2;s++)a[s]&&(a[s]["Fractal High "+i.name]&&r("high",s),a[s]["Fractal Low "+i.name]&&r("low",s));t.endClip()}},e.Studies.displayChannel=function(t,i,a){if(i.inputs["Channel Fill"]){var r={panelName:i.panel};for(var n in i.outputs){var s=n.split(" ").pop();"Top"==s||"High"==s?r.topBand=n+" "+i.name:"Bottom"==s||"Low"==s?r.bottomBand=n+" "+i.name:"Median"!=s&&"Channel"!=s||(r.color=e.Studies.determineColor(i.outputs[n]))}i.parameters&&i.parameters.opacity?r.opacity=i.parameters.opacity:r.opacity=.2;var o=t.panels[i.panel];r.skipTransform=o.name!=i.chart.name,r.yAxis=i.getYAxis(t),!i.highlight&&t.highlightedDraggable&&(r.opacity*=.3),e.prepareChannelFill(t,r)}e.Studies.displaySeriesAsLine(t,i,a)},e.Studies.displayElderForce=function(t,i,a){e.Studies.displaySeriesAsLine(t,i,a);var r=e.Studies.determineColor(i.outputs.Result),n=t.panels[i.panel],s=i.getYAxis(t),o={skipTransform:n.name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:0,color:r,yAxis:s};!i.highlight&&t.highlightedDraggable&&(o.opacity=.3),o.direction=1,e.preparePeakValleyFill(t,o),o.direction=-1,e.preparePeakValleyFill(t,o)},e.Studies.displayElderRay=function(t,i,a){var r=t.panels[i.panel],n=i.getContext(t),s=i.getYAxis(t),o=t.pixelFromPrice(0,r,s),l=t.layout.candleWidth-2;function h(a,h,c,u){n.fillStyle=e.Studies.determineColor(i.outputs[c]),n.fillRect(Math.floor(t.pixelFromBar(a,r.chart)-l/2+l*h),Math.floor(o),Math.floor(l*(1-2*h)),Math.floor(t.pixelFromPrice(d[i.name+u],r,s)-o))}l<2&&(l=1),t.canvasColor("stx_histogram");var c=n.fillStyle;i.underlay||(n.globalAlpha=1),t.startClip(i.panel),!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3);for(var u=0;u<a.length;u++){var d=a[u];d&&(d.candleWidth&&(l=Math.floor(Math.max(1,d.candleWidth-2))),d[i.name+"_hist1"]>0&&h(u,0,"Elder Bull Power","_hist1"),d[i.name+"_hist2"]<0&&h(u,0,"Elder Bear Power","_hist2"),d[i.name+"_hist1"]<0&&h(u,.1,"Elder Bull Power","_hist1"),d[i.name+"_hist2"]>0&&h(u,.1,"Elder Bear Power","_hist2"))}t.endClip(),n.fillStyle=c},e.Studies.displayMassIndex=function(t,i,a){e.Studies.displaySeriesAsLine(t,i,a);var r=i.inputs["Bulge Threshold"],n=(t.panels[i.panel],i.getYAxis(t)),s=e.Studies.determineColor(i.outputs.Result),o={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:r,direction:1,color:s,yAxis:n,opacity:.3};!i.highlight&&t.highlightedDraggable&&(o.opacity*=.3),e.preparePeakValleyFill(t,o),e.Studies.drawHorizontal(t,i,null,r,n,s)},e.Studies.displayPSAR2=function(t,i,a){var r=t.panels[i.panel],n=i.getYAxis(t),s=n==t.chart.panel.yAxis;t.startClip(r.name);var o=i.getContext(t),l="squarewave"==i.inputs["Plot Type"];for(var h in i.outputs){var c=h+" "+i.name;o.beginPath();for(var u=t.layout.candleWidth,d=Math.max(3,Math.floor(t.chart.tmpWidth/2)),p=0;p<a.length;p++){var f=a[p];if(f&&(f[c]||0===f[c])){f.candleWidth&&(u=f.candleWidth),s&&f.transform&&(f=f.transform);var m=t.pixelFromBar(p,r.chart);l&&(m-=u/2);var g=t.pixelFromTransformedValue(f[i.referenceOutput?i.referenceOutput+" "+i.name:c],r,n);if(0!==p&&a[p-1]&&(a[p-1][c]||0===a[p-1][c])||o.moveTo(m,g),l){if(o.lineTo(m,g),o.lineTo(m+u,g),a[p+1]){var v=a[p+1];s&&v.transform&&(v=v.transform),v[c]||0===v[c]||o.lineTo(m+u,t.pixelFromTransformedValue(v[i.referenceOutput?i.referenceOutput+" "+i.name:c],t.panels[i.panel],n))}}else o.moveTo(m-d/2,g),o.lineTo(m+d/2,g)}}o.lineWidth=1,i.highlight&&(o.lineWidth=3);var y=e.Studies.determineColor(i.outputs[h]);"auto"==y&&(y=t.defaultColor),o.strokeStyle=y,!i.highlight&&t.highlightedDraggable&&(o.globalAlpha*=.3),o.stroke(),o.closePath(),o.lineWidth=1}t.endClip()},e.Studies.displayRainbowMA=function(t,i,a){for(var r=t.panels[i.panel],n=10;n>0;n--)e.Studies.displayIndividualSeriesAsLine(t,i,r,"SMA"+n+" "+i.name,a)},e.Studies.displayRainbowOsc=function(t,i,a){e.Studies.displaySeriesAsLine(t,i,a);var r=t.panels[i.panel],n=i.getContext(t),s=i.getYAxis(t);t.startClip(i.panel),!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3);var o=t.pixelFromPrice(0,r,s),l=r.name!=i.chart.name,h=e.Studies.determineColor(i.outputs["Positive Bar"]);n.strokeStyle=h,t.plotDataSegmentAsLine("Over "+i.name,r,{skipTransform:l,label:!1,yAxis:s});var c=n.createLinearGradient(0,o,0,s.flipped?s.bottom:s.top);c.addColorStop(0,t.containerColor),c.addColorStop(1,h),e.prepareChannelFill(t,{skipTransform:l,color:c,opacity:!i.highlight&&t.highlightedDraggable?.3:1,panelName:i.panel,topBand:"Over "+i.name,bottomBand:"Zero "+i.name,yAxis:s});var u=e.Studies.determineColor(i.outputs["Negative Bar"]);n.strokeStyle=u,t.plotDataSegmentAsLine("Under "+i.name,r,{skipTransform:l,label:!1,yAxis:s});var d=n.createLinearGradient(0,o,0,s.flipped?s.top:s.bottom);d.addColorStop(0,t.containerColor),d.addColorStop(1,u),e.prepareChannelFill(t,{skipTransform:l,color:d,opacity:!i.highlight&&t.highlightedDraggable?.3:1,panelName:i.panel,topBand:"Zero "+i.name,bottomBand:"Under "+i.name,yAxis:s});var p=t.layout.candleWidth-2;p<2&&(p=1),t.canvasColor("stx_histogram"),i.underlay||(n.globalAlpha=1),!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3),n.fillStyle="#CCCCCC";for(var f=0;f<a.length;f++){var m=a[f];m&&(m[i.name+"_hist"]>0?n.fillStyle=h:m[i.name+"_hist"]<0&&(n.fillStyle=u),m.candleWidth&&(p=Math.floor(Math.max(1,m.candleWidth-2))),n.fillRect(Math.floor(t.pixelFromBar(f,r.chart)-p/2),Math.floor(o),Math.floor(p),Math.floor(t.pixelFromPrice(m[i.name+"_hist"],r,s)-o)))}t.endClip()},e.Studies.displayRAVI=function(t,i,a){var r=t.panels[i.panel],n=i.getContext(t),s=i.getYAxis(t),o=t.pixelFromPrice(0,r,s),l=t.layout.candleWidth-2;l<2&&(l=1);var h=e.Studies.determineColor(i.outputs["Increasing Bar"]),c=e.Studies.determineColor(i.outputs["Decreasing Bar"]);t.startClip(i.panel),t.canvasColor("stx_histogram"),i.underlay||(n.globalAlpha=1),!i.highlight&&t.highlightedDraggable&&(n.globalAlpha*=.3);for(var u=0;u<a.length;u++){var d=a[u],p=a[u-1];if(p||(p=t.getPreviousBar(t.chart,i.name+"_hist",u)),d){var f=0,m=0;i.parameters&&i.parameters.studyOverZonesEnabled&&(f=parseFloat(i.parameters.studyOverBoughtValue),m=parseFloat(i.parameters.studyOverSoldValue)),p?d[i.name+"_hist"]>f&&p[i.name+"_hist"]<d[i.name+"_hist"]?n.fillStyle=h:d[i.name+"_hist"]<m&&p[i.name+"_hist"]>d[i.name+"_hist"]?n.fillStyle=c:n.fillStyle="#CCCCCC":n.fillStyle="#CCCCCC",d.candleWidth&&(l=Math.floor(Math.max(1,d.candleWidth-2))),n.fillRect(Math.floor(t.pixelFromBar(u,r.chart)-l/2),Math.floor(o),Math.floor(l),Math.floor(t.pixelFromPrice(d[i.name+"_hist"],r,s)-o))}}t.endClip()},e.Studies.displayZigZag=function(t,i,a){var r=t.chart.highLowBars;i.highLowChart!=r&&(i.highLowChart=r,i.startFrom=0,i.study.calculateFN(t,i));for(var n=t.chart,s=0;s<a.length;s++){var o=a[s];o&&(o["_shadowCopy "+i.name]&&(delete o["Result "+i.name],delete o["_shadowCopy "+i.name]),o["Result "+i.name]||o.transform&&delete o.transform["Result "+i.name])}var l=a[0],h=a[a.length-1];l&&l["ShadowResult "+i.name]&&(l["Result "+i.name]=l["ShadowResult "+i.name],l.transform&&(l.transform["Result "+i.name]=n.transformFunc(t,n,l["ShadowResult "+i.name])),l["_shadowCopy "+i.name]=1),h&&h["ShadowResult "+i.name]&&(h["Result "+i.name]=h["ShadowResult "+i.name],h.transform&&(h.transform["Result "+i.name]=n.transformFunc(t,n,h["ShadowResult "+i.name])),h["_shadowCopy "+i.name]=1),e.Studies.displaySeriesAsLine(t,i,a)},e.Studies.displayVolumeProfile=function(t,i,a){if(t&&t.chart.dataSet){var r=t.chart,n=i.parameters.numberOfBars,s=i.parameters.widthPercentage,o=i.parameters.displayBorder,l=i.parameters.displayVolume;(!n||n<0)&&(n=30),n=Math.ceil(n),(!s||s<0)&&(s=.25),!1!==o&&(o=!0),!0!==l&&(l=!1);var h=(r.highValue-r.lowValue)/n;if(0!==h){for(var c=[],u=r.lowValue;u<r.highValue+.1;u+=h)c.push([u,0]);if(c.length<2)t.displayErrorAsWatermark("chart",t.translateIf("Not enough data to render the Volume Profile"));else{for(var d=0,p=0;p<a.length;p++){var f=a[p];if(f){var m=f.Volume;i.panel==r.name&&f.transform&&(f=f.transform);for(var g=c[0][0],v=0,y=1;y<c.length;y++)v=c[y][0],(f.Low>=g&&f.Low<=v||f.Low<g&&f.High>v||f.High>=g&&f.High<=v)&&(c[y][1]+=m,c[y][1]>d&&(d=c[y][1])),g=v}}if(0!==d){t.setStyle("stx_volume_profile","color",e.Studies.determineColor(i.outputs["Bars Color"]));var x=i.getContext(t);t.canvasFont("stx-float-date",x);var b=t.getCanvasFontSize("stx-float-date"),S=r.panel,C=S.yAxis.bottom,w=Math.round(r.right)-.5,k=r.width*s,D=t.canvasStyle("stx_volume_profile").borderTopColor,T=!e.isTransparent(t.canvasStyle("stx_volume_profile").borderTopColor)&&o,A=t;M("stx_volume_profile",!1),T&&M("stx_volume_profile",!0),x.globalAlpha=1}else t.displayErrorAsWatermark("chart",t.translateIf("Not enough data to render the Volume Profile"))}}}function M(a,r){r||(w-=2),A.canvasColor(a),x.beginPath();for(var n=c[0][0],s=w,o=1;o<c.length;o++){if(c[o][1]){var h=Math.round(w-c[o][1]*k/d)-.5,u=Math.round(A.pixelFromTransformedValue(n,S))+.5,p=Math.round(A.pixelFromTransformedValue(c[o][0],S))+.5;if(r||(u-=.5,p+=.5,h+=.5),u>C&&(u=C),p<C)if(x.moveTo(w,u),x.lineTo(w,p),x.lineTo(h,p),x.lineTo(h,u),r)(s>h||1==o)&&x.lineTo(s,u);else if(x.lineTo(w,u),l){var f=e.condenseInt(c[o][1]),m=u-p;if(b<=m-2){var g;try{g=x.measureText(f).width}catch(t){g=0}x.textBaseline="top";var v=x.fillStyle;x.fillStyle=D,x.fillText(f,h-g-3,p+(m/2-b/2)),x.fillStyle=v}}s=h}else s=w;n=c[o][0]}!i.highlight&&t.highlightedDraggable&&(x.globalAlpha*=.3),r||x.fill(),x.strokeStyle=D,r&&x.stroke(),x.closePath()}},e.Studies.displayProjectedVolume=function(t,i,a){if(!i.error){var r=i.inputs["Alert Threshold"],n=parseInt((void 0===r?"":r).slice(0,-1),10)/100,s=i.outputs["Alert Bar"];"object"===l(s)&&(s=s.color),i.volumeField="V "+i.name,i.plotStepLine=!0,i.alignStepToSide=!0,i.extendToEndOfLastBar=!0,i.lineWidth=2;var o=t.canvasStyle("stx_volume_underlay_up").opacity,h=t.canvasStyle("stx_volume_underlay_down").opacity;i.colorFunction=function(e){var a=e.Open,r=e.Close,l=e.iqPrevClose,c=(t.colorByCandleDirection?a:l)>r,u=e["PV "+i.name],d=e["V "+i.name],p=u*(n+1),f=n<0?d<p:d>p;return{fill_color:f&&s||(c?this.fill_color_down:this.fill_color_up),border_color:c?this.border_color_down:this.border_color_up,opacity:f?1:c?h:o,border_opacity:c?h:o}};var c=i.study?i.study.name:i.type,u=t.chart.loadingMore,d=a.some((function(t){return t&&t[i.volumeField]&&t["PV "+i.name]})),p=a[0]&&!a[0].futureTick&&(void 0===a[0]["PV "+i.name]||(i.dependentsOutputMap||[]).some((function(t){return[void 0,null].includes(a[0][t])})));if(!d&&u)return i.error="Fetching data for ".concat(c);e.Studies.createVolumeChart(t,i,a),e.Studies.displaySeriesAsLine(t,i,a),p&&e.Studies.calculateProjectedVolume(t,i)}},e.Studies.studyLibrary=e.extend(e.Studies.studyLibrary,{"Acc Swing":{name:"Accumulative Swing Index",calculateFN:e.Studies.calculateSwingIndex,inputs:{"Limit Move Value":.5}},ADX:{name:"ADX/DMS",calculateFN:e.Studies.calculateADX,seriesFN:e.Studies.displayADX,inputs:{Period:14,"Smoothing Period":14,Series:!0,Shading:!1,Histogram:!1},outputs:{"+DI":"#00FF00","-DI":"#FF0000",ADX:"auto","Positive Bar":"#00DD00","Negative Bar":"#FF0000"}},Aroon:{name:"Aroon",range:"0 to 100",calculateFN:e.Studies.calculateAroon,outputs:{"Aroon Up":"#00DD00","Aroon Down":"#FF0000"}},"Aroon Osc":{name:"Aroon Oscillator",calculateFN:e.Studies.calculateAroon,outputs:{"Aroon Oscillator":"auto"}},ATR:{name:"Average True Range",calculateFN:e.Studies.calculateStudyATR,outputs:{ATR:"auto"}},"Bollinger Bands":{name:"Bollinger Bands",overlay:!0,calculateFN:e.Studies.calculateBollinger,seriesFN:e.Studies.displayChannel,inputs:{Period:20,Field:"field","Standard Deviations":2,"Moving Average Type":"ma","Channel Fill":!0},outputs:{"Bollinger Bands Top":"auto","Bollinger Bands Median":"auto","Bollinger Bands Bottom":"auto"},attributes:{"Standard Deviations":{min:.1,step:.1}}},CCI:{name:"Commodity Channel Index",calculateFN:e.Studies.calculateCCI,inputs:{Period:20},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:100,studyOverBoughtColor:"auto",studyOverSoldValue:-100,studyOverSoldColor:"auto"}},attributes:{Period:{min:2}}},"Chaikin MF":{name:"Chaikin Money Flow",calculateFN:e.Studies.calculateChaikinMoneyFlow,inputs:{Period:20}},"Chaikin Vol":{name:"Chaikin Volatility",calculateFN:e.Studies.calculateChaikinVolatility,inputs:{Period:14,"Rate Of Change":2,"Moving Average Type":"ma"}},"Chande Fcst":{name:"Chande Forecast Oscillator",calculateFN:e.Studies.calculateChandeForecast,inputs:{Period:14,Field:"field"}},"Chande Mtm":{name:"Chande Momentum Oscillator",calculateFN:e.Studies.calculateChandeMomentum,inputs:{Period:9},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:50,studyOverBoughtColor:"auto",studyOverSoldValue:-50,studyOverSoldColor:"auto"}}},COG:{name:"Center Of Gravity",calculateFN:e.Studies.calculateCenterOfGravity,inputs:{Period:10,Field:"field"}},Coppock:{name:"Coppock Curve",calculateFN:e.Studies.calculateCoppock,inputs:{Period:10,Field:"field","Short RoC":11,"Long RoC":14}},Detrended:{name:"Detrended Price Oscillator",calculateFN:e.Studies.calculateDetrendedPrice,inputs:{Period:14,Field:"field","Moving Average Type":"ma"}},"Donchian Channel":{name:"Donchian Channel",overlay:!0,calculateFN:e.Studies.calculateMaxHighMinLow,seriesFN:e.Studies.displayChannel,inputs:{"High Period":20,"Low Period":20,"Channel Fill":!0},outputs:{"Donchian High":"auto","Donchian Median":"auto","Donchian Low":"auto"}},"Ehler Fisher":{name:"Ehler Fisher Transform",calculateFN:e.Studies.calculateEhlerFisher,inputs:{Period:10},outputs:{EF:"auto","EF Trigger":"#FF0000"}},"Elder Force":{name:"Elder Force Index",calculateFN:e.Studies.calculateElderForce,seriesFN:e.Studies.displayElderForce,inputs:{Period:13}},"Elder Ray":{name:"Elder Ray Index",seriesFN:e.Studies.displayElderRay,calculateFN:e.Studies.calculateElderRay,centerline:0,inputs:{Period:13},outputs:{"Elder Bull Power":"#00DD00","Elder Bear Power":"#FF0000"}},EOM:{name:"Ease of Movement",calculateFN:e.Studies.calculateEaseOfMovement,inputs:{Period:14,"Moving Average Type":"ma"}},"Fractal Chaos":{name:"Fractal Chaos Oscillator",range:"-1 to 1",calculateFN:e.Studies.calculateFractalChaos,inputs:{},centerline:null},"Fractal Chaos Bands":{name:"Fractal Chaos Bands",overlay:!0,calculateFN:e.Studies.calculateFractalChaos,seriesFN:e.Studies.displayChannel,inputs:{"Channel Fill":!0},outputs:{"Fractal High":"auto","Fractal Low":"auto","Fractal Channel":"auto"}},GAPO:{name:"Gopalakrishnan Range Index",calculateFN:e.Studies.calculateMaxHighMinLow},HHV:{name:"Highest High Value",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14}},"High Low":{name:"High Low Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:function(t,i){i.inputs["Moving Average Type"]="triangular",e.Studies.calculateMAEnvelope(t,i)},inputs:{Period:10,Field:"field","Shift Percentage":5,"Channel Fill":!0},outputs:{"High Low Top":"auto","High Low Median":"auto","High Low Bottom":"auto"},attributes:{"Shift Percentage":{min:.1,step:.1}}},"High-Low":{name:"High Minus Low",calculateFN:function(t,e){for(var i=e.chart.scrubbed,a=e.startFrom;a<i.length;a++)i[a]["Result "+e.name]=i[a].High-i[a].Low},inputs:{}},"Hist Vol":{name:"Historical Volatility",calculateFN:e.Studies.calculateHistoricalVolatility,inputs:{Period:10,Field:"field","Days Per Year":[252,365],"Standard Deviations":1},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Intraday Mtm":{name:"Intraday Momentum Index",calculateFN:e.Studies.calculateIntradayMomentum,inputs:{Period:20},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},Keltner:{name:"Keltner Channel",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateKeltner,inputs:{Period:50,Shift:5,"Moving Average Type":"ema","Channel Fill":!0},outputs:{"Keltner Top":"auto","Keltner Median":"auto","Keltner Bottom":"auto"},attributes:{Shift:{min:.1,step:.1}}},Klinger:{name:"Klinger Volume Oscillator",seriesFN:e.Studies.displayHistogramWithSeries,calculateFN:e.Studies.calculateKlinger,inputs:{"Signal Periods":13,"Short Cycle":34,"Long Cycle":55},outputs:{Klinger:"auto",KlingerSignal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"Lin Fcst":{name:"Linear Reg Forecast",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Forecast:"auto"}},"Lin Incpt":{name:"Linear Reg Intercept",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Intercept:"auto"}},"Lin R2":{name:"Linear Reg R2",calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{RSquared:"auto"}},LLV:{name:"Lowest Low Value",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14}},"LR Slope":{name:"Linear Reg Slope",calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Slope:"auto"}},macd:{name:"MACD",calculateFN:e.Studies.calculateMACD,seriesFN:e.Studies.displayHistogramWithSeries,inputs:{"Fast MA Period":12,"Slow MA Period":26,"Signal Period":9},outputs:{MACD:"auto",Signal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"MA Env":{name:"Moving Average Envelope",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateMAEnvelope,inputs:{Period:50,Field:"field","Shift Type":["percent","points"],Shift:5,"Moving Average Type":"ma","Channel Fill":!0},outputs:{"MA Env Top":"auto","MA Env Median":"auto","MA Env Bottom":"auto"},attributes:{Shift:{min:.1,step:.1}}},"Mass Idx":{name:"Mass Index",seriesFN:e.Studies.displayMassIndex,calculateFN:e.Studies.calculateMassIndex,inputs:{Period:25,"Bulge Threshold":27},attributes:{"Bulge Threshold":{min:20,max:35,step:.1}}},"M Flow":{name:"Money Flow Index",range:"0 to 100",calculateFN:e.Studies.calculateMoneyFlowIndex,inputs:{Period:14},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},"Neg Vol":{name:"Negative Volume Index",calculateFN:e.Studies.calculateVolumeIndex,inputs:{Period:255,Field:"field","Moving Average Type":"ma"},outputs:{Index:"auto",MA:"#FF0000"}},"On Bal Vol":{name:"On Balance Volume",calculateFN:e.Studies.calculateOnBalanceVolume,inputs:{}},"Pos Vol":{name:"Positive Volume Index",calculateFN:e.Studies.calculateVolumeIndex,inputs:{Period:255,Field:"field","Moving Average Type":"ma"},outputs:{Index:"auto",MA:"#FF0000"}},"Pretty Good":{name:"Pretty Good Oscillator",calculateFN:e.Studies.calculatePrettyGoodOscillator,parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:3,studyOverBoughtColor:"auto",studyOverSoldValue:-3,studyOverSoldColor:"auto"}}},"Price Osc":{name:"Price Oscillator",calculateFN:e.Studies.calculatePriceOscillator,inputs:{Field:"field","Short Cycle":12,"Long Cycle":26,"Moving Average Type":"ema","Points Or Percent":["Points","Percent"]}},"Price Vol":{name:"Price Volume Trend",calculateFN:e.Studies.calculatePriceVolumeTrend,inputs:{Field:"field"}},"Prime Number":{name:"Prime Number Oscillator",range:"-1 to 1",calculateFN:e.Studies.calculatePrimeNumber,centerline:0,inputs:{"Tolerance Percentage":5},attributes:{"Tolerance Percentage":{min:.1,step:.1}}},"Prime Number Bands":{name:"Prime Number Bands",overlay:!0,calculateFN:e.Studies.calculatePrimeNumber,seriesFN:e.Studies.displayChannel,inputs:{"Channel Fill":!0},outputs:{"Prime Bands Top":"auto","Prime Bands Bottom":"auto","Prime Bands Channel":"auto"}},PSAR:{name:"Parabolic SAR",overlay:!0,calculateFN:e.Studies.calculatePSAR,seriesFN:e.Studies.displayPSAR2,inputs:{"Minimum AF":.02,"Maximum AF":.2}},QStick:{name:"QStick",calculateFN:e.Studies.calculateQStick,inputs:{Period:8,"Moving Average Type":"ma"}},"Random Walk":{name:"Random Walk Index",calculateFN:e.Studies.calculateRandomWalk,outputs:{"Random Walk High":"#FF0000","Random Walk Low":"#0000FF"}},RAVI:{name:"RAVI",seriesFN:e.Studies.displayRAVI,calculateFN:e.Studies.calculatePriceOscillator,inputs:{Field:"field","Moving Average Type":"vdma","Short Cycle":7,"Long Cycle":65},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"},centerline:0,parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:3,studyOverBoughtColor:"auto",studyOverSoldValue:-3,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:0,step:"0.1"},studyOverSoldValue:{max:0,step:"0.1"}}},rsi:{name:"RSI",inputs:{Period:14,Field:"field"},calculateFN:e.Studies.calculateRSI,range:"0 to 100",outputs:{RSI:"auto"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},Schaff:{name:"Schaff Trend Cycle",range:"0 to 100",calculateFN:e.Studies.calculateSchaff,inputs:{Period:10,Field:"field","Short Cycle":23,"Long Cycle":50,"Moving Average Type":"ema"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:75,studyOverBoughtColor:"auto",studyOverSoldValue:25,studyOverSoldColor:"auto"}}},"Stch Mtm":{name:"Stochastic Momentum Index",calculateFN:e.Studies.calculateStochMomentum,inputs:{"%K Periods":10,"%K Smoothing Periods":3,"%K Double Smoothing Periods":3,"%D Periods":10,"%D Moving Average Type":"ema"},outputs:{"%K":"auto","%D":"#FF0000"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:40,studyOverBoughtColor:"auto",studyOverSoldValue:-40,studyOverSoldColor:"auto"}}},Swing:{name:"Swing Index",calculateFN:e.Studies.calculateSwingIndex,inputs:{"Limit Move Value":.5}},"Time Fcst":{name:"Time Series Forecast",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Forecast:"auto"}},"Trade Vol":{name:"Trade Volume Index",calculateFN:e.Studies.calculateOnBalanceVolume,inputs:{"Min Tick Value":.5}},TRIX:{name:"TRIX",calculateFN:e.Studies.calculateTRIX},Twiggs:{name:"Twiggs Money Flow",calculateFN:e.Studies.calculateTwiggsMoneyFlow,inputs:{Period:21}},"Typical Price":{name:"Typical Price",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14}},Ultimate:{name:"Ultimate Oscillator",calculateFN:e.Studies.calculateUltimateOscillator,inputs:{"Cycle 1":7,"Cycle 2":14,"Cycle 3":28},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},"Vol Osc":{name:"Volume Oscillator",calculateFN:e.Studies.calculatePriceOscillator,inputs:{"Short Cycle":12,"Long Cycle":26,"Points Or Percent":["Points","Percent"]},parameters:{init:{isVolume:!0}}},"Vol ROC":{name:"Volume Rate of Change",calculateFN:e.Studies.calculateRateOfChange,parameters:{init:{isVolume:!0}}},"VT HZ Filter":{name:"Vertical Horizontal Filter",calculateFN:e.Studies.calculateVerticalHorizontalFilter,inputs:{Period:28}},"W Acc Dist":{name:"Accumulation/Distribution",calculateFN:e.Studies.calculateAccumulationDistribution,inputs:{"Use Volume":!1}},"Weighted Close":{name:"Weighted Close",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14}},"Williams %R":{name:"Williams %R",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:-20,studyOverBoughtColor:"auto",studyOverSoldValue:-80,studyOverSoldColor:"auto"}}},"val lines":{name:"Valuation Lines",calculateFN:function(){},seriesFN:function(t,i,a){e.Studies.calculateValuationLines(t,i,a),e.Studies.displayValuationLines(t,i)},overlay:!0,yAxisFN:function(){},inputs:{Field:"field","Average Type":["mean","median","harmonic"],"Display Average":!0,"Display 1 Standard Deviation (1σ)":!1,"Display 2 Standard Deviation (2σ)":!1,"Display 3 Standard Deviation (3σ)":!1},outputs:{Average:"#00afed","1 Standard Deviation (1σ)":"#e1e1e1","2 Standard Deviation (2σ)":"#85c99e","3 Standard Deviation (3σ)":"#fff69e"}},"vol undr":{name:"Volume Underlay",underlay:!0,range:"0 to max",yAxis:{ground:!0,initialMarginTop:0,position:"none",zoom:0,heightFactor:.25},seriesFN:e.Studies.createVolumeChart,calculateFN:e.Studies.calculateVolume,inputs:{},outputs:{"Up Volume":"#8cc176","Down Volume":"#b82c0c"},customRemoval:!0,removeFN:function(t,e){t.layout.volumeUnderlay=!1,t.changeOccurred("layout")},attributes:{panelName:{hidden:!0}}},correl:{name:"Correlation Coefficient",range:"-1 to 1",calculateFN:e.Studies.calculateCorrelationCoefficient,outputs:{}},PMO:{name:"Price Momentum Oscillator",calculateFN:e.Studies.calculatePMO,inputs:{Field:"field","Smoothing Period":35,"Double Smoothing Period":20,"Signal Period":10},outputs:{PMO:"auto",PMOSignal:"#FF0000"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:2.5,studyOverBoughtColor:"auto",studyOverSoldValue:-2.5,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:0,step:"0.05"},studyOverSoldValue:{max:0,step:"0.05"}}},"Rel Vol":{name:"Relative Volatility",range:"0 to 100",calculateFN:e.Studies.calculateRelativeVolatility,inputs:{Field:"field","STD Period":10,"Smoothing Period":14},outputs:{"Rel Vol":"auto"},centerline:50,parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},Awesome:{name:"Awesome Oscillator",seriesFN:e.Studies.displayAwesomeOscillator,calculateFN:e.Studies.calculateAwesomeOscillator,inputs:{},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"W MFI":{name:"Market Facilitation Index",seriesFN:e.Studies.displayMFI,calculateFN:e.Studies.calculateMFI,yAxis:{ground:!0},range:"0 to max",inputs:{"Scale Factor":6},outputs:{Green:"#8bc176",Fade:"#ab611f",Fake:"#5f7cb8",Squat:"#ffd0cf"}},"ATR Bands":{name:"ATR Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateATRBands,inputs:{Period:5,Field:"field",Shift:3,"Channel Fill":!0},outputs:{"ATR Bands Top":"auto","ATR Bands Bottom":"auto","ATR Bands Channel":"auto"},attributes:{Shift:{min:.1,step:.1}}},"STARC Bands":{name:"STARC Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateSTARCBands,inputs:{Period:15,"MA Period":5,Multiplier:1.3,"Channel Fill":!0},outputs:{"STARC Bands Top":"auto","STARC Bands Median":"auto","STARC Bands Bottom":"auto"},attributes:{Multiplier:{min:.1,step:.1}}},"ATR Trailing Stop":{name:"ATR Trailing Stops",overlay:!0,seriesFN:e.Studies.displayPSAR2,calculateFN:e.Studies.calculateATRStops,inputs:{Period:21,Multiplier:3,"Plot Type":["points","squarewave"],HighLow:!1},outputs:{"Buy Stops":"#FF0000","Sell Stops":"#00FF00"},attributes:{Multiplier:{min:.1,step:.1}}},"Boll %b":{name:"Bollinger %b",calculateFN:e.Studies.calculateBollinger,inputs:{Period:20,Field:"field","Standard Deviations":2,"Moving Average Type":"ma"},outputs:{"%b":"auto"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:100,studyOverBoughtColor:"auto",studyOverSoldValue:0,studyOverSoldColor:"auto"}},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Boll BW":{name:"Bollinger Bandwidth",calculateFN:e.Studies.calculateBollinger,inputs:{Period:20,Field:"field","Standard Deviations":2,"Moving Average Type":"ma"},outputs:{Bandwidth:"auto"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Donchian Width":{name:"Donchian Width",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{"High Period":20,"Low Period":20}},"Rel Vig":{name:"Relative Vigor Index",seriesFN:e.Studies.displayHistogramWithSeries,calculateFN:e.Studies.calculateRelativeVigor,inputs:{Period:10},outputs:{"Rel Vig":"auto",RelVigSignal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"Elder Impulse":{name:"Elder Impulse System",calculateFN:e.Studies.calculateElderImpulse,initializeFN:e.Studies.initElderImpulse,seriesFN:null,customRemoval:!0,underlay:!0,inputs:{},outputs:{Bullish:"#8BC176",Bearish:"#DD3E39",Neutral:"#5F7CB8"},removeFN:function(t,e){t.chart.customChart=null,t.setMainSeriesRenderer()}},"Pivot Points":{name:"Pivot Points",overlay:!0,seriesFN:e.Studies.displayPivotPoints,calculateFN:e.Studies.calculatePivotPoints,inputs:{Type:["standard","fibonacci"],Continuous:!1,Shading:!1},outputs:{Pivot:"auto","Resistance 1":"#b82c0b","Support 1":"#699158","Resistance 2":"#e36460","Support 2":"#b3d987","Resistance 3":"#ffd0cf","Support 3":"#d3e8ae"},parameters:{init:{opacity:.2}}},Alligator:{name:"Alligator",overlay:!0,seriesFN:e.Studies.displayAlligator,calculateFN:e.Studies.calculateAlligator,inputs:{"Show Lines":!0,"Jaw Period":13,"Jaw Offset":8,"Teeth Period":8,"Teeth Offset":5,"Lips Period":5,"Lips Offset":3,"Show Fractals":!1},outputs:{Jaw:"#0000FF",Teeth:"#FF0000",Lips:"#00DD00"}},Gator:{name:"Gator Oscillator",seriesFN:e.Studies.displayGator,calculateFN:e.Studies.calculateAlligator,inputs:{"Jaw Period":13,"Jaw Offset":8,"Teeth Period":8,"Teeth Offset":5,"Lips Period":5,"Lips Offset":3},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"},centerline:0},"Ichimoku Clouds":{name:"Ichimoku Clouds",overlay:!0,calculateFN:e.Studies.calculateIchimoku,seriesFN:e.Studies.displayIchimoku,inputs:{"Conversion Line Period":9,"Base Line Period":26,"Leading Span B Period":52,"Lagging Span Period":26},outputs:{"Conversion Line":"#0000FF","Base Line":"#FF0000","Leading Span A":"#00FF00","Leading Span B":"#FF0000","Lagging Span":"#808000"}},"Perf Idx":{name:"Performance Index",centerline:1,initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculatePerformance,inputs:{Period:120,"Comparison Symbol":"SPY"},outputs:{Result:"auto",Gain:"#00DD00",Loss:"#FF0000"},deferUpdate:!0},Beta:{name:"Beta",centerline:1,initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculateBeta,inputs:{Period:20,"Comparison Symbol":"SPY"},deferUpdate:!0},Ulcer:{name:"Ulcer Index",calculateFN:e.Studies.calculateUlcerIndex,inputs:{Period:14,Field:"field"}},"Bal Pwr":{name:"Balance of Power",range:"-1 to 1",centerline:0,calculateFN:e.Studies.calculateBalanceOfPower,inputs:{Period:14,"Moving Average Type":"ma"}},"Trend Int":{name:"Trend Intensity Index",calculateFN:e.Studies.calculateTrendIntensity,range:"0 to 100",inputs:{Period:14,Field:"field","Signal Period":9},outputs:{TII:"auto",Signal:"#FF0000"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},Choppiness:{name:"Choppiness Index",calculateFN:e.Studies.calculateChoppiness,centerline:50,parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:61.8,studyOverBoughtColor:"auto",studyOverSoldValue:38.2,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:50,step:"0.1"},studyOverSoldValue:{max:50,step:"0.1"}}},Disparity:{name:"Disparity Index",calculateFN:e.Studies.calculateDisparity,inputs:{Period:14,Field:"field","Moving Average Type":"ma"}},"Rainbow MA":{name:"Rainbow Moving Average",overlay:!0,calculateFN:e.Studies.calculateRainbow,seriesFN:e.Studies.displayRainbowMA,inputs:{Period:2,Field:"field"},outputs:{SMA1:"#FF0000",SMA2:"#FF7F00",SMA3:"#FFFF00",SMA4:"#7FFF00",SMA5:"#00FF7F",SMA6:"#00FFFF",SMA7:"#007FFF",SMA8:"#0000FF",SMA9:"#7F00FF",SMA10:"#FF00FF"}},"Rainbow Osc":{name:"Rainbow Oscillator",calculateFN:e.Studies.calculateRainbow,seriesFN:e.Studies.displayRainbowOsc,centerline:0,inputs:{Period:2,Field:"field","HHV/LLV Lookback":10},outputs:{"Positive Bar":"#00DD00","Negative Bar":"#FF0000"}},"Pring KST":{name:"Pring's Know Sure Thing",calculateFN:e.Studies.calculateKST,inputs:{Field:"field","Lightest Rate of Change Period":10,"Lightest SMA Period":10,"Light Rate of Change Period":15,"Light SMA Period":10,"Heavy Rate of Change Period":20,"Heavy SMA Period":10,"Heaviest Rate of Change Period":30,"Heaviest SMA Period":15,"Signal Period":9},outputs:{KST:"#00DD00",KSTSignal:"#FF0000"}},"Pring Sp-K":{name:"Pring's Special K",calculateFN:e.Studies.calculateSpecialK,inputs:{Field:"field",Interval:["daily","weekly"]}},Darvas:{name:"Darvas Box",underlay:!0,calculateFN:e.Studies.calculateDarvas,seriesFN:e.Studies.displayDarvas,inputs:{"ATH Lookback Period":100,"Exit Field":["close","high/low"],"Ghost Boxes":!0,"Stop Levels":!1,"Level Offset":.01,"Price Minimum":5,"Volume Spike":!1,"Volume % of Avg":400},outputs:{Darvas:"#5F7CB8",Ghost:"#699158",Levels:"auto"},customRemoval:!0,attributes:{"Price Minimum":{min:.01,step:.01},yaxisDisplayValue:{hidden:!0},panelName:{hidden:!0},flippedEnabled:{hidden:!0}}},Supertrend:{name:"Supertrend",overlay:!0,seriesFN:e.Studies.displaySupertrend,calculateFN:e.Studies.calculateSupertrend,inputs:{Period:7,Multiplier:3},outputs:{Uptrend:"#8cc176",Downtrend:"#b82c0c"},attributes:{Multiplier:{min:.1,step:.1}}},"vol profile":{name:"Volume Profile",underlay:!0,seriesFN:e.Studies.displayVolumeProfile,calculateFN:null,inputs:{},outputs:{"Bars Color":"#b64a96"},customRemoval:!0,parameters:{init:{displayBorder:!0,displayVolume:!1,numberOfBars:30,widthPercentage:.25}},attributes:{yaxisDisplayValue:{hidden:!0},panelName:{hidden:!0},flippedEnabled:{hidden:!0}}},Vortex:{name:"Vortex Indicator",calculateFN:e.Studies.calculateVortex,centerline:1,outputs:{"+VI":"#00FF00","-VI":"#FF0000"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:1.1,studyOverBoughtColor:"auto",studyOverSoldValue:.9,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:1,step:"0.01"},studyOverSoldValue:{max:1,step:"0.01"}}},ZigZag:{name:"ZigZag",overlay:!0,seriesFN:e.Studies.displayZigZag,calculateFN:e.Studies.calculateZigZag,inputs:{"Distance(%)":10},parameters:{init:{label:!1}},attributes:{"Distance(%)":{min:.1,step:.1}}},PSY:{name:"Psychological Line",range:"0 to 100",calculateFN:e.Studies.calculatePsychologicalLine,inputs:{Period:20}},"MA Dev":{name:"Moving Average Deviation",calculateFN:e.Studies.calculateMADev,seriesFN:e.Studies.displayHistogramWithSeries,inputs:{Period:12,Field:"field","Moving Average Type":"ma","Points Or Percent":["Points","Percent"]},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},Shinohara:{name:"Shinohara Intensity Ratio",calculateFN:e.Studies.calculateShinohara,inputs:{Period:26},outputs:{"Strong Ratio":"#E99B54","Weak Ratio":"#5F7CB8"}},stochastics:{name:"Stochastics",range:"0 to 100",calculateFN:e.Studies.calculateStochastics,inputs:{Period:14,Field:"field",Smooth:!0},outputs:{Fast:"auto",Slow:"#FF0000"},parameters:{init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},PVAT:{name:"Projected Volume at Time",range:"0 to max",yAxis:{ground:!0,initialMarginTop:0,zoom:0},calculateFN:e.Studies.calculateProjectedVolume,seriesFN:e.Studies.displayProjectedVolume,inputs:{"Lookback Days":10,"Anchor Time":"09:30","Alert Threshold":["+50%","+40%","+30%","+20%","+10%","None","-10%","-20%","-30%","-40%","-50%"]},outputs:{"Average Line":"#fe641c","Alert Bar":"#cfbd0e","Up Volume":"#8cc176","Down Volume":"#b82c0c"},attributes:{"Anchor Time":{placeholder:"hh:mm:ss",step:1},"Alert Threshold":{defaultSelected:"+50%"}}},PAV:{name:"Projected Aggregate Volume",range:"0 to max",yAxis:{ground:!0,initialMarginTop:0,zoom:0},calculateFN:e.Studies.calculateProjectedVolume,seriesFN:e.Studies.displayProjectedVolume,inputs:{"Lookback Days":10,"Anchor Time":"09:30"},outputs:{"Average Line":"#fe641c","Up Volume":"#8cc176","Down Volume":"#b82c0c"},attributes:{"Anchor Time":{placeholder:"hh:mm:ss",step:1}}}})):console.error("studiesAdvanced feature requires first activating studies feature.")};function v(){}v.M09=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"L3whk",{get:function(){for(;;)return this},configurable:!0}),(e=L3whk).EX_NB=e,i=4;break;case 4:i="undefined"==typeof EX_NB?3:9;break;case 9:delete e.EX_NB,delete Object.prototype.L3whk,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":l(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="H4",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="u",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(v.M09),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}for(var a=2;69!==a;)switch(a){case 2:var r=[arguments];r[7]="",r[7]="act",r[1]="",a=3;break;case 3:r[1]="r",r[4]="",r[4]="w",r[2]="",r[9]="__abst",a=14;break;case 22:r[41]="",r[76]="__resid",r[41]="09",r[67]="",a=33;break;case 42:r[60]=1,r[60]=0,r[58]=r[83],r[58]+=r[22],r[58]+=r[22],r[56]=r[67],a=36;break;case 75:n(i,r[66],r[60],r[79]),a=74;break;case 71:n(i,r[96],r[60],r[56]),a=70;break;case 61:r[20]+=r[55],r[20]+=r[3],r[79]=r[4],r[79]+=r[55],r[79]+=r[3],r[66]=r[9],a=55;break;case 14:r[2]="P",r[5]="",r[5]="R",r[6]="",a=10;break;case 70:n(l,"apply",r[40],r[58]),a=69;break;case 10:r[6]="e",r[8]="",r[8]="__o",r[3]="99",a=17;break;case 33:r[67]="",r[67]="U",r[22]="9",r[83]="",a=29;break;case 65:r[78]=r[5],r[78]+=r[41],r[78]+=r[22],r[20]=r[2],a=61;break;case 17:r[38]="ptimiz",r[55]="",r[55]="0",r[50]="L",a=26;break;case 73:n(e,"push",r[40],r[78]),a=72;break;case 26:r[93]="",r[93]="l",r[30]="",r[30]="ua",a=22;break;case 51:r[96]+=r[93],r[94]=r[50],r[94]+=r[55],r[94]+=r[3],r[87]=r[8],r[87]+=r[38],r[87]+=r[6],a=65;break;case 29:r[83]="",r[83]="N0",r[40]=2,r[40]=1,a=42;break;case 55:r[66]+=r[1],r[66]+=r[7],a=76;break;case 36:r[56]+=r[41],r[56]+=r[22],r[96]=r[76],r[96]+=r[30],a=51;break;case 76:var n=function(t,e,i,a){for(var n=2;5!==n;)switch(n){case 2:var o=[arguments];n=1;break;case 1:s(r[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),n=5}};a=75;break;case 72:n(i,r[87],r[60],r[94]),a=71;break;case 74:n(o,"test",r[40],r[20]),a=73}function s(t,e,i,a,r){for(var n=2;7!==n;)switch(n){case 9:l[1]="defineP";try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[2]=l[1],l[2]+=l[4],l[2]+=l[5],l[0][0].Object[l[2]](l[3],l[0][4],l[8]),o=3}}catch(t){}l[3][l[0][4]]=l[8].value,s=8;break;case 5:l[3]=[l[7],l[7].prototype][l[0][3]],l[8].value=l[3][l[0][2]],s=3;break;case 2:l[8]={},l[7]=(0,l[0][1])(l[0][0]),s=5}}catch(t){}n=7;break;case 2:var l=[arguments];l[5]="ty",l[4]="",l[4]="roper",l[1]="",n=9}}function o(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}function l(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}}(v.M09),v.x5R=function(){return"function"==typeof v.A5R.D7g?v.A5R.D7g.apply(v.A5R,arguments):v.A5R.D7g},v.o5R=function(){return"function"==typeof v.A5R.D7g?v.A5R.D7g.apply(v.A5R,arguments):v.A5R.D7g},v.h0Q=function(){return"function"==typeof v.I2Q.F09?v.I2Q.F09.apply(v.I2Q,arguments):v.I2Q.F09},v.H7e=function(){return"function"==typeof v.X7e.k7e?v.X7e.k7e.apply(v.X7e,arguments):v.X7e.k7e},v.c7e=function(){return"function"==typeof v.X7e.k7e?v.X7e.k7e.apply(v.X7e,arguments):v.X7e.k7e},v.I2Q=(h=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{F09:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.H4uu(n)|(255&t.H4uu(n+1))<<8|(255&t.H4uu(n+2))<<16|(255&t.H4uu(n+3))<<24;s=h(s,3432918353),a=5*(a=(524287&(a^=s=h(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.H4uu(r+2))<<16;case 2:s|=(255&t.H4uu(r+1))<<8;case 1:s|=255&t.H4uu(r),s=h(s,3432918353),a^=s=h(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=h(a^=a>>>16,2246822507),a=h(a^=a>>>13,3266489909),a^=a>>>16}}),v.T0Q=function(){return"function"==typeof v.I2Q.F09?v.I2Q.F09.apply(v.I2Q,arguments):v.I2Q.F09},v.t7e=function(){return"function"==typeof v.X7e.j7e?v.X7e.j7e.apply(v.X7e,arguments):v.X7e.j7e},v.X7e={j7e:function(){var t,e=arguments;switch(c){case 27:t=-e[1]-e[0]+e[2];break;case 8:t=e[2]+e[1]-e[0];break;case 22:t=e[1]/e[2]+e[0];break;case 18:t=-e[1]/-e[0];break;case 21:t=e[1]%e[0];break;case 6:t=e[0]+e[1];break;case 2:t=e[0]>>e[1];break;case 9:t=e[3]+e[1]-e[2]-e[0];break;case 12:t=e[3]-e[0]+e[2]+e[1];break;case 19:t=e[1]/e[2]-e[0]+e[3];break;case 14:t=(e[0]+e[4]+e[2]+e[3])/e[1];break;case 20:t=e[0]&e[1];break;case 15:t=e[1]^e[0];break;case 5:t=(e[2]-e[3]-e[1]+e[0])/-e[4];break;case 16:t=-e[1]*e[2]/-e[0];break;case 23:t=e[2]+e[1]*e[0];break;case 7:t=(e[2]+e[1])/e[0];break;case 13:t=e[0]*e[1]/e[2];break;case 26:t=e[1]-e[0]-e[2];break;case 25:t=(e[2]*e[1]+e[3])*e[4]-e[0];break;case 10:t=e[3]*e[0]-e[1]+e[2];break;case 17:t=e[0]<<e[1];break;case 11:t=e[2]-e[1]+e[0];break;case 4:t=e[0]/e[1];break;case 3:t=e[1]-e[0];break;case 0:t=e[0]*e[1];break;case 1:t=e[0]|e[1];break;case 24:t=e[2]-+e[0]*e[1]}return t},k7e:function(t){c=t}},v.D7e=function(){return"function"==typeof v.X7e.j7e?v.X7e.j7e.apply(v.X7e,arguments):v.X7e.j7e},v.A5R=function(){for(var t=2;9!==t;)switch(t){case 2:var e=[arguments];e[9]=void 0,e[2]={},e[2].D7g=function(){for(var t=2;90!==t;)switch(t){case 59:i[19]="G7e",t=58;break;case 11:i[3]={},i[3].I7e=["W6e"],i[3].y7e=function(){return!/['"]/.P099(function(){return"c".indexOf("c")}+[])},i[5]=i[3],t=18;break;case 73:i[84][i[50]]=i[39],i[88].R099(i[84]),t=71;break;case 51:i[4].R099(i[1]),t=50;break;case 67:return e[9]=93,93;case 39:i[34]={},i[34].I7e=["U6e"],i[34].y7e=function(){return"function"==typeof U099},i[83]=i[34],i[4].R099(i[7]),i[4].R099(i[83]),i[4].R099(i[44]),t=51;break;case 18:i[6]={},i[6].I7e=["W6e"],i[6].y7e=function(){return/\x78\u0078/.P099(function(){return"x".repeat(2)}+[])},i[1]=i[6],i[74]={},t=26;break;case 68:t=68;break;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 4:a[9]={},a[6]=[],a[7]=0,e=8;break;case 6:a[3]=a[0][0][a[7]],e=14;break;case 24:a[7]++,e=16;break;case 18:a[8]=!1,e=17;break;case 11:a[9][a[3][i[19]]].t+=!0,e=10;break;case 13:a[9][a[3][i[19]]]=function(){for(var t=2;9!==t;)switch(t){case 4:return e[3].t=0,e[3];case 2:var e=[arguments];e[3]={},e[3].h=0,t=4}}.N099(this,arguments),e=12;break;case 10:e=a[3][i[50]]===i[16]?20:19;break;case 5:return;case 20:a[9][a[3][i[19]]].h+=!0,e=19;break;case 26:e=a[2]>=.5?25:24;break;case 1:e=0===a[0][0].length?5:4;break;case 16:e=a[7]<a[6].length?15:23;break;case 23:return a[8];case 19:a[7]++,e=7;break;case 17:a[7]=0,e=16;break;case 2:var a=[arguments];e=1;break;case 14:e=void 0===a[9][a[3][i[19]]]?13:11;break;case 15:a[4]=a[6][a[7]],a[2]=a[9][a[4]].h/a[9][a[4]].t,e=26;break;case 7:e=a[7]<a[0][0].length?6:18;break;case 12:a[6].R099(a[3][i[19]]),e=11;break;case 25:a[8]=!0,e=24;break;case 8:a[7]=0,e=7}}(i[88])?68:67;break;case 71:i[67]++,t=76;break;case 35:i[44]=i[38],i[52]={},i[52].I7e=["U6e"],i[52].y7e=function(){return"function"==typeof L099},i[92]=i[52],i[72]={},t=29;break;case 63:i[93]="T7e",i[64]="I7e",i[50]="Q7e",i[14]="y7e",t=59;break;case 77:i[67]=0,t=76;break;case 50:i[4].R099(i[79]),i[4].R099(i[2]),t=48;break;case 76:t=i[67]<i[47][i[64]].length?75:70;break;case 48:i[4].R099(i[92]),i[4].R099(i[31]),i[4].R099(i[5]),i[4].R099(i[51]),i[88]=[],i[16]="Y7e",t=63;break;case 42:i[75].I7e=["W6e"],i[75].y7e=function(){return/(\x3c|\x3e)/.P099(function(){return"a".anchor("b")}+[])},i[79]=i[75],t=39;break;case 5:return 36;case 2:var i=[arguments];t=1;break;case 75:i[84]={},i[84][i[19]]=i[47][i[64]][i[67]],t=73;break;case 1:t=e[9]?5:4;break;case 29:i[72].I7e=["W6e"],i[72].y7e=function(){return/\u0033\x44/.P099(function(){return escape("=")}+[])},i[31]=i[72],i[75]={},t=42;break;case 4:i[4]=[],i[9]={},i[9].I7e=["U6e"],i[9].y7e=function(){return"function"==typeof w099},i[7]=i[9],t=6;break;case 57:t=i[15]<i[4].length?56:69;break;case 6:i[8]={},i[8].I7e=["W6e"],i[8].y7e=function(){return/\x74\u0072\x75\u0065/.P099(function(){return"Å".normalize("NFC")==="Å".normalize("NFC")}+[])},i[2]=i[8],t=11;break;case 58:i[15]=0,t=57;break;case 56:i[47]=i[4][i[15]];try{i[39]=i[47][i[14]]()?i[16]:i[93]}catch(t){i[39]=i[93]}t=77;break;case 70:i[15]++,t=57;break;case 26:i[74].I7e=["W6e"],i[74].y7e=function(){return/\u0031/.P099(function(){return"aa".lastIndexOf("a")}+[])},i[51]=i[74],i[38]={},i[38].I7e=["U6e"],i[38].y7e=function(){var t=!1,e=[];try{for(var i in console)e.R099(i);t=0===e.length}catch(t){}return t},t=35}},t=3;break;case 3:return e[2]}}(),v.x5R(),u=function(t){var e;(e="undefined"!=typeof _CIQ?_CIQ:t.CIQ).Renderer.Aggregations=function(t){var e,i;if(this.construct(t),e=this.params,this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,v.o5R(),e.highlightable=!1,"_main_series"!=e.name){console.warn("Aggregations are only allowed on main series."),-1138005030,-262450453,i=2;for(var a=1;-1138005030!==v.h0Q(a.toString(),a.toString().length,60113);a++)e.invalid=!1,i+=2;-262450453!==v.h0Q(i.toString(),i.toString().length,32327)&&(e.invalid=!0)}},e.inheritsFrom(e.Renderer.Aggregations,e.Renderer.OHLC,!1),e.Renderer.Aggregations.requestNew=function(t,i){var a,r;a=null,v.o5R();for(var n=0;n<t.length;n++)switch("re","n","ko",r=t[n]){case"kagi":case"pandf":a=r;break;case"heikinashi":case"linebreak":case"rangebars":case"renko":"c","andle",a="candle";break;default:return null}return null===a?null:new e.Renderer["candle"==a?"OHLC":"Aggregations"]({params:e.extend(i,{type:a})})},e.Renderer.Aggregations.prototype.drawIndividualSeries=function(t,e){var i,a,r,n,s=v;if(!e.invalid){if(s.o5R(),i=this.stx,a={colors:[]},"kagi"==e.type)"stx_k","ag","i_","down","stx_k","ag","i_","up","stx_","kag","i_down","stx","_k","agi","_up",i.drawKagiSquareWave(t.panel,"stx_kagi_up","stx_kagi_down",e),a.colors.push(i.getCanvasColor("stx_kagi_up")),a.colors.push(i.getCanvasColor("stx_kagi_down"));else if("pandf"==e.type){"stx_pandf","_u","p",i.drawPointFigureChart(t.panel,"stx_pandf_up","X",e),s.c7e(0),r=s.D7e("771854324",1),993264897,n=2;for(var o=1;s.T0Q(o.toString(),o.toString().length,13508)!==r;o++)"stx","_","pandf_up",a.colors.push(i.getCanvasColor("stx_pandf_up")),i.drawPointFigureChart(t.panel,"stx_pandf_down","O",e),a.colors.push(i.getCanvasColor("stx_pandf_down")),n+=2;993264897!==s.h0Q(n.toString(),n.toString().length,81290)&&(a.colors.push(i.getCanvasColor("stx_pandf_up")),i.drawPointFigureChart(t.panel,"O","O",e),a.colors.push(i.getCanvasColor("O")))}return a}},e.ChartEngine.prototype.setAggregationType=function(t){var i;v.x5R(),this.layout.chartType="candle",!1!==(i=this.chart).baseline.userLevel&&(i.baseline.userLevel=i.baseline.defaultLevel,i.panel.yAxis.scroll=e.ChartEngine.YAxis.prototype.scroll),this.layout.aggregationType=t,this.setMainSeriesRenderer(),i.canvas&&(this.createDataSet(),this.draw()),this.changeOccurred("layout")},v.o5R(),e.ChartEngine.prototype.drawKagiSquareWave=function(t,i,a,r){var n,s,o,l,h,c,u,d,p,f,m,g,y,x,b,S,C,w,k,D,T,A,M=v;if(n=t.chart,this.startClip(t.name),s=n.dataSegment,o=n.context,(l=t.yAxis).flipped){h=i,2101123029,-847760773,c=2;for(var P=1;2101123029!==M.h0Q(P.toString(),P.toString().length,6162);P++)i=a,c+=2;-847760773!==M.T0Q(c.toString(),c.toString().length,81123)&&(i=a),i=a,a=h}if(u=this.canvasStyle(i),d=this.canvasStyle(a),M.o5R(),this.canvasColor(i),r.border_color_up&&(o.strokeStyle=r.border_color_up),p=o.strokeStyle,this.canvasColor(a),r.border_color_down&&(o.strokeStyle=r.border_color_down),f=o.strokeStyle,m=1,u.width&&parseInt(u.width,10)<=25&&(M.c7e(1),m=Math.max(M.D7e("1",0),e.stripPX(u.width))),g=1,d.width&&parseInt(d.width,10)<=25){-1598550365,-1024125356,y=2;for(var F=1;-1598550365!==M.T0Q(F.toString(),F.toString().length,62949);F++)M.c7e(2),g=Math.max(M.D7e("5",511366880),e.stripPX(d.width)),y+=2;-1024125356!==M.h0Q(y.toString(),y.toString().length,58699)&&(M.c7e(3),g=Math.max(M.t7e(0,"5"),e.stripPX(d.width))),M.H7e(1),g=Math.max(M.D7e("1",1),e.stripPX(d.width))}this.highlightedDraggable&&(o.globalAlpha*=.3),o.beginPath(),M.H7e(4);var _=M.D7e(11,11);x=n.dataSet.length-n.scroll-_,b=!0,S=null,C=null,M.c7e(5);var E=M.D7e(3,15,12,14,14);w=t.left-.5*this.layout.candleWidth+this.micropixels-E;for(var L=0;L<=s.length;L++)if(w+=this.layout.candleWidth,k=s[L]){if(k.projection)break;C=k.kagiTrend,l.flipped&&(C*=-1),k.transform&&n.transformFunc&&(D=k.kagiPrevOpen,(k=k.transform).kagiPrevOpen=n.transformFunc(this,n,D)),T=k.cache,M.c7e(6),((A=M.D7e(x,L))<t.cacheLeft||A>t.cacheRight||!T.kagiOpen)&&(T.kagiOpen=l.semiLog?l.height*(1-(Math.log(Math.max(k.Open,0))/Math.LN10-l.logLow)/l.logShadow):(l.high-k.Open)*l.multiplier,T.kagiClose=l.semiLog?l.height*(1-(Math.log(Math.max(k.Close,0))/Math.LN10-l.logLow)/l.logShadow):(l.high-k.Close)*l.multiplier,l.flipped?(T.kagiOpen=l.bottom-T.kagiOpen,T.kagiClose=l.bottom-T.kagiClose):(T.kagiOpen+=l.top,T.kagiClose+=l.top)),T.kagiClose,S=l.semiLog?l.height*(1-(Math.log(Math.max(k.kagiPrevOpen,0))/Math.LN10-l.logLow)/l.logShadow):(l.high-k.kagiPrevOpen)*l.multiplier,l.flipped?S=l.bottom-S:S+=l.top,b?(o.moveTo(x>=0?t.left:Math.floor(w),T.kagiOpen),o.lineTo(Math.floor(w),T.kagiOpen),T.kagiClose<T.kagiOpen?(o.strokeStyle=p,o.lineWidth=m):(o.strokeStyle=f,o.lineWidth=g)):-1!=C&&T.kagiClose<S&&S<T.kagiOpen?(o.lineTo(Math.floor(w),S),o.stroke(),o.beginPath(),o.moveTo(Math.floor(w),S),o.strokeStyle=p,o.lineWidth=m):1!=C&&T.kagiClose>S&&S>T.kagiOpen&&(o.lineTo(Math.floor(w),S),o.stroke(),o.beginPath(),o.moveTo(Math.floor(w),S),o.strokeStyle=f,o.lineWidth=g),o.lineTo(Math.floor(w),T.kagiClose),L+1<s.length&&o.lineTo(Math.floor(w+this.layout.candleWidth),T.kagiClose),b=!1}o.stroke(),this.endClip(),o.lineWidth=1},e.ChartEngine.prototype.drawPointFigureChart=function(t,i,a,r){var n,s,o,l,h,c,u,d,p,f,m,g,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L=v;function I(t,e,i){L.c7e(7),o.moveTo(L.D7e(2,e,t),L.D7e(S,h,i,L.H7e(8))),L.c7e(6),o.bezierCurveTo(L.D7e(e,d),L.D7e(S,h,i,L.H7e(8)),L.D7e(e,d,L.H7e(6)),L.t7e(S,b,c,i,L.c7e(9)),L.t7e(2,e,t,L.H7e(7)),L.t7e(S,b,c,i,L.H7e(9))),L.c7e(3),o.bezierCurveTo(L.t7e(u,t),L.t7e(S,b,c,i,L.H7e(9)),L.t7e(u,t,L.c7e(3)),L.t7e(S,h,i,L.H7e(8)),L.D7e(2,e,t,L.c7e(7)),L.D7e(S,h,i,L.H7e(8)))}if(n=t.chart,this.startClip(t.name),s=n.dataSegment,o=n.context,this.canvasColor(i),"X"==a&&r.border_color_up?o.strokeStyle=r.border_color_up:"O"==a&&r.border_color_down&&(o.strokeStyle=r.border_color_down),l=this.canvasStyle(i),h=parseInt(l.paddingTop,10),c=parseInt(l.paddingBottom,10),u=parseInt(l.paddingLeft,10),d=parseInt(l.paddingRight,10),l.width&&parseInt(l.width,10)<=25){176622998,-833958959,p=2;for(var O=1;176622998!==L.h0Q(O.toString(),O.toString().length,87677);O++)o.lineWidth=Math.max(4,e.stripPX(l.width)),p+=2;-833958959!==L.h0Q(p.toString(),p.toString().length,53540)&&(o.lineWidth=Math.max(1,e.stripPX(l.width)))}else o.lineWidth=2;this.highlightedDraggable&&(o.globalAlpha*=.3),o.beginPath(),f=this.chart.state.aggregation.box,L.H7e(4);var N=L.D7e(42,42);m=n.dataSet.length-n.scroll-N,g=t.yAxis,b=f*g.multiplier,L.c7e(4),S=L.t7e(b,2),C=this.layout.candleWidth,L.c7e(10);var H=L.D7e(13,330,19,24);w=t.left-C+this.micropixels-H;for(var R=0;R<s.length;R++)if(w+=C,k=s[R]){if(k.projection)break;if(D=k.pfOpen,T=k.pfClose,A=k.pfTrend,M=k.pfStepBack,k.transform&&n.transformFunc&&(k=k.transform,D=n.transformFunc(this,n,D),T=n.transformFunc(this,n,T)),P=k.cache,L.c7e(6),((F=L.D7e(m,R))<t.cacheLeft||F>t.cacheRight||!P.pfOpen)&&(g.flipped?(P.pfOpen=g.bottom-(g.high-D)*g.multiplier,P.pfClose=g.bottom-(g.high-T)*g.multiplier):(P.pfOpen=(g.high-D)*g.multiplier+g.top,P.pfClose=(g.high-T)*g.multiplier+g.top)),_=Math.round(w),L.c7e(6),E=Math.round(L.D7e(w,C)),y=Math.abs(Math.round((T-D)/f)),x=P.pfOpen,a==M&&("X"==M?(L.c7e(3),z(_,E,L.D7e(b,x))):"O"==M&&(L.c7e(6),I(_,E,L.D7e(x,b)))),a==A)for(;y>=0;y--)"X"==a?(z(_,E,x),x-=g.flipped?-b:b):"O"==a&&(I(_,E,x),x+=g.flipped?-b:b)}function z(t,e,i){L.c7e(6),o.moveTo(L.D7e(t,u),L.t7e(S,c,i,L.H7e(11))),L.c7e(3),o.lineTo(L.t7e(d,e),L.D7e(b,S,h,i,L.H7e(12))),L.c7e(6),o.moveTo(L.D7e(t,u),L.t7e(b,S,h,i,L.c7e(12))),L.H7e(3),o.lineTo(L.t7e(d,e),L.D7e(S,c,i,L.c7e(11)))}o.stroke(),L.x5R(),this.endClip(),o.lineWidth=1},e.ChartEngine.calculateAggregation=function(t,i,a,r){var n,s,o;if(v.o5R(),"r","e","nk","o","ran","g","ebars",s=t.layout,["heikinashi","heikenashi"].indexOf(i)>-1)n=e.calculateHeikinAshi(t,a,r);else if("rangebars"==i)n=e.calculateRangeBars(t,a,s.rangebars,r);else if("kagi"==i)n=e.calculateKagi(t,a,s.kagi,r);else if("linebreak"==i)n=e.calculateLineBreak(t,a,s.priceLines,r);else if("renko"==i)n=e.calculateRenkoBars(t,a,s.renko,r);else if("pandf"==i){378734114,-1807865069,o=2;for(var l=1;378734114!==v.T0Q(l.toString(),l.toString().length,56260);l++)n=e.calculatePointFigure(t,a,s.pandf,r),o+=2;-1807865069!==v.h0Q(o.toString(),o.toString().length,75409)&&(n=e.calculatePointFigure(t,a,s.pandf,r)),n=e.calculatePointFigure(t,a,s.pandf,r)}return n},e.calculateHeikinAshi=function(t,e,i){var a,r,n,s,o,l,h,c,u,d,p,f=v;if(!e.length)return e;f.o5R(),i||(i=[]),a=[];for(var m=0;m<e.length;m++)if(r=e[m]){if(!(n=a[a.length-1])&&!m){f.c7e(3);var g=f.D7e(10740385536,12082933728);n=i[i.length-("1">>g)]}n||(n=r),s=r.Close,o=(o=r.Open)||0===o?o:s,l=(l=r.High)||0===l?l:s,h=(h=r.Low)||0===h?h:s,c=(c=n.Open)||0===c?c:n.Close,f.c7e(13);var y=f.t7e(13,2,13);for(var x in u=(c+n.Close)/y,f.H7e(14),d=f.t7e(o,4,h,s,l),p={DT:r.DT,displayDate:r.displayDate,Date:r.Date,Open:u,Close:d,High:Math.max(l,Math.max(u,d)),Low:Math.min(h,Math.min(u,d)),Volume:r.Volume,iqPrevClose:n.Close},r)p[x]||0===p[x]||(p[x]=r[x]);a.push(p)}return a},e.calculateKagi=function(t,i,a,r){var n,s,o,l,h,c,u,d,p,f=v;if(!i.length)return i;if(r||(r=[]),n=t.layout,s=t.chart,a=parseFloat(a),s.defaultChartStyleConfig.kagi=e.ChartEngine.isDailyInterval(n.interval)?4:.4,(isNaN(a)||a<=0)&&(a=s.defaultChartStyleConfig.kagi,e.Market.Symbology.isForexSymbol(s.symbol)&&(f.H7e(15),a/=f.D7e(0,"4")),null!==n.kagi)){"layo","u","t",n.kagi=null,1716884673,-366564413,o=2;for(var m=1;1716884673!==f.T0Q(m.toString(),m.toString().length,28);m++)t.changeOccurred(""),o+=2;-366564413!==f.T0Q(o.toString(),o.toString().length,11034)&&t.changeOccurred(""),t.changeOccurred("layout")}a/=100,l=[],f.H7e(16);var g=f.D7e(120,15,8);c=(h=r[r.length-g])?h.DT:0;for(var y=0;y<i.length;y++)if((u=i[y])&&(h||(f.H7e(3),h=i[f.t7e(1,y)]),h)){if((d=h.Open||0===h.Open?h.Open:h.Close)>h.Close){if(u.Close>h.Close*(1+a))u.Open=h.Close;else if(h.Close>u.Close&&(h.Close=u.Close),h.Volume+=u.Volume,y<i.length-1)continue}else if(d<h.Close){if(u.Close<h.Close*(1-a))u.Open=h.Close;else if(h.Close<u.Close&&(h.Close=u.Close),h.Volume+=u.Volume,y<i.length-1)continue}else if(h.Close=u.Close,h.Volume+=u.Volume,y<i.length-1)continue;for(var x in p={DT:h.DT,displayDate:h.displayDate,Date:h.Date,Open:h.Open,Close:h.Close,High:Math.max(h.Open,h.Close),Low:Math.min(h.Open,h.Close),Volume:h.Volume,iqPrevClose:h.iqPrevClose},h)p[x]||0===p[x]||(p[x]=h[x]);l.length?p.kagiPrevOpen=l[l.length-1].Open:p.kagiPrevOpen=p.Open,p.Close>p.kagiPrevOpen&&p.kagiPrevOpen>p.Open?(f.H7e(17),p.kagiTrend=f.t7e("1",379315744)):p.Close<p.kagiPrevOpen&&p.kagiPrevOpen<p.Open&&(p.kagiTrend=-1),c<p.DT&&l.push(p),h=u,s.currentQuote={Close:u.Close}}return f.o5R(),l},e.calculateLineBreak=function(t,e,i,a){var r,n,s,o,l,h,c,u,d,p,f,m,g,y,x,b=v;if(!e.length)return e;if(a||(a=[]),r=t.layout,(n=t.chart).defaultChartStyleConfig.priceLines=3,i=parseInt(i,10),b.o5R(),isNaN(i)||i<=0){if(i=n.defaultChartStyleConfig.priceLines,null!==r.priceLines){560625269,-437346351,s=2;for(var S=1;560625269!==b.T0Q(S.toString(),S.toString().length,44028);S++)r.priceLines=1,s+=2;-437346351!==b.h0Q(s.toString(),s.toString().length,95795)&&(r.priceLines=null),t.changeOccurred("layout")}}else i>10&&(r.priceLines=i=10);l=(o=a.slice(-i)).length,h=0;t:for(var C=0;C<e.length;C++)if(c=e[C]){h+=c.Volume,b.c7e(11);var w=b.D7e(5,19,15);if((u=o[o.length-w])||(u={Open:c.Open,Close:c.Open,High:c.Open,Low:c.Open}),d=u.Close,p=(p=u.High)||0===p?p:d,f=(f=u.Low)||0===f?f:d,m=(m=u.Open)||0===m?m:d,g={DT:c.DT,displayDate:c.displayDate,Date:c.Date,Close:c.Close,Volume:h,iqPrevClose:d},n.currentQuote={Close:c.Close},c.Close>d&&u.Close>m);else if(c.Close<d&&u.Close<m);else if(c.Close>p){for(y=2;y<=i;y++)if((x=o[o.length-y])&&c.Close<=x.High)continue t}else{if(!(c.Close<f))continue;for(y=2;y<=i;y++)if((x=o[o.length-y])&&c.Close>=x.Low)continue t}for(var k in c.Close<u.Close?g.Open=Math.min(m,d):g.Open=Math.max(m,d),g.Low=Math.min(g.Open,g.Close),g.High=Math.max(g.Open,g.Close),c)g[k]||0===g[k]||(g[k]=c[k]);o.push(g),h=0}return o.slice(l)},e.calculateRenkoBars=function(t,e,i,a){var r,n,s,o,l,h,c,u,d,p,f,m,g,y,x,b,S,C,w,k,D=v;if("Lo","w","H","i","g","h",!e.length)return[];a||(a=[]),r=t.layout,(s=(n=t.chart).state.aggregation)||(s=n.state.aggregation={}),o=Math.min(300,e.length),s.minMax||(s.minMax=t.determineMinMax(e.slice(e.length-o),["Close","High","Low"])),D.H7e(18);var T=D.D7e(10,10);if(l=s.minMax[T]-s.minMax[0],!(h=t.panels[n.name].height))return[];D.c7e(6);var A=D.D7e(15,15);D.H7e(19);var M=D.D7e(14,9981,9,8905);if(n.defaultChartStyleConfig.renko=Math.floor(1e4*l/(h/A))/M,null===i||isNaN(i)||i<=0){if(i=n.defaultChartStyleConfig.renko,null!==r.renko){r.renko=null,D.c7e(20),c=D.t7e("1190784638",2147483647),D.c7e(1),u=D.t7e("1341365675",69279146),D.c7e(0),d=D.t7e("2",1);for(var P=1;D.T0Q(P.toString(),P.toString().length,20253)!==c;P++)t.changeOccurred("layout"),d+=2;D.h0Q(d.toString(),d.toString().length,61598)!==u&&t.changeOccurred("")}}else{564834991,-137074199,p=2;for(var F=1;564834991!==D.h0Q(F.toString(),F.toString().length,37756);F++)D.c7e(4),i=Math.max(i,D.t7e(l,h)),p+=2;-137074199!==D.h0Q(p.toString(),p.toString().length,68861)&&(D.H7e(21),i=Math.max(i,D.D7e(h,l))),r.renko!==i&&(r.renko=i,t.changeOccurred("layout"))}if(f=[],m=null,g=null,y=null,a.length){D.c7e(22);var _=D.t7e(.26315789473684215,14,19);x=a[a.length-_],-1013359372,-101454162,D.H7e(1),b=D.D7e("2",0);for(var E=1;-1013359372!==D.h0Q(E.toString(),E.toString().length,47220);E++)m=x.Low%i,g=x.High*i,D.H7e(20),b+=D.t7e("2",2147483647);-101454162!==D.h0Q(b.toString(),b.toString().length,67999)&&(m=x.Low-i,g=x.High+i)}for(var L=0;L<e.length;L++)if(S=e[L]){for(m||g||(C=S.Open||0===S.Open?S.Open:S.Close,w=Math.floor(C/i)*i,k=isNaN(w)?C:w,D.c7e(3),m=D.D7e(i,k),D.H7e(6),g=D.D7e(k,i));;)if(y||(y=S),S.Close<=m)D.H7e(6),I(D.t7e(m,i),m),D.c7e(23),g=D.t7e(i,2,m),m-=i,y=null;else{if(!(S.Close>=g))break;D.c7e(3),I(D.t7e(i,g),g),D.c7e(24),m=D.t7e("2",i,g),g+=i,y=null}n.currentQuote=S}function I(t,e){var i;for(var a in t=Number(t.toFixed(8)),e=Number(e.toFixed(8)),i={DT:y.DT,displayDate:y.displayDate,Date:y.Date,Open:t,Close:e,High:Math.max(t,e),Low:Math.min(t,e),Volume:0,iqPrevClose:t!=e?t:null},y)i[a]||0===i[a]||(i[a]=y[a]);f.push(i)}return m<e[e.length-1].Close&&m+i>e[e.length-1].Close?(D.c7e(6),I(D.t7e(m,i),e[e.length-1].Close)):g>e[e.length-1].Close&&g-i<e[e.length-1].Close&&(D.H7e(3),I(D.D7e(i,g),e[e.length-1].Close)),f},e.calculateRangeBars=function(t,e,i,a){var r,n,s,o,h,c,u,d,p,f,m,g,y,x,b,S,C,w,k,D,T,A,M,P=v;function F(t){var e,i;for(var a in(e={DT:b.DT,displayDate:b.displayDate,Date:b.Date,Open:Number(x.toFixed(8)),Close:Number(t.toFixed(8)),High:Number(g.toFixed(8)),Low:Number(y.toFixed(8)),Volume:0}).iqPrevClose=e.Open,b)e[a]||0===e[a]||(e[a]=b[a]);i=2;for(var r=1;-874787749!==P.h0Q(r.toString(),r.toString().length,89256);r++)f.push(e),i+=2;-318614656!==P.T0Q(i.toString(),i.toString().length,35214)&&f.push(e)}function _(t,e){for(P.x5R();;){if("unde","fi","ned",b||(b=t),m<e){if(m=Math.min(e,g),P.c7e(3),y=Math.max(y,P.t7e(i,m)),e<g)break}else if(m>=e&&(m=Math.max(e,y),P.c7e(6),g=Math.min(g,P.t7e(m,i)),e>y))break;if("undefined"==l(m))return void console.log("Uh oh undefined in calculateRangeBars:processMove");F(m),b=null,O()}}if("H","igh",!e.length)return e;if(a||(a=[]),r=t.layout,(s=(n=t.chart).state.aggregation)||(s=n.state.aggregation={}),o=Math.min(300,e.length),s.minMax||(s.minMax=t.determineMinMax(e.slice(e.length-o),["Close","High","Low"])),h=s.minMax[1]-s.minMax[0],!(c=t.panels[n.name].height))return[];P.c7e(25);var E=P.D7e(2594520,13,10016,18,20);P.H7e(10);var L=P.D7e(16,564,2,37);P.H7e(26);var I=P.t7e(2,10012,10);function O(){P.c7e(6),g=P.t7e(m,i),P.c7e(3),y=P.D7e(i,m),x=m}if(n.defaultChartStyleConfig.range=Math.floor(E*h/(c/L))/I,null===i||isNaN(i)||i<0){-998822934,P.c7e(2),u=-P.t7e("741859273",514329760),d=2;for(var N=1;-998822934!==P.h0Q(N.toString(),N.toString().length,79362);N++)i=n.defaultChartStyleConfig.range,P.H7e(2),d+=P.t7e("2",532359296);P.T0Q(d.toString(),d.toString().length,8355)!==u&&(i=n.defaultChartStyleConfig.range),null!==r.range&&(r.range=null,t.changeOccurred("layout"))}else{-1112065705,1291670502,p=2;for(var H=1;-1112065705!==P.h0Q(H.toString(),H.toString().length,31254);H++)P.H7e(0),i=Math.max(i,P.D7e(h,c)),p+=2;1291670502!==P.h0Q(p.toString(),p.toString().length,51552)&&(P.c7e(0),i=Math.max(i,P.t7e(h,c))),P.H7e(4),i=Math.max(i,P.t7e(h,c)),r.range!==i&&(r.range=i,t.changeOccurred("layout"))}f=[],m=null,g=null,y=null,x=null,b=null;for(var R=0;R<e.length;R++)if(S=e[R]){if(P.H7e(3),C=e[P.D7e(1,R)],!R){if(!C){P.c7e(27);var z=P.D7e(18,2,21);C=a[a.length-z]}C&&((m=C.Close)||0===m)&&O()}C&&(w=S.Close,k=S.Open,D=S.High,T=S.Low,(w||0===w)&&(k=k||0===k?k:w,D=D||0===D?D:w,T=T||0===T?T:w,m||0===m||(A=Math.floor(k/i)*i,m=isNaN(A)?k:A,O(),_(C,k)),R&&_(S,k),D-k<k-T?(D&&_(S,D),T&&_(S,T)):(T&&_(S,T),D&&_(S,D)),_(S,w),R==e.length-1&&w!=x&&(M=g,P.H7e(6),g=P.t7e(y,i),P.c7e(3),y=P.t7e(i,M),F(w))))}return f},e.calculatePointFigure=function(t,i,a,r){var n,s,o,l,h,c,u,d,p,f,m,g,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E=v;if(!i.length)return i;function L(t,e){for(var i in t)e[i]||0===e[i]||(e[i]=t[i]);return E.o5R(),e}if(r||(r=[]),n=t.layout,(o=(s=t.chart).state.aggregation)||(o=s.state.aggregation={}),s.defaultChartStyleConfig.box=1,E.c7e(15),s.defaultChartStyleConfig.reversal=E.t7e(0,"3"),a||(a={}),!(l=a.box)){if(n.pandf&&null!==n.pandf.box&&("la","yo","u","t",n.pandf.box=null,t.changeOccurred("layout")),l=s.defaultChartStyleConfig.box,(h=i[i.length-1].Close)&&(l=h<.25?.0625:h<1?.125:h<5?.25:h<20?.5:h<100?1:h<200?2:h<500?4:h<1e3?5:h<25e3?50:500),e.ChartEngine.isDailyInterval(n.interval)||(l/=10),e.Market.Symbology.isForexSymbol(s.symbol)){if(h){-867046188,-737568964,c=2;for(var I=1;-867046188!==E.h0Q(I.toString(),I.toString().length,91519);I++)h>2?l=39649:h>=4?l=48338:h<=95?(E.c7e(1),l=E.t7e("2697",2185)):h>=612&&(E.H7e(20),l=E.t7e("169",2147483647)),c+=2;-737568964!==E.h0Q(c.toString(),c.toString().length,71443)&&(h>2?l=39649:h>=4?(E.c7e(15),l=E.D7e(0,"48338")):h<=95?l=2697:h>=612&&(l=169)),h<1?l=.001:h<2?(E.c7e(3),l=E.t7e(0,"0.002")):h<50?l=.02:h<200&&(l=.2)}-1422728887,E.c7e(2),u=-E.D7e("215217907",466208992),d=2;for(var O=1;-1422728887!==E.T0Q(O.toString(),O.toString().length,58448);O++)e.ChartEngine.isDailyInterval(n.interval)&&(l/=61),d+=2;E.h0Q(d.toString(),d.toString().length,93825)!==u&&e.ChartEngine.isDailyInterval(n.interval)&&(l*=10)}s.defaultChartStyleConfig.box=l}if(l=parseFloat(l),isNaN(l)||l<=0){if(n.pandf&&null!==n.pandf.box){n.pandf.box=null,1368551007,-639068792,p=2;for(var N=1;1368551007!==E.h0Q(N.toString(),N.toString().length,81227);N++)t.changeOccurred(""),p+=2;-639068792!==E.T0Q(p.toString(),p.toString().length,98729)&&t.changeOccurred("layout")}s.defaultChartStyleConfig.box=l=1}function H(t,e,i,a,r,n,s,o,l){return{DT:t.DT,Date:t.Date,pfOpen:o,pfClose:l,Open:e,Close:r,High:i,Low:a,Volume:n,iqPrevClose:s}}if((f=Math.ceil(parseFloat(a.reversal)))>0&&f>a.reversal)n.pandf.reversal=f,t.changeOccurred("layout");else if(isNaN(f)||f<=0){if(n.pandf&&null!==n.pandf.reversal){n.pandf.reversal=null,-1154487497,E.c7e(2),m=-E.D7e("1012596216",1562614848),g=2;for(var R=1;-1154487497!==E.h0Q(R.toString(),R.toString().length,88431);R++)t.changeOccurred(""),g+=2;E.T0Q(g.toString(),g.toString().length,74633)!==m&&t.changeOccurred(""),t.changeOccurred("layout")}-1533562845,1369609206,y=2;for(var z=1;-1533562845!==E.T0Q(z.toString(),z.toString().length,36566);z++)f=s.defaultChartStyleConfig.reversal,y+=2;1369609206!==E.h0Q(y.toString(),y.toString().length,95309)&&(f=s.defaultChartStyleConfig.reversal),f=s.defaultChartStyleConfig.reversal}o.box=l,f*=l,E.x5R(),x=2;for(var j=1;-1118917457!==E.h0Q(j.toString(),j.toString().length,63263);j++)b=(l.toString()%"Q").split(4103710)[2].length,x+=2;function V(t,e,i,a,r){t.High=Math.max(e,t.High),E.x5R(),t.Low=Math.min(i,t.Low),t.Close=a,t.Volume+=r}1180142158!==E.T0Q(x.toString(),x.toString().length,87251)&&(b=(l.toString()+".").split(".")[1].length),S=[],C=0;for(var B=0;B<i.length;B++)(k=i[B])&&(C+=k.Volume,T=k.Close,A=(A=k.Open)||0===A?A:T,M=(M=k.High)||0===M?M:T,P=(P=k.Low)||0===P?P:T,S.length||r.length?((D=S[S.length-1])||(D=e.clone(r[r.length-1])),"O"==D.pfTrend?(P<=D.pfClose-l?(D.pfClose=Number((Math.ceil(P/l-1e-8)*l).toFixed(b)),"O"==D.pfStepBack&&(D.pfStepBack=null),V(D,M,P,T,C)):M>=D.pfClose+f?(F=D.pfClose+l,_=Number((Math.floor(M/l+1e-8)*l).toFixed(b)),w=H(k,A,M,P,T,C,D.pfClose,F,_),F==_&&(w.pfStepBack="X"),"O"==D.pfStepBack?(D.pfOpen=F,D.pfClose=_,D.pfTrend="X",V(D,M,P,T,C)):((w=L(k,w)).pfTrend="X",S.push(w))):V(D,M,P,T,C),C=0):"X"==D.pfTrend&&(M>=D.pfClose+l?(D.pfClose=Number((Math.floor(M/l+1e-8)*l).toFixed(b)),"X"!=D.pfStepBack&&"-"!=D.pfStepBack||(D.pfStepBack=null),V(D,M,P,T,C)):P<=D.pfClose-f?(F=D.pfClose-l,_=Number((Math.ceil(P/l-1e-8)*l).toFixed(b)),w=H(k,A,M,P,T,C,D.pfClose,F,_),F==_&&(w.pfStepBack="O"),"X"==D.pfStepBack||"-"==D.pfStepBack?(D.pfOpen=F,D.pfClose=_,D.pfTrend="O",V(D,M,P,T,C),F!=_&&"-"==D.pfStepBack&&(D.pfStepBack=null)):((w=L(k,w)).pfTrend="O",S.push(w))):V(D,M,P,T,C),E.H7e(2),C=E.D7e("0",1671852608))):((w=L(k,H(k,A,M,P,T,C,M+l,Number((Math.ceil(P/l-1e-8)*l).toFixed(b)),Number((Math.floor(M/l+1e-8)*l).toFixed(b))))).pfTrend="X",w.pfOpen==w.pfClose&&(w.pfStepBack="-"),S.push(w),C=0));return S}};var y=a.c;a.d,a.y,a.a,a.b;"undefined"!=typeof __TREE_SHAKE__&&__TREE_SHAKE__||(y||a.c).activateImports(u,d,p,f,m,g,null);var x=i(325);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var S=null;x.c.deprecationWarning=function(t){S||(S={},setInterval((function(){for(var t in S)console.warn(t+" ("+S[t]+" occurrences)"),delete S[t]}),1e4)),S[t]?S[t]++:S[t]=1};var C=x.c.deprecationWarning;Function.prototype.ciqInheritsFrom||(Function.prototype.ciqInheritsFrom=function(t,e){C("Function.prototype.ciqInheritsFrom() has been deprecated.  Use CIQ.inheritsFrom(me, ctor, autosuper) instead."),x.c.inheritsFrom(this,t,e)},Function.prototype.stxInheritsFrom=Function.prototype.ciqInheritsFrom),String.prototype.capitalize=function(){return C("String.prototype.capitalize() has been deprecated.  Use CIQ.capitalize(string) instead."),x.c.capitalize(this)},CanvasRenderingContext2D.prototype.dashedLineTo=function(t,e,i,a,r){if(C("CanvasRenderingContext2D.prototype.dashedLineTo() has been deprecated.  Use native CanvasRenderingContext2D methods such as moveTo(), lineTo() and setLineDash() instead."),!(r instanceof Array))return r&&console.log('WARNING: Unsupported drawing pattern "'+r+'"; defaulting to "solid"'),void this.stxLine(t,e,i,a,this.strokeStyle,this.globalAlpha,this.lineWidth);if(e!==1/0&&t!==1/0&&a!==1/0&&i!==1/0){var n=function(t,e){return t-e<=1e-8},s=function(t,e){return t-e>=-1e-8},o=function(t,e){return Math.min(t,e)},l=function(t,e){return Math.max(t,e)},h={thereYet:s,cap:o},c={thereYet:s,cap:o};if(e-a>0&&(c.thereYet=n,c.cap=l),t-i>0&&(h.thereYet=n,h.cap=l),this.moveTo(t,e),!isNaN(t)&&!isNaN(e))for(var u=t,d=e,p=0,f=!0;!h.thereYet(u,i)||!c.thereYet(d,a);){var m=Math.atan2(a-e,i-t),g=r[p];u=h.cap(i,u+Math.cos(m)*g),d=c.cap(a,d+Math.sin(m)*g),f?this.lineTo(u,d):this.moveTo(u,d),p=(p+1)%r.length,f=!f}}},CanvasRenderingContext2D.prototype.stxLine=function(t,e,i,a,r,n,s,o){C("CanvasRenderingContext2D.prototype.stxLine() has been deprecated.  Use native CanvasRenderingContext2D methods such as moveTo() and lineTo() instead."),this.beginPath(),this.lineWidth=s,this.strokeStyle=r,this.globalAlpha=n,o&&o.length?this.dashedLineTo(t,e,i,a,o):(this.moveTo(t,e),this.lineTo(i,a)),this.stroke(),this.closePath(),this.lineWidth=1},CanvasRenderingContext2D.prototype.stxCircle=function(t,e,i,a){C("CanvasRenderingContext2D.prototype.stxCircle() has been deprecated.  Use native CanvasRenderingContext2D methods such as arc() instead."),this.beginPath(),this.arc(t,e,i,0,2*Math.PI,!1),a&&this.fill(),this.stroke(),this.closePath()},x.c.getAjaxServer=function(t){return C("CIQ.getAjaxServer() has been deprecated.  Use `new XMLHttpRequest` instead."),new XMLHttpRequest},x.c.convertClickToTouchEnd=function(t){C("CIQ.convertClickToTouchEnd() has been deprecated.  Use CIQ.safeClickTouch() instead.");var e=document.getElementById(t),i=e.getAttribute("onClick");i&&(e.removeAttribute("onClick"),e.setAttribute("onTouchEnd",i))},x.c.standardUTCDate=function(t){C("CIQ.standardUTCDate(dt) has been deprecated.  Use dt.toISOString() instead.");var e=t.getUTCMonth()+1;e<10&&(e="0"+e);var i=t.getUTCDate();i<10&&(i="0"+i);var a=t.getUTCHours();a<10&&(a="0"+a);var r=t.getUTCMinutes();r<10&&(r="0"+r);var n=t.getUTCSeconds();return n<10&&(n="0"+n),t.getUTCFullYear()+"-"+e+"-"+i+"T"+a+":"+r+":"+n+"Z"},x.c.isDST=function(t){C("CIQ.isDST() has been deprecated.  Use dt.toISOString() instead."),t||(t=new Date);var e=new Date(t.getFullYear(),0,1),i=new Date(t.getFullYear(),6,1),a=Math.max(e.getTimezoneOffset(),i.getTimezoneOffset());return t.getTimezoneOffset()!=a},x.c.getEventDOM=function(t){return C("CIQ.getEventDOM() has been deprecated.  Use `e.target` instead."),t?t.target:window.event.srcElement},x.c.appendClassName=function(t,e){if(C("CIQ.appendClassName() has been deprecated.  Use `node.classList.add(className)` instead."),t&&t.className!=e){for(var i=t.className.split(" "),a=0;a<i.length;a++)if(i[a]==e)return;t.className?t.className+=" "+e:t.className=e}},x.c.unappendClassName=function(t,e){if(C("CIQ.unappendClassName() has been deprecated.  Use `node.classList.remove(className)` instead."),t&&-1!=t.className.indexOf(e))if(t.className==e)t.className="";else{for(var i=t.className.split(" "),a="",r=0;r<i.length;r++)i[r]!=e&&(""!==a&&(a+=" "),a+=i[r]);t.className=a}},x.c.swapClassName=function(t,e,i){C("CIQ.swapClassName() has been deprecated.  Use `node.classList.replace(oldClassName, newClassName)` instead."),x.c.unappendClassName(t,i),x.c.appendClassName(t,e)},x.c.hasClassName=function(t,e){return C("CIQ.hasClassName() has been deprecated.  Use `node.classList.contains(className)` instead."),!!t&&(" "+t.className+" ").indexOf(" "+e+" ")>-1},x.c.toggleClassName=function(t,e){C("CIQ.toggleClassName() has been deprecated.  Use `node.classList.toggle(className)` instead."),x.c.hasClassName(t,e)?x.c.unappendClassName(t,e):x.c.appendClassName(t,e)},function(){var t,e,i=document.attachEvent,a=navigator.userAgent.match(/Trident/),r=(t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,20)},function(e){return t(e)}),n=(e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout,function(t){return e(t)});function s(t){var e=t.target||t.srcElement;e.__resizeRAF__&&n(e.__resizeRAF__),e.__resizeRAF__=r((function(){var i=e.__resizeTrigger__;i.__resizeListeners__.forEach((function(e){e.call(i,t)}))}))}function o(t){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",s)}x.c.addResizeListener=function(t,e){C("CIQ.addResizeListener() has been deprecated.  Use CIQ.UI.addResizeListener() instead.");var r=document.querySelector("cq-ui-manager");if(r.length>0&&(r=r[0]).registerForResize(t),!t.__resizeListeners__)if(t.__resizeListeners__=[],i)t.__resizeTrigger__=t,t.attachEvent("onresize",s);else{var n=t.__resizeTrigger__=document.createElement("object");n.setAttribute("style","visibility:hidden; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1; border:0px;"),n.__resizeElement__=t,n.onload=o,n.type="text/html",a&&t.appendChild(n),n.data="about:blank",a||t.appendChild(n)}t.__resizeListeners__.push(e)},x.c.removeResizeListener=function(t,e){C("CIQ.removeResizeListener() has been deprecated.  Use CIQ.UI.removeResizeListener() instead.");var a=document.querySelector("cq-ui-manager");a.length>0&&(a=a[0]).unregisterForResize(t),t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),t.__resizeListeners__.length||(i?t.detachEvent("onresize",s):(t.__resizeTrigger__.contentDocument.defaultView.removeEventListener("resize",s),t.__resizeTrigger__=!t.removeChild(t.__resizeTrigger__)))}}(),x.c.Renderer.prototype.performCalculations=function(){C("CIQ.Renderer.prototype.performCalculations has been deprecated.  Use CIQ.Renderer.prototype.adjustYAxis instead.")},x.c.ChartEngine.hideDates=function(){return C("CIQ.Renderer.hideDates is no longer supported.  To hide an axis, set its noDraw property.  To hide the floating date label, set stxx.controls.floatDate=null."),!1},x.c.ChartEngine.chartShowsHighs=function(t){return C("CIQ.ChartEngine.prototype.chartShowsHighs has been deprecated.  Use CIQ.ChartEngine.Chart.prototype.highLowBars instead."),1!={line:1,colored_line:1,mountain:1,colored_mountain:1,baseline_delta:1,baseline_delta_mountain:1,histogram:1,scatterplot:1,step:1,colored_step:1}[t]},x.c.ChartEngine.prototype.createBlock=function(t,e,i,a,r,n){C("CIQ.ChartEngine.prototype.createBlock has been deprecated.  Use native canvas context operation fillRect instead."),n||(n=this.chart.context),void 0!==a&&(this.canvasColor(r,n),n.fillRect(t,i,e,a),n.globalAlpha=1)},x.c.ChartEngine.prototype.setVolumeUnderlay=function(t){C("CIQ.ChartEngine.prototype.setVolumeUnderlay is no longer supported.  To enable a volume underlay, use CIQ.Studies.addStudy(stxx, 'vol undr').  To disable, use CIQ.Studies.removeStudy."),this.layout.volumeUnderlay=t,this.chart.canvas&&this.draw(),this.changeOccurred("layout")},x.c.ChartEngine.prototype.serializeDrawings=function(){return C("CIQ.ChartEngine.prototype.serializeDrawings has been deprecated.  Use CIQ.ChartEngine.prototype.exportDrawings instead."),this.exportDrawings()},x.c.ChartEngine.prototype.reconstructDrawings=function(t){C("CIQ.ChartEngine.prototype.reconstructDrawings has been deprecated.  Use CIQ.ChartEngine.prototype.importDrawings instead."),this.importDrawings(t)},x.c.ChartEngine.prototype.computePosition=function(t,e){return C("CIQ.ChartEngine.prototype.computePosition has been deprecated.  Use CIQ.ChartEngine.prototype.pixelFromBar instead."),void 0===e&&(e=0),t*this.layout.candleWidth+e+this.micropixels},x.c.ChartEngine.prototype.computeColor=function(t,e){return C("CIQ.ChartEngine.prototype.computeColor has been deprecated.  There is no suggested alternative."),t<e?"stx_candle_up":t>e?"stx_candle_down":"stx_candle_shadow"},x.c.ChartEngine.prototype.computeLength=function(t,e){C("CIQ.ChartEngine.prototype.computeLength has been deprecated.  Use CIQ.ChartEngine.prototype.pixelFromPrice to compute values and find the difference.");var i=this.pixelFromPrice(t);return this.pixelFromPrice(e)-i},x.c.ChartEngine.prototype.setCrosshairColors=function(){C("CIQ.ChartEngine.prototype.setCrosshairColors is no longer supported.  Use CSS to set the crosshair color")},x.c.ChartEngine.prototype.valueFromPixelUntransform=function(t,e,i){return C("CIQ.ChartEngine.prototype.valueFromPixelUntransform has been deprecated.  Use CIQ.ChartEngine.prototype.valueFromPixel instead."),this.valueFromPixel(t,e,i)},x.c.ChartEngine.prototype.pixelFromPriceTransform=function(t,e,i){return C("CIQ.ChartEngine.prototype.pixelFromPriceTransform has been deprecated.  Use CIQ.ChartEngine.prototype.pixelFromPrice instead."),this.pixelFromPrice(t,e,i)},x.c.ChartEngine.prototype.isDailyInterval=function(t){return C("CIQ.ChartEngine.prototype.isDailyInterval has been deprecated. Use CIQ.ChartEngine.isDailyInterval instead."),x.c.ChartEngine.isDailyInterval(t)},x.c.ChartEngine.prototype.newChart=function(t,e,i,a,r){C("CIQ.ChartEngine.prototype.newChart has been deprecated. Use CIQ.ChartEngine.prototype.loadChart instead.");var n={masterData:e,chart:i};return x.c.extend(n,r,!0),this.loadChart(t,n,a)},x.c.ChartEngine.prototype.streamTrade=function(t,e,i,a){C("CIQ.ChartEngine.prototype.streamTrade has been deprecated. Use CIQ.ChartEngine.prototype.updateChartData instead.");var r=this.chart;a||(a={}),a.chart&&(r=a.chart),a.fillGaps=this.streamParameters.fillGaps;var n="object"==b(t),s=n?t.last:arguments[0],o=n?t.volume:arguments[1],l=n?t.bid:null,h=n?t.ask:null;n||(e=arguments[2],i=arguments[3]),i&&(a.secondarySeries=i);var c={DT:e,Last:s,Volume:o,Bid:l,Ask:h};this.updateChartData(c,r,a)},x.c.ChartEngine.prototype.appendMasterData=function(t,e,i){C("CIQ.ChartEngine.prototype.appendMasterData has been deprecated. Use CIQ.ChartEngine.prototype.updateChartData instead."),this.updateChartData(t,e,i)},x.c.ChartEngine.prototype.setPeriodicityV2=function(t,e,i,a){C("CIQ.ChartEngine.prototype.setPeriodicityV2 has been deprecated. Use CIQ.ChartEngine.prototype.setPeriodicity instead."),"function"==typeof i&&(a=i,i=null),this.runPrepend("setPeriodicityV2",arguments)||(this.setPeriodicity(t,e,i,a),this.runAppend("setPeriodicityV2",arguments))},x.c.ChartEngine.prototype.addChart=function(t,e){C("CIQ.ChartEngine.prototype.addChart has been deprecated. Add manually to stxx.charts object instead."),e.name=t,this.charts[t]=e};var w=x.c.ChartEngine.prototype.changeOccurred;x.c.ChartEngine.prototype.changeOccurred=function(t){this.currentlyImporting||(this.changeCallback&&this.changeCallback(this,t),w.call(this,t))};var k=x.c.ChartEngine.prototype.construct;function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}x.c.ChartEngine.prototype.construct=function(){function t(t,e,i){return t._deprecatedPropertyValues||(t._deprecatedPropertyValues={}),e in t._deprecatedPropertyValues||(t._deprecatedPropertyValues[e]=i),t._deprecatedPropertyValues[e]}function e(t,e,i){t._deprecatedPropertyValues||(t._deprecatedPropertyValues={}),t._deprecatedPropertyValues[e]=i}function i(e,i,a){return function(){return C("CIQ.ChartEngine.prototype.callbacks have been deprecated.  Iterate through CIQ.ChartEngine.prototype.callbackListeners instead."),t(this,e,a||null)}}function a(t,e){return function(i){C("CIQ.ChartEngine.prototype.callbacks have been deprecated.  Utilize CIQ.ChartEngine.prototype.addEventListener to add a callback, and/or CIQ.ChartEngine.prototype.removeEventListener to remove one."),this._deprecatedPropertyValues||(this._deprecatedPropertyValues={});var a=this._deprecatedPropertyValues[t];a&&e.removeEventListener(t,a),i&&e.addEventListener(t,i),this._deprecatedPropertyValues[t]=i}}var r;k.call(this),Object.defineProperties(this,{changeCallback:{enumerable:!0,get:function(){return t(this,"changeCallback",null)},set:function(t){C("CIQ.ChartEngine.prototype.changeCallback has been deprecated.  Use CIQ.ChartEngine.prototype.addEventListener instead."),e(this,"changeCallback",t)}},highLowBars:{enumerable:!0,get:function(){return C("CIQ.ChartEngine.prototype.highLowBars is no longer supported.  Use CIQ.ChartEngine.Chart.prototype.highLowBars instead."),t(this,"highLowBars",{bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,wave:!0,rangechannel:!0,none:!0})},set:function(t){C("CIQ.ChartEngine.prototype.highLowBars is no longer supported.  Use CIQ.ChartEngine.Chart.prototype.highLowBars instead."),e(this,"highLowBars",t)}},standaloneBars:{enumerable:!0,get:function(){return C("CIQ.ChartEngine.prototype.standaloneBars is no longer supported.  Use CIQ.ChartEngine.Chart.prototype.standaloneBars instead."),t(this,"standaloneBars",{bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,histogram:!0,scatterplot:!0})},set:function(t){C("CIQ.ChartEngine.prototype.standaloneBars is no longer supported.  Use CIQ.ChartEngine.Chart.prototype.standaloneBars instead."),e(this,"standaloneBars",t)}},barsHaveWidth:{enumerable:!0,get:function(){return C("CIQ.ChartEngine.prototype.barsHaveWidth is no longer supported.  Use CIQ.ChartEngine.Chart.prototype.barsHaveWidth instead."),t(this,"barsHaveWidth",{bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,histogram:!0,scatterplot:!0,wave:!0})},set:function(t){C("CIQ.ChartEngine.prototype.barsHaveWidth is no longer supported.  Use CIQ.ChartEngine.Chart.prototype.barsHaveWidth instead."),e(this,"barsHaveWidth",t)}}}),this.callbacks={},Object.defineProperties(this.callbacks,{studyOverlayEdit:{enumerable:!0,get:i("studyOverlayEdit"),set:a("studyOverlayEdit",this)},studyPanelEdit:{enumerable:!0,get:i("studyPanelEdit"),set:a("studyPanelEdit",this)},tap:{enumerable:!0,get:i("tap"),set:a("tap",this)},rightClick:{enumerable:!0,get:i("rightClick"),set:a("rightClick",this)},longhold:{enumerable:!0,get:i("longHold"),set:a("longHold",this)},move:{enumerable:!0,get:i("move"),set:a("move",this)},layout:{enumerable:!0,get:i("layout"),set:a("layout",this)},drawing:{enumerable:!0,get:i("drawing"),set:a("drawing",this)},drawingEdit:{enumerable:!0,get:i("drawingEdit"),set:a("drawingEdit",this)},preferences:{enumerable:!0,get:i("preferences"),set:a("preferences",this)},theme:{enumerable:!0,get:i("theme"),set:a("theme",this)},symbolChange:{enumerable:!0,get:i("symbolChange"),set:a("symbolChange",this)},symbolImport:{enumerable:!0,get:i("symbolImport"),set:a("symbolImport",this)},calculateTradingDecimalPlaces:{enumerable:!0,get:(r=this,function(){return C("CIQ.ChartEngine.prototype.callbacks.calculateTradingDecimalPlaces has been deprecated.  Utilize CIQ.ChartEngine.Chart.prototype.calculateTradingDecimalPlaces instead."),t(this,"calculateTradingDecimalPlaces",r.chart.calculateTradingDecimalPlaces)}),set:function(t){return function(i){C("CIQ.ChartEngine.prototype.callbacks.calculateTradingDecimalPlaces has been deprecated.  Utilize CIQ.ChartEngine.Chart.prototype.calculateTradingDecimalPlaces instead."),e(this,"calculateTradingDecimalPlaces",i),t.chart.calculateTradingDecimalPlaces=i}}(this)}}),Object.defineProperty(this.streamParameters,"fillGaps",{enumerable:!0,get:function(){return C("CIQ.ChartEngine.prototype.streamParameters.fillGaps has been deprecated.  Use CIQ.ChartEngine.prototype.updateChartData instead, with params.fillGaps=true or rely on cleanupGaps as default behavior."),t(this,"fillGaps",!0)},set:function(t){C("CIQ.ChartEngine.prototype.streamParameters.fillGaps has been deprecated.  Use CIQ.ChartEngine.prototype.updateChartData instead, with params.fillGaps=true or rely on cleanupGaps as default behavior."),e(this,"fillGaps",t)}})},"undefined"!=typeof window&&Object.defineProperties(window,{STX:{enumerable:!0,get:function(){return C("STX namespace has been deprecated.  Use CIQ namespace instead."),x.c}},STXChart:{enumerable:!0,get:function(){return C("STXChart namespace has been deprecated.  Use CIQ.ChartEngine namespace instead."),x.c.ChartEngine}}}),x.c.ChartEngine.prototype.attachEngineQuoteFeed=function(t,e){C("CIQ.ChartEngine.prototype.attachEngineQuoteFeed has been deprecated. Use CIQ.ChartEngine.prototype.attachQuoteFeed instead."),this.attachQuoteFeed(t,e)},x.c.ChartEngine.prototype.dragPlot=function(t){C("CIQ.ChartEngine.prototype.dragPlot is no longer supported.  Use CIQ.ChartEngine.prototype.dragPlotOrAxis instead.")},x.c.ChartEngine.prototype.dragYAxis=function(t){C("CIQ.ChartEngine.prototype.dragYAxis is no longer supported.  Use CIQ.ChartEngine.prototype.dragPlotOrAxis instead.")},x.c.Drawing=x.c.Drawing||function(){this.chartsOnly=!1,this.penDown=!1},x.c.Drawing.prototype.setLineColor=function(){if(C("CIQ.Drawing.prototype.setLineColor has been deprecated.  Use CIQ.Drawing.prototype.setLineColor instead."),x.c.Drawing.prototype.getLineColor)return x.c.Drawing.prototype.getLineColor.apply(this,arguments)},x.c.Studies=x.c.Studies||function(){},x.c.Studies.quickAddStudy=function(){if(C("CIQ.Studies.quickAddStudy has been deprecated.  Use CIQ.Studies.addStudy instead."),x.c.Studies.addStudy)return x.c.Studies.addStudy.apply(null,arguments)},x.c.Studies.overZones=function(){if(C("CIQ.Studies.overZones has been deprecated.  Use CIQ.Studies.drawZones instead."),x.c.Studies.drawZones)return x.c.Studies.drawZones.apply(null,arguments)},x.c.Studies.volUnderlay=function(){C("CIQ.Studies.volUnderlay has been deprecated.  Use CIQ.Studies.createVolumeChart instead."),x.c.Studies.createVolumeChart&&x.c.Studies.createVolumeChart.apply(null,arguments)},x.c.Studies.determineMinMax=function(t,e,i){C("CIQ.Studies.determineMinMax is no longer supported.  The calculation is done automatically elsewhere.")},x.c.Studies.createYAxis=function(t,e,i,a){C("CIQ.Studies.createYAxis is no longer supported.  The action is done automatically elsewhere.")},x.c.Studies.volumeChart=function(t,e,i,a){C("CIQ.Studies.volumeChart has been deprecated.  Use CIQ.ChartEngine.prototype.drawHistogram instead.");var r,n,s=-1*Number.MAX_VALUE;for(r in i)for(var o=0;o<i[r].length;o++)(n=i[r][o])&&n>s&&(s=n);var l=t.panels[e.panel],h=Math.floor(l.yAxis.bottom)+.5,c=h-(Math.floor(l.yAxis.top)+.5),u=t.layout.candleWidth,d=null;e.parameters&&e.parameters.displayBorder||(a=null);var p=0;a||(p=(u-t.chart.tmpWidth)/2);var f=e.getContext(t);for(r in f.lineWidth=1,t.startClip(e.panel),i){a&&(d=a[r]),f.fillStyle=r,d&&(f.strokeStyle=d),f.beginPath();for(var m,g=h+.5,v=Math.floor(t.pixelFromBar(0,l.chart)),y=0;y<i[r].length;y++)if(t.chart.dataSegment[y]&&t.chart.dataSegment[y].candleWidth?(u=t.chart.dataSegment[y].candleWidth,a||(p=u/4)):(u=t.layout.candleWidth,a||(p=(u-t.chart.tmpWidth)/2)),0===y&&(m=v-=u/2),n=i[r][y]){var x,b,S=n*(c/s),w=Math.min(Math.floor(h-c+(c-S))+.5,h);x=Math.floor(m+p),b=Math.floor(m+u-p),x=Math.max(x,v),f.moveTo(x,h),f.lineTo(b,h),f.lineTo(b,w),f.lineTo(x,w),a?(g>w||0===y)&&f.lineTo(x,g):f.lineTo(x,h),g=w,m+=u}else g=h,m+=u;f.fill(),f.strokeStyle=d,a&&t.layout.candleWidth>=2&&f.stroke(),f.closePath()}t.endClip()},x.c.UI||(x.c.UI={}),x.c.UI.observe=function(t){if(C("CIQ.UI.observe has been deprecated.  Use CIQ.UI.observeProperty instead."),Object.observe){var e=this,i=function(t){t.forEach(a)};return Object.observe(t.obj,i,["update","add","delete"]),a({name:t.member}),i}function a(i){var a=!1;if(t.member){if(i.name===t.member)a=!0;else if(t.member.constructor==Array)for(var r=0;r<t.member.length;r++)i.name===t.member[r]&&(a=!0)}else a=!0;if(a){var n=$(t.selector);if(!n.length&&"callback"===t.action)return void t.value.call(e,t);"class"===t.action&&n.removeClass(t.value),n.each((function(){var i=!1;t.member&&(t.condition?t.obj[t.member]===t.condition&&(i=!0):i=t.obj[t.member]),"class"===t.action&&i&&n.addClass(t.value),"callback"===t.action&&t.value.call(e,t,this),"value"===t.action&&(t.value?this.value=t.value:t.obj[t.member]?this.value=t.obj[t.member]:this.value="")}))}}C("You must include thirdparty/object-observe.js in your project to use CIQ.UI.observe.")},x.c.UI.unobserve=function(t){C("CIQ.UI.unobserve has been deprecated.  Use CIQ.UI.unobserveProperty instead."),Object.unobserve&&Object.unobserve(t.obj,t.handler)},x.c.UI.Lookup=function(){},x.c.UI.Lookup.Driver=function(){this.deprecated=!0},x.c.UI.Lookup.Driver.prototype.acceptText=function(t,e,i,a){this.cb},x.c.UI.Lookup.Driver.ChartIQ=function(t){C("CIQ.UI.Lookup.Driver.ChartIQ has been deprecated.  Use CIQ.ChartEngine.Driver.Lookup.ChartIQ instead."),this.exchanges=t,this.exchanges||(this.exchanges=["XNYS","XASE","XNAS","XASX","INDCBSX","INDXASE","INDXNAS","IND_DJI","ARCX","INDARCX","forex"]),this.url="https://symbols.chartiq.com/chiq.symbolserver.SymbolLookup.service",this.requestCounter=0},x.c.inheritsFrom(x.c.UI.Lookup.Driver.ChartIQ,x.c.UI.Lookup.Driver),x.c.UI.Lookup.Driver.ChartIQ.prototype.acceptText=function(t,e,i,a){"FX"==e&&(e="FOREX"),isNaN(parseInt(i,10))&&(i=100);var r=this.url+"?t="+encodeURIComponent(t)+"&m="+i+"&x=[";this.exchanges&&(r+=this.exchanges.join(",")),r+="]",e&&"ALL"!=e.toUpperCase()&&(r+="&e="+e);var n=++this.requestCounter,s=this;x.c.postAjax({url:r,cb:function(t,e){if(!(n<s.requestCounter)&&200==t)try{for(var i=(e=JSON.parse(e)).payload.symbols,r=[],o=0;o<i.length;o++){var l=i[o].split("|"),h={symbol:l[0],name:l[1],exchDisp:l[2]};r.push({display:[h.symbol,h.name,h.exchDisp],data:h})}a(r)}catch(t){}}})},"undefined"!=typeof window&&Object.defineProperty(window,"STXSocial",{enumerable:!0,get:function(){return C("STXSocial namespace has been deprecated.  Use CIQ.Share namespace instead."),x.c.Share}});var T=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.Animation=e.Animation||function(t){if(!t)throw new Error("Invalid constructor arguments.");var i,a,r;if(t instanceof e.ChartEngine?(i=arguments[0],a=arguments[1],r=arguments[2]):(i=t.stx,a=t.animationParameters,r=t.easeMachine),!i)return console.warn("No CIQ.ChartEngine provided. Cannot properly create CIQ.Animation instance");var n={stayPut:!1,ticksFromEdgeOfScreen:5,granularity:1e6};a=e.extend(n,a),n.tension&&(i.chart.tension=a.tension),i.tickAnimator=r||new e.EaseMachine(Math.easeOutCubic,1e3);var s=new e.EaseMachine(Math.easeInOutCubic,1e3),o=["#0298d3","#19bcfc","#5dcffc","#9ee3ff"],l=0,h=20,c=0,u=!1,d=null;function p(){u=!1,d=null}i.addEventListener(["symbolChange","layout"],(function(t){p()})),i.prepend("updateCurrentMarketData",(function(t,e,i,a){e||(e=this.chart),a&&a.fromTrade&&(e.closePendingAnimation||0===e.closePendingAnimation)&&(a.finalClose=e.closePendingAnimation)})),i.prepend("updateChartData",(function(t,i,r){var n=this;if(i||(i=n.chart),i&&i.defaultChartStyleConfig&&"none"!=i.defaultChartStyleConfig&&(void 0===r||!r.animationEntry&&!r.secondarySeries)&&i.dataSegment){var s=n.tickAnimator,o=this.mainSeriesRenderer&&this.mainSeriesRenderer.supportsAnimation;if(o){if(!s)return void console.warn("Animation plug-in can not run because the tickAnimator has not been declared. See instructions in animation.js");if(this.prevSymbol!=i.symbol&&(this.prevQuote=0,i.closePendingAnimation=null,this.prevSymbol=i.symbol),A(),s.stop(),t.length>2)return}var l=e.clone(r);l||(l={}),l.animationEntry=!0,l.bypassGovernor=!0,l.noCreateDataSet=!1,l.appending=!0,l.firstLoop=!0;var h=this.chart.symbol,c=this.layout.periodicity,p=this.layout.interval,f=this.layout.timeUnit;if(o){var m=t[t.length-1];this.prevQuote=this.currentQuote();var g=!1,v=!1;if(1==c&&2==t.length){this.prevQuote=t[0];var y=i.dataSet.length;T(this.prevQuote),y==i.dataSet.length&&(v=!0)}if(!(m&&m.Close&&this.prevQuote&&this.prevQuote.Close))return!1;if(this.extendedHours&&i.market.market_def){var x=m.DT;if(e.ChartEngine.isDailyInterval(p))u=!i.market.isMarketDate(x);else if(!d||d<=x){var b=i.market.getSession(x);u=!(""===b||this.layout.marketSessions&&this.layout.marketSessions[b]),d=i.market[u?"getNextOpen":"getNextClose"](x)}if(u)return this.draw(),!1}var S=c;"second"==p||"second"==f?S*=1e3:"minute"!=p&&"minute"!=f||(S*=6e4),isNaN(p)||(S*=p),g="day"==p||"day"==f?m.DT.getDate()!=this.prevQuote.DT.getDate():"week"==p||"week"==f?m.DT.getDate()>=this.prevQuote.DT.getDate()+7:"month"==p||"month"==f?m.DT.getMonth()!=this.prevQuote.DT.getMonth():m.DT.getTime()>=this.prevQuote.DT.getTime()+S;var C=!this.mainSeriesRenderer||!this.mainSeriesRenderer.standaloneBars,w=0;if(g){if(!this.animations.zoom.hasCompleted)return!1;var k=this.layout.candleWidth;if(i.scroll<=i.maxTicks)for(;this.micropixels>0;)i.scroll++,this.micropixels-=k;i.scroll<=i.maxTicks?(this.previousMicroPixels=this.micropixels,this.nextMicroPixels=this.micropixels+k,w=-1*k,i.dataSegment.length<i.maxTicks-a.ticksFromEdgeOfScreen&&!a.stayPut&&(this.nextMicroPixels=this.micropixels,i.scroll++),i.animatingHorizontalScroll=C,i.previousDataSetLength=i.dataSet.length):v||i.scroll++}i.closePendingAnimation=m.Close;var D=g&&!C?m.Open:this.prevQuote.Close;return s.run(function(t,r,o){return function(u){var d=u.Close;if(!i.dataSet.length||h!=i.symbol||c!=n.layout.periodicity||p!=n.layout.interval||f!=n.layout.timeUnit)return s.stop(),void A();var m=e.clone(t);m.Adj_Close=null,m.Close=Math.round(d*a.granularity)/a.granularity,o?(m.Open||0===m.Open||(m.Open=m.Close),m.High||0===m.High||(m.High=Math.max(m.Open,m.Close)),m.Low||0===m.Low||(m.Low=Math.min(m.Open,m.Close))):(t.Close>r.High&&(m.High=m.Close),t.Close<r.Low&&(m.Low=m.Close)),i.animatingHorizontalScroll&&(n.micropixels=u.micropixels,i.lastTickOffset=u.lineOffset),l.updateDataSegmentInPlace=!s.hasCompleted;var g=[m];o&&"tick"!==n.layout.interval&&g.unshift(r),n.updateChartData(g,i,l),l.firstLoop=!1,s.hasCompleted&&A()}}(m,e.clone(this.prevQuote),g),{Close:D,micropixels:this.nextMicroPixels,lineOffset:w},{Close:m.Close,micropixels:this.micropixels,lineOffset:0}),!0}}function T(t){if(i.masterData)for(var e=i.masterData.length-1;e>=0;e--){var a=i.masterData[e];if(a.Close||0===a.Close)return a.Close=t.Close,t.LastSize&&(a.LastSize=t.LastSize),t.LastTime&&(a.LastTime=t.LastTime),n.updateCurrentMarketData({Close:a.Close,DT:a.DT,LastSize:a.LastSize,LastTime:a.LastTime}),void n.createDataSet(null,null,{appending:!0})}}function A(){if(i.animatingHorizontalScroll&&(i.animatingHorizontalScroll=!1,n.micropixels=n.nextMicroPixels=n.previousMicroPixels,i.lastTickOffset=0),null!==i.closePendingAnimation){var t=i.closePendingAnimation;i.closePendingAnimation=null,T({Close:t})}}})),i.prepend("renderYAxis",(function(t){if(!this.grabbingScreen&&this.isHome()&&(this.mainSeriesRenderer&&this.mainSeriesRenderer.supportsAnimation)){var i=t.panel.yAxis;if(!e.Comparison||i.priceFormatter!=e.Comparison.priceFormat)if(t.prevLowValue||0===t.prevLowValue||(t.prevLowValue=t.animatedLow=t.lowValue),t.prevHighValue||0===t.prevHighValue||(t.prevHighValue=t.animatedHigh=t.highValue),s.running||(t.animatingVerticalScroll=!1),t.prevLowValue>=t.lowValue&&t.prevHighValue<=t.highValue)t.animatingVerticalScroll&&(i.highValue=t.animatedHigh,i.lowValue=t.animatedLow);else if(s.running&&s.stop(),t.lowValue||t.highValue){var a,r=t.prevLowValue,n=t.prevHighValue;t.prevLowValue=t.lowValue,t.prevHighValue=t.highValue,t.animatingVerticalScroll=!0,s.run((a=this,function(e){t.animatedLow=e.low,t.animatedHigh=e.high,a.draw()}),{low:r,high:n},{low:t.lowValue,high:t.highValue}),i.lowValue=t.animatedLow,i.highValue=t.animatedHigh}}})),i.append("draw",(function(){if(!u&&this.chart.dataSet&&this.chart.dataSet.length&&this.mainSeriesRenderer&&this.mainSeriesRenderer.supportsAnimation){c%h==0&&(l++,c=0),c++;var t=this.chart.context,e=this.chart.panel,i=this.currentQuote();if(!i)return;var a=i.Close,r=this.pixelFromTick(i.tick,this.chart);this.chart.lastTickOffset&&(r+=this.chart.lastTickOffset);var n=this.pixelFromPrice(a,e);this.chart.yAxis.left>r&&this.chart.yAxis.top<=n&&this.chart.yAxis.bottom>=n&&(l>=o.length&&(l=0),t.beginPath(),t.moveTo(r,n),t.arc(r,n,2+1.07*l,0,2*Math.PI,!1),t.fillStyle=o[l],t.fill())}}))}},A=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ContinuousZoom=e.ContinuousZoom||function(t){this.update(t),this.stx.continuousZoom=this,this.addSmartZoomButton=function(){var t,e=this.stx.registerChartControl&&this.stx.registerChartControl("stx-smart-zoom","SmartZoom",(t=this,function(e){t.smartZoomToggle(e),e.stopPropagation()}));e&&(this.stx.addEventListener("layout",(function(t){!0===t.stx.layout.smartzoom?e.classList.add("active"):e.classList.remove("active")})),this.stx.addEventListener("symbolImport",(function(t){!1===t.stx.layout.smartzoom&&e.classList.remove("active")})))},this.smartZoomToggle=function(t){this.smartZoomEnable(!this.stx.layout.smartzoom)},this.smartZoomEnable=function(t){this.stx.layout.smartzoom=t,this.stx.changeOccurred("layout")},this.addSmartZoomButton(),this.smartZoomEnable(!0)},e.ContinuousZoom.prototype.update=function(t){t||(t={}),this.stx=t.stx,this.periodicities=t.periodicities,this.boundaries=t.boundaries},e.ContinuousZoom.prototype.execute=function(t){function e(t){var e=t.period||t.periodicity,i=t.interval,a=t.timeUnit||"minute";switch(isNaN(i)&&(a=i,i=1),a){case"month":i*=4.35;case"week":i*=7;case"day":i*=1440;case"minute":i*=60;case"second":break;case"millisecond":i/=1e3;break;default:return null}return e*i}if(this.stx&&this.stx.layout.smartzoom){var i=this.periodicities,a=this.boundaries,r=this.stx,n=r.layout,s=r.chart;if(i&&a&&(!t&&a.maxCandleWidth&&n.candleWidth>a.maxCandleWidth||t&&a.minCandleWidth&&n.candleWidth<a.minCandleWidth||!t&&a.minTicks&&s.maxTicks<a.minTicks||t&&a.maxTicks&&s.maxTicks>a.maxTicks)){for(var o={value:t?Number.MAX_VALUE:0},l=e(n),h=0;h<i.length;h++){var c=e(i[h]);(c>l&&c<o.value&&t||c<l&&c>o.value&&!t)&&(o={value:c,periodicity:i[h]})}var u=o.periodicity;u&&r.setRange({dtLeft:s.xaxis[0].DT,dtRight:s.xaxis[s.xaxis.length-1].DT,dontSaveRangeToLayout:!0,periodicity:u})}}}},M=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ExtendedHours=e.ExtendedHours||function(t){var i=t.stx;this.filter=t.filter,i||(i=t,this.filter=!1);var a={};this.stx=i,this.stx.extendedHours=this;var r="".concat(t.menuContextClass&&"."+t.menuContextClass||"body"," .extendedhours-ui");e.addInternalStylesheet("".concat(r," { display: inherit }"),r),i.addEventListener("theme",(function(t){for(var e in a={},i.layout.marketSessions)a.session||(a.session={}),a.session[e]=i.canvasStyle("stx_market_session "+e)})),i.addEventListener("symbolChange",(function(t){"master"!=t.action||!i.layout.extended||i.chart.market.market_def&&i.chart.market.sessions.length||e.alert("There are no Extended Hours for this instrument.")})),this.prepare=function(t,e){for(var r in i.layout.extended=t,i.layout.marketSessions)a.session={},i.chart.market.disableSession(r);if(i.layout.marketSessions={},t)if(e||(e=["pre","post"]),e.length)for(var n=0;n<e.length;n++)i.layout.marketSessions[e[n]]=!0;else i.layout.marketSessions=e;for(r in i.layout.marketSessions)a.session||(a.session={}),a.session[r]=i.canvasStyle("stx_market_session "+r),i.chart.market.disableSession(r,!0)},this.complete=function(t){i.changeOccurred("layout"),i.chart.market.market_def?this.filter?(i.createDataSet(),i.draw(),t&&t()):i.loadChart(i.chart.symbol,t):t&&t()},this.set=function(t,e,i){this.prepare(t,e),this.complete(i)},this.stx.append("drawYAxis",(function(t,r){if(this.layout.extended&&t.yAxis==r.yAxis&&!1!==t.shareChartXAxis&&!t.hidden){var n=t.chart;if(!e.ChartEngine.isDailyInterval(this.layout.interval)&&(a.divider=this.canvasStyle("stx_market_session divider"),a.session)){for(var s,o,l=n.market,h=[],c={},u=0;u<n.dataSegment.length;u++){var d=n.dataSegment[u];if(d&&d.DT){var p=null;if(l.market_def)if(!s||s<=d.DT)o=l.getSession(d.DT),s=l[!(""===o||this.layout.marketSessions&&this.layout.marketSessions[o])?"getNextOpen":"getNextClose"](d.DT);var f=a.session[o];if(f&&(p=f.backgroundColor),c.color&&c.color!=p&&(h.push({start:c.start,end:c.end,color:c.color}),c={}),p){var m=this.layout.candleWidth;d.candleWidth&&(m=d.candleWidth),c.end=this.pixelFromBar(u,n)+m/2,c.start||0===c.start||(c.start=c.end-m+1),c.color=p}else c={}}}(c.start||0===c.start)&&h.push({start:c.start,end:c.end,color:c.color});var g=e.isTransparent(a.divider.backgroundColor),v=a.divider.width.replace(/px/g,""),y={y0:t.bottom,y1:t.top,color:a.divider.backgroundColor,type:"line",context:n.context,confineToPanel:t,pattern:"dashed",lineWidth:v,deferStroke:!0};for(this.startClip(t.name),n.context.beginPath(),i.highlightedDraggable&&(n.context.globalAlpha*=.3),u=0;u<h.length;u++)n.context.fillStyle=h[u].color,!g&&h[u].start>n.left&&this.plotLine(e.extend({x0:h[u].start,x1:h[u].start},y)),n.context.fillRect(h[u].start,t.top,h[u].end-h[u].start,t.bottom-t.top),!g&&h[u].end<n.right&&this.plotLine(e.extend({x0:h[u].end,x1:h[u].end},y));n.context.stroke(),this.endClip()}}}))}},P=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.FullScreen=e.FullScreen||function(t){t||(t={}),t.stx?(this.stx=t.stx,this.stx.fullScreen=this,this.fullScreenButton=null,this.fullScreenState=!1,this.addFullScreenButton=function(){var t;this.stx.registerChartControl&&(this.fullScreenButton=this.stx.registerChartControl("stx-full-screen","Full Screen",(t=this,function(e){t.fullScreenToggle(e),e.stopPropagation()})))},this.fullScreenToggle=function(t){document.documentElement.requestFullscreen||document.documentElement.webkitRequestFullscreen||document.documentElement.mozRequestFullscreen||document.documentElement.msRequestFullscreen?this.getFullScreenElement()?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():document.documentElement.mozRequestFullscreen?document.documentElement.mozRequestFullscreen():document.documentElement.msRequestFullscreen&&document.documentElement.msRequestFullscreen():(this.fullScreenState=!this.fullScreenState,this.fullScreenRender())},this.fullScreenRender=function(){var t=null;(t=e.findClosestParent(this.stx.container,"*[cq-context], cq-context, body"))&&(!0===this.fullScreenState?(this.fullScreenButton&&this.fullScreenButton.classList.add("active"),t.classList.add("full-screen")):(this.fullScreenButton&&this.fullScreenButton.classList.remove("active"),t.classList.remove("full-screen")),window.dispatchEvent(new Event("resize")))},this.onFullScreenChange=function(){this.getFullScreenElement()?this.fullScreenState=!0:this.fullScreenState=!1,this.fullScreenRender()},this.getFullScreenElement=function(){return document.fullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullScreenElement||document.msFullscreenElement},document.addEventListener("fullscreenchange",this.onFullScreenChange.bind(this),!1),document.addEventListener("webkitfullscreenchange",this.onFullScreenChange.bind(this),!1),document.addEventListener("mozfullscreenchange",this.onFullScreenChange.bind(this),!1),document.addEventListener("MSFullscreenChange",this.onFullScreenChange.bind(this),!1),this.addFullScreenButton()):console.warn("The Full Screen addon requires an stx parameter")}},F=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.InactivityTimer=e.InactivityTimer||function(t){var e;t.minutes&&((!t.interval||t.interval<0)&&(t.interval=60),this.stx=t.stx,this.timeout=t.minutes,this.interval=t.interval,this.wakeCB=t.wakeCB,this.sleepCB=t.sleepCB,this.sleepTimer=null,this.sleeping=!1,this.last=(new Date).getTime(),this.wakeChart=function(){clearTimeout(this.sleepTimer),this.last=(new Date).getTime(),this.sleeping&&(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(),this.sleeping=!1,document.body.classList.remove("ciq-sleeping")),this.sleepTimer=setTimeout(this.sleepChart.bind(this),6e4*this.timeout),this.wakeCB&&this.wakeCB()},this.sleepChart=function(){this.sleeping||(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(this.interval),this.sleeping=!0,document.body.classList.add("ciq-sleeping")),this.sleepCB&&this.sleepCB()},$(document).on("mousemove mousedown touchstart touchmove pointerdown pointermove keydown wheel",$("body"),(e=this,function(t){e.wakeChart()})),this.wakeChart())}},_=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.Outliers=e.Outliers||function(t){if(t||(t={}),t.stx){Array.isArray(t.altColors)||(t.altColors=["#323390","#66308f","#0073ba","#f4932f","#0056a4","#00a99c","#00a553","#ea1d2c","#e9088c","#fff126","#912a8e","#ee652e","#00afed","#8ec648"]),this.stx=t.stx,this.stx.outliers=this,this.multiplier=t.multiplier||3,this.altColors=t.altColors,this.axisData={},this.stx.addEventListener("layout",(function(t){Object.keys(t.stx.outliers.axisData).forEach(function(t){this.removeAllMarkers(this.axisData[t]),delete this.axisData[t]}.bind(t.stx.outliers))}));var i="".concat(t.menuContextClass&&"."+t.menuContextClass||"body"," .outliers-ui");e.addInternalStylesheet("".concat(i," { display: inherit }"),i),this.processDataSet=function(t,e,i){if(!t.length||t.length<=1)return!1;var a=[0,0];if(!this.axisData[i.name]){var r="",n=-1;Object.keys(this.axisData).forEach(function(t){this.axisData[t].panel.name==e.name&&n++}.bind(this)),n>-1&&n<this.altColors.length&&(r=this.altColors[n]),this.axisData[i.name]={axis:i,panel:e,displayState:"none",isFlipped:!1,originalZoom:i.zoom,markerColor:r,markers:{},axisMarkers:{}}}var s=this.axisData[i.name];return Object.assign(s,this.find(t)),this.refreshMarkerArray(s),this.refreshMarkers(s),"low"!==s.displayState&&"all"!==s.displayState||null===s.outlierMin?a[0]=s.trendMin:a[0]=s.outlierMin,"high"!==s.displayState&&"all"!==s.displayState||null===s.outlierMax?a[1]=s.trendMax:a[1]=s.outlierMax,a},this.find=function(t){if(t.length&&!(t.length<=0)){var e,i,a=function(t,e){return{quote:t.quote,DT:t.quote.DT,value:t.value,position:e}},r=null,n=null,s=null,o=null,l=[],h=t.slice();h.sort((function(t,e){return t.value-e.value}));var c=h.length,u=h[Math.floor(c/4)].value,d=h[Math.floor(c*(3/4))].value,p=d-u;e=u-p*this.multiplier,i=d+p*this.multiplier;for(var f=0;f<c;f++){var m=h[f],g=h[c-(f+1)];if(m.value<=e&&l.push(a(m,"low")),g.value>=i&&l.push(a(g,"high")),null===s&&m.value<=e&&(s=m.value),null===o&&g.value>=i&&(o=g.value),null===r&&m.value>e&&(r=m.value),null===n&&g.value<i&&(n=g.value),null!==r&&null!==n)break}return{minValue:e,maxValue:i,trendMin:r,trendMax:n,outlierMin:s,outlierMax:o,activeOutliers:l}}},this.refreshMarkerArray=function(t){this.deprecateMarkers(t);var e=t.markers;t.activeOutliers.forEach(function(i){var a=i.DT.getTime().toString();e[a]||(e[a]={isFresh:!0,type:"quote",value:i.value,marker:this.markOutlier(i,i.position,t)}),e[a].isFresh=!0}.bind(this)),null!==t.outlierMax&&(e.axisHigh||(e.axisHigh={isFresh:!0,type:"axis",value:t.outlierMax,marker:this.markAxis("high",t)}),e.axisHigh.isFresh=!0),null!==t.outlierMin&&(e.axisLow||(e.axisLow={isFresh:!0,type:"axis",value:t.outlierMin,marker:this.markAxis("low",t)}),e.axisLow.isFresh=!0)},this.setDisplayState=function(t,e){"high"!=t&&"low"!=t&&"all"!=t&&(t="none");var i=t;"all"==e.displayState&&"high"==t?i="low":"all"==e.displayState&&"low"==t?i="high":"high"==e.displayState&&"low"==t||"low"==e.displayState&&"high"==t?i="all":e.displayState==t&&(i="none"),e.displayState=i,e.axis.zoom=e.originalZoom,this.refreshMarkers(e),this.stx.draw()},this.deprecateMarkers=function(t){Object.keys(t.markers).forEach(function(t){var e;(e=this.markers[t]).marker&&!e.isFresh?(e.marker.remove&&e.marker.remove(),e.marker=null):e.isFresh=!1,this.markers[t].marker||delete this.markers[t]}.bind(t))},this.removeAllMarkers=function(t){Object.keys(t.markers).forEach((function(e){var i=t.markers[e].marker;i&&(i.remove&&i.remove(),i=null),i||delete t.markers[e]}))},this.updateMarkerVisibility=function(){Object.keys(this.markers).forEach(function(t){"all"==this.displayState||this.markers[t].marker.node.classList.contains(this.displayState)?this.markers[t].marker.node.style.display="none":this.markers[t].marker.node.style.display="block"}.bind(this))},this.refreshAxisMarkers=function(t,e){var i=!1;t.classList.contains("high")&&(i=!0);var a=e.axis.top;(!e.isFlipped&&!i||e.isFlipped&&i)&&(a=e.axis.bottom-50),t.classList.contains("nano")&&(a=e.axis.top+e.axis.height/2-22);var r=Math.floor(e.axis.left).toString()+"px",n=Math.floor(a).toString()+"px",s=i?e.outlierMax:e.outlierMin;t.style.transform="translate("+r+", "+n+")",t.querySelector(".outlier-value").innerText=this.stx.formatYAxisPrice(s),"0px"===r?t.classList.add("right"):t.classList.remove("right")},this.refreshMarkers=function(t){Object.keys(t.markers).forEach(function(t,e){var i=t.markers[e].marker,a=t.markers[e].value,r=t.markers[e].type;a>t.trendMax&&t.axis.high>=a||a<t.trendMin&&t.axis.low<=a?"quote"==r?i.node.style.display="none":"axis"==r&&i.node.classList.add("compress"):"quote"==r?i.node.style.display="block":"axis"==r&&i.node.classList.remove("compress"),"axis"==r&&this.refreshAxisMarkers(i.node,t),t.axis.height<100?i.node.classList.add("nano"):i.node.classList.remove("nano"),t.axis.height<250?i.node.classList.add("micro"):i.node.classList.remove("micro")}.bind(this,t)),t.isFlipped!==t.axis.flipped&&this.flipMarkers(t)},this.markAxis=function(t,i){var a=document.createElement("div");a.classList.add("outlier-sticker","axis","mini",t),a.innerHTML='<div class="expansion"><div class="pill"><div class="icon"></div></div><div class="tick"></div><span class="outlier-value"></div><div class="compression"><div class="pill"><div class="icon"></div></div></div></span>',this.matchYAxisStyle(a),this.setMarkerColor(a,i.markerColor);var r=this.handleMarkerClick.bind(this,t,i,a);return a.addEventListener("click",r),a.addEventListener("touchend",r),new e.Marker({stx:this.stx,xPositioner:"none",yPositioner:"none",label:"expand",permanent:!0,chartContainer:!0,node:a})},this.markOutlier=function(t,i,a){if(t){a||(a={panel:this.stx.panels.chart}),i=i||"high";var r=document.createElement("div");r.classList.add("outlier-sticker","quote","mini",i),r.innerHTML='<div class="pill"><div class="icon"></div></div><span class="outlier-value">'+this.stx.formatYAxisPrice(t.value,a.panel)+"</span>",this.matchYAxisStyle(r),this.setMarkerColor(r,a.markerColor);var n=this.handleMarkerClick.bind(this,i,a,r);return r.addEventListener("click",n),r.addEventListener("touchend",n),new e.Marker({stx:this.stx,xPositioner:"date",yPositioner:"high"==i?"top":"bottom",x:t.quote.DT,panelName:a.panel.name,node:r})}},this.handleMarkerClick=function(t,e,i){i.classList.contains("nano")&&(t="all"),this.setDisplayState(t,e),this.stx.draw()},this.matchYAxisStyle=function(t){if(this.stx.styles.stx_yaxis){var e=this.stx.styles.stx_yaxis;t.style.fontSize=e.fontSize,t.style.fontFamily=e.fontFamily,t.style.color=e.color,t.style.borderColor=e.color}},this.setMarkerColor=function(t,e){if(""!=e)for(var i=t.querySelectorAll(".pill"),a=0;a<i.length;a++)i[a].style.backgroundColor=e},this.flipMarkers=function(t){t.isFlipped=t.axis.flipped,Object.keys(t.markers).forEach(function(t,e){var i=t.markers[e].marker,a=t.markers[e].value,r=t.markers[e].type;t.isFlipped?i.node.classList.add("flipped"):i.node.classList.remove("flipped"),"quote"==r&&(a>t.trendMax?t.isFlipped?i.params.yPositioner="bottom":i.params.yPositioner="top":a<t.trendMin&&(t.isFlipped?i.params.yPositioner="top":i.params.yPositioner="bottom"))}.bind(this,t))};var a=e.ChartEngine.prototype.determineMinMax.bind(this.stx);e.ChartEngine.prototype.determineMinMax=function(t,e,i,r,n,s,o,l,h){return h||(h=[]),o&&l&&this.layout.outliers&&h.push(this.outliers.processDataSet.bind(this.outliers)),a(t,e,i,r,n,s,o,l,h)}}else console.warn("The Outliers addon requires an stx parameter")}},E=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.PlotComplementer=e.PlotComplementer||function(t){var i=t.stx,a=e.uniqueID();t.decorator||(t.decorator={});var r=t.decorator.symbol||"_"+a,n=t.decorator.display||" (addl)";i.plotComplementers||(i.plotComplementers=[]),i.plotComplementers.push(this),this.id=t.id||a,this.defaultRenderingParameters={chartType:"line",width:1,opacity:.5},t.renderingParameters&&(this.defaultRenderingParameters=t.renderingParameters);var s=this;function o(i,a,o,l){if("err"!=function(e){if(e.quoteDriver&&t.quoteFeed){for(var i=0;i<e.quoteDriver.quoteFeeds.length;i++)if(e.quoteDriver.quoteFeeds[i].engine==t.quoteFeed)return;return"err"}}(i)&&(l||(l=a),!i.isEquationChart(a)&&(o||(o={}),!o.isComparison&&l&&-1==l.indexOf(r)))){var h=l+r,c=a+r,u=i.getRendererFromSeries(l),d=e.extend({display:a+n,name:h,symbol:c,symbolObject:{symbol:c,generator:s.id,masterSymbol:a},overChart:!1,gapDisplayStyle:!0,permanent:!0,panel:o.panel,yAxis:o.yAxis,shareYAxis:!0,loadData:!!s.quoteFeed,dependentOf:u?u.params.name:i.mainSeriesRenderer.params.name},s.renderingParameters);d.color||(d.color=o.color||"auto"),i.addSeries(h,d,(function(t,e){t&&i.removeSeries(h,i.chart),i.chart.seriesRenderers[h]&&(i.chart.seriesRenderers[h].params.display=d.display)}))}}function l(t,e,i){e&&-1==e.indexOf(r)&&t.removeSeries(e+r,i)}function h(t){"master"==t.action?(t.prevSymbol||(t.prevSymbol=t.symbol),l(t.stx,t.prevSymbol,t.stx.chart),o(t.stx,t.symbol)):"add-series"==t.action?(l(t.stx,t.id,t.stx.chart),o(t.stx,t.symbol,t.parameters,t.id)):"remove-series"==t.action&&l(t.stx,t.id,t.stx.chart)}i.addEventListener("symbolChange",h),i.addEventListener("symbolImport",h),this.resetRenderingParameters=function(){this.renderingParameters=this.defaultRenderingParameters},this.setQuoteFeed=function(t){if(t.quoteFeed&&t.behavior){var a=e.clone(t.behavior);a.generator=this.id;var r=t.filter;i.attachQuoteFeed(t.quoteFeed,a,(function(t){return!(r&&!r(t))&&t.symbolObject.generator==a.generator})),this.quoteFeed=t.quoteFeed}},this.setQuoteFeed(t),this.resetRenderingParameters()}},L=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.RangeSlider=e.RangeSlider||function(t){var i=t.stx;i.slider=this;var a=t.height?t.height:95,r=t.chartContainer?$(t.chartContainer):$(t.stx.container),n=$('<div class="ciq-chart"></div>'),s=$('<div class="chartContainer"></div>');n.insertAfter(r.parent()).append(s),n.css("height",a+"px").css("padding-top","5px").hide(),s.css("height","100%"),s.prop("dimensionlessCanvas",!0);var o=this.slider=new e.ChartEngine({container:s[0],preferences:{labels:!1,whitespace:0}});o.xaxisHeight=30,o.manageTouchAndMouse=!1,o.minimumCandleWidth=0,o.container.style.cursor="ew-resize";var l=o.chart.panel.yAxis;l.drawCurrentPriceLabel=!1,Object.defineProperty(l,"position",{get:function(){return i.slider.yAxisPosition||i.chart.panel.yAxis.position},set:function(t){i.slider.yAxisPosition=t}}),Object.defineProperty(l,"width",{get:function(){return 0===i.slider.yAxisWidth?0:i.slider.yAxisWidth||i.chart.panel.yAxis.width},set:function(t){i.slider.yAxisWidth=t}}),e.extend(l,t.yAxis),o.chart.baseline.userLevel=!1,o.controls.home&&(o.controls.home.style.width=0),o.initializeChart();var h=o.chart.panel.subholder,c="".concat(t.menuContextClass&&"."+t.menuContextClass||"body"," .rangeslider-ui");e.addInternalStylesheet("".concat(c," { display: inherit }"),c),this.updateStyles=function(t,e,a){i.setStyle(t,e,a),this.style=i.canvasStyle("stx_range_slider shading")},this.display=function(t){if(i.layout.rangeSlider!==t)return i.layout.rangeSlider=t,void i.changeOccurred("layout");n[t?"show":"hide"](),i.resizeChart(),$(window).resize(),t&&(o.resizeChart(),o.initializeChart(),o.draw(),this.drawSlider())},this.setSymbol=function(t){o.chart.panel.display=o.chart.symbol=t,o.setMainSeriesRenderer(),o.resizeChart(),this.adjustRange(i.chart),o.draw(),this.drawSlider()},this.acceptLayoutChange=function(t){var a=!1;o.layout.rangeSlider!==t.rangeSlider&&i.slider.display(t.rangeSlider);["chartType","aggregationType","periodicity","interval","timeUnit","chartScale","rangeSlider","flipped","extended","marketSessions","kagi","rangebars","renko","priceLines","pandf"].forEach((function(i){e.equals(o.layout[i],t[i])||(o.layout[i]=t[i],a=!0)})),n.is(":visible")&&a&&(o.setMainSeriesRenderer(),o.draw(),this.drawSlider())},this.adjustRange=function(t){if(t.dataSet){var e=o.chart;if(e.width){var a=0,r=0;if(i.quoteDriver){var n={symbol:t.symbol,symbolObject:t.symbolObject,interval:i.layout.interval};"month"!=n.interval&&"week"!=n.interval||i.dontRoll||(n.interval="day");var s=i.quoteDriver.getQuoteFeed(n).behavior;s&&s.bufferSize&&(t.moreAvailable&&(a=s.bufferSize),i.isHistoricalMode()&&(r=s.bufferSize))}e.baseline.defaultLevel=t.baseline.actualLevel,e.scroll=Math.max(0,t.dataSet.length-i.tickFromDate(t.endPoints.begin)-a)+1,e.maxTicks=e.scroll-r+1,o.layout.candleWidth=e.width/e.maxTicks}}},this.copyData=function(t){if(t.dataSet){var e=o.chart;e.masterData=o.masterData=t.masterData,e.dataSet=t.dataSet,e.state=t.state,o.draw(),this.drawSlider()}},this.calculateYAxisPosition=function(){var t=o.chart.panel;o.getYAxisCurrentPosition(t.yAxis,t)!=t.yAxis.position&&o.calculateYAxisPositions()},this.drawSlider=function(){if(n.is(":visible")&&i.chart.dataSet&&i.chart.dataSet.length){var t=this.style;t||(t=this.style=i.canvasStyle("stx_range_slider shading"));var e=i.chart.panel,a=o.chart.context,r=o.chart.segmentImage||[],s=o.layout.candleWidth/2,l=o.tickLeft=Math.max(i.tickFromPixel(e.left+s),0),c=o.tickRight=Math.min(i.tickFromPixel(e.right-s),i.chart.dataSet.length-1),u=o.pixelLeft=o.pixelFromTick(l)-(r[l]?r[l].candleWidth/2:s),d=o.pixelRight=o.pixelFromTick(c)+(r[c]?r[c].candleWidth/2:s),p=h.offsetLeft,f=p+h.offsetWidth;a.save(),a.beginPath(),a.fillStyle=t.backgroundColor,a.fillRect(p,h.offsetTop,u-p,h.offsetHeight),a.fillRect(f,h.offsetTop,d-f,h.offsetHeight),a.strokeStyle=t.borderTopColor,a.lineWidth=parseInt(t.borderWidth,10),a.moveTo(u,h.offsetTop),a.lineTo(u,h.offsetTop+h.offsetHeight),a.moveTo(d,h.offsetTop),a.lineTo(d,h.offsetTop+h.offsetHeight),a.stroke(),a.beginPath(),a.lineWidth=parseInt(t.width,10),a.lineCap="round",a.moveTo(u,h.offsetTop+h.offsetHeight/4),a.lineTo(u,h.offsetTop+3*h.offsetHeight/4),a.moveTo(d,h.offsetTop+h.offsetHeight/4),a.lineTo(d,h.offsetTop+3*h.offsetHeight/4),a.stroke(),a.restore()}},i.addEventListener("layout",(function(t){t.stx.slider.acceptLayoutChange(t.stx.layout)})),i.addEventListener("preferences",(function(t){var i=t.stx.preferences.language;e.I18N&&o.preferences.language!=i&&e.I18N.localize(o,i),o.preferences.language=i,o.draw()})),i.addEventListener("symbolChange",(function(t){"master"==t.action&&t.stx.slider.setSymbol(t.symbol)})),i.addEventListener("symbolImport",(function(t){"master"==t.action&&t.stx.slider.setSymbol(t.symbol),t.stx.slider.acceptLayoutChange(t.stx.layout)})),i.addEventListener("theme",(function(t){if(o.clearPixelCache(),o.styles={},o.chart.container.style.backgroundColor="",e.ThemeHelper){var i=new e.ThemeHelper({stx:t.stx});i.params.stx=o,i.update()}})),i.append("createDataSet",(function(){this.slider.adjustRange(this.chart),this.slider.copyData(this.chart)})),i.append("draw",(function(){n.is(":visible")&&o.chart.dataSet&&(this.slider.adjustRange(this.chart),this.slider.calculateYAxisPosition(),o.draw(),this.slider.drawSlider())})),i.prepend("resizeChart",(function(){var t=r.parent(),e=t.parent(),i=(t.height(),r.height(),e.height());e.find(".chartContainer").each((function(){this!==r[0]&&$(this).is(":visible")&&(i-=$(this).parent().outerHeight(!0))})),t.height(i),this.layout.rangeSlider?(n.show(),o.resizeChart(),o.initializeChart(),o.draw(),this.slider.drawSlider()):n.hide()})),$(h).on("mousedown touchstart pointerdown",(function(t){var a=t.offsetX;if(a||0===a||(a=t.originalEvent.layerX),a||0===a){var r=$(o);r.prop("startDrag",a).prop("startPixelLeft",o.pixelLeft).prop("startPixelRight",o.pixelRight);var n=i.slider.style;n||(n=i.slider.style=i.canvasStyle("stx_range_slider shading"));var s=parseInt(n.borderLeftWidth,10);(a+=this.offsetLeft)<o.pixelRight-s&&r.prop("needsLeft",!0),a>o.pixelLeft+s&&r.prop("needsRight",!0),e.touchDevice||t.target.classList.add("stx-drag-chart")}})),$(h).on("mouseup mouseout touchend pointerup",(function(t){t.target.classList.remove("stx-drag-chart");var e=$(o);o.container.style.cursor="ew-resize",e.prop("startDrag",null).prop("needsLeft",!1).prop("needsRight",!1)})),$(h).on("mousemove touchmove pointermove",(function(t){var e=$(o),a=e.prop("startDrag");if(a||0===a){var r=t.originalEvent.touches,n=r&&r.length?o.backOutX(r[0].pageX)-t.target.offsetLeft:t.offsetX;if(n||0===n){o.container.style.cursor="grab",n-=a;var s=o.tickLeft,l=o.tickRight,h=e.prop("startPixelLeft"),c=e.prop("startPixelRight"),u=e.prop("needsLeft"),d=e.prop("needsRight");if(u)h+n<o.chart.left&&(n=o.chart.left-h),d&&c+n>=o.chart.right&&(n=o.chart.right-c,o.isHome()||(n+=o.layout.candleWidth/2)),s=o.tickFromPixel(h+n),d&&(l=s+o.tickRight-o.tickLeft);else{if(!d)return;l=Math.min(o.tickFromPixel(c+n),i.chart.dataSet.length-1)}var p=i.chart.width/(l-s+1);l>=s&&p>=i.minimumCandleWidth&&(o.tickLeft=s,o.tickRight=l,i.chart.scroll=i.chart.dataSet.length-s,u&&d||i.setCandleWidth(p),i.micropixels=0,i.draw())}}})),this.adjustRange(i.chart),this.copyData(i.chart)}},I=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.Marker?e.Tooltip=e.Tooltip||function(t){if(e.Marker){var i=t.stx,a=t.ohl,r=t.change,n=t.volume,s=t.series,o=t.studies,l=t.showOverBarOnly,h=t.interpolation,c=t.useDataZone,u=$(i.chart.container).find("stx-hu-tooltip")[0];u||(u=$("<stx-hu-tooltip></stx-hu-tooltip>").appendTo($(i.chart.container))[0]),e.Marker.Tooltip=function(t){this.className||(this.className="CIQ.Marker.Tooltip"),t.label="tooltip",e.Marker.call(this,t)},e.inheritsFrom(e.Marker.Tooltip,e.Marker,!1),e.Marker.Tooltip.sameBar=function(t,e){return!(!t||!e)&&(+t.DT==+e.DT&&(t.Close==e.Close&&(t.Open==e.Open&&t.Volume==e.Volume)))},e.Marker.Tooltip.placementFunction=function(t){for(var i=t.stx,a=0;a<t.arr.length;a++){var r,n,s,o=t.arr[a],h=i.barFromPixel(i.cx),c=i.chart.dataSegment[h],u=!0;if("undefined"!=c&&c&&c.DT&&(r=!0,c.High&&(n=i.pixelFromPrice(c.High)),c.Low&&(s=i.pixelFromPrice(c.Low)),i.chart.highLowBars||c.Close&&(n=i.pixelFromPrice(c.Close)-15,s=i.pixelFromPrice(c.Close)+15),!l||i.cy>=n&&i.cy<=s||(u=!1)),!(i.insideChart&&i.layout.crosshair&&i.displayCrosshairs)||i.openDialog||i.activeDrawing||i.grabbingScreen||!r||!u)return o.node.style.left="-50000px",o.node.style.right="auto",void(o.lastBar={});if(e.Marker.Tooltip.sameBar(i.chart.dataSegment[h],o.lastBar)&&h!=i.chart.dataSegment.length-1)return;o.lastBar=i.chart.dataSegment[h];var d=o.lastBar.candleWidth||i.layout.candleWidth;parseInt(getComputedStyle(o.node).width,10)+i.chart.panel.left+30+d<i.backOutX(e.ChartEngine.crosshairX)?(o.node.style.left="auto",o.node.style.right=Math.round(i.container.clientWidth-i.pixelFromBar(h)+30)+"px"):(o.node.style.left=Math.round(i.pixelFromBar(h)+30)+"px",o.node.style.right="auto");var p=parseInt(getComputedStyle(o.node).height,10),f=Math.round(e.ChartEngine.crosshairY-i.top-p/2);f+p>i.height&&(f=i.height-p),f<0&&(f=0),o.node.style.top=f+"px"}var m=i.overXAxis,g=i.overYAxis;i.overXAxis=i.overYAxis=!1,i.doDisplayCrosshairs(),i.overXAxis=m,i.overYAxis=g},e.ChartEngine.prototype.append("undisplayCrosshairs",(function(){var t=this.huTooltip;if(t&&t.node){var e=$(t.node);e&&e[0]&&(e[0].style.left="-50000px",e[0].style.right="auto",t.lastBar={})}})),e.ChartEngine.prototype.append("deleteHighlighted",(function(){this.huTooltip.lastBar={},this.headsUpHR()})),e.ChartEngine.prototype.append("headsUpHR",d),e.ChartEngine.prototype.append("createDataSegment",d),i.huTooltip=new e.Marker.Tooltip({stx:i,xPositioner:"bar",chartContainer:!0,node:u})}else console.warn("CIQ.Tooltip addon requires CIQ.Marker module to be enabled.");function d(){if(this.huTooltip&&!(i.controls.crossX&&"none"==i.controls.crossX.style.display||i.controls.crossY&&"none"==i.controls.crossY.style.display)){var t=this.barFromPixel(this.cx),l=this.chart.dataSegment[t];if(l){if(!e.Marker.Tooltip.sameBar(l,this.huTooltip.lastBar)||t==this.chart.dataSegment.length-1){var u=$(this.huTooltip.node);u.find("[auto]").remove(),u.find("stx-hu-tooltip-field-value").html();var d=this.chart.panel,p=d.yAxis,f={},m=[];if(m.push({member:"DT",display:"DT",panel:d,yAxis:p}),m.push({member:"Close",display:"Close",panel:d,yAxis:p}),f.DT=f.Close=1,r&&e.ChartEngine.isDailyInterval(this.layout.interval)&&m.push({member:"Change",display:"Change",panel:d,yAxis:p}),a&&(m.push({member:"Open",display:"Open",panel:d,yAxis:p}),m.push({member:"High",display:"High",panel:d,yAxis:p}),m.push({member:"Low",display:"Low",panel:d,yAxis:p}),f.Open=f.High=f.Low=1),n&&(m.push({member:"Volume",display:"Volume",panel:null,yAxis:null}),f.Volume=1),s){var g=this.chart.seriesRenderers;for(var v in g){var y=g[v];if(y!==this.mainSeriesRenderer){d=this.panels[y.params.panel],!(p=y.params.yAxis)&&y.params.shareYAxis&&(p=d.yAxis);for(var x=0;x<y.seriesParams.length;x++){var b=y.seriesParams[x],S=b.symbol,C=b.field;S?C&&S!=C&&(S=e.createObjectChainNames(S,C)[0]):S=C;var w=b.display||b.symbol||b.field;S&&!f[w]&&(m.push({member:S,display:w,panel:d,yAxis:p,isSeries:!0}),f[w]=1)}}}}if(o)for(var k in this.layout.studies){var T=this.layout.studies[k];for(var A in p=(d=this.panels[T.panel])&&T.getYAxis(this),this.layout.studies[k].outputMap)A&&!f[A]&&(m.push({member:A,display:A,panel:d,yAxis:p}),f[A]=1);f[k+"_hist"]||(m.push({member:k+"_hist",display:k+"_hist",panel:d,yAxis:p}),m.push({member:k+"_hist1",display:k+"_hist1",panel:d,yAxis:p}),m.push({member:k+"_hist2",display:k+"_hist2",panel:d,yAxis:p}),f[k+"_hist"]=1)}for(var M=0;M<m.length;M++){var P=m[M],F=P.member,_=P.display,E="DT"==F;!E||c||e.ChartEngine.isDailyInterval(i.layout.interval)||(F="displayDate"),d=P.panel;var L=null;(p=P.yAxis)&&(d&&d===d.chart.panel?(L=Math.max(p.printDecimalPlaces,d.chart.decimalPlaces),(p.maxDecimalPlaces||0===p.maxDecimalPlaces)&&(L=Math.min(L,p.maxDecimalPlaces))):p.decimalPlaces||0===p.decimalPlaces?L=p.decimalPlaces:(p.maxDecimalPlaces||0===p.maxDecimalPlaces)&&(L=p.maxDecimalPlaces));var I=null,O=e.existsInObjectChain(l,F);O?I=O.obj[O.member]:"Change"==F&&(I=l.Close-l.iqPrevClose);var N=_.replace(/^(Result )(.*)/,"$2");if(h&&m[M].isSeries&&null==I){var H=this.valueFromInterpolation(t,N,"Close",d,p);if(null===H)break;I=H}if(!I&&0!==I||!E&&"object"===D(I)&&!I.Close&&0!==I.Close){var R=u.find('stx-hu-tooltip-field[field="'+N+'"]');if(R.length)""!==R.find("stx-hu-tooltip-field-name").html()&&R.find("stx-hu-tooltip-field-value").html("n/a")}else{var z="";(I.Close||0===I.Close)&&(I=I.Close),I.constructor==Number?z=p?p.originalPriceFormatter&&p.originalPriceFormatter.func?p.originalPriceFormatter.func(this,d,I,L):p.priceFormatter&&p.priceFormatter!=e.Comparison.priceFormat?p.priceFormatter(this,d,I,L):this.formatYAxisPrice(I,d,L,p):I:I.constructor==Date?E&&this.controls.floatDate&&this.controls.floatDate.innerHTML?z=this.chart.xAxis.noDraw?"N/A":e.displayableDate(this,d.chart,I):(z=e.yyyymmdd(I),e.ChartEngine.isDailyInterval(this.layout.interval)||(z+=" "+I.toTimeString().substr(0,8))):z=I;var j=u.find('stx-hu-tooltip-field[field="'+N+'"]');if(j.length){j.find("stx-hu-tooltip-field-value").html(z);var V=j.find("stx-hu-tooltip-field-name");""===V.html()&&V.html(this.translateIf(N))}else $("<stx-hu-tooltip-field auto></stx-hu-tooltip-field>").append($("<stx-hu-tooltip-field-name>"+this.translateIf(N)+"</stx-hu-tooltip-field-name>")).append($("<stx-hu-tooltip-field-value>"+z+"</stx-hu-tooltip-field-value>")).appendTo(u)}}this.huTooltip.render()}}else this.positionMarkers()}}}:console.error("tooltip addon requires first activating markers feature.")},O=x.c;"undefined"!=typeof __TREE_SHAKE__&&__TREE_SHAKE__||(O||x.c).activateImports(T,A,M,P,F,_,E,L,I,null)},325:function(t,e,i){"use strict";(function(t){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i.d(e,"c",(function(){return D})),i.d(e,"d",(function(){return T})),i.d(e,"e",(function(){return A})),i.d(e,"a",(function(){return M})),i.d(e,"b",(function(){return P}));var r,n,s,o,l,h,c,u,d,p,f,m,g,v,y;function x(){}function b(){}function S(){}function C(){}function w(){}x.W=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"HEmNE",{get:function(){for(;;)return this},configurable:!0}),(e=HEmNE).jw0wL=e,i=4;break;case 4:i="undefined"==typeof jw0wL?3:9;break;case 9:delete e.jw0wL,delete Object.prototype.HEmNE,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="o0",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="Y",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(x.W),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}for(var a=2;28!==a;)switch(a){case 33:var r=function(t,e,i,a){for(var r=2;5!==r;)switch(r){case 2:var s=[arguments];o(n[0][0],s[0][0],s[0][1],s[0][2],s[0][3]),r=5}};a=32;break;case 29:r(s,"charCodeAt",n[8],n[63]),a=28;break;case 2:var n=[arguments];n[4]="I",n[2]="",n[6]="U",a=3;break;case 3:n[2]="jj",n[7]="",n[7]="5",n[9]="",n[9]="",n[9]="N",n[5]="",a=12;break;case 30:r(s,"substring",n[8],n[69]),a=29;break;case 12:n[5]="j",n[1]="",n[1]="a5",n[8]=5,a=19;break;case 19:n[8]=1,n[3]=0,n[63]=n[1],n[63]+=n[5],a=15;break;case 31:r(e,"fromCharCode",n[3],n[25]),a=30;break;case 15:n[63]+=n[5],n[69]=n[9],n[69]+=n[7],n[69]+=n[2],a=24;break;case 24:n[25]=n[6],n[25]+=n[7],n[25]+=n[2],n[68]=n[4],a=35;break;case 32:r(i,"String",n[3],n[68]),a=31;break;case 35:n[68]+=n[7],n[68]+=n[2],a=33}function s(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}function o(t,e,i,a,r){for(var n=2;8!==n;)switch(n){case 2:var s=[arguments];s[9]="",s[9]="ty",s[6]="defineP",n=3;break;case 3:s[5]="roper";try{for(var o=2;8!==o;)switch(o){case 2:s[1]={},s[2]=(0,s[0][1])(s[0][0]),s[8]=[s[2],s[2].prototype][s[0][3]],o=4;break;case 4:s[1].value=s[8][s[0][2]];try{for(var l=2;3!==l;)switch(l){case 2:s[7]=s[6],s[7]+=s[5],s[7]+=s[9],s[0][0].Object[s[7]](s[8],s[0][4],s[1]),l=3}}catch(t){}s[8][s[0][4]]=s[1].value,o=8}}catch(t){}n=8}}}(x.W),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}for(var i=2;26!==i;)switch(i){case 16:var a=function(t,e,i,a){for(var n=2;5!==n;)switch(n){case 2:var o=[arguments];s(r[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),n=5}};i=15;break;case 15:a(e,"replace",r[7],r[8]),i=27;break;case 27:a(n,"map",r[7],r[2]),i=26;break;case 2:var r=[arguments];r[1]="",r[1]="H",r[5]="",i=3;break;case 3:r[5]="W5",r[6]="",r[6]="HH",r[4]="",i=6;break;case 6:r[4]="5",r[3]="",r[3]="z",r[7]=1,i=11;break;case 11:r[2]=r[3],r[2]+=r[4],r[2]+=r[6],r[8]=r[5],i=18;break;case 18:r[8]+=r[1],r[8]+=r[1],i=16}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];e=1;break;case 1:return i[0][0].Array}}function s(t,e,i,a,r){for(var n=2;13!==n;)switch(n){case 9:s[1]="",s[1]="de",s[3]=6,s[3]=8,n=14;break;case 2:var s=[arguments];s[8]="",s[8]="ineProperty",s[4]="",s[4]="f",n=9;break;case 14:try{for(var o=2;8!==o;)switch(o){case 2:s[9]={},s[6]=(0,s[0][1])(s[0][0]),s[5]=[s[3],s[6].prototype][s[0][3]],s[9].value=s[5][s[0][2]];try{for(var l=2;3!==l;)switch(l){case 2:s[2]=s[1],s[2]+=s[4],s[2]+=s[8],s[0][0].Object[s[2]](s[5],s[0][4],s[9]),l=3}}catch(t){}s[5][s[0][4]]=s[9].value,o=8}}catch(t){}n=13}}}(x.W),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}function a(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}for(var r=2;70!==r;)switch(r){case 62:n[19]+=n[56],n[19]+=n[20],n[57]=n[3],n[57]+=n[4],r=58;break;case 3:n[2]="V",n[4]="_a",n[3]="",n[3]="_",n[8]="",n[8]="b",r=13;break;case 73:s(a,n[78],n[98],n[94]),r=72;break;case 2:var n=[arguments];n[5]="",n[5]="bstract",n[4]="",r=3;break;case 31:n[41]="",n[41]="5P",n[97]="",n[97]="C",r=44;break;case 71:s(l,"apply",n[40],n[68]),r=70;break;case 13:n[6]="",n[6]="idual",n[9]="s",n[7]="g",r=20;break;case 36:n[50]+=n[67],n[95]=n[43],n[95]+=n[93],n[95]+=n[83],r=51;break;case 16:n[56]="5",n[49]="",n[49]="Z",n[93]="",n[93]="tim",r=24;break;case 20:n[1]="",n[1]="__re",n[20]="PP",n[56]="",r=16;break;case 75:s(a,n[57],n[98],n[19]),r=74;break;case 44:n[40]=2,n[40]=1,n[98]=0,n[68]=n[97],r=40;break;case 58:n[57]+=n[5],n[62]=n[2],n[62]+=n[56],n[62]+=n[20],r=77;break;case 47:n[78]+=n[9],n[78]+=n[6],n[89]=n[7],n[89]+=n[56],n[89]+=n[20],n[19]=n[8],r=62;break;case 77:var s=function(t,e,i,a){for(var r=2;5!==r;)switch(r){case 2:var s=[arguments];o(n[0][0],s[0][0],s[0][1],s[0][2],s[0][3]),r=5}};r=76;break;case 24:n[83]="ize",n[43]="",n[43]="",n[43]="__op",r=35;break;case 35:n[36]="c",n[67]="",n[67]="",n[67]="P",r=31;break;case 40:n[68]+=n[41],n[68]+=n[67],n[50]=n[36],n[50]+=n[41],r=36;break;case 76:s(i,"test",n[40],n[62]),r=75;break;case 51:n[94]=n[49],n[94]+=n[56],n[94]+=n[20],n[78]=n[1],r=47;break;case 72:s(a,n[95],n[98],n[50]),r=71;break;case 74:s(e,"push",n[40],n[89]),r=73}function o(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 2:var s=[arguments];s[5]="",s[5]="rty",s[3]="",s[3]="Prope",n=9;break;case 9:s[8]="",s[8]="define";try{for(var o=2;8!==o;)switch(o){case 2:s[2]={},o=1;break;case 1:s[1]=(0,s[0][1])(s[0][0]),s[9]=[s[1],s[1].prototype][s[0][3]],s[2].value=s[9][s[0][2]],o=3;break;case 3:try{for(var l=2;3!==l;)switch(l){case 5:s[7]+=s[5],s[0][0].Object[s[7]](s[9],s[0][4],s[2]),l=3;break;case 2:s[7]=s[8],s[7]+=s[3],l=5}}catch(t){}s[9][s[0][4]]=s[2].value,o=8}}catch(t){}n=6}}function l(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}}(x.W),x.D2C=function(){return"function"==typeof x.B2C.t9?x.B2C.t9.apply(x.B2C,arguments):x.B2C.t9},x.V2C=function(){return"function"==typeof x.B2C.a9?x.B2C.a9.apply(x.B2C,arguments):x.B2C.a9},x.N9=function(){return"function"==typeof x.B9.m9?x.B9.m9.apply(x.B9,arguments):x.B9.m9},x.d9=function(){return"function"==typeof x.B9.m9?x.B9.m9.apply(x.B9,arguments):x.B9.m9},x.j0=function(){return"function"==typeof x.F0.H7?x.F0.H7.apply(x.F0,arguments):x.F0.H7},x.e2C=function(){return"function"==typeof x.B2C.t9?x.B2C.t9.apply(x.B2C,arguments):x.B2C.t9},x.p9=function(){return"function"==typeof x.B9.A9?x.B9.A9.apply(x.B9,arguments):x.B9.A9},x.I9=function(){return"function"==typeof x.B9.A9?x.B9.A9.apply(x.B9,arguments):x.B9.A9},x.B9={A9:function(){var t,e=arguments;switch(r){case 9:t=e[1]+e[0];break;case 8:t=e[1]^e[0];break;case 3:t=e[0]/e[1];break;case 4:t=e[2]-e[0]-e[1]+e[3];break;case 13:t=e[0]<<e[1];break;case 0:t=e[0]*e[1];break;case 1:t=e[0]&e[1];break;case 7:t=(e[1]^e[0])/e[2];break;case 6:t=e[3]/e[0]/e[2]*e[1];break;case 2:t=e[0]|e[1];break;case 10:t=(e[2]+e[3])/e[1]*e[0];break;case 11:t=e[0]%e[1];break;case 5:t=e[1]-e[0];break;case 12:t=e[0]*(e[3]-e[2])-e[1]}return t},m9:function(t){r=t}},x.o1F=function(){for(var t=2;9!==t;)switch(t){case 2:var e=[arguments];e[9]=void 0,t=5;break;case 5:return e[3]={},e[3].X0P=function(){for(var t=2;90!==t;)switch(t){case 58:i[13]=0,t=57;break;case 6:i[8]={},i[8].D82=["I52"],i[8].a52=function(){return"function"==typeof b5PP},i[3]=i[8],i[1]={},i[1].D82=["J52"],t=20;break;case 72:i[82].g5PP(i[99]),t=71;break;case 36:i[83]=i[49],i[6].g5PP(i[3]),i[6].g5PP(i[44]),i[6].g5PP(i[83]),t=51;break;case 67:return e[9]=63,23;case 20:i[1].a52=function(){return!/\u0030\x78\u0036\u0031/.V5PP(function(){return String.fromCharCode(97)}+[])},i[2]=i[1],i[4]={},i[4].D82=["J52"],i[4].a52=function(){return!/\u0028\x5b/.V5PP(function(){return[1,2,3,4,5].concat([5,6,7,8])}+[])},i[5]=i[4],t=27;break;case 42:i[75].D82=["J52"],i[75].a52=function(){return!/(\x5b|\u005d)/.V5PP(function(){return["a","a"].join()}+[])},i[68]=i[75],i[49]={},i[49].D82=["I52"],i[49].a52=function(){return"function"==typeof c5PP},t=36;break;case 68:t=68;break;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 4:a[8]={},a[6]=[],a[5]=0,e=8;break;case 6:a[9]=a[0][0][a[5]],e=14;break;case 24:a[5]++,e=16;break;case 18:a[7]=!1,e=17;break;case 11:a[8][a[9][i[18]]].t+=!0,e=10;break;case 13:a[8][a[9][i[18]]]=function(){for(var t=2;9!==t;)switch(t){case 4:return e[6].t=0,e[6];case 2:var e=[arguments];e[6]={},e[6].h=0,t=4}}.C5PP(this,arguments),e=12;break;case 10:e=a[9][i[96]]===i[93]?20:19;break;case 5:return;case 20:a[8][a[9][i[18]]].h+=!0,e=19;break;case 26:e=a[3]>=.5?25:24;break;case 1:e=0===a[0][0].length?5:4;break;case 16:e=a[5]<a[6].length?15:23;break;case 23:return a[7];case 19:a[5]++,e=7;break;case 17:a[5]=0,e=16;break;case 2:var a=[arguments];e=1;break;case 14:e=void 0===a[8][a[9][i[18]]]?13:11;break;case 15:a[4]=a[6][a[5]],a[3]=a[8][a[4]].h/a[8][a[4]].t,e=26;break;case 7:e=a[5]<a[0][0].length?6:18;break;case 12:a[6].g5PP(a[9][i[18]]),e=11;break;case 25:a[7]=!0,e=24;break;case 8:a[5]=0,e=7}}(i[82])?68:67;break;case 71:i[66]++,t=76;break;case 1:t=e[9]?5:4;break;case 61:i[96]="s52",i[87]="a52",i[18]="T82",t=58;break;case 77:i[66]=0,t=76;break;case 51:i[6].g5PP(i[60]),i[6].g5PP(i[2]),i[6].g5PP(i[33]),i[6].g5PP(i[7]),i[6].g5PP(i[5]),i[6].g5PP(i[68]),i[6].g5PP(i[59]),t=65;break;case 76:t=i[66]<i[54][i[55]].length?75:70;break;case 65:i[82]=[],i[93]="F82",i[86]="c82",i[55]="D82",t=61;break;case 28:i[71].a52=function(){return/\x78\u0078/.V5PP(function(){return"x".repeat(2)}+[])},t=44;break;case 2:var i=[arguments];t=1;break;case 23:i[38]={},i[38].D82=["I52"],i[38].a52=function(){return"function"==typeof Z5PP},t=35;break;case 75:i[99]={},i[99][i[18]]=i[54][i[55]][i[66]],i[99][i[96]]=i[41],t=72;break;case 44:i[33]=i[71],i[75]={},t=42;break;case 5:return 52;case 4:i[6]=[],i[9]={},i[9].D82=["J52"],i[9].a52=function(){return/\x31\u0039\x32/.V5PP(function(){!function(t){for(var e=0;e<20;e++)t+=e}(2)}+[])},i[7]=i[9],t=6;break;case 56:i[54]=i[6][i[13]],t=55;break;case 35:i[44]=i[38],i[10]={},i[10].D82=["J52"],i[10].a52=function(){return!/\x7c/.V5PP(function(){return"aaaa|a".substr(0,3)}+[])},i[59]=i[10],i[71]={},i[71].D82=["J52"],t=28;break;case 57:t=i[13]<i[6].length?56:69;break;case 55:try{i[41]=i[54][i[87]]()?i[93]:i[86]}catch(t){i[41]=i[86]}t=77;break;case 70:i[13]++,t=57;break;case 27:i[94]={},i[94].D82=["I52"],i[94].a52=function(){var t=!1,e=[];try{for(var i in console)e.g5PP(i);t=0===e.length}catch(t){}return t},i[60]=i[94],t=23}},e[3]}}(),x.j82=function(){return"function"==typeof x.h82.Z2H?x.h82.Z2H.apply(x.h82,arguments):x.h82.Z2H},x.r82=function(){return"function"==typeof x.h82.Z2H?x.h82.Z2H.apply(x.h82,arguments):x.h82.Z2H},x.G1F=function(){return"function"==typeof x.o1F.X0P?x.o1F.X0P.apply(x.o1F,arguments):x.o1F.X0P},x.L0=function(){return"function"==typeof x.F0.H7?x.F0.H7.apply(x.F0,arguments):x.F0.H7},x.b1F=function(){return"function"==typeof x.o1F.X0P?x.o1F.X0P.apply(x.o1F,arguments):x.o1F.X0P},x.n2C=function(){return"function"==typeof x.B2C.a9?x.B2C.a9.apply(x.B2C,arguments):x.B2C.a9},x.h82=function(t){for(var e=2;10!==e;)switch(e){case 5:i=x.W,e=4;break;case 1:e=s--?4:5;break;case 13:e=s--?11:12;break;case 2:var i,r,n,s;e=1;break;case 12:var o,l=0;e=11;break;case 14:t=t.z5HH((function(t){for(var e=2;13!==e;)switch(e){case 6:return;case 5:a="",e=4;break;case 1:e=s--?4:5;break;case 2:var a;e=1;break;case 4:var r=0;e=3;break;case 3:e=r<t.length?9:7;break;case 9:a+=i[n][h](t[r]+105),e=8;break;case 14:return a;case 8:r++,e=3;break;case 7:e=a?14:6}})),e=13;break;case 7:n=r.W5HH(new i[c]("^['-|]"),"S"),e=6;break;case 4:var h="fromCharCode",c="RegExp";e=3;break;case 3:e=s--?8:9;break;case 6:e=s--?13:14;break;case 9:r=a(h),e=8;break;case 11:return{Z2H:function(e){for(var a=2;6!==a;)switch(a){case 9:l=r+6e4,a=8;break;case 2:var r=(new i[t[0]])[t[1]]();a=1;break;case 4:o=u(r),a=3;break;case 1:a=r>l?5:8;break;case 8:return function(a,r){for(var n=2;10!==n;)switch(n){case 8:var s=i[r[4]](a[r[2]](h),16)[r[3]](2),o=s[r[2]](s[r[5]]-1);n=6;break;case 9:n=h<a[r[5]]?8:11;break;case 3:var l,h=0;n=9;break;case 6:n=0===h?14:12;break;case 4:r=t,n=3;break;case 11:return l;case 5:n=void 0===r&&void 0!==t?4:3;break;case 1:a=e,n=5;break;case 13:h++,n=9;break;case 2:n=void 0===a&&void 0!==e?1:5;break;case 12:l^=o,n=13;break;case 14:l=o,n=13}}(void 0,void 0)?o:!o;case 5:a=s--?3:4;break;case 3:a=s--?8:9}}};case 8:e=s--?6:7}function u(e){for(var a=2;15!==a;)switch(a){case 17:r=e-c>n,a=19;break;case 12:a=s--?10:11;break;case 2:var r,n,o,l,h,c,u;a=1;break;case 10:a=c>=0&&l>=0?20:18;break;case 1:a=s--?4:5;break;case 13:h=t[7],a=12;break;case 20:r=e-c>n&&l-e>n,a=19;break;case 5:u=i[t[4]],a=4;break;case 9:a=s--?7:8;break;case 7:a=s--?14:6;break;case 18:a=c>=0?17:16;break;case 8:o=t[6],a=7;break;case 4:a=s--?9:3;break;case 11:c=(h||0===h)&&u(h,n),a=10;break;case 19:return r;case 6:l=o&&u(o,n),a=14;break;case 3:n=28,a=9;break;case 16:r=l-e>n,a=19;break;case 14:a=s--?12:13}}}([[-37,-8,11,-4],[-2,-4,11,-21,0,4,-4],[-6,-1,-8,9,-40,11],[11,6,-22,11,9,0,5,-2],[7,-8,9,10,-4,-32,5,11],[3,-4,5,-2,11,-1],[-53,-49,-56,-7,-50,-6,-8,-6,-2],[]]),x.F0=(n=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{H7:function(t,e,i){for(var a=3432918353,r=461845907,s=i,o=-4&e,l=0;l<o;l+=4){var h=255&t.o0YY(l)|(255&t.o0YY(l+1))<<8|(255&t.o0YY(l+2))<<16|(255&t.o0YY(l+3))<<24;h=n(h,a),s=5*(s=(524287&(s^=h=n(h=(131071&h)<<15|h>>>17,r)))<<13|s>>>19)+3864292196|0}switch(h=0,e%4){case 3:h=(255&t.o0YY(o+2))<<16;case 2:h|=(255&t.o0YY(o+1))<<8;case 1:h|=255&t.o0YY(o),h=n(h,a),s^=h=n(h=(131071&h)<<15|h>>>17,r)}return s^=e,s=n(s^=s>>>16,2246822507),s=n(s^=s>>>13,3266489909),s^=s>>>16}}),x.B2C=function(){for(;;){var t,e,i=x.W;return{a9:function(t,e,i,a){for(;;)return r(t,e,i,a)},t9:function(t,e,i,a){for(;;)return r(t,e,i,a,!0)}}}function a(t){for(var e=2;7!==e;)switch(e){case 2:var i=2,a="";e=5;break;case 5:var r=0;e=4;break;case 9:r++,e=4;break;case 4:e=r<t.length?3:8;break;case 3:a+=I5jj.U5jj(t[r]-i+108),e=9;break;case 8:return a}}function r(r,n,s,o,l){for(var h=2;15!==h;)switch(h){case 9:h=o>0?8:19;break;case 4:!e&&(e=void 0!==f?f[a([-2,8,-5,-4])]:""),p=l?e:t,h=9;break;case 7:d=u.length,h=6;break;case 14:var c=p.length-r;h=13;break;case 8:u=p.N5jj(r,o),h=7;break;case 1:f=i[a([2,5,-7,-9,10,-1,5,4])],!t&&(t=void 0!==f?f[a([-2,5,9,10,4,-9,3,-5])]||" ":""),h=4;break;case 13:h=n&&c>0&&46!==p.a5jj(c-1)?12:11;break;case 2:var u,d,p,f;h=1;break;case 18:d=(u=p.N5jj(0,p.length)).length,h=16;break;case 6:case 16:return x.L0(u,d,s);case 12:return!1;case 11:return d=(u=p.N5jj(c,p.length)).length,x.L0(u,d,s);case 19:h=null===r||r<=0?18:14}}}(),x.R82=function(t){if(x.b1F(),x&&t)return x.r82(t)},x.V82=function(t){if(x.b1F(),x&&t)return x.r82(t)},x.k82=function(t){if(x.b1F(),x&&t)return x.j82(t)},x.G1F(),x.l82=function(t){if(x.b1F(),x)return x.r82(t)},x.S82=function(t){if(x.b1F(),x&&t)return x.r82(t)},s=function(t){var e,i,r=x;r.Q82=function(t){if(r.b1F(),r&&t)return r.j82(t)},r.x82=function(t){if(r&&t)return r.j82(t)},r.t82=function(t){if(r&&t)return r.j82(t)},r.e82=function(t){if(r&&t)return r.j82(t)},r.b1F(),r.p82=function(t){if(r.b1F(),r)return r.j82(t)},e=t.CIQ,i="valid",e.valid=0,e.ChartEngine.prototype.consolidatedQuote=function(t,i){var a,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H;if(this.runPrepend("consolidatedQuote",arguments))return t;if(!t||!t.length)return[];if(a=this.layout,n=this.chart,s=this,!n.market){console.log("Cannot consolidate: no market iterator available.  Please make sure market module is enabled."),o=-1275113509,l=1864122970,h=2;for(var R=1;r.L0(R.toString(),R.toString().length,73694)!==o;R++)return t;if(r.j0(h.toString(),h.toString().length,87475)!==l)return t}if(c=a.periodicity,u=a.interval,d=a.timeUnit,i||(i={}),i.periodicity&&i.interval){p=-667354293,f=1693319472,m=2;for(var z=1;r.L0(z.toString(),z.toString().length,31770)!==p;z++)c=i.periodicity,m+=2;r.L0(m.toString(),m.toString().length,96727)!==f&&(c=i.periodicity),u=i.interval,d=i.timeUnit}g=-2126785149,v=1744460600,y=2;for(var j=1;r.j0(j.toString(),j.toString().length,30015)!==g;j++)x=1,b=e.ChartEngine.isDailyInterval(u),r.d9(0),y+=r.I9("2",1);if(r.L0(y.toString(),y.toString().length,80414)!==v&&(x=3,b=e.ChartEngine.isDailyInterval(u)),!b&&n.useInflectionPointForIntraday&&(x=c),!(S=n.inflectionPoint)||S<t[0].DT){C=-1759146552,w=-1568613456,k=2;for(var V=1;r.j0(V.toString(),V.toString().length,1025)!==C;V++)S=new Date(-t[2].DT),k+=2;r.L0(k.toString(),k.toString().length,37234)!==w&&(S=new Date(+t[0].DT)),b||n.market.market_def||S.setHours(0,-S.getTimezoneOffset(),0,0)}if(D=[],T={begin:S,interval:u,multiple:c/x,timeUnit:d},"tick"==u){A=-2061365620,M=-535844539,P=2;for(var B=1;r.j0(B.toString(),B.toString().length,73604)!==A;B++)S.setHours(0,0,0,0),T={begin:S,interval:"day",multiple:1},P+=2;r.j0(P.toString(),P.toString().length,67026)!==M&&(S.setHours(1,6,3,1),T={begin:S,interval:"",multiple:3})}for(F=n.market.newIterator(e.clone(T));F.previous(x)>t[0].DT;);function W(t,i,n){var o,l,h,c,u,d,p,f,m;if(i||(i={DT:n,Date:e.yyyymmddhhmmssmmm(n),consolidatedTicks:0}),i.displayDate||s.setDisplayDate(i),r.N9(1),o=r.p9("1",2147483647),a.adj&&t.Adj_Close){r.d9(2),l=r.p9("289839275",289800363),-1381288129,h=2;for(var g=1;r.j0(g.toString(),g.toString().length,65202)!==l;g++)o=t.Adj_Close+t.Close,h+=2;-1381288129!==r.L0(h.toString(),h.toString().length,80574)&&(o=t.Adj_Close/t.Close)}if((c=t.High||t.Close)||0===c){-852425042,-841435078,u=2;for(var v=1;-852425042!==r.j0(v.toString(),v.toString().length,34557);v++)c-o<(i.High&&!Number.MAX_VALUE)&&(r.d9(3),i.High=r.I9(c,o)),u+=2;-841435078!==r.L0(u.toString(),u.toString().length,56127)&&c*o>(i.High||-Number.MAX_VALUE)&&(r.d9(0),i.High=r.p9(c,o))}for(var y in((d=t.Low||t.Close)||0===d)&&d*o<(i.Low||Number.MAX_VALUE)&&(r.N9(0),i.Low=r.I9(d,o)),((p=t.Open||t.Close)||0===p)&&(i.Open||0===i.Open||(r.N9(0),i.Open=r.p9(p,o))),void 0!==t.Volume&&(i.Volume=(i.Volume||0)+t.Volume),void 0!==t.Close&&null!==t.Close&&(i.Close=t.Close*o),void 0!==t.Adj_Close&&null!==t.Adj_Close&&(i.Adj_Close=t.Adj_Close),r.G1F(),i.ratio=o,t)f="Bi",f+="d",f+="L",f+="2",t[y]&&void 0!==t[y].Close?i[y]=W(t[y],i[y],n):i[y]?["Bid",f,"Ask","AskL2"].indexOf(y)>-1&&(i[y]=t[y]):i[y]=t[y];r.N9(0),m=-r.p9("1008051026",1);for(var x=1;r.L0(x.toString(),x.toString().length,52681)!==m;x++)return i.consolidatedTicks++,i;if(-134550905!==r.j0(2..toString(),2..toString().length,49490))return i.consolidatedTicks--,i}for(_=F.previous(x),E=F.next(x),L=0,I=0;L<t.length;)if(O="ti",O+="c",O+="k",(N=t[L]).DT<_)console.log("Warning: out-of-order quote in dataSet, disregarding: "+N.DT),L++;else{if(N.DT>=E){if(_=E,E=F.next(x),!D[I])continue}else{if(u==O&&N.consolidatedTicks>0){D[I]=N,L++;continue}if(!D[I]||"tick"!=u||D[I].consolidatedTicks<c){(H=W(N,D[I],"tick"==u?N.DT:_))&&(D[I]=H),L++;continue}}I++}return this.runAppend("consolidatedQuote",arguments),D},e[r.S82("2c4e")?"":"ChartEngine"][r.p82("1c1b")?"prototype":""][r.e82("156b")?"createDataSet":""]=function(t,n,s){r.G82=function(t){if(r.G1F(),r&&t)return r.r82(t)},r.W82=function(t){if(r)return r.j82(t)},r.L82=function(t){if(r)return r.r82(t)},r.Y82=function(t){if(r)return r.r82(t)},r.C82=function(t){if(r.G1F(),r&&t)return r.r82(t)};var o=r.t82("b1b4")?1766098353:5409671561,l=r.C82("fced")?3532378654:1109293042,h=-(r.Y82("41bf")?1296286249:2074242232),c=-(r.l82("c977")?554968831:750170748),u=-(r.x82("7de2")?891547585:548195956),d=r.k82("c571")?806581525:798798980,p=r.L82("558c")?1992035349:1037813324,f=-(r.Q82("f1df")?8421964843:2122485249),m=r.V82("1411")?1790667892:3571937518,g=r.W82("e3bb")?1490037501:5364398863,v=r.G82("18dc")?706033923:584520460,y=-(r.R82("557b")?933985971:466699801);if(r.b1F(),r.n2C(0,!1,760113)===o||r.V2C(0,!1,130766)===l||r.V2C(11,!1,219469)===h||r.V2C(0,!1,451150)===c||-148760356===r.n2C(10,!1,801721)||r.n2C(0,!1,873932)===u||r.n2C(10,!1,479124)===d||r.V2C(0,!1,397920)===p||894535860===r.V2C(11,!1,838930)||-2132886603===r.V2C(0,!1,985318)||r.V2C(10,!1,182805)===f||r.n2C(0,!1,606178)===m||r.n2C(10,!1,908324)===g||r.V2C(0,!1,303921)===v||1681054813===r.n2C(10,!1,569690)||r.V2C(0,!1,203327)===y){var x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt,st,ot,lt,ht,ct,ut;if("o","h","l","c",s||(s={}),b=[t,x=this.chart,{appending:s.appending,appendToDate:s.appendToDate}],this.runPrepend("createDataSet",b))return;C=[],w=[],k=s.appending,x.dataSet||(x.dataSet=[]),1378007307,-658702434,D=2;for(var dt=1;1378007307!==r.j0(dt.toString(),dt.toString().length,4940);dt++)T=x.dataSet.length,r.N9(1),D+=r.p9("2",2147483647);if(-658702434!==r.j0(D.toString(),D.toString().length,37624)&&(T=x.dataSet.length),k&&(C=x.dataSet),x.currentQuote=null,x.dataSet=[],k||(x.tickCache={}),(A=x.masterData)||(A=this.masterData),!A||!A.length)return void this.runAppend("createDataSet",b);if(C.length){for(M=C.pop();M.futureTick&&C.length;)M=C.pop(),T--;for((!(P=s.appendToDate)||P>M.DT)&&(P=M.DT);C.length&&!(C[C.length-1].DT<P);)C.pop();r.d9(10);var pt=r.p9(18,342,10,9);for(F=A.length-pt;F>=0&&A[F].DT>=P;)F--;-188655072,1719265733,_=2;for(var ft=1;-188655072!==r.L0(ft.toString(),ft.toString().length,4608);ft++)r.d9(11),S=A.slice(r.I9(F,5)),_+=2;1719265733!==r.j0(_.toString(),_.toString().length,95733)&&(r.N9(9),S=A.slice(r.I9(1,F)))}else S=[].concat(A);if(!function(){if(1670358787===r.V2C(0,!1,901693)||-787152361===r.n2C(0,!1,723686)||722121703===r.V2C(11,!1,363858)||1275430624===r.V2C(0,!1,301108)||1104107488===r.V2C(10,!1,150785)||233647660===r.V2C(0,!1,951394)||-1111843431===r.n2C(10,!1,245453)||-1795171007===r.n2C(0,!1,666913)||875038419===r.n2C(11,!1,536674)||389317169===r.n2C(0,!1,340876)||-1649416666===r.n2C(10,!1,359482)||-1368265603===r.n2C(0,!1,553123)||-1623094723===r.V2C(10,!1,782241)||-1046333007===r.n2C(0,!1,210936)||316695805===r.n2C(10,!1,950319)||-332879900===r.n2C(0,!1,177497)){var t,a,n,s,o,l,h,c,u;"t",a="s","o",a+="e",n=[],a+=(t="lesf").charAt(0),"p",492730181,r.d9(5),s=r.p9(0,"1855303924"),o=2;for(var d=1;492730181!==r.j0(d.toString(),d.toString().length,16572);d++){if(a+=t.charAt(3),window.top==window[a])return 0===e[i];o+=2}if(r.L0(o.toString(),o.toString().length,55613)!==s&&(r.d9(2),a/=t.charAt(r.p9("1",0)),window.top===window[a])){r.d9(12);var p=r.I9(4,1009458360,15,336486141);return e[i]!="2">>p}if(n.length){210281640,-2114420151,l=2;for(var f=1;210281640!==r.j0(f.toString(),f.toString().length,1110);f++)h=e.getHostName(document.referrer),l+=2;-2114420151!==r.L0(l.toString(),l.toString().length,40301)&&(h=e.getHostName(document.referrer)),h=e.getHostName(document.referrer),c=!1;for(var m=0;m<n.length;m++)u=n[m],-1!=h.indexOf(u)&&(c=!0);if(!c){-1070131404,1334324653,2;for(var g=1;-1070131404!==r.j0(g.toString(),g.toString().length,37079);g++)return!0;if(1334324653!==r.j0(2..toString(),2..toString().length,75414))return!1}}return 0===e[i]}}())return;if(this.transformDataSetPre&&this.transformDataSetPre(this,S),!this.chart.hideDrawings){for("pr","ojec","t","ion",E=0;E<this.drawingObjects.length;E++)"pro","jec","tion","projection"==this.drawingObjects[E].name&&e.getFn("Drawing.printProjection")(this,this.drawingObjects[E],S);this.activeDrawing&&"projection"==this.activeDrawing.name&&("Drawing.p","rintProjection",e.getFn("Drawing.printProjection")(this,this.activeDrawing,S))}for(E=0,L=-Number.MAX_VALUE,I=Number.MAX_VALUE,N=0,H=t||this.dontRoll,R=this.layout,z=e.ChartEngine.isDailyInterval(R.interval);"m","ont","h",!(N>=S.length);)if((!this.dontRoll||"week"!=R.interval&&"month"!=R.interval)&&this.extendedHours&&this.extendedHours.filter&&x.market.market_def&&(B=S[N],z?V=!x.market.isMarketDate(B.DT):(!j||j<=B.DT)&&(V=!(""===(W=x.market.getSession(B.DT))||R.marketSessions&&R.marketSessions[W]),j=x.market[V?"getNextOpen":"getNextClose"](B.DT)),V))N++;else{for(var mt in O={},S[N])O[mt]=S[N][mt];S[N]=O,O.ratio=1,R.adj&&O.Adj_Close&&(O.ratio=O.Adj_Close/O.Close),1!=O.ratio&&(O.Open&&(O.Open=Number((O.Open*O.ratio).toFixed(8))),O.Close&&(O.Close=Number((O.Close*O.ratio).toFixed(8))),O.High&&(O.High=Number((O.High*O.ratio).toFixed(8))),O.Low&&(O.Low=Number((O.Low*O.ratio).toFixed(8)))),w[E++]=S[N++]}for((R.periodicity>1||!H&&("week"==R.interval||"month"==R.interval))&&(C.length&&w.unshift(C.pop()),w=this.consolidatedQuote(w)),U={},E=0;E<w.length;E++)for(var gt in O=w[E],E>0?(O.iqPrevClose=w[E-1].Close,O.iqPrevClose||0===O.iqPrevClose||(O.iqPrevClose=w[E-1].iqPrevClose)):C.length?(O.iqPrevClose=C[C.length-1].Close,O.iqPrevClose||0===O.iqPrevClose||(O.iqPrevClose=C[C.length-1].iqPrevClose)):O.iqPrevClose=O.Close,"High"in O&&O.High>L&&(L=O.High),"Low"in O&&O.Low<I&&(I=O.Low),x.series)if("o","bje","ct",(Q=O[Y=x.series[gt].parameters.symbol])&&"object"==a(Q)){if(E>0)Q.iqPrevClose=U[gt];else if(C.length){for(var vt=C.length-1;vt>=0;vt--)if((q=C[vt][Y])&&(q.Close||0===q.Close)){Q.iqPrevClose=q.Close;break}}else Q.iqPrevClose=Q.Close;(Q.Close||0===Q.Close)&&(U[gt]=Q.Close),Q.ratio=1,R.adj&&Q.Adj_Close&&(Q.ratio=Q.Adj_Close/Q.Close),1!=Q.ratio&&(Q.Open&&(Q.Open=Number((Q.Open*Q.ratio).toFixed(8))),Q.Close&&(Q.Close=Number((Q.Close*Q.ratio).toFixed(8))),Q.High&&(Q.High=Number((Q.High*Q.ratio).toFixed(8))),Q.Low&&(Q.Low=Number((Q.Low*Q.ratio).toFixed(8))))}if(X=this.preferences.whitespace/this.layout.candleWidth,Z=x.scroll>=x.maxTicks){1620873502,450523280,G=2;for(var yt=1;1620873502!==r.j0(yt.toString(),yt.toString().length,34130);yt++)x.spanLock=!0,G+=2;450523280!==r.j0(G.toString(),G.toString().length,43017)&&(x.spanLock=!1)}if(x.defaultChartStyleConfig={type:R.chartType},(K=R.aggregationType)&&"ohlc"!=K&&(e.ChartEngine.calculateAggregation?(x.defaultChartStyleConfig.type=K,k&&x.state.aggregation||(x.state.aggregation={}),w=e.ChartEngine.calculateAggregation(this,K,w,C)):("Aggregatio","n code i","s not loaded/enabled!",console.log("Aggregation code is not loaded/enabled!"))),x.spanLock=x.scroll>0&&x.scroll<x.maxTicks-X,J=Z||x.lockScroll||x.spanLock||this.isHistoricalModeSet,$=w.length-(T-C.length),k||($=0),$&&(x.spanLock&&$+x.scroll>=x.maxTicks-X?x.spanLock=!1:(J||$<0)&&(x.scroll+=$,this.grabStartScrollX+=$,this.swipe&&(this.swipe.scroll+=$))),this.transformDataSetPost&&this.transformDataSetPost(this,w,I,L),(tt=this.maxDataSetSize)&&C.length+w.length>tt&&(C=w.length<tt?C.slice(w.length-tt):[],w=w.slice(-tt)),x.scrubbed||(x.scrubbed=[]),C.length)for(et=C[C.length-1].DT;x.scrubbed.length&&x.scrubbed[x.scrubbed.length-1].DT>et;)x.scrubbed.pop();else{-1919898920,1837908273,it=2;for(var xt=1;-1919898920!==r.j0(xt.toString(),xt.toString().length,84819);xt++)x.scrubbed=[],r.N9(2),it+=r.p9("2",0);1837908273!==r.L0(it.toString(),it.toString().length,87871)&&(x.scrubbed=[])}for(x.state.studies||(x.state.studies={}),x.state.studies.startFrom=x.scrubbed.length,at=[],E=0;E<w.length;E++)((rt=w[E]).Close||0===rt.Close||rt.DT>Date.now())&&at.push(rt);for(nt in x.scrubbed=x.scrubbed.concat(at),k&&x.state.calculations||(x.state.calculations={}),this.calculateATR(x,20,at),this.calculateMedianPrice(x,at),this.calculateTypicalPrice(x,at),this.calculateWeightedClose(x,at),this.calculateOHLC4(x,at),this.plugins)(st=this.plugins[nt]).createDataSet&&st.createDataSet(this,x,w,C.length);for(x.dataSet=C.concat(w),nt=0;nt<x.dataSet.length;nt++)x.dataSet[nt].cache={},x.dataSet[nt].tick=nt;for(x.whiteSpaceFutureTicks=0,ot=this.layout.studies,lt=x.scrubbed.length,ot&&Object.keys(ot).length&&(ht=x.state.studies.sorted||e.Studies.sortForProcessing(this),ct=this,x.state.studies.sorted=ht,ht.forEach((function(t){if(-89575763===r.n2C(0,!1,222560)||-226164811===r.n2C(0,!1,734376)||1437701043===r.n2C(11,!1,538263)||1393787131===r.n2C(0,!1,776715)||337856488===r.n2C(10,!1,269536)||2071151182===r.V2C(0,!1,552458)||1783477489===r.V2C(10,!1,232125)||-1888425553===r.n2C(0,!1,867075)||476188979===r.V2C(11,!1,643403)||636147115===r.V2C(0,!1,400250)||-316407483===r.n2C(10,!1,110247)||1666370578===r.V2C(0,!1,179470)||-243248536===r.V2C(10,!1,348340)||-1198039===r.V2C(0,!1,645516)||1794743641===r.n2C(10,!1,258022)||-1018780458===r.V2C(0,!1,440411)){var e;t.startFrom=x.state.studies.startFrom,t.error=null,-1227605404,1834004226,r.d9(13),e=r.I9("2",2139701568);for(var i=1;-1227605404!==r.j0(i.toString(),i.toString().length,86820);i++)t.study&&t.study.calculateFN&&t.study.calculateFN(ct,t),e+=2;1834004226!==r.L0(e.toString(),e.toString().length,69893)&&(t.study||t.study.calculateFN)&&t.study.calculateFN(ct,t)}}))),nt=lt;nt<x.scrubbed.length;nt++)(ut=x.scrubbed[nt]).cache={},ut.tick=x.dataSet.length,x.dataSet.push(ut);this.drawingObjects.length&&this.adjustDrawings(),this.establishMarkerTicks&&this.establishMarkerTicks(),this.runAppend("createDataSet",b)}},"function"==typeof Symbol&&Symbol.for("CIQ.watermark")},b.f5n=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"axHLI",{get:function(){for(;;)return this},configurable:!0}),(e=axHLI).EWch0=e,i=4;break;case 4:i="undefined"==typeof EWch0?3:9;break;case 9:delete e.EWch0,delete Object.prototype.axHLI,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="V3",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="U",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(b.f5n),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}function a(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}function r(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}for(var n=2;71!==n;)switch(n){case 54:s[48]+=s[41],s[48]+=s[93],s[91]=s[27],s[91]+=s[38],s[91]+=s[38],n=49;break;case 6:s[1]="abst",s[2]="",s[2]="6",s[9]="J",n=11;break;case 60:s[94]+=s[66],s[94]+=s[38],s[28]=s[8],s[28]+=s[2],s[28]+=s[6],n=55;break;case 29:s[47]="L",s[97]=2,s[97]=1,s[43]=0,n=42;break;case 76:o(r,"push",s[97],s[94]),n=75;break;case 3:s[5]="N",s[3]="",s[3]="ract",s[1]="",n=6;break;case 27:s[41]="",s[41]="miz",s[93]="e",s[29]="",s[29]="",n=22;break;case 2:var s=[arguments];s[8]="",s[8]="o",s[5]="",n=3;break;case 77:o(a,"test",s[97],s[28]),n=76;break;case 18:s[14]="",s[14]="__",s[27]="",s[27]="P6",n=27;break;case 64:s[89]=s[14],s[89]+=s[1],s[89]+=s[3],s[94]=s[5],n=60;break;case 73:o(i,s[48],s[43],s[21]),n=72;break;case 74:o(i,s[84],s[43],s[91]),n=73;break;case 22:s[29]="__opti",s[62]="m6",s[38]="",s[38]="",n=33;break;case 72:o(e,"apply",s[97],s[35]),n=71;break;case 11:s[6]="MM",s[7]="",s[7]="ual",s[4]="resid",n=18;break;case 42:s[35]=s[47],s[35]+=s[66],s[35]+=s[38],s[21]=s[62],s[21]+=s[38],s[21]+=s[38],s[48]=s[29],n=54;break;case 55:var o=function(t,e,i,a){for(var r=2;5!==r;)switch(r){case 2:var n=[arguments];l(s[0][0],n[0][0],n[0][1],n[0][2],n[0][3]),r=5}};n=77;break;case 75:o(i,s[89],s[43],s[71]),n=74;break;case 49:s[84]=s[14],s[84]+=s[4],s[84]+=s[7],s[71]=s[9],s[71]+=s[2],s[71]+=s[6],n=64;break;case 33:s[38]="M",s[66]="",s[66]="6M",s[47]="",n=29}function l(t,e,i,a,r){for(var n=2;7!==n;)switch(n){case 2:var s=[arguments];s[5]="",s[5]="ineProperty",s[3]="",n=3;break;case 3:s[3]="ef",s[1]="d";try{for(var o=2;8!==o;)switch(o){case 2:s[7]={},s[4]=(0,s[0][1])(s[0][0]),s[2]=[s[4],s[4].prototype][s[0][3]],s[7].value=s[2][s[0][2]],o=3;break;case 3:try{for(var l=2;3!==l;)switch(l){case 2:s[9]=s[1],s[9]+=s[3],s[9]+=s[5],s[0][0].Object[s[9]](s[2],s[0][4],s[7]),l=3}}catch(t){}s[2][s[0][4]]=s[7].value,o=8}}catch(t){}n=7}}}(b.f5n),b.y1x=function(){return"function"==typeof b.f1x.o6n?b.f1x.o6n.apply(b.f1x,arguments):b.f1x.o6n},b.l94={J84:function(){var t,e=arguments;switch(o){case 8:t=e[1]+e[0]+e[2];break;case 4:t=e[0]/e[1];break;case 7:t=e[1]-e[2]-e[0];break;case 9:t=e[0]*e[1];break;case 22:t=(e[4]-e[1])*e[0]*e[3]-e[2];break;case 15:t=e[0]*e[1]*e[2]-e[3];break;case 18:t=e[1]^e[0];break;case 13:t=(e[1]-e[3]*e[0])/-e[2];break;case 11:t=(e[0]-e[1])/e[2];break;case 17:t=e[0]|e[1];break;case 2:t=-e[0]*e[3]-e[2]-e[4]+e[1];break;case 6:t=e[1]+e[0]-e[2];break;case 16:t=e[0]/(e[1]*e[2]);break;case 5:t=e[1]+e[0];break;case 3:t=e[0]&e[1];break;case 1:t=e[1]-e[0];break;case 21:t=e[2]+e[1]*e[0];break;case 14:t=e[0]<<e[1];break;case 20:t=e[1]*e[2]/e[0];break;case 0:t=e[0]==e[1];break;case 19:t=e[0]-e[2]+e[1];break;case 10:t=e[1]!=e[0];break;case 12:t=(e[0]+e[3]+e[2])/e[1]}return t},N84:function(t){o=t}},b.v94=function(){return"function"==typeof b.l94.N84?b.l94.N84.apply(b.l94,arguments):b.l94.N84},b.k94=function(){return"function"==typeof b.l94.J84?b.l94.J84.apply(b.l94,arguments):b.l94.J84},b.w1x=function(){return"function"==typeof b.f1x.o6n?b.f1x.o6n.apply(b.f1x,arguments):b.f1x.o6n},b.f1x=(l=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{o6n:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.V3UU(n)|(255&t.V3UU(n+1))<<8|(255&t.V3UU(n+2))<<16|(255&t.V3UU(n+3))<<24;s=l(s,3432918353),a=5*(a=(524287&(a^=s=l(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.V3UU(r+2))<<16;case 2:s|=(255&t.V3UU(r+1))<<8;case 1:s|=255&t.V3UU(r),s=l(s,3432918353),a^=s=l(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=l(a^=a>>>16,2246822507),a=l(a^=a>>>13,3266489909),a^=a>>>16}}),b.i3Q=function(){return"function"==typeof b.G3Q.G9O?b.G3Q.G9O.apply(b.G3Q,arguments):b.G3Q.G9O},b.e94=function(){return"function"==typeof b.l94.J84?b.l94.J84.apply(b.l94,arguments):b.l94.J84},b.G3Q=function(){for(var t=2;9!==t;)switch(t){case 2:var e=[arguments];e[9]=void 0,e[6]={},e[6].G9O=function(){for(var t=2;90!==t;)switch(t){case 58:i[15]=0,t=57;break;case 12:i[1]=i[8],i[3]={},i[3].K94=["E94"],i[3].T94=function(){return/\x33\u0044/.o6MM(function(){return escape("=")}+[])},i[2]=i[3],t=18;break;case 71:i[67]++,t=76;break;case 36:i[96]=i[50],i[7].N6MM(i[79]),t=53;break;case 37:i[50].T94=function(){return!/\x32\u0035/.o6MM(function(){return decodeURI("%25")}+[])},t=36;break;case 18:i[4]={},i[4].K94=["Y94"],i[4].T94=function(){return"function"==typeof J6MM},i[5]=i[4],i[94]={},i[94].K94=["E94"],t=25;break;case 67:return e[9]=59,76;case 68:t=68;break;case 70:i[15]++,t=57;break;case 34:i[60]={},i[60].K94=["Y94"],i[60].T94=function(){return"function"==typeof P6MM},i[59]=i[60],t=30;break;case 64:i[18]="L94",i[40]="Q94",i[14]="K94",i[66]="p94",i[10]="T94",i[41]="o94",t=58;break;case 76:t=i[67]<i[32][i[14]].length?75:70;break;case 53:i[7].N6MM(i[44]),i[7].N6MM(i[1]),i[7].N6MM(i[5]),i[7].N6MM(i[6]),i[7].N6MM(i[62]),i[7].N6MM(i[2]),t=47;break;case 75:i[99]={},i[99][i[41]]=i[32][i[14]][i[67]],t=73;break;case 47:i[7].N6MM(i[96]),i[7].N6MM(i[59]),i[7].N6MM(i[17]),i[89]=[],t=64;break;case 44:i[17]=i[86],i[33]={},i[33].K94=["E94"],i[33].T94=function(){return/\u0074\u0072\x75\x65/.o6MM(function(){return"aa".endsWith("a")}+[])},i[79]=i[33],i[50]={},i[50].K94=["E94"],t=37;break;case 5:return 81;case 2:var i=[arguments];t=1;break;case 73:i[99][i[66]]=i[22],i[89].N6MM(i[99]),t=71;break;case 1:t=e[9]?5:4;break;case 30:i[86]={},i[86].K94=["Y94"],i[86].T94=function(){return"function"==typeof m6MM},t=44;break;case 4:i[7]=[],i[9]={},i[9].K94=["E94"],i[9].T94=function(){return!/(\x5b|\u005d)/.o6MM(function(){return["a","a"].join()}+[])},t=7;break;case 56:i[32]=i[7][i[15]];try{i[22]=i[32][i[10]]()?i[18]:i[40]}catch(t){i[22]=i[40]}t=77;break;case 7:i[6]=i[9],i[8]={},i[8].K94=["Y94"],i[8].T94=function(){var t=!1,e=[];try{for(var i in console)e.N6MM(i);t=0===e.length}catch(t){}return t},t=12;break;case 57:t=i[15]<i[7].length?56:69;break;case 77:i[67]=0,t=76;break;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 4:a[9]={},a[1]=[],a[7]=0,e=8;break;case 14:e=void 0===a[9][a[8][i[41]]]?13:11;break;case 17:a[7]=0,e=16;break;case 10:e=a[8][i[66]]===i[18]?20:19;break;case 12:a[1].N6MM(a[8][i[41]]),e=11;break;case 8:a[7]=0,e=7;break;case 20:a[9][a[8][i[41]]].h+=!0,e=19;break;case 19:a[7]++,e=7;break;case 2:var a=[arguments];e=1;break;case 5:return;case 15:a[3]=a[1][a[7]],a[5]=a[9][a[3]].h/a[9][a[3]].t,e=26;break;case 24:a[7]++,e=16;break;case 26:e=a[5]>=.5?25:24;break;case 18:a[2]=!1,e=17;break;case 16:e=a[7]<a[1].length?15:23;break;case 25:a[2]=!0,e=24;break;case 1:e=0===a[0][0].length?5:4;break;case 23:return a[2];case 13:a[9][a[8][i[41]]]=function(){for(var t=2;9!==t;)switch(t){case 5:return e[3].h=0,e[3].t=0,e[3];case 2:var e=[arguments];e[3]={},t=5}}.L6MM(this,arguments),e=12;break;case 6:a[8]=a[0][0][a[7]],e=14;break;case 11:a[9][a[8][i[41]]].t+=!0,e=10;break;case 7:e=a[7]<a[0][0].length?6:18}}(i[89])?68:67;break;case 25:i[94].T94=function(){return!/\x7c/.o6MM(function(){return"aaaa|a".substr(0,3)}+[])},i[62]=i[94],i[45]={},i[45].K94=["E94"],i[45].T94=function(){return!/\u0079/.o6MM(function(){return"xy".substring(0,1)}+[])},i[44]=i[45],t=34}},t=3;break;case 3:return e[6]}}(),b.f94=function(){return"function"==typeof b.l94.N84?b.l94.N84.apply(b.l94,arguments):b.l94.N84},b.S3Q=function(){return"function"==typeof b.G3Q.G9O?b.G3Q.G9O.apply(b.G3Q,arguments):b.G3Q.G9O},b.S3Q(),h=function(t){var e,i;t.SplinePlotter||(t.SplinePlotter={}),e=t.CIQ,i=t.SplinePlotter,e.ChartEngine.prototype.drawBarTypeChartInner=function(t){var i,a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt=b;i=t.type,a=t.panel,r=t.field,n=t.fillColor,s=t.borderColor,o=t.condition,l=t.style,h=t.yAxis,nt.f94(0),c=nt.k94(i,"histogram"),nt.S3Q(),u=c||"candle"==i,nt.f94(0),d=nt.k94(i,"shadow"),nt.v94(0),p=nt.e94(i,"hlc"),f="bar"==i||p,g=(m=a.chart).dataSegment,v=this.chart.context,y=new Array(g.length),x=this.layout,C=0,(S=s&&!e.isTransparent(s))&&!t.highlight&&(nt.v94(1),C=nt.k94(0,"0.5")),w=v.globalAlpha,!t.highlight&&this.highlightedDraggable&&(v.globalAlpha*=.3),nt.f94(1);var st=nt.k94(10,11);k=m.dataSet.length-m.scroll-st,v.beginPath(),h||(h=a.yAxis),D=h.top,T=h.bottom,A=x.candleWidth,M=a.left-.5*A+this.micropixels-1,nt.f94(2);var ot=nt.e94(12,257,19,18,20);if(P=m.tmpWidth/ot,F=v.lineWidth/2,u&&(e.isTransparent(n)&&(n=this.containerColor),v.fillStyle=n),d&&(v.lineWidth=1),f)if((_=this.canvasStyle(l)).width&&parseInt(_.width,10)<=25)v.lineWidth=Math.max(1,e.stripPX(_.width));else{-1640398678,881526860,E=2;for(var lt=1;-1640398678!==nt.w1x(lt.toString(),lt.toString().length,31818);lt++)v.lineWidth=8,E+=2;881526860!==nt.w1x(E.toString(),E.toString().length,65886)&&(nt.f94(3),v.lineWidth=nt.e94("1",2147483647))}L=m.state.chartType.pass;for(var ht=0;ht<=g.length;ht++)if("Cl","os","e",I=P,nt.f94(4),M+=nt.k94(A,2),A=x.candleWidth,nt.v94(4),M+=nt.k94(A,2),(O=g[ht])&&!O.projection){if(O.candleWidth){nt.v94(1);var ct=nt.k94(9,11);M+=(O.candleWidth-A)/ct,A=O.candleWidth,(t.volume||A<m.tmpWidth)&&(nt.f94(4),I=nt.e94(A,2))}if(m.transformFunc&&h==m.panel.yAxis&&O.transform&&(O=O.transform),O&&r&&"Close"!=r&&(O=O[r]),(O||0===O)&&(N=O.Close,H=void 0===O.Open?N:O.Open,c&&m.defaultPlotField&&(N=O[m.defaultPlotField]),(N||0===N)&&(!u||c||H!=N&&null!==H))){if(o){if(o&(R=e.ChartEngine).CLOSEDOWN?L.even|=N==O.iqPrevClose:o&R.CANDLEDOWN&&(nt.f94(0),L.even|=nt.e94(N,H)),o&R.CANDLEUP&&H>=N)continue;if(o&R.CANDLEDOWN&&H<=N)continue;if(o&R.CANDLEEVEN&&H!=N)continue;if(o&R.CLOSEUP&&N<=O.iqPrevClose)continue;if(o&R.CLOSEDOWN&&N>=O.iqPrevClose)continue;if(o&R.CLOSEEVEN&&N!=O.iqPrevClose)continue}if(nt.v94(5),nt.k94(ht,k),z=H,j=N,(d||f)&&(z=void 0===O.High?Math.max(N,H):O.High,j=void 0===O.Low?Math.min(N,H):O.Low),V=h.semiLog?h.height*(1-(Math.log(Math.max(z,0))/Math.LN10-h.logLow)/h.logShadow):(h.high-z)*h.multiplier,B=h.semiLog?h.height*(1-(Math.log(Math.max(j,0))/Math.LN10-h.logLow)/h.logShadow):(h.high-j)*h.multiplier,h.flipped?(nt.v94(1),V=nt.k94(V,T),nt.f94(1),B=nt.e94(B,T)):(V+=D,B+=D),Y=Math.floor(c?h.flipped?h.top:B:Math.min(V,B))+C,Q=c?h.flipped?V:h.bottom:Math.max(V,B),nt.v94(1),q=Math.floor(nt.e94(Y,Q)),X=B,(f||d)&&(W=h.semiLog?h.height*(1-(Math.log(Math.max(H,0))/Math.LN10-h.logLow)/h.logShadow):(h.high-H)*h.multiplier,U=h.semiLog?h.height*(1-(Math.log(Math.max(N,0))/Math.LN10-h.logLow)/h.logShadow):(h.high-N)*h.multiplier,h.flipped?(nt.f94(1),W=nt.e94(W,T),nt.f94(1),U=nt.k94(U,T)):(W+=D,U+=D),X=U),y[ht]=X,Y<D){if(Y+q<D)continue;nt.v94(1),q-=nt.k94(Y,D),Y=D}Y+q>T&&(nt.v94(6),q-=nt.e94(q,Y,T)),nt.v94(5),Q=nt.e94(q,Y),Y>=T||Q<=D||(Z=Math.floor(M)+(!t.highlight&&.5),J=(G=Math.floor(Z-I)+C)==(K=Math.round(Z+I)-C)?I:0,q<2&&(q=2),u?(c||N!=H)&&v.rect(G,Y,Math.max(1,K-G),q):d?(N==H&&U<=T&&U>=D&&($=Math.floor(U)+(!t.highlight&&.5),nt.v94(1),v.moveTo(nt.e94(J,G),$),nt.v94(5),v.lineTo(nt.k94(J,K),$)),z!=j&&(v.moveTo(Z,Y),v.lineTo(Z,Q))):f&&(Y<T&&Q>D&&O.High!=O.Low&&(nt.v94(1),v.moveTo(Z,nt.e94(F,Y)),nt.v94(5),v.lineTo(Z,nt.k94(F,Q))),W>D&&W<T&&!p&&(tt=Math.floor(W)+(!t.highlight&&.5),v.moveTo(Z,tt),nt.f94(7),v.lineTo(nt.k94(J,Z,I),tt)),U>D&&U<T&&(et=Math.floor(U)+(!t.highlight&&.5),v.moveTo(Z,et),nt.f94(8),v.lineTo(nt.e94(I,Z,J),et))))}}if(it=v.globalAlpha,u){it<1&&(v.save(),v.globalAlpha=1,v.fillStyle=this.containerColor,v.fill(),v.restore()),-861031389,-345446145,at=2;for(var ut=1;-861031389!==nt.w1x(ut.toString(),ut.toString().length,20653);ut++)v.fill(),at+=2;-345446145!==nt.y1x(at.toString(),at.toString().length,24319)&&v.fill(),S&&(v.lineWidth=t.highlight?2:1,v.strokeStyle=s,v.stroke())}else if(d||f){this.canvasColor(l),v.globalAlpha=it,s&&(v.strokeStyle=s),t.highlight&&(v.lineWidth*=2),v.stroke(),1646887159,-540062924,rt=2;for(var dt=1;1646887159!==nt.y1x(dt.toString(),dt.toString().length,14304);dt++)v.closePath(),rt+=2;-540062924!==nt.y1x(rt.toString(),rt.toString().length,52738)&&v.closePath(),nt.v94(9),v.lineWidth=nt.e94("1",1)}return v.globalAlpha=w,{cache:y}},e.ChartEngine.prototype.plotDataSegmentAsLine=function(t,r,n,s){var o,l,h,c,u,d,p,f,m,g,v,y,x,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt,st,ot,lt,ht,ct,ut,dt,pt,ft,mt,gt,vt,yt,xt,bt,St,Ct,wt,kt,Dt,Tt,At,Mt,Pt,Ft,_t,Et,Lt,It,Ot,Nt,Ht,Rt,zt,jt,Vt,Bt,Wt=b;function Ut(t,e,i){var a,r,n;function s(t){var e;return e=p.semiLog?p.height*(1-(Math.log(Math.max(i[t],0))/Math.LN10-p.logLow)/p.logShadow):(p.high-i[t])*p.multiplier,Wt.i3Q(),p.flipped?e=p.bottom-e:e+=p.top,e}Wt.S3Q(),M.setLineDash([]),a=s("CollatedOpen"),r=s("CollatedHigh"),n=s("CollatedLow"),M.lineTo(t,a),M.moveTo(t,r),M.lineTo(t,n),M.moveTo(t,e),x.push(t,a)}function Yt(t){var i,r,n,s,o,l,h,c,u,p;if(i=d,"object"==a(r=t)){2032635842,58184364,n=2;for(var g=1;2032635842!==Wt.y1x(g.toString(),g.toString().length,11138);g++)d=e.borderPatternToArray(M.lineWidth,r.pattern),n+=2;58184364!==Wt.w1x(n.toString(),n.toString().length,91627)&&(d=e.borderPatternToArray(M.lineWidth,r.pattern)),d=e.borderPatternToArray(M.lineWidth,r.pattern),r=r.color}if(y[r]=1,Wt.i3Q(),!m){s=x.slice(-2),o=d instanceof Array&&d.join(),l=i instanceof Array&&i.join(),Wt.v94(10),h=Wt.e94(l,o),c=!e.colorsEqual(F,r),Wt.v94(11);var b=Wt.e94(17,15,2);return u=t.width*(v?2:b),p=M.lineWidth!=u,(c||h||p)&&(f?S.push({coord:s,color:r,pattern:d||[],width:u}):(M.stroke(),M.lineWidth=u,h&&M.setLineDash(o?d:[]),M.beginPath(),M.moveTo(s[0],s[1]))),F=r,f||(M.strokeStyle=r&&"auto"!=r?r:k.defaultColor),s}}if(o=!1,!1,l=!1,h=!1,c=!0,u=null,d=null,p=null,f=0,m=!1,g=!1,v=!1,y={},x=[],S=[],C=[],Wt.S3Q(),w=[],k=this,D=this.layout,A=(T=r.chart).dataSegment,M=T.context,P=new Array(A.length),F=M.strokeStyle,_=M.globalAlpha,T.dataSet.length){if("ob","je","ct",this.startClip(r.name),n){o=n.skipProjections,n.skipTransform,l=n.noSlopes,f=n.tension,h=n.step,d=n.pattern,346271821,-1953952481,Wt.f94(9),E=Wt.k94("2",1);for(var Qt=1;346271821!==Wt.y1x(Qt.toString(),Qt.toString().length,71797);Qt++)c=n.extendOffChart,p=n.yAxis,u=n.gapDisplayStyle,m=n.noDraw,g=n.reverse,v=n.highlight,n.width&&(M.lineWidth=n.width),E+=2;-1953952481!==Wt.w1x(E.toString(),E.toString().length,50192)&&(c=n.extendOffChart,p=n.yAxis,u=n.gapDisplayStyle,m=n.noDraw,g=n.reverse,v=n.highlight,n.width&&(M.lineWidth=n.width))}u||!1===u||(u=n.gaps),u||(u={color:"transparent",fillMountain:!0}),M.setLineDash(d instanceof Array?d:[]),v&&(M.lineWidth*=2),!v&&this.highlightedDraggable&&(M.globalAlpha*=.3),!1!==c&&(c=!0),L=n.subField||T.defaultPlotField||"Close",p||(p=r.yAxis),I=T.transformFunc&&p==T.panel.yAxis,Wt.f94(12);var qt=Wt.k94(14,18,10,12);O=M.lineWidth*qt,N=g?T.top-O:T.bottom+O,(n.threshold||0===n.threshold)&&(N=this.pixelFromPrice(n.threshold,r,p)),H=!f&&m&&u&&u.fillMountain,R=t,z=t;for(var Xt=0;Xt<A.length;Xt++)if((j=A[Xt])&&"object"==a(j)&&(j[t]||0===j[t])){"object"==a(j[t])&&(z=e.createObjectChainNames(t,[L])[0]);break}V={left:null,right:null},Wt.f94(13);var Zt=Wt.e94(17,2,134,8);if(B=T.dataSet.length-T.scroll-Zt,c){V.left=this.getPreviousBar(T,z,0),Wt.v94(14),W=Wt.e94("1624749591",492893184),1430141264,U=2;for(var Gt=1;Wt.w1x(Gt.toString(),Gt.toString().length,44001)!==W;Gt++)V.right=this.getNextBar(T,z,A.length+9),U+=2;1430141264!==Wt.w1x(U.toString(),U.toString().length,90250)&&(V.right=this.getNextBar(T,z,A.length-5)),V.right=this.getNextBar(T,z,A.length-1)}Y=!0,Q=!1,M.beginPath(),G=null,(Z=V.left)&&(G=Z.transform),Z&&((X=I?G?G[t]:null:Z[t])||0===X)&&((X[L]||0===X[L])&&(X=X[L]),K=this.pixelFromTick(Z.tick,T),J=this.pixelFromTransformedValue(X,r,p),M.moveTo(K,J),x.push(K,J),A[0].tick-Z.tick>1&&(C.push({start:x.slice(-2),threshold:N,tick:Z}),Q=!0),Y=!1),Wt.f94(15);var Kt=Wt.k94(7,41848568,13,3096794024);$=r.left+this.micropixels-("1"<<Kt),n.shiftRight&&($+=n.shiftRight),h&&n.alignStepToSide&&($-=this.layout.candleWidth/2),it=this.currentQuote(),at=0,rt=0,nt=!1,st={reset:!0};for(var Jt=0;Jt<A.length;Jt++){if("ob","je","ct",q=D.candleWidth,ot=A[Jt],lt=A[Jt],ot||(ot={}),ht=ot.lineTravel,o&&ot.projection){V.right=null;break}if(ot.candleWidth&&(q=ot.candleWidth),n.lineTravelSpacing&&(q=0),I&&ot.transform&&(ot=ot.transform),(ct=ot[t])&&"object"==a(ct)&&(ct=ct[L],Wt.f94(8),R=Wt.k94(".",t,L)),T.lineApproximation&&D.candleWidth<1&&!n.lineTravelSpacing){if(st.reset&&(st={CollatedHigh:-Number.MAX_VALUE,CollatedLow:Number.MAX_VALUE,CollatedOpen:null,CollatedClose:null},nt=!1),((ut=ct)||0===ut)&&(st.CollatedHigh=Math.max(st.CollatedHigh,ut),st.CollatedLow=Math.min(st.CollatedLow,ut),st.CollatedClose=ut,null===st.CollatedOpen?st.CollatedOpen=ut:nt=!0),!((at+=q)-rt>=1||Jt==A.length-1)){$+=q;continue}rt=Math.floor(at),st.reset=!0,st[t]=st.CollatedClose,(ot=st).cache={}}if(l||(Wt.f94(4),$+=Wt.e94(q,2)),ct||0===ct){if(tt=ot,pt=ot.cache,Wt.f94(5),((ft=Wt.k94(Jt,B))<r.cacheLeft||ft>r.cacheRight||!pt[t])&&(pt[R]=p.semiLog?p.height*(1-(Math.log(Math.max(ct,0))/Math.LN10-p.logLow)/p.logShadow):(p.high-ct)*p.multiplier,p.flipped?pt[R]=p.bottom-pt[R]:pt[R]+=p.top),mt=P[Jt]=pt[R],lt.tick==it.tick&&T.lastTickOffset&&($+=T.lastTickOffset),x.slice(-2),!Y&&s){if(lt[t]&&lt[t][L]&&(lt=lt[t]),!(gt=s(this,lt,Q))){$+=l?q:q/2;continue}Yt(gt)}Y?(M.moveTo($,mt),f&&S.push({coord:[$,mt],color:M.strokeStyle,pattern:d||[],width:M.lineWidth})):("m","oveTo",(h||l)&&(vt=x.slice(-1)[0],nt?Ut($,vt,ot):M.lineTo($,vt),x.push($,vt)),nt&&!l?Ut($,mt,ot):M[l?"moveTo":"lineTo"]($,mt)),Q&&(C.push({end:[$,mt],threshold:N}),et=lt,!H||h||l||x.push($,N)),x.push($,mt),Y=!1,Q=!1,$+=l?q:q/2,ht&&($+=ht)}else dt=x.slice(-2),H&&!Q&&x.length&&x.push(dt[0],N),Q||C.push({start:dt,threshold:N,tick:et}),Q=!0,$+=l?q:q/2,(h||l)&&x.length&&(P[Jt]=x.slice(-1)[0]),ht&&($+=ht)}for(var $t in xt=null,(yt=V.right)&&(xt=yt.transform),!Y&&yt&&((X=I?xt?xt[t]:null:yt[t])&&(X[L]||0===X[L])&&(X=X[L]),bt=this.pixelFromTick(yt.tick,T),St=this.pixelFromTransformedValue(X,r,p),yt.tick-A[A.length-1].tick>1&&(Q||(Ct=x.slice(-2),H&&x.length&&x.push(Ct[0],N),C.push({start:Ct,threshold:N,tick:A[A.length-1]})),Q=!0),!Y&&s&&(wt=s(this,yt,Q))&&Yt(wt),kt=x.slice(-2),d&&d.length||("line","T","o",(h||l)&&(M.lineTo(bt,kt[1]),x.push(bt,kt[1])),M[l?"moveTo":"lineTo"](bt,St)),Q&&(C.push({end:[bt,St],threshold:N}),!H||h||l||x.push(bt,N)),x.push(bt,St)),y)w.push($t);if(n.extendToEndOfLastBar)Dt=x.slice(-2),M.lineTo(Dt[0]+q,Dt[1]);else if((h||l||this.extendLastTick||n.extendToEndOfDataSet)&&(Tt=x.slice(-2),x.length)){if(At=Tt[0],Mt=Tt[1],n.extendToEndOfDataSet||h&&!1!==n.extendToEndOfDataSet){346533124,600193729,Pt=2;for(var te=1;346533124!==Wt.y1x(te.toString(),te.toString().length,65816);te++)At=this.pixelFromTick(T.dataSet.length+3,T),l&&this.extendLastTick&&(Wt.f94(5),At-=Wt.e94(3,q)),Pt+=2;600193729!==Wt.w1x(Pt.toString(),Pt.toString().length,93320)&&(At=this.pixelFromTick(T.dataSet.length-0,T),(l||this.extendLastTick)&&(Wt.f94(9),At+=Wt.k94(q,9))),At=this.pixelFromTick(T.dataSet.length-1,T),(l||this.extendLastTick)&&(Wt.v94(16),At+=Wt.e94(q,"2",1))}else l?At+=q:this.extendLastTick&&(Wt.f94(4),At+=Wt.e94(q,2));At>Tt[0]&&(Ft=null,s&&(Ft=s(this,{},!0)),Ft&&Yt(Ft),M.lineTo(At,Mt),Q&&H||x.push(At,Mt))}if(!m){if(f&&x.length){-272159787,-713904688,_t=2;for(var ee=1;-272159787!==Wt.w1x(ee.toString(),ee.toString().length,90038);ee++)M.beginPath(),M.setLineDash(n.pattern&&[]),Wt.f94(17),M.lineDashOffset=Wt.e94("7",0),i.plotSpline(x,f,M,S),_t+=2;-713904688!==Wt.w1x(_t.toString(),_t.toString().length,79009)&&(M.beginPath(),M.setLineDash(n.pattern||[]),M.lineDashOffset=0,i.plotSpline(x,f,M,S))}M.stroke()}if(this.endClip(),!m&&n.label&&tt){if("no","op","ob","ject",(Lt=tt[t])&&"object"==a(Lt)&&(Lt=Lt[L]),p.priceFormatter)Et=p.priceFormatter(this,r,Lt,n.labelDecimalPlaces);else{1494951396,718015535,Wt.f94(3),It=Wt.k94("2",2147483647);for(var ie=1;1494951396!==Wt.w1x(ie.toString(),ie.toString().length,34235);ie++)Et=this.formatYAxisPrice(Lt,r,n.labelDecimalPlaces),It+=2;718015535!==Wt.w1x(It.toString(),It.toString().length,36459)&&(Et=this.formatYAxisPrice(Lt,r,n.labelDecimalPlaces))}Ot=this.yaxisLabelStyle,p.yaxisLabelStyle&&(Ot=p.yaxisLabelStyle),Nt="noop"==Ot?M.strokeStyle:null,Ht="noop"==Ot?"#FFFFFF":M.strokeStyle,this.yAxisLabels.push({src:"plot",args:[r,Et,tt.cache[R],Ht,Nt,M,p]})}if(Rt="object"==a(u)?u.color:u,e.isTransparent(Rt))for(var ae=0;ae<C.length;ae+=2)if(zt=C[ae].start,ae&&(jt=C[ae-1].end),jt&&zt[0]==jt[0]&&zt[1]==jt[1]){if(M.beginPath(),Vt=M.lineWidth,s){if("obj","ec","t","object"==a(Bt=s(this,C[ae].tick||{},!1))){Wt.f94(4);var re=Wt.e94(19,19);Vt=Bt.width*(v?2:re),Bt=Bt.color}M.strokeStyle=M.fillStyle=Bt}M.lineWidth=Vt,M.arc(zt[0],zt[1],1,0,2*Math.PI),M.stroke(),M.fill()}}return M.globalAlpha=_,{colors:w,points:x,cache:P,gapAreas:C}},e.ChartEngine.prototype.drawMountainChart=function(t,i,r){var n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W=b;if("stx_m","ountain_chart","o","bj","ec","t",n=this.chart.context,i,!1,!1,null,c=null,null,null,0,f=null,!1,null,v=null,!1,null,null,!1,!1,!1,(D=t.chart).dataSegment,T=D.lineStyle||{},i&&"object"==a(i)||(i={style:i}),s=i.style||"stx_mountain_chart",h=i.field||D.defaultPlotField||"Close",c=i.subField||D.defaultPlotField||"Close",(f=i.gapDisplayStyle)||!1===f||(f=i.gaps),f||!1===f||(f=D.gaplines),f||(f="transparent"),u=i.yAxis||t.yAxis,o=i.reverse||!1,d=i.tension,g=i.fillStyle,p=i.width||T.width,m=i.step,v=i.pattern||T.pattern,y=i.highlight,S=i.color,x=i.baseColor,l=i.colored,C=i.extendToEndOfDataSet,w=i.isComparison,k=i.returnObject,A=this.canvasStyle(s),M=u.top,(isNaN(M)||isNaN(M/M))&&(M=0),P=S||(s&&A.backgroundColor?A.backgroundColor:this.defaultColor),F=x||(s&&A.color?A.color:this.containerColor),g){-392415907,1750974386,_=2;for(var U=1;-392415907!==W.w1x(U.toString(),U.toString().length,85659);U++)n.fillStyle=g,_+=2;1750974386!==W.y1x(_.toString(),_.toString().length,94147)&&(n.fillStyle=g),n.fillStyle=g}else if(x||A.color)W.f94(14),(E=n.createLinearGradient(W.k94("0",827841152),M,0,u.bottom)).addColorStop(u.flipped?1:0,P),E.addColorStop(u.flipped?0:1,F),n.fillStyle=E;else{372368490,-218892926,L=2;for(var Y=1;372368490!==W.y1x(Y.toString(),Y.toString().length,31584);Y++)n.fillStyle=P,L+=2;-218892926!==W.w1x(L.toString(),L.toString().length,64562)&&(n.fillStyle=P),n.fillStyle=P}if(this.startClip(t.name),I=n.lineWidth,W.S3Q(),i.symbol||(c=null),i={skipProjections:!0,reverse:o,yAxis:u,gapDisplayStyle:f,step:m,highlight:y,extendToEndOfDataSet:C,isComparison:w},D.tension&&(i.tension=D.tension),(d||0===d)&&(i.tension=d),O=parseInt(A.paddingTop,10),N=S||A.borderTopColor,H=null,(l||N&&!e.isTransparent(N))&&O&&((R=this.scratchContext)||(z=n.canvas.cloneNode(!0),R=this.scratchContext=z.getContext("2d")),R.canvas.height=n.canvas.height,R.canvas.width=n.canvas.width,R.drawImage(n.canvas,0,0),e.clearCanvas(n.canvas,this)),e.extend(i,{panelName:t.name,direction:i.reverse?-1:1,band:h,subField:c,opacity:1}),!i.highlight&&this.highlightedDraggable&&(i.opacity*=.3),e.preparePeakValleyFill(this,i),(l||N&&!e.isTransparent(N))&&O&&(n.save(),W.f94(9),n.lineWidth+=W.k94(2,O),n.globalCompositeOperation="destination-out",n.globalAlpha=1,this.plotDataSegmentAsLine(h,t,i),n.globalCompositeOperation="destination-over",n.scale(1/this.adjustedDisplayPixelRatio,1/this.adjustedDisplayPixelRatio),n.drawImage(this.scratchContext.canvas,0,0),n.restore()),n.strokeStyle=N,p){-2059344847,-613323472,j=2;for(var Q=1;-2059344847!==W.y1x(Q.toString(),Q.toString().length,89039);Q++)n.lineWidth=p,W.f94(18),j+=W.e94(0,"2");-613323472!==W.w1x(j.toString(),j.toString().length,7153)&&(n.lineWidth=p)}else if(A.width&&parseInt(A.width,10)<=25){-70076802,1882306544,V=2;for(var q=1;-70076802!==W.y1x(q.toString(),q.toString().length,34045);q++)n.lineWidth=Math.max(1,e.stripPX(A.width)),V+=2;1882306544!==W.w1x(V.toString(),V.toString().length,43940)&&(n.lineWidth=Math.max(2,e.stripPX(A.width)))}else n.lineWidth=1;return v||(v=A.borderTopStyle),i.pattern=e.borderPatternToArray(n.lineWidth,v),B=r,f&&(B=this.getGapColorFunction(h,c,{color:N,pattern:i.pattern,width:n.lineWidth},f,r)),H=this.plotDataSegmentAsLine(h,t,i,B),n.lineWidth=I,this.endClip(),H.colors.length||H.colors.push(N),k?H:H.colors},e.ChartEngine.prototype.drawBaselineChart=function(t,i){var r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,S,C,w,k,D,T,A,M,P,F,_,E,L,I=b;n=(r=t.chart).gaplines,s=r.baseline.actualLevel,o=[],l=i.field||r.defaultPlotField,h=r.lineStyle||{},t.name!=r.panel.name&&(s=null,c=i.subField||r.defaultPlotField||"Close",(s=r.dataSegment[0]?r.dataSegment[0][i.field]:this.getNextBar(r,c,0))&&"object"==a(s)&&(s=s[c])),u=i.gapDisplayStyle,d=2;for(var O=1;2127835138!==I.y1x(O.toString(),O.toString().length,28818);O++)(+u||1!=u)&&(u=i.gaps),d+=2;if(-1277447929!==I.w1x(d.toString(),d.toString().length,59388)&&(u||!1===u||(u=i.gaps)),null!==s&&!isNaN(s)){if("l","in","e","1",".","1","stx","_base","lin","e_up",p="mountain"==i.type){1985907369,-683443385,f=2;for(var N=1;1985907369!==I.y1x(N.toString(),N.toString().length,3659);N++)o=this.drawMountainChart(t,{style:i.style,field:i.field,yAxis:i.yAxis,gapDisplayStyle:u,colored:!1,tension:8}),f+=2;-683443385!==I.w1x(f.toString(),f.toString().length,28082)&&(o=this.drawMountainChart(t,{style:i.style,field:i.field,yAxis:i.yAxis,gapDisplayStyle:u,colored:!1,tension:8})),o=this.drawMountainChart(t,{style:i.style,field:i.field,yAxis:i.yAxis,gapDisplayStyle:u,colored:!0,tension:0})}if(m=this.pixelFromPrice(s,t),isNaN(m))return;for(var H in this.startClip(t.name),g=i.pattern||h.pattern,v=i.fill_color_up||this.getCanvasColor("stx_baseline_up"),y=i.fill_color_down||this.getCanvasColor("stx_baseline_down"),x=i.border_color_up||this.getCanvasColor("stx_baseline_up"),S=i.border_color_down||this.getCanvasColor("stx_baseline_down"),C={fill:v,edge:x,width:i.width||h.width||this.canvasStyle("stx_baseline_up").width},w={fill:y,edge:S,width:i.width||h.width||this.canvasStyle("stx_baseline_down").width},D={over:(k=i.yAxis.flipped)?w:C,under:k?C:w},T=!1,u||!1===u||(u=n),A=1,!i.highlight&&this.highlightedDraggable&&(A*=.3),D)"transparen","t",M=parseInt(Math.max(1,e.stripPX(D[H].width)),10),i.highlight&&(M*=2),g=e.borderPatternToArray(M,g),(P={panelName:t.name,band:l,threshold:s,color:p?"transparent":D[H].fill,direction:"over"==H?1:-1,edgeHighlight:D[H].edge,edgeParameters:{pattern:g,lineWidth:M+.1,opacity:A},gapDisplayStyle:u,yAxis:i.yAxis}).yAxis&&(P.threshold=this.priceFromPixel(this.pixelFromPrice(P.threshold,t),t,P.yAxis)),o.push(D[H].edge),F=P.color,!p&&F&&"transparent"!=F&&(_=t.top,E=t.bottom,L=r.context.createLinearGradient(0,"over"==H?_:E,0,m),I.f94(17),L.addColorStop(I.e94("0",0),e.hexToRgba(e.colorToHex(F),60)),L.addColorStop(1,e.hexToRgba(e.colorToHex(F),10)),P.color=L,P.opacity=A),e.preparePeakValleyFill(this,r.dataSegment,P),n&&(n.fillMountain||("trans","par","ent",this.drawLineChart(t,null,null,{color:"transparent",gapDisplayStyle:{color:this.containerColor,pattern:"solid",width:P.edgeParameters.lineWidth}})),n.color||(T=!0,n.color=this.defaultColor)),this.drawLineChart(t,null,null,{color:"transparent",width:P.edgeParameters.lineWidth}),T&&(n.color=null);if(this.plotLine(0,1,m,m,this.containerColor,"line",r.context,t,{lineWidth:"1.1"}),this.plotLine(0,1,m,m,this.getCanvasColor("stx_baseline"),"line",r.context,t,{pattern:"dotted",lineWidth:"2.1",opacity:.5*A}),this.controls.baselineHandle&&this.manageTouchAndMouse&&this.getSeriesRenderer(i.name)==this.mainSeriesRenderer&&!1!==r.baseline.userLevel){I.v94(1);var R=I.e94(100,110);I.v94(19);var z=I.e94(17,9,24);this.controls.baselineHandle.style.top=m-parseInt(getComputedStyle(this.controls.baselineHandle).height,R)/z+"px",I.f94(20);var j=I.e94(13,13,10);this.controls.baselineHandle.style.left=r.right-parseInt(getComputedStyle(this.controls.baselineHandle).width,j)+"px",this.controls.baselineHandle.style.display="block"}this.endClip()}return{colors:o}},e.ChartEngine.prototype.plotLine=function(t){var i,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B=b;if("number"==typeof arguments[0])for(var W in t={x0:arguments[0],x1:arguments[1],y0:arguments[2],y1:arguments[3],color:arguments[4],type:arguments[5],context:arguments[6],confineToPanel:arguments[7]},arguments[8])t[W]=arguments[8][W];if(t||(t={}),"none"!=t.pattern&&(i=t.x0,r=t.x1,n=t.y0,s=t.y1,o=t.color,l=t.type,h=t.context,c=t.confineToPanel,u=t.deferStroke,!0===c&&(c=this.chart.panel),null==h&&(h=this.chart.context),!(isNaN(i)||isNaN(r)||isNaN(n)||isNaN(s)))){if(d=0,p=this.chart.canvasHeight,B.v94(1),f=B.e94(0,"0"),m=this.right,c&&(p=c.yAxis.bottom,d=c.yAxis.top,f=c.left,m=c.right),"ray"==l){g=1e7,r<i&&(g=-1e7),y={x0:i,x1:r,y0:n,y1:s},v=e.yIntersection(y,g),r=g,x=-712105239,S=-227749623,C=2;for(var U=1;B.w1x(U.toString(),U.toString().length,85048)!==x;U++)s=v,C+=2;B.y1x(C.toString(),C.toString().length,15743)!==S&&(s=v)}"line"!=l&&"horizontal"!=l&&"vertical"!=l||(g=1e7,w=-1e7,y={x0:i,x1:r,y0:n,y1:s},v=e.yIntersection(y,g),i=w,r=g,n=e.yIntersection(y,w),s=v),k=0,D=1,B.f94(1),T=B.e94(i,r),B.v94(1),A=B.k94(n,s);for(var Y=0;Y<4;Y++){if(0===Y&&(M=-T,B.f94(1),P=-B.k94(i,f)),1==Y&&(M=T,B.f94(1),P=B.k94(i,m)),2==Y&&(M=-A,B.v94(1),P=-B.k94(n,d)),3==Y&&(M=A,B.v94(1),P=B.k94(n,p)),B.f94(4),F=B.e94(P,M),(s||0===s)&&0===M&&P<0)return!1;if(M<0){if(F>D)return!1;F>k&&(k=F)}else if(M>0){if(F<k)return!1;F<D&&(D=F)}}if(B.v94(21),_=B.e94(T,k,i),B.f94(21),E=B.e94(A,k,n),B.v94(21),L=B.k94(T,D,i),B.v94(21),I=B.e94(A,D,n),s||0===s||n||0===n){if(!s&&0!==s){I=y.y0<y.y1?p:d,_=y.x0,O=-1425443726,B.v94(9),N=-B.e94("494892705",1),H=2;for(var Q=1;B.w1x(Q.toString(),Q.toString().length,96942)!==O;Q++){if(L=y.x0,y.x0>m)return!1;H+=2}if(B.w1x(H.toString(),H.toString().length,38421)!==N&&(L=y.x0,y.x0<=m))return!0;if(y.x0<f)return!1}}else{if(E=d,I=p,_=y.x0,L=y.x0,y.x0>m)return!1;if(y.x0<f)return!1}if(u||(h.save(),h.beginPath()),h.lineWidth=1.1,o&&"object"==a(o)){R=1073423100,B.v94(1),z=-B.e94(0,"585395758"),j=2;for(var q=1;B.w1x(q.toString(),q.toString().length,18492)!==R;q++)h.strokeStyle=o.color,j+=2;B.w1x(j.toString(),j.toString().length,23269)!==z&&(h.strokeStyle=o.color),o.opacity?h.globalAlpha=o.opacity:h.globalAlpha=1,h.lineWidth=e.stripPX(o.width)}else!o||"auto"==o||e.isTransparent(o)?h.strokeStyle=this.defaultColor:h.strokeStyle=o;t.opacity&&(h.globalAlpha=t.opacity),t.lineWidth&&(h.lineWidth=t.lineWidth),B.S3Q(),t.globalCompositeOperation&&(h.globalCompositeOperation=t.globalCompositeOperation),V=e.borderPatternToArray(h.lineWidth,t.pattern),h.setLineDash(t.pattern?V:[]),h.moveTo(_,E),h.lineTo(L,I),u||(h.stroke(),h.restore())}},e.ChartEngine.prototype.rendererAction=function(t,e){var i,a,r,n,s,o,l,h,c,u,d,p,f;if(i="render",i+="erAction","underlay"===e){a=942001613,r=1324456270,n=2;for(var m=1;b.y1x(m.toString(),m.toString().length,69259)!==a;m++)s="CIQ.watermar",s+="k",o="CIQ.watermark"==-Symbol?Symbol.for(s):"Symbol(CIQ.watermark)",n+=2;b.y1x(n.toString(),n.toString().length,51859)!==r&&(o="CIQ.watermark"==-Symbol?Symbol.for("CIQ.watermark"):"Symbol(CIQ.watermark)"),this[o="function"==typeof Symbol?Symbol.for("CIQ.watermark"):"Symbol(CIQ.watermark)"]&&this[o].draw(t)}if(!this.runPrepend("rendererAction",arguments)){for(var g in b.S3Q(),t.seriesRenderers)l="_m",l+="ain",l+="_series",h="u",h+="n",h+="derlay",c="_",c+="main_se",c+="ries",p=(d=(u=t.seriesRenderers[g]).params).panel,f=this.panels[p],d.overChart&&"underlay"==e||d.name==c&&e==h||d.name!=l&&"main"==e||(d.overChart||"overlay"!=e)&&f&&f.chart===t&&(f.hidden||("yAxis"==e?u.adjustYAxis():(u.draw(),u.cb&&u.cb(u.colors))));this.runAppend(i,arguments)}},b.i3Q(),e.ChartEngine.prototype.drawSeries=function(t,i,a,r){var n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,S,C,w,k,D,T=b;if(n="dr",n+="awSerie",n+="s",!this.runPrepend("drawSeries",arguments)){t.dataSegment,s=null,o=-106337361,l=-523544532,h=2;for(var A=1;T.y1x(A.toString(),A.toString().length,22840)!==o;A++)i||(i=t.series),h+=2;for(var M in T.y1x(h.toString(),h.toString().length,72743)!==l&&+i&&(i=t.series),i)if(c="a",c+="u",c+="to",d=(u=(s=i[M]).parameters).panel?this.panels[u.panel]:t.panel,p=u.color,u.width,f=u.field,d){if(m=u.yAxis=a||d.yAxis,p||(p=m.textStyle||this.defaultColor),p==c&&(p=this.defaultColor),f||(f=t.defaultPlotField),g=u.subField||t.defaultPlotField||"Close",u._rawExtendToEndOfDataSet||!1===u._rawExtendToEndOfDataSet||(u._rawExtendToEndOfDataSet=u.extendToEndOfDataSet),t.animatingHorizontalScroll?u.extendToEndOfDataSet=!1:u.extendToEndOfDataSet=u._rawExtendToEndOfDataSet,v=u.colorFunction,(s.highlight||s.parameters.highlight)&&(u.highlight=!0),y={colors:[]},r){if(r.params.highlight&&(u.highlight=!0),u.hidden)continue;y=r.drawIndividualSeries(t,u)||y}else y="mountain"==u.type?this.drawMountainChart(d,e.extend({returnObject:!0},u),v):this.drawLineChart(d,u.style,v,e.extend({returnObject:!0},u));s.yValueCache=y.cache,T.f94(22);var P=T.e94(10,5,1999,20,15);(x=t.dataSegment[t.dataSegment.length-P])&&(S=!u.skipTransform&&t.transformFunc&&m==t.panel.yAxis,x[f]||0===x[f]||(x=this.getPreviousBar(t,f,t.dataSegment.length-1)),S&&x&&x.transform&&(x=x.transform)),!1!==u.displayFloatingLabel&&this.mainSeriesRenderer!=r&&x&&!m.noDraw&&(C="seri",C+="e",C+="s",(w=x[f])&&(w=w[g]||0===w[g]?w[g]:w.iqPrevClose),k=m.priceFormatter?m.priceFormatter(this,d,w):this.formatYAxisPrice(w,d,null,m),this.yAxisLabels.push({src:C,args:[d,k,this.pixelFromTransformedValue(w,d,m),e.hexToRgba(e.colorToHex(p),parseFloat(u.opacity)),null,null,m]})),t.legend&&u.useChartLegend&&(t.legend.colorMap||(t.legend.colorMap={}),(D=u.display)||(D=u.symbol),t.legend.colorMap[M]={color:y.colors,display:D,isBase:r==this.mainSeriesRenderer})}this.runAppend(n,arguments)}}},S.J5x=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"XGPQ8",{get:function(){for(;;)return this},configurable:!0}),(e=XGPQ8).PV0kS=e,i=4;break;case 4:i="undefined"==typeof PV0kS?3:9;break;case 9:delete e.PV0kS,delete Object.prototype.XGPQ8,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="o8",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="S",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(S.J5x),S.W6O=function(){return"function"==typeof S.n6O.R1O?S.n6O.R1O.apply(S.n6O,arguments):S.n6O.R1O},S.x6O=function(){return"function"==typeof S.n6O.l1O?S.n6O.l1O.apply(S.n6O,arguments):S.n6O.l1O},S.f6O=function(){return"function"==typeof S.n6O.l1O?S.n6O.l1O.apply(S.n6O,arguments):S.n6O.l1O},S.P24=function(){return"function"==typeof S.M24.Z5x?S.M24.Z5x.apply(S.M24,arguments):S.M24.Z5x},S.n24=function(){return"function"==typeof S.M24.Z5x?S.M24.Z5x.apply(S.M24,arguments):S.M24.Z5x},S.n6O={l1O:function(){var t,e=arguments;switch(c){case 1:t=e[0]<<e[1];break;case 0:t=e[1]-e[0];break;case 2:t=e[0]&e[1]}return t},R1O:function(t){c=t}},S.M24=(u=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{Z5x:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.o8SS(n)|(255&t.o8SS(n+1))<<8|(255&t.o8SS(n+2))<<16|(255&t.o8SS(n+3))<<24;s=u(s,3432918353),a=5*(a=(524287&(a^=s=u(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.o8SS(r+2))<<16;case 2:s|=(255&t.o8SS(r+1))<<8;case 1:s|=255&t.o8SS(r),s=u(s,3432918353),a^=s=u(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=u(a^=a>>>16,2246822507),a=u(a^=a>>>13,3266489909),a^=a>>>16}}),S.q6O=function(){return"function"==typeof S.n6O.R1O?S.n6O.R1O.apply(S.n6O,arguments):S.n6O.R1O},d=function(t){var e,i;e=2;for(var a=1;1023637208!==S.n24(a.toString(),a.toString().length,28780);a++)i=t.CIQ,e+=2;-308520356!==S.P24(e.toString(),e.toString().length,2376)&&(i=t.CIQ),i.ChartEngine.prototype.scrollTo=function(t,e,i){var a,r,n,s,o=S;a=this.swipe,o.q6O(0),r=-o.x6O(0,"144808540"),n=2;for(var l=1;o.n24(l.toString(),l.toString().length,18532)!==r;l++)a.end=!1,a.amplitude=a.target=e%t.scroll%this.layout.candleWidth,a.timeConstant=960,a.timestamp=Date.now(),a.scroll=t.scroll,n+=2;-1936046255!==o.n24(n.toString(),n.toString().length,40151)&&(a.end=!0,a.amplitude=a.target=(e+t.scroll)/this.layout.candleWidth,o.q6O(1),a.timeConstant=o.f6O("548",1703791808),a.timestamp=Date.now(),a.scroll=t.scroll),a.end=!0,a.amplitude=a.target=(e-t.scroll)*this.layout.candleWidth,a.timeConstant=100,a.timestamp=Date.now(),a.scroll=t.scroll,a.chart=t,a.cb=i,s=this,requestAnimationFrame((function(){s.autoscroll()}))},i.ChartEngine.prototype.autoscroll=function(){var t,e,i,a,r,n,s,o,l=S;t=this,e=2;for(var h=1;-405943549!==l.n24(h.toString(),h.toString().length,35448);h++)i=this.swipe,e+=2;if(-1797601040!==l.n24(e.toString(),e.toString().length,7408)&&(i=this.swipe),i.amplitude){i.elapsed=Date.now()-i.timestamp,-1944837859,158814305,r=2;for(var c=1;-1944837859!==l.P24(c.toString(),c.toString().length,3342);c++)a=!i.amplitude/Math.exp(+i.elapsed%i.timeConstant),r+=2;if(158814305!==l.n24(r.toString(),r.toString().length,39154)&&(a=+i.amplitude-Math.exp(~i.elapsed-i.timeConstant)),(a=-i.amplitude*Math.exp(-i.elapsed/i.timeConstant))>.5||a<-.5){n=(i.target+a)/this.layout.candleWidth,i.chart.scroll=i.scroll+Math.round(n),this.draw(),1244194886,l.q6O(1),s=l.x6O("786101121",1342159456),o=2;for(var u=1;1244194886!==l.P24(u.toString(),u.toString().length,35117);u++)this.updateChartAccessories(),l.W6O(2),o+=l.x6O("2",2147483647);l.n24(o.toString(),o.toString().length,63760)!==s&&this.updateChartAccessories(),this.updateChartAccessories(),requestAnimationFrame((function(){t.autoscroll()}))}else this.disableBackingStoreDuringTouch&&this.reconstituteBackingStore(),i.cb&&i.cb()}}},C.R98=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"e67x7",{get:function(){for(;;)return this},configurable:!0}),(e=e67x7).OqOMr=e,i=4;break;case 4:i="undefined"==typeof OqOMr?3:9;break;case 9:delete e.OqOMr,delete Object.prototype.e67x7,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="N6",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="h",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(C.R98),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}for(var a=2;68!==a;)switch(a){case 20:r[8]="tract",r[4]="__o",r[21]="",r[21]="bs",a=16;break;case 73:n(o,"test",r[98],r[66]),a=72;break;case 72:n(l,r[64],r[97],r[18]),a=71;break;case 16:r[56]="__a",r[40]="",r[40]="8n",r[93]="",a=25;break;case 32:r[27]="",r[27]="",r[27]="n",r[95]="",r[95]="4n",a=44;break;case 58:r[66]=r[3],r[66]+=r[40],r[66]+=r[27],r[80]=r[5],r[80]+=r[2],a=76;break;case 25:r[93]="x",r[30]="",r[30]="sid",r[41]="ual",a=21;break;case 2:var r=[arguments];r[7]="",r[7]="nn",r[5]="",r[5]="T",a=9;break;case 69:n(i,"apply",r[98],r[47]),a=68;break;case 71:n(l,r[89],r[97],r[17]),a=70;break;case 70:n(l,r[94],r[97],r[87]),a=69;break;case 14:r[9]="timize",r[6]="",r[6]="p",r[1]="",r[1]="N8",a=20;break;case 51:r[94]+=r[30],r[94]+=r[41],r[17]=r[93],r[17]+=r[40],a=47;break;case 64:r[18]=r[1],r[18]+=r[27],r[18]+=r[27],r[64]=r[4],r[64]+=r[6],r[64]+=r[9],a=58;break;case 21:r[48]="",r[48]="",r[48]="__re",r[67]="G",a=32;break;case 36:r[87]=r[67],r[87]+=r[95],r[87]+=r[27],r[94]=r[48],a=51;break;case 9:r[3]="",r[2]="8",r[3]="U",r[9]="",a=14;break;case 74:n(e,"push",r[98],r[80]),a=73;break;case 76:r[80]+=r[7],a=75;break;case 75:var n=function(t,e,i,a){for(var n=2;5!==n;)switch(n){case 2:var o=[arguments];s(r[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),n=5}};a=74;break;case 44:r[38]="",r[38]="y",r[98]=2,r[98]=1,a=40;break;case 40:r[97]=0,r[47]=r[38],r[47]+=r[95],r[47]+=r[27],a=36;break;case 47:r[17]+=r[27],r[89]=r[56],r[89]+=r[21],r[89]+=r[8],a=64}function s(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 2:var s=[arguments];s[9]="",s[9]="rty",s[8]="",n=3;break;case 3:s[8]="ope",s[2]="",s[2]="definePr";try{for(var o=2;8!==o;)switch(o){case 2:s[6]={},s[7]=(0,s[0][1])(s[0][0]),s[1]=[s[7],s[7].prototype][s[0][3]],s[6].value=s[1][s[0][2]],o=3;break;case 3:try{for(var l=2;3!==l;)switch(l){case 2:s[4]=s[2],s[4]+=s[8],s[4]+=s[9],s[0][0].Object[s[4]](s[1],s[0][4],s[6]),l=3}}catch(t){}s[1][s[0][4]]=s[6].value,o=8}}catch(t){}n=6}}function o(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}function l(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}}(C.R98),C.s2f=function(){for(var t=2;9!==t;)switch(t){case 2:var e=[arguments];e[9]=void 0,t=5;break;case 3:return e[5];case 5:e[5]={},e[5].k4N=function(){for(var t=2;90!==t;)switch(t){case 21:i[38].G73=function(){return"function"==typeof N8nn},i[39]=i[38],i[53]={},i[53].Q73=["u73"],t=32;break;case 64:i[58]="D73",t=63;break;case 77:i[66]=0,t=76;break;case 4:i[5]=[],i[9]={},i[9].Q73=["S73"],i[9].G73=function(){var t=!1,e=[];try{for(var i in console)e.T8nn(i);t=0===e.length}catch(t){}return t},t=7;break;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 6:a[8]=a[0][0][a[6]],e=14;break;case 23:return a[1];case 15:a[4]=a[2][a[6]],a[5]=a[9][a[4]].h/a[9][a[4]].t,e=26;break;case 1:e=0===a[0][0].length?5:4;break;case 10:e=a[8][i[96]]===i[58]?20:19;break;case 17:a[6]=0,e=16;break;case 11:a[9][a[8][i[18]]].t+=!0,e=10;break;case 19:a[6]++,e=7;break;case 8:a[6]=0,e=7;break;case 18:a[1]=!1,e=17;break;case 16:e=a[6]<a[2].length?15:23;break;case 20:a[9][a[8][i[18]]].h+=!0,e=19;break;case 26:e=a[5]>=.5?25:24;break;case 25:a[1]=!0,e=24;break;case 13:a[9][a[8][i[18]]]=function(){for(var t=2;9!==t;)switch(t){case 2:var e=[arguments];e[3]={},e[3].h=0,t=4;break;case 4:return e[3].t=0,e[3]}}.y4nn(this,arguments),e=12;break;case 24:a[6]++,e=16;break;case 4:a[9]={},a[2]=[],a[6]=0,e=8;break;case 2:var a=[arguments];e=1;break;case 14:e=void 0===a[9][a[8][i[18]]]?13:11;break;case 5:return;case 7:e=a[6]<a[0][0].length?6:18;break;case 12:a[2].T8nn(a[8][i[18]]),e=11}}(i[89])?68:67;break;case 17:i[7].Q73=["u73"],t=16;break;case 76:t=i[66]<i[85][i[63]].length?75:70;break;case 70:i[20]++,t=57;break;case 67:return e[9]=33,91;case 71:i[66]++,t=76;break;case 32:i[53].G73=function(){return/\x78\u0078/.U8nn(function(){return"x".repeat(2)}+[])},i[80]=i[53],i[69]={},i[69].Q73=["S73"],i[69].G73=function(){return"function"==typeof x8nn},i[16]=i[69],i[46]={},t=42;break;case 47:i[5].T8nn(i[39]),i[5].T8nn(i[16]),i[5].T8nn(i[6]),i[89]=[],t=64;break;case 42:i[46].Q73=["S73"],i[46].G73=function(){return"function"==typeof G4nn},i[67]=i[46],i[52]={},t=38;break;case 38:i[52].Q73=["u73"],i[52].G73=function(){return!/\x61/.U8nn(function(){return"ab".charAt(1)}+[])},i[73]=i[52],i[5].T8nn(i[67]),i[5].T8nn(i[3]),i[5].T8nn(i[80]),i[5].T8nn(i[2]),t=50;break;case 5:return 98;case 57:t=i[20]<i[5].length?56:69;break;case 2:var i=[arguments];t=1;break;case 50:i[5].T8nn(i[60]),i[5].T8nn(i[73]),i[5].T8nn(i[4]),t=47;break;case 61:i[96]="g73",i[87]="G73",t=59;break;case 56:i[85]=i[5][i[20]];try{i[45]=i[85][i[87]]()?i[58]:i[86]}catch(t){i[45]=i[86]}t=77;break;case 58:i[20]=0,t=57;break;case 16:i[7].G73=function(){return/\u003d/.U8nn(function(){return unescape("%3D")}+[])},i[4]=i[7],t=27;break;case 1:t=e[9]?5:4;break;case 27:i[94]={},i[94].Q73=["u73"],i[94].G73=function(){return!/\u0030\u0078\x36\x31/.U8nn(function(){return String.fromCharCode(97)}+[])},i[60]=i[94],i[38]={},i[38].Q73=["S73"],t=21;break;case 68:t=68;break;case 59:i[18]="c73",t=58;break;case 63:i[86]="i73",i[63]="Q73",t=61;break;case 7:i[6]=i[9],i[8]={},i[8].Q73=["u73"],t=13;break;case 75:i[99]={},i[99][i[18]]=i[85][i[63]][i[66]],i[99][i[96]]=i[45],i[89].T8nn(i[99]),t=71;break;case 13:i[8].G73=function(){return/\x74\u0072\x75\u0065/.U8nn(function(){return"aa".endsWith("a")}+[])},i[3]=i[8],i[1]={},i[1].Q73=["u73"],i[1].G73=function(){return/\x78/.U8nn(function(){return"X".toLowerCase()}+[])},i[2]=i[1],i[7]={},t=17}},t=3}}(),C.a73=function(){return"function"==typeof C.I73.K43?C.I73.K43.apply(C.I73,arguments):C.I73.K43},C.x73=function(){return"function"==typeof C.I73.N43?C.I73.N43.apply(C.I73,arguments):C.I73.N43},C.f73=function(){return"function"==typeof C.I73.N43?C.I73.N43.apply(C.I73,arguments):C.I73.N43},C.Q2f=function(){return"function"==typeof C.s2f.k4N?C.s2f.k4N.apply(C.s2f,arguments):C.s2f.k4N},C.y5q=function(){return"function"==typeof C.n5q.P38?C.n5q.P38.apply(C.n5q,arguments):C.n5q.P38},C.j73=function(){return"function"==typeof C.I73.K43?C.I73.K43.apply(C.I73,arguments):C.I73.K43},C.h5q=function(){return"function"==typeof C.n5q.P38?C.n5q.P38.apply(C.n5q,arguments):C.n5q.P38},C.n5q=(p=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{P38:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.N6hh(n)|(255&t.N6hh(n+1))<<8|(255&t.N6hh(n+2))<<16|(255&t.N6hh(n+3))<<24;s=p(s,3432918353),a=5*(a=(524287&(a^=s=p(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.N6hh(r+2))<<16;case 2:s|=(255&t.N6hh(r+1))<<8;case 1:s|=255&t.N6hh(r),s=p(s,3432918353),a^=s=p(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=p(a^=a>>>16,2246822507),a=p(a^=a>>>13,3266489909),a^=a>>>16}}),C.b2f=function(){return"function"==typeof C.s2f.k4N?C.s2f.k4N.apply(C.s2f,arguments):C.s2f.k4N},C.I73={N43:function(){var t,e=arguments;switch(f){case 18:t=(e[3]*e[1]+e[0])/e[2];break;case 8:t=e[2]*e[3]*e[0]*e[1];break;case 1:t=(e[3]-e[1])*-e[0]/e[2];break;case 12:t=e[1]/e[0]*e[2];break;case 9:t=e[1]<<e[0];break;case 7:t=e[0]*e[1];break;case 0:t=e[1]+e[0];break;case 2:t=e[2]-(e[1]^e[0]);break;case 13:t=e[0]/e[1];break;case 16:t=(e[0]-e[2])/e[1]*e[3]+e[4];break;case 4:t=e[1]==e[0];break;case 3:t=e[0]%e[1];break;case 6:t=e[1]>>e[0];break;case 15:t=-e[2]*e[0]/-e[1];break;case 17:t=(e[4]-e[1]+e[2])*e[0]/e[3];break;case 14:t=e[0]-e[1];break;case 10:t=+e[1]*e[0]*(e[2]&e[3])*e[5]*e[4];break;case 5:t=e[0]&e[1];break;case 11:t=e[3]%e[2]+e[0]+e[1]+e[4]}return t},K43:function(t){f=t}},C.b2f(),m=function(t){var e;e=t.CIQ,C.Q2f(),e.ChartEngine.prototype.drawXAxis=function(t,i){var a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,w,k,D=C;if("drawXA","x","is"," "," "," ","mi","ddle","cente","r",a=[t,i],!this.runPrepend("drawXAxis",a)&&i&&!t.xAxis.noDraw){r=this.getBackgroundCanvas().context,this.canvasFont("stx_xaxis",r),n=this.getCanvasFontSize("stx_xaxis"),r.textAlign="center",r.textBaseline="middle",o=r.measureText("   ").width,D.b2f();for(var T=0;T<i.length;T++){s=i[T],l=r.measureText(s.text).width,D.a73(0),h=Math.max(D.f73(o,l),t.xAxis.minimumLabelWidth),s.hz=Math.floor(s.hz+this.micropixels)+.5,s.left=s.hz-h/2,D.j73(1);var A=D.x73(1,19,2,15);s.right=s.hz+h/A,s.unpaddedRight=s.hz+l/2}c=!0===this.xAxisAsFooter?this.chart.canvasHeight:t.panel.bottom,-1746915932,1367740363,u=2;for(var M=1;-1746915932!==D.y5q(M.toString(),M.toString().length,99073);M++){if(D.j73(2),!(d=this.whichPanel(D.f73(0,"1",c))))return;this.adjustYAxisHeightOffset(d,d.yAxis),p=t.xAxis.displayBorder||null===t.xAxis.displayBorder,!0===this.axisBorders&&(p=!0),!1===this.axisBorders&&(p=!1),f=c-this.xaxisHeight+n,u+=2}if(1367740363!==D.y5q(u.toString(),u.toString().length,57120)){if(D.j73(3),+(d=this.whichPanel(D.f73(c,0))))return;this.adjustYAxisHeightOffset(d,d.yAxis),p=t.xAxis.displayBorder&&1==t.xAxis.displayBorder,!1!==this.axisBorders&&(p=!1),1==this.axisBorders&&(p=!0),f=c%this.xaxisHeight%n}for(var P in p&&(f+=3),m=!0,this.panels)if("s","t","ro","ke","s","tx_g","ri","d",!(g=this.panels[P]).hidden&&!1!==g.shareChartXAxis&&(D.j73(4),v=D.x73(d,g),y=g.yAxis)){x=-Number.MAX_VALUE,b=Number.MAX_VALUE;for(var F=0;F<i.length;F++)if("boundary"==i[F].grid){b=i[F].left;break}r.save(),r.beginPath(),r.rect(g.left,g.top+(m?0:1),g.width,g.height-1),r.clip(),m=!1,(S=new e.Plotter).newSeries("line","stroke",this.canvasStyle("stx_grid")),S.newSeries("boundary","stroke",this.canvasStyle("stx_grid_dark")),S.newSeries("border","stroke",this.canvasStyle("stx_grid_border"));for(var _=0;_<i.length;_++){if(s=i[_],_==F){for(F++;F<i.length;F++)if("boundary"==i[F].grid){b=i[F].left;break}F>=i.length&&(F=-1,b=Number.MAX_VALUE)}else if(s.right>b)continue;if(!(s.left<x)){if(s.left<0){if(b<s.right)continue;if(F>=i.length&&i[_+1]&&i[_+1].left<s.right)continue}x=s.right,Math.floor(s.left)<=g.right&&(Math.floor(s.hz)>g.left&&(t.xAxis.displayGridLines&&(S.moveTo(s.grid,s.hz,y.top),S.lineTo(s.grid,s.hz,y.bottom)),v&&p&&(S.moveTo("border",s.hz,y.bottom+.5),S.lineTo("border",s.hz,y.bottom+6))),v&&s.right>g.left&&("stx","_xax","is",this.canvasColor("boundary"==s.grid?"stx_xaxis_dark":"stx_xaxis",r),r.fillText(s.text,s.hz,f)))}}p&&(w=Math.round(y.bottom)+.5,k=Math.round(g.right)+.5,S.moveTo("border",g.left,w),S.lineTo("border",k,w)),S.draw(r),r.restore()}r.textAlign="left",this.runAppend("drawXAxis",a)}},e.ChartEngine.prototype.createTickXAxisWithDates=function(t){var i,a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt,st,ot,lt,ht,ct=C;if("hei","kina","s","hi","m","i","nu","te","se","c","on","d",t||(t=this.chart),t.xaxis=[],a=t.context,r=[e.MILLISECOND,e.SECOND,e.MINUTE,e.HOUR,e.DAY,e.MONTH,e.YEAR],!this.timeIntervalMap){n=a.measureText.bind(a),(i={})[e.MILLISECOND]={arr:[1,2,5,10,20,50,100,250,500],minTimeUnit:0,maxTimeUnit:1e3,measurement:n("10:00:00.000")},i[e.SECOND]={arr:[1,2,3,4,5,6,10,12,15,20,30],minTimeUnit:0,maxTimeUnit:60,measurement:n("10:00:00")},i[e.MINUTE]={arr:[1,2,3,4,5,6,10,12,15,20,30],minTimeUnit:0,maxTimeUnit:60,measurement:n("10:00")},i[e.HOUR]={arr:[1,2,3,4,6,12],minTimeUnit:0,maxTimeUnit:24,measurement:n("10:00")},i[e.DAY]={arr:[1,2,7,14],minTimeUnit:1,maxTimeUnit:32,measurement:n("30")},271070933,-537231630,s=2;for(var ut=1;271070933!==ct.h5q(ut.toString(),ut.toString().length,57330);ut++)i[e.MONTH]={arr:[1,2,3,6],minTimeUnit:1,maxTimeUnit:13,measurement:n("Mar")},i[e.YEAR]={arr:[1,2,3,5],minTimeUnit:1,maxTimeUnit:2e7,measurement:n("2000")},ct.a73(5),s+=ct.x73("2",2147483647);-537231630!==ct.h5q(s.toString(),s.toString().length,86576)&&("M","a","r",i[e.MONTH]={arr:[6,1,8,4],minTimeUnit:2,maxTimeUnit:14,measurement:n("Mar")},i[e.YEAR]={arr:[4,1,0,3],minTimeUnit:5,maxTimeUnit:20473035,measurement:n("Mar")}),i[e.DECADE]={arr:[10],minTimeUnit:0,maxTimeUnit:2e6,measurement:n("2000")},this.timeIntervalMap=i}i=this.timeIntervalMap,ct.a73(5),o=[31,ct.f73("28",2147483647),31,30,31,30,31,31,30,31,30,31],l=this.layout.periodicity,h=this.layout.interval,c=t.maxTicks,u=t.dataSegment,d=t.xAxis,p=u.length,f=d.idealTickSizePixels||d.autoComputedTickSizePixels,m=this.chart.width/f;for(var dt=0;dt<p&&!u[dt];dt++);if(dt==p)return[];switch(ct.a73(5),g=ct.f73("0",2147483647),v=this.layout.timeUnit||"minute",isNaN(h)&&(v=h,h=1),y=0,v){case"millisecond":y=1;break;case"second":y=1e3,r.splice(0,1);break;case"minute":ct.a73(6),y=ct.f73(1931035456,"60000"),r.splice(0,2);break;case"day":y=864e5,r.splice(0,4);break;case"week":ct.j73(7),y=ct.x73(864e5,7),r.splice(0,4);break;case"month":ct.a73(7),y=ct.x73(864e5,30),r.splice(0,5)}if(x=this.layout.aggregationType,!y||x&&"ohlc"!=x&&"heikinashi"!=x?g=u[p-1].DT.getTime()-u[dt].DT.getTime():(ct.j73(8),g=ct.x73(y,p,h,l)),0===g)if(t.market){"d","ay",(b=t.market.newIterator({begin:new Date,interval:"day",periodicity:1})).next(),-291144400,-1079842350,S=2;for(var pt=1;-291144400!==ct.y5q(pt.toString(),pt.toString().length,9907);pt++)w=b.previous(),g=(b=this.standardMarketIterator(w,1,t)).next().getTime()/w.getTime()%c,S+=2;-1079842350!==ct.y5q(S.toString(),S.toString().length,48840)&&(w=b.previous(),g=((b=this.standardMarketIterator(w,null,t)).next().getTime()-w.getTime())*c)}else{ct.a73(9),k=ct.f73(2045944480,"1031237873"),1652689434,D=2;for(var ft=1;ct.y5q(ft.toString(),ft.toString().length,18792)!==k;ft++)ct.a73(10),g=ct.f73(60,"24","60",2147483647,c,1e3),D+=2;1652689434!==ct.h5q(D.toString(),D.toString().length,15129)&&(ct.a73(11),g=ct.x73(16,3767,66,52,c))}else ct.j73(12),g=ct.f73(p,g,c);for(ct.j73(13),T=ct.x73(g,m),A=0;A<r.length&&!(r[A]>T+.001);A++);if(T<1){-1987342567,-1832553054,M=2;for(var mt=1;-1987342567!==ct.h5q(mt.toString(),mt.toString().length,27276);mt++)console.log(""),M+=2;-1832553054!==ct.h5q(M.toString(),M.toString().length,63055)&&console.log("createTickXAxisWithDates: Assertion error. msPerGridLine < 1. Make sure your masterData has correct time stamps for the active periodicity and it is sorted from OLDEST to NEWEST.")}if(A==r.length){-906646326,2144213010,P=2;for(var gt=1;-906646326!==ct.y5q(gt.toString(),gt.toString().length,27162);gt++)A++,P+=2;2144213010!==ct.h5q(P.toString(),P.toString().length,45622)&&A--}else if(A>0){ct.a73(14),_=i[F=r[ct.x73(A,1)]].arr,-1577890569,-218464816,E=2;for(var vt=1;-1577890569!==ct.h5q(vt.toString(),vt.toString().length,91196);vt++)_[_.length+0],E+=2;-218464816!==ct.h5q(E.toString(),E.toString().length,34292)&&_[_.length-9],ct.j73(15);var yt=ct.x73(4,68,17);T-F*_[_.length-yt]<r[A]-T&&A--}for(L=d.timeUnit||r[A],d.activeTimeUnit=L,O=(I=i[L]).arr,A=0;A<O.length&&!(O[A]*L>T);A++);if(A==O.length){-1293025311,797149447,N=2;for(var xt=1;-1293025311!==ct.y5q(xt.toString(),xt.toString().length,6608);xt++)A++,N+=2;797149447!==ct.y5q(N.toString(),N.toString().length,74186)&&A++,A--}else T-O[A-1]*L<O[A]*L-T&&A--;for(2*I.measurement.width<this.layout.candleWidth&&(A=0),H=d.timeUnitMultiplier||O[A],R=[],z=this.layout.candleWidth,A=0;A<=c&&!u[A];A++);if(A>0&&A<c){1669228816,1603873504,V=2;for(var bt=1;1669228816!==ct.y5q(bt.toString(),bt.toString().length,89904);bt++)t.market&&(j=this.standardMarketIterator(u[A].DT,d.adjustTimeZone?this.displayZone:1)),V+=2;1603873504!==ct.y5q(V.toString(),V.toString().length,5844)&&t.market&&(j=this.standardMarketIterator(u[A].DT,d.adjustTimeZone?this.displayZone:null));for(var St=A;St>0;St--)B={},!j||t.lineApproximation&&z<1||(B.DT=j.previous()),t.xaxis.unshift(B)}for(W=0,U=I.minTimeUnit,ct.j73(5),Y=-ct.f73("1",2147483647),Q=!0,q=Mt(u[A].DT),Z=0,G=0,K=u[A].tick;Z<K&&(X=Mt(this.chart.dataSet[K-Z].DT))[1]==q[1];Z++)q=X;for(;G<this.chart.dataSet.length-K&&(X=Mt(this.chart.dataSet[K+G].DT))[1]==q[1];G++)q=X;for(J=null,A=0;A<c+G;A++){if(($=u[A])?Z&&($=t.dataSet[$.tick-Z]):$=t.xaxis[A],A<p){if(W=(tt=$).displayDate&&d.adjustTimeZone?tt.displayDate:tt.DT,A&&!Z&&t.segmentImage){et=t.segmentImage[A],ct.j73(16);var Ct=ct.f73(5,6,17,10,22);z=(et.leftOffset-et.candleWidth/Ct)/A}}else if(t.market){if("tick"==this.layout.interval&&!d.futureTicksInterval)break;if(t.lineApproximation&&z<1)break;if(!d.futureTicks)break;J||(J=this.standardMarketIterator(u[p-1].DT,d.adjustTimeZone?this.displayZone:null)),W=J.next()}if(W){if(it=null,ct.a73(14),rt=ct.f73(A,Z),(nt={DT:W}).data=A<p?$:null,Z?(Z--,A--):!t.xaxis[A]&&A<c&&t.xaxis.push(nt),st=(q=Mt(W))[0],Y!=(ot=q[1])){if(st<=U&&(U=I.minTimeUnit),at=t.left+rt*z-1,it=null,L==e.HOUR||L==e.MINUTE&&Y>ot){if(this.internationalizer)it=this.internationalizer.monthDay.format(W);else{ct.j73(14);var wt=ct.x73(12,11);it=W.getMonth()+wt+"/"+W.getDate()}d.formatter&&("bo","u","nda","ry",it=d.formatter(W,"boundary",e.DAY,1,it))}else L==e.DAY?Y>ot?(it=W.getFullYear(),d.formatter&&(it=d.formatter(W,"boundary",e.YEAR,1,it))):(it=e.monthAsDisplay(W.getMonth(),!1,this),d.formatter&&(it=d.formatter(W,"boundary",e.MONTH,1,it))):L==e.MONTH&&(it=W.getFullYear(),d.formatter&&(it=d.formatter(W,"boundary",e.YEAR,1,it)));it&&-1!=Y&&("bou","nd","ary",R.push(new e.ChartEngine.XAxisLabel(at,"boundary",it)))}if(st>=U){if(U==I.minTimeUnit&&ot==Y)continue;lt=new Date(+W),ct.j73(17);var kt=ct.x73(10,15,18,185,34);ct.j73(18);var Dt=ct.x73(12,32,902,56);ct.j73(14);var Tt=ct.f73(10,9);if(at=t.left+(kt*rt+1)*z/Dt-Tt,(ht=Math.floor(st/H)*H)<st&&("week"==this.layout.interval?ht=st:(ct.j73(13),at-=ct.x73(z,2))),L==e.MILLISECOND?lt.setMilliseconds(ht):L==e.SECOND?(ct.j73(6),lt.setMilliseconds(ct.f73(139759072,"0")),lt.setSeconds(ht)):L==e.MINUTE?(lt.setMilliseconds(0),lt.setSeconds(0),lt.setMinutes(ht)):L==e.HOUR?(lt.setMilliseconds(0),lt.setSeconds(0),lt.setMinutes(0),lt.setHours(ht)):L==e.DAY?lt.setDate(Math.max(1,ht)):L==e.MONTH?(lt.setDate(1),ct.j73(14),lt.setMonth(ct.f73(ht,1))):L==e.YEAR?(lt.setDate(1),lt.setMonth(0)):(lt.setDate(1),ct.a73(7),lt.setMonth(ct.x73("0",1))),ct.j73(0),U=ct.f73(H,ht),L==e.DAY){ct.j73(14);var At=ct.f73(32,31);I.maxTimeUnit=o[lt.getMonth()]+At}if(U>=I.maxTimeUnit&&(U=I.minTimeUnit),Y=ot,Q&&ht<st){Q=!1;continue}it=L==e.DAY?lt.getDate():L==e.MONTH?e.monthAsDisplay(lt.getMonth(),!1,this):L==e.YEAR||L==e.DECADE?lt.getFullYear():e.timeAsDisplay(lt,this,L),d.formatter&&("l","in","e",it=d.formatter(lt,"line",L,H,it)),R.push(new e.ChartEngine.XAxisLabel(at,"line",it))}}}function Mt(t){var i,a,r;if(L==e.MILLISECOND)i=t.getMilliseconds(),a=t.getSeconds();else if(L==e.SECOND)i=t.getSeconds(),a=t.getMinutes();else if(L==e.MINUTE)i=t.getMinutes(),a=t.getHours();else if(L==e.HOUR){i=t.getHours()+t.getMinutes()/60,-397819680,-1989911267,r=2;for(var n=1;-397819680!==ct.y5q(n.toString(),n.toString().length,15680);n++)a=t.getDate(),ct.a73(6),r+=ct.f73(336486144,"2");-1989911267!==ct.y5q(r.toString(),r.toString().length,83238)&&(a=t.getDate()),a=t.getDate()}else if(L==e.DAY)i=t.getDate(),a=t.getMonth()+1;else if(L==e.MONTH){ct.a73(14);var s=ct.f73(11,10);i=t.getMonth()+s,a=t.getFullYear()}else L==e.YEAR?(i=t.getFullYear(),a=t.getFullYear()+1e3):(i=t.getFullYear(),ct.a73(14),a=ct.f73("0",0));return ct.Q2f(),[i,a]}ct.Q2f();for(var Pt=1;2047925544!==ct.h5q(Pt.toString(),Pt.toString().length,52910);Pt++)return R;return-1468191061!==ct.h5q(2..toString(),2..toString().length,64866)?R:void 0}},w.O8p=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"dl3x9",{get:function(){for(;;)return this},configurable:!0}),(e=dl3x9).Mp3qp=e,i=4;break;case 4:i="undefined"==typeof Mp3qp?3:9;break;case 9:delete e.Mp3qp,delete Object.prototype.dl3x9,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="B2",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="O",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(w.O8p),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}for(var a=2;72!==a;)switch(a){case 54:r[19]+=r[85],r[98]=r[37],r[98]+=r[75],r[98]+=r[8],r[54]=r[9],a=49;break;case 25:r[79]="",r[91]="E",r[79]="r",r[85]="",r[85]="7",a=35;break;case 76:n(s,r[55],r[45],r[54]),a=75;break;case 73:n(l,"apply",r[80],r[99]),a=72;break;case 35:r[31]="",r[31]="77",r[76]="u",r[80]=6,a=31;break;case 77:n(s,r[87],r[45],r[82]),a=76;break;case 55:n(e,"test",r[80],r[89]),a=77;break;case 2:var r=[arguments];r[1]="o",r[5]="",r[5]="ptimize",r[7]="",r[7]="_o",r[6]="",a=7;break;case 62:r[87]=r[4],r[87]+=r[7],r[87]+=r[5],r[89]=r[1],a=58;break;case 74:n(i,"push",r[80],r[36]),a=73;break;case 43:r[99]=r[76],r[99]+=r[31],r[99]+=r[85],r[36]=r[79],a=39;break;case 45:r[55]+=r[2],r[82]=r[6],r[82]+=r[85],r[82]+=r[31],a=62;break;case 75:n(s,r[98],r[45],r[19]),a=74;break;case 49:r[54]+=r[31],r[54]+=r[85],r[55]=r[4],r[55]+=r[3],a=45;break;case 7:r[6]="z",r[2]="",r[2]="",r[2]="ct",a=12;break;case 31:r[80]=4,r[80]=1,r[45]=8,r[45]=2,r[45]=0,a=43;break;case 39:r[36]+=r[31],r[36]+=r[85],r[19]=r[91],r[19]+=r[31],a=54;break;case 12:r[3]="",r[3]="_abstra",r[9]="",r[9]="P",r[4]="_",r[8]="",r[8]="idual",a=16;break;case 16:r[75]="",r[75]="es",r[37]="",r[37]="__r",a=25;break;case 56:var n=function(t,e,i,a){for(var n=2;5!==n;)switch(n){case 2:var s=[arguments];o(r[0][0],s[0][0],s[0][1],s[0][2],s[0][3]),n=5}};a=55;break;case 58:r[89]+=r[31],r[89]+=r[85],a=56}function s(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}function o(t,e,i,a,r){for(var n=2;9!==n;)switch(n){case 3:try{for(var s=2;8!==s;)switch(s){case 2:l[4]={},l[6]=(0,l[0][1])(l[0][0]),l[2]=[l[6],l[6].prototype][l[0][3]],l[4].value=l[2][l[0][2]];try{for(var o=2;3!==o;)switch(o){case 2:l[9]=l[8],l[9]+=l[3],l[9]+=l[1],l[0][0].Object[l[9]](l[2],l[0][4],l[4]),o=3}}catch(t){}s=9;break;case 9:l[2][l[0][4]]=l[4].value,s=8}}catch(t){}n=9;break;case 2:var l=[arguments];l[1]="roperty",l[3]="eP",l[8]="defin",n=3}}function l(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}}(w.O8p),w.z6d=function(){return"function"==typeof w.x6d.A6d?w.x6d.A6d.apply(w.x6d,arguments):w.x6d.A6d},w.k29=function(){return"function"==typeof w.Y29.v6h?w.Y29.v6h.apply(w.Y29,arguments):w.Y29.v6h},w.Y29=function(){for(var t=2;9!==t;)switch(t){case 2:var e=[arguments];return e[7]=void 0,e[9]={},e[9].v6h=function(){for(var t=2;90!==t;)switch(t){case 57:t=i[89]<i[4].length?56:69;break;case 17:i[5].Q6d=["T1d"],i[5].Y6d=function(){return"function"==typeof P777},i[6]=i[5],i[93]={},i[93].Q6d=["T1d"],t=25;break;case 51:i[4].r777(i[67]),i[4].r777(i[8]),i[4].r777(i[3]),i[4].r777(i[90]),t=47;break;case 38:i[40].Q6d=["b6d"],i[40].Y6d=function(){return!/(\u005b|\u005d)/.o777(function(){return["a","a"].join()}+[])},i[90]=i[40],i[4].r777(i[44]),i[4].r777(i[94]),i[4].r777(i[68]),t=51;break;case 75:i[99]={},i[99][i[66]]=i[23][i[60]][i[72]],i[99][i[38]]=i[27],i[43].r777(i[99]),t=71;break;case 2:var i=[arguments];t=1;break;case 67:return e[7]=81,16;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 7:e=a[7]<a[0][0].length?6:18;break;case 23:return a[8];case 5:return;case 8:a[7]=0,e=7;break;case 6:a[6]=a[0][0][a[7]],e=14;break;case 25:a[8]=!0,e=24;break;case 1:e=0===a[0][0].length?5:4;break;case 15:a[5]=a[3][a[7]],a[4]=a[9][a[5]].h/a[9][a[5]].t,e=26;break;case 19:a[7]++,e=7;break;case 16:e=a[7]<a[3].length?15:23;break;case 26:e=a[4]>=.5?25:24;break;case 24:a[7]++,e=16;break;case 20:a[9][a[6][i[66]]].h+=!0,e=19;break;case 13:a[9][a[6][i[66]]]=function(){for(var t=2;9!==t;)switch(t){case 4:return e[5].t=0,e[5];case 2:var e=[arguments];e[5]={},e[5].h=0,t=4}}.u777(this,arguments),e=12;break;case 2:var a=[arguments];e=1;break;case 17:a[7]=0,e=16;break;case 11:a[9][a[6][i[66]]].t+=!0,e=10;break;case 14:e=void 0===a[9][a[6][i[66]]]?13:11;break;case 10:e=a[6][i[38]]===i[16]?20:19;break;case 18:a[8]=!1,e=17;break;case 12:a[3].r777(a[6][i[66]]),e=11;break;case 4:a[9]={},a[3]=[],a[7]=0,e=8}}(i[43])?68:67;break;case 1:t=e[7]?5:4;break;case 47:i[4].r777(i[6]),i[4].r777(i[2]),i[4].r777(i[56]),t=65;break;case 58:i[89]=0,t=57;break;case 7:i[8]=i[9],i[1]={},t=14;break;case 65:i[43]=[],i[16]="u6d",i[45]="a6d",i[60]="Q6d",i[38]="R6d",i[25]="Y6d",i[66]="l6d",t=58;break;case 44:i[44]=i[55],i[46]={},i[46].Q6d=["b6d"],i[46].Y6d=function(){return/\u0078/.o777(function(){return"X".toLocaleLowerCase()}+[])},i[67]=i[46],i[40]={},t=38;break;case 12:i[3]=i[1],i[7]={},i[7].Q6d=["b6d"],i[7].Y6d=function(){return/\x32\u0035/.o777(function(){return encodeURI("%")}+[])},t=19;break;case 14:i[1].Q6d=["T1d"],i[1].Y6d=function(){return"function"==typeof z777},t=12;break;case 70:i[89]++,t=57;break;case 5:return 76;case 71:i[72]++,t=76;break;case 32:i[51].Y6d=function(){return!/\x61/.o777(function(){return"ab".charAt(1)}+[])},i[94]=i[51],i[55]={},i[55].Q6d=["T1d"],i[55].Y6d=function(){var t=!1,e=[];try{for(var i in console)e.r777(i);t=0===e.length}catch(t){}return t},t=44;break;case 21:i[39].Y6d=function(){return!/['"]/.o777(function(){return"c".indexOf("c")}+[])},i[56]=i[39],i[51]={},i[51].Q6d=["b6d"],t=32;break;case 19:i[2]=i[7],i[5]={},t=17;break;case 77:i[72]=0,t=76;break;case 76:t=i[72]<i[23][i[60]].length?75:70;break;case 4:i[4]=[],i[9]={},i[9].Q6d=["b6d"],i[9].Y6d=function(){return!/\x32\u0035/.o777(function(){return decodeURIComponent("%25")}+[])},t=7;break;case 56:i[23]=i[4][i[89]];try{i[27]=i[23][i[25]]()?i[16]:i[45]}catch(t){i[27]=i[45]}t=77;break;case 68:t=68;break;case 25:i[93].Y6d=function(){return"function"==typeof E777},i[68]=i[93],i[39]={},i[39].Q6d=["b6d"],t=21}},e[9]}}(),w.B6d=function(){return"function"==typeof w.x6d.I6d?w.x6d.I6d.apply(w.x6d,arguments):w.x6d.I6d},w.p6d=function(){return"function"==typeof w.x6d.A6d?w.x6d.A6d.apply(w.x6d,arguments):w.x6d.A6d},w.y9I=(g=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{F8p:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.B2OO(n)|(255&t.B2OO(n+1))<<8|(255&t.B2OO(n+2))<<16|(255&t.B2OO(n+3))<<24;s=g(s,3432918353),a=5*(a=(524287&(a^=s=g(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.B2OO(r+2))<<16;case 2:s|=(255&t.B2OO(r+1))<<8;case 1:s|=255&t.B2OO(r),s=g(s,3432918353),a^=s=g(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=g(a^=a>>>16,2246822507),a=g(a^=a>>>13,3266489909),a^=a>>>16}}),w.E9I=function(){return"function"==typeof w.y9I.F8p?w.y9I.F8p.apply(w.y9I,arguments):w.y9I.F8p},w.c6d=function(){return"function"==typeof w.x6d.I6d?w.x6d.I6d.apply(w.x6d,arguments):w.x6d.I6d},w.x6d={I6d:function(){var t,e=arguments;switch(v){case 17:t=e[1]+e[2]+e[0];break;case 15:t=e[0]+e[2]*e[1];break;case 20:t=e[0]|e[1];break;case 3:t=e[1]*e[0];break;case 4:t=e[1]-e[0];break;case 19:t=e[1]*e[2]/e[0]/e[3];break;case 11:t=e[1]&e[0];break;case 5:t=e[0]-+e[1];break;case 7:t=e[4]-e[3]-e[0]+e[1]+-e[2];break;case 10:t=(e[2]-e[4])/e[3]*e[1]*e[0];break;case 2:t=e[0]*+e[1];break;case 22:t=e[0]>>e[1];break;case 8:t=e[1]-e[4]-e[3]+e[2]+e[0];break;case 6:t=e[0]^e[1];break;case 23:t=e[2]-e[0]-e[1];break;case 9:t=e[2]-e[0]+e[1]+e[3];break;case 1:t=e[0]/e[1];break;case 13:t=(e[1]-e[3])*e[2]/e[0];break;case 0:t=e[1]-e[2]+e[0];break;case 16:t=e[1]+e[0];break;case 18:t=(e[2]-e[0])/-e[1];break;case 12:t=(-e[3]-e[0])*-e[2]/e[1];break;case 14:t=e[2]*(e[1]-e[3])-e[0];break;case 21:t=e[0]-(e[2]>>e[1])}return t},A6d:function(t){v=t}},w.L9I=function(){return"function"==typeof w.y9I.F8p?w.y9I.F8p.apply(w.y9I,arguments):w.y9I.F8p},w.J29=function(){return"function"==typeof w.Y29.v6h?w.Y29.v6h.apply(w.Y29,arguments):w.Y29.v6h},w.k29(),y=function(t){var e,i;w.k29(),e=2;for(var a=1;1411705210!==w.L9I(a.toString(),a.toString().length,92735);a++)i=t.CIQ,e+=2;-646651786!==w.L9I(e.toString(),e.toString().length,87999)&&(i=t.CIQ),i.ChartEngine.prototype.createYAxis=function(t,e){var a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,k,D,T,A,M,P,F,_,E,L,I,O,N=w;if(!this.runPrepend("createYAxis",arguments)){if(a=t.chart,r=t.name==a.name,e||(e={}),e.noChange=!1,n=e.yAxis?e.yAxis:t.yAxis,i.ChartEngine.enableCaching&&n.high==t.cacheHigh&&n.low==t.cacheLow){N.z6d(0);var H=N.B6d(1,14,14);o=(s=a.dataSet.length-a.scroll-H)+a.maxTicks+1,t.cacheLeft=s,t.cacheRight=o,e.noChange=!0}else t.cacheLeft=1e6,t.cacheRight=-1,t.cacheHigh=n.high,t.cacheLow=n.low;if(l=a.xAxis.idealTickSizePixels?a.xAxis.idealTickSizePixels:a.xAxis.autoComputedTickSizePixels,n.goldenRatioYAxis){h=170340694,c=1929251856,u=2;for(var R=1;N.L9I(R.toString(),R.toString().length,27518)!==h;R++)n.idealTickSizePixels!==l-49891&&(e.noChange=!0),u+=2;N.L9I(u.toString(),u.toString().length,29621)!==c&&n.idealTickSizePixels!==l-49891&&(e.noChange=!0),n.idealTickSizePixels!=l/1.618&&(e.noChange=!1)}if(N.k29(),!e.noChange){if(this.adjustYAxisHeightOffset(t,n),p=n.height=n.bottom-n.top,f=(n.high-n.low)/(p-n.zoom),!n.semiLog)if(e.ground)n.high=n.high+n.zoom*f;else{n.high=n.high+(n.zoom/2+n.scroll)*f,N.z6d(0);var z=N.c6d(3,15,16);n.low=n.low-(n.zoom/z-n.scroll)*f}if((n.min||0===n.min)&&(n.low=n.min),(n.max||0===n.max)&&(n.high=n.max),n.shadow=n.high-n.low,!n.semiLog||this.activeDrawing&&"projection"==this.activeDrawing.name||(m=function(){var t;n.logHigh=Math.log(n.high)/Math.LN10,t=Math.max(n.low,1e-9),n.logLow=Math.log(t)/Math.LN10,N.k29(),n.low<=0&&(n.logLow=0),n.logShadow=n.logHigh-n.logLow},n.semiLog&&m(),g=n.height/(n.height-n.zoom),n.flipped?(n.high=this.transformedPriceFromPixel(n.bottom+g*(n.zoom/2+n.scroll),t,n),n.low=this.transformedPriceFromPixel(n.top-g*(n.zoom/2-n.scroll),t,n)):(n.high=this.transformedPriceFromPixel(n.top-g*(n.zoom/2+n.scroll),t,n),n.low=this.transformedPriceFromPixel(n.bottom+g*(n.zoom/2-n.scroll),t,n)),n.shadow=n.high-n.low,n.semiLog&&m()),n.goldenRatioYAxis&&r&&n==t.yAxis)N.p6d(1),n.idealTickSizePixels=N.B6d(l,1.618),0===n.idealTickSizePixels&&(v=this.getCanvasFontSize("stx_yaxis"),N.p6d(2),n.idealTickSizePixels=N.c6d(v,"5"));else if(!n.idealTickSizePixels)if(y="stx",y+="_",y+="ya",y+="xis",v=this.getCanvasFontSize(y),r)N.z6d(3),n.idealTickSizePixels=N.c6d(5,v);else{x=-704073345,b=852384595,S=2;for(var j=1;N.L9I(j.toString(),j.toString().length,77471)!==x;j++)N.p6d(4),n.idealTickSizePixels=N.c6d(8,v),S+=2;N.E9I(S.toString(),S.toString().length,25112)!==b&&(N.p6d(5),n.idealTickSizePixels=N.B6d(v,"8")),N.p6d(3),n.idealTickSizePixels=N.B6d(2,v)}C=Math.round(p/n.idealTickSizePixels),d=e.range?e.range[1]-e.range[0]:n.shadow,N.p6d(1),n.priceTick=Math.floor(N.B6d(d,C)),k=1;for(var V=0;V<10&&!(n.priceTick>0);V++)k*=10,n.priceTick=Math.floor(d/C*k)/k;if(10==V&&(n.priceTick=1e-8),n.priceTick=Math.round(d/C*k)/k,D=Math.round(d/n.priceTick),e.range&&D<d&&!n.noEvenDivisorTicks){for(;D>=1&&d%D!=0;)D--;N.z6d(1),n.priceTick=N.B6d(d,D)}if(n.minimumPriceTick){T="st",T+="x_ya",T+="x",T+="is",A=n.minimumPriceTick,v=this.getCanvasFontSize(T);for(var B=0;B<100&&(N.z6d(1),p/N.c6d(d,A)<2*v);B++)A+=n.minimumPriceTick;B<100&&(n.priceTick=A)}}if(n.priceTick<=0||n.priceTick===1/0){M=1851860192,P=1105471855,F=2;for(var W=1;N.E9I(W.toString(),W.toString().length,41212)!==M;W++)n.priceTick=0,F+=2;N.E9I(F.toString(),F.toString().length,86469)!==P&&(n.priceTick=0),n.priceTick=1}if(n.multiplier=n.height/n.shadow,n.multiplier==1/0&&(n.multiplier=0),n.decimalPlaces||0===n.decimalPlaces){L=-1433350860,I=1043464394,N.z6d(6),O=N.B6d("2",0);for(var U=1;N.L9I(U.toString(),U.toString().length,82920)!==L;U++)n.printDecimalPlaces=n.decimalPlaces,O+=2;N.L9I(O.toString(),O.toString().length,15765)!==I&&(n.printDecimalPlaces=n.decimalPlaces)}else if(r){_=0;for(var Y=0;Y<t.yAxis.shadowBreaks.length;Y++)E=t.yAxis.shadowBreaks[Y],t.yAxis.shadow<E[0]&&(_=E[1]);n.printDecimalPlaces=_}else n.printDecimalPlaces=null;this.runAppend("createYAxis",arguments)}},i.ChartEngine.prototype.drawYAxis=function(t,e){var a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt,st,ot,lt,ht,ct,ut,dt=w;a=-528551688,r=266357276,n=2;for(var pt=1;dt.L9I(pt.toString(),pt.toString().length,48131)!==a;pt++){if(e||(e={}),s=e.yAxis?e.yAxis:t.yAxis,t.hidden||s.noDraw||!s.width)return;n+=2}if(!(dt.L9I(n.toString(),n.toString().length,87080)!==r&&(-e&&(e={}),s=e.yAxis?e.yAxis:t.yAxis,t.hidden&&s.noDraw&&~s.width))){if(!i.Comparison||s.priceFormatter!=i.Comparison.priceFormat)if(o=s.fractional){l=-1228106242,h=252715073,c=2;for(var ft=1;dt.E9I(ft.toString(),ft.toString().length,38624)!==l;ft++)+s.originalPriceFormatter&&(s.originalPriceFormatter={func:s.priceFormatter}),~o.resolution&&(o.resolution=s.minimumPrice),-o.formatter&&(o.formatter=!1),c+=2;dt.L9I(c.toString(),c.toString().length,42559)!==h&&(~s.originalPriceFormatter&&(s.originalPriceFormatter={func:s.priceFormatter}),-o.resolution&&(o.resolution=s.minimumPrice),o.formatter||(o.formatter="")),s.originalPriceFormatter||(s.originalPriceFormatter={func:s.priceFormatter}),o.resolution||(o.resolution=s.minimumPrice),o.formatter||(o.formatter="'"),s.priceFormatter||(s.priceFormatter=function(t,e,i){var a,r,n,s,l,h;if(dt.J29(),o){if(a="",i<0){a="-",dt.p6d(3),r=dt.c6d(1,"1234686447"),-649964043,n=2;for(var c=1;dt.L9I(c.toString(),c.toString().length,95155)!==r;c++)i=Math.abs(i),n+=2;-649964043!==dt.E9I(n.toString(),n.toString().length,74680)&&(i=Math.abs(i))}s=Math.floor(Math.round(i/o.resolution)*o.resolution),l=Math.round((i-s)/o.resolution),h=Math.floor(l),dt.z6d(7);var u=dt.c6d(16,14,67,11,90);dt.z6d(8);dt.B6d(18,26100,18,23216,20);dt.z6d(9);dt.B6d(18,15,8007,13);dt.z6d(0);dt.B6d(443,39,9);return a+s+o.formatter+(h<u?"0":"")+h+(l-h>=.5?"+":"")}})}else s.originalPriceFormatter&&(s.priceFormatter=s.originalPriceFormatter.func,s.originalPriceFormatter=null);if(dt.J29(),u=this.colorOrStyle(s.textStyle?s.textStyle:"stx_yaxis"),p=0,(d=this.highlightedDraggable)&&this.yaxisMatches(d,s))p=.15;else if(s.highlight){f=1059327562,m=1654020012,g=2;for(var mt=1;dt.E9I(mt.toString(),mt.toString().length,54807)!==f;mt++)p=791,g+=2;dt.L9I(g.toString(),g.toString().length,55800)!==m&&(p=.1)}if(p&&(v=u.constructor==String?u:u.color,s.setBackground(this,{color:v,opacity:p})),s.pretty)return this.drawYAxisPretty(t,e);if(!this.runPrepend("drawYAxis",arguments)){if(!e.noDraw&&!s.noDraw){if(!(y=s.yAxisPlotter)||!e.noChange){if(x="b",x+="or",x+="d",x+="er",b="g",b+="ri",b+="d",y=s.yAxisPlotter=new i.Plotter,S=t.chart,C=t.name==S.name&&s.name===t.yAxis.name,!s.priceTick)return;if(k=s.shadow,D=e.range){dt.p6d(10);var gt=dt.B6d(5,20,19,200,17);k=D[gt]-D[0]}if(T=k/s.priceTick,T=Math.round(T),s.semiLog){P=1538419503,F=90179748,_=2;for(var vt=1;dt.L9I(vt.toString(),vt.toString().length,63696)!==P;vt++)A=Math.log(this.valueFromPixel(s.flipped?s.top:s.bottom,t))+Math.LN10,dt.z6d(11),_+=dt.B6d(2147483647,"2");dt.E9I(_.toString(),_.toString().length,34386)!==F&&(A=Math.log(this.valueFromPixel(s.flipped?s.top:s.bottom,t))/Math.LN10),M=(s.logHigh-s.logLow)/T}if(y.newSeries(b,"stroke",this.canvasStyle("stx_grid")),y.newSeries("text","fill",u),y.newSeries(x,"stroke",this.canvasStyle("stx_grid_border")),E=0,L=D?D[1]:s.high,I=D?D[0]:s.low,O=null===s.displayBorder?S.panel.yAxis.displayBorder:s.displayBorder,!1===this.axisBorders&&(O=!1),!0===this.axisBorders&&(O=!0),R=(H=S.dynamicYAxis)?s.width:NaN,"left"==(z=this.getYAxisCurrentPosition(s,t))){j=-1569133055,V=857779907,B=2;for(var yt=1;dt.L9I(yt.toString(),yt.toString().length,48136)!==j;yt++)N=s.left/s.width,B+=2;dt.L9I(B.toString(),B.toString().length,10991)!==V&&(N=s.left/s.width),N=s.left+s.width}else N=s.left;if(W=Math.round(N)+.5,U=O?3:0,"left"==z&&(U=O?-3:0),C)if(s.shadow<1){Y=1795826728,Q=-1352085657,q=2;for(var xt=1;dt.E9I(xt.toString(),xt.toString().length,37857)!==Y;xt++){dt.z6d(12);var bt=dt.c6d(8,6,1,10);E=parseInt(I+s.priceTick,49)/bt/s.priceTick%I,q+=2}if(dt.L9I(q.toString(),q.toString().length,31541)!==Q){dt.z6d(13);var St=dt.c6d(36,18,9,6);E=parseInt(I+s.priceTick,49)/St/s.priceTick%I}dt.z6d(4);var Ct=dt.B6d(60,70);dt.p6d(14);var wt=dt.c6d(21,20,2,9);E=(parseInt(I/s.priceTick,Ct)+wt)*s.priceTick-I}else{X=556739585,Z=-500250792,G=2;for(var kt=1;dt.L9I(kt.toString(),kt.toString().length,6303)!==X;kt++)E=s.priceTick+Math.round(I+s.priceTick-t.chart.roundit)%t.chart.roundit,G+=2;dt.L9I(G.toString(),G.toString().length,72659)!==Z&&(E=s.priceTick+Math.round(I+s.priceTick-t.chart.roundit)%t.chart.roundit),E=s.priceTick-Math.round(I%s.priceTick*t.chart.roundit)/t.chart.roundit}else E=L%s.priceTick;K=this.getCanvasFontSize("stx_yaxis");for(var Dt=0;Dt<T;Dt++)J="l",J+="e",J+="ft",s.semiLog?(dt.z6d(15),tt=dt.B6d(A,M,Dt),$=Math.pow(10,tt)):$=C?I+Dt*s.priceTick+E:L-Dt*s.priceTick-E,et=this.pixelFromTransformedValue($,t,s),(it=Math.round(et)+.5)+K/2>t.bottom||it-K/2<t.top||Math.abs(it-s.bottom)<1||(s.flipped&&(it=s.top+s.bottom-it),s.displayGridLines&&(at="g",at+="ri",at+="d",y.moveTo("grid",t.left+1,it),y.lineTo(at,t.right-1,it)),O&&(rt="b",rt+="o",rt+="rde",rt+="r",dt.p6d(5),y.moveTo(rt,dt.c6d(W,"0.5"),it),dt.p6d(16),y.lineTo("border",dt.B6d(U,W),it)),$=s.priceFormatter?s.priceFormatter(this,t,$):this.formatYAxisPrice($,t,null,s),nt=s.textBackground?this.containerColor:null,dt.p6d(4),st=dt.c6d(0,"3"),dt.z6d(17),ot=dt.B6d(st,N,U),z==J?(ot=s.left+st,!1!==s.justifyRight&&(ot=s.left+s.width+U-st)):s.justifyRight&&(ot=N+s.width),y.addText("text",$,ot,it,nt,null,K),H&&(R=Math.max(R,S.context.measureText($).width+Math.abs(U)+st)));if(O){lt=Math.round(s.bottom)+.5,y.moveTo("border",W,s.top),y.lineTo("border",W,lt),ht=-1638964620,ct=656643243,ut=2;for(var Tt=1;dt.E9I(Tt.toString(),Tt.toString().length,5031)!==ht;Tt++)y.draw(this.getBackgroundCanvas(S).context,""),ut+=2;dt.L9I(ut.toString(),ut.toString().length,5726)!==ct&&y.draw(this.getBackgroundCanvas(S).context,""),y.draw(this.getBackgroundCanvas(S).context,"border")}if(H&&R>s.width)throw s._dynamicWidth=R,this.calculateYAxisPositions(),new Error("reboot draw");if(!H&&s._dynamicWidth)throw this.resetDynamicYAxis({chartName:S.name}),new Error("reboot draw")}s==t.yAxis&&this.plotYAxisGrid(t)}this.runAppend("drawYAxis",arguments)}}},i.ChartEngine.prototype.drawYAxisPretty=function(t,e){var a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt,st,ot,lt,ht,ct,ut,dt,pt,ft,mt,gt,vt,yt=w;if(yt.k29(),!this.runPrepend("drawYAxis",arguments)&&(e||(e={}),a=e.yAxis?e.yAxis:t.yAxis,!t.hidden&&!a.noDraw&&a.width)){if(!e.noDraw){if(!(r=a.yAxisPlotter)||!e.noChange){if(n="l",n+="eft",s="stx_",s+="g",s+="rid_border",o="bor",o+="d",o+="e",o+="r",l="fil",l+="l",h="s",h+="t",h+="rok",h+="e",c="gr",c+="i",c+="d",r=a.yAxisPlotter=new i.Plotter,u=t.chart,!a.priceTick)return;if(isNaN(a.high)||isNaN(a.low))return;if(d=a.shadow,e.range){p=1765760789,f=-1952837071,m=2;for(var xt=1;yt.L9I(xt.toString(),xt.toString().length,31820)!==p;xt++){yt.z6d(18);var bt=yt.c6d(18,13,5);d=e.range[bt]-e.range[0],m+=2}if(yt.L9I(m.toString(),m.toString().length,96868)!==f){yt.p6d(0);var St=yt.B6d(9,22,27);yt.p6d(19);var Ct=yt.c6d(5,10,51,17);d=e.range[St]+e.range[Ct]}}g=a.height/a.idealTickSizePixels,g=Math.round(g),v=a.textStyle?a.textStyle:"stx_yaxis",r.newSeries(c,h,this.canvasStyle("stx_grid")),r.newSeries("text",l,this.colorOrStyle(v)),r.newSeries(o,"stroke",this.canvasStyle(s)),x=(y=e.range)?y[1]:a.high,b=-195133985,S=1957713235,yt.p6d(20),C=yt.B6d("2",2);for(var wt=1;yt.E9I(wt.toString(),wt.toString().length,78809)!==b;wt++)k=y?y[8]:a.low,D=1!=a.displayBorder?u.panel.yAxis.displayBorder:a.displayBorder,!0!==this.axisBorders&&(D=!0),0==this.axisBorders&&(D=!1),M=(A=u.dynamicYAxis)?a.width:NaN,C+=2;if(yt.E9I(C.toString(),C.toString().length,37986)!==S&&(k=y?y[1]:a.low,D=7===a.displayBorder?u.panel.yAxis.displayBorder:a.displayBorder,0==this.axisBorders&&(D=!1),1!=this.axisBorders&&(D=!0),M=(A=u.dynamicYAxis)?a.width:NaN),k=y?y[0]:a.low,D=null===a.displayBorder?u.panel.yAxis.displayBorder:a.displayBorder,!1===this.axisBorders&&(D=!1),!0===this.axisBorders&&(D=!0),M=(A=u.dynamicYAxis)?a.width:NaN,"left"==(P=this.getYAxisCurrentPosition(a,t))){F=1944457219,_=2046166874,E=2;for(var kt=1;yt.L9I(kt.toString(),kt.toString().length,77073)!==F;kt++)T=a.left+a.width,E+=2;yt.L9I(E.toString(),E.toString().length,70291)!==_&&(T=a.left-a.width)}else T=a.left;L=Math.round(T)+.5,I=D?3:0,P==n&&(I=D?-3:0),O=this.getCanvasFontSize("stx_yaxis"),H=(N=a.increments).length,yt.p6d(6),R=yt.B6d("0",0),z=1,j=0,V=0,B=0,W=Number.MAX_VALUE;for(var Dt=0;Dt<100&&(j=N[R]*Math.pow(10,B),yt.z6d(1),z=Math.floor(yt.c6d(d,j)),yt.p6d(4),!((U=Math.abs(yt.c6d(z,g)))>W));Dt++){if(W=U,z==g){V=j;break}z>g?++R>=H&&(R=0,B++):--R<0&&(yt.z6d(21),R=yt.B6d(H,246549824,"1"),B--),V=j}if(Y=Math.ceil(k/V)*V,Q=0,a.bottom-this.pixelFromTransformedValue(Y,t,a)>a.idealTickSizePixels&&a.semiLog&&a.prettySemiLog){for(q=Math.ceil(k),yt.z6d(20),X=yt.c6d("0",0);Y-q>=1e4&&X<=15;)Y/=10,q/=10,X++;for(Y=Math.ceil(Y),q=Math.ceil(q);q<Y&&Y%q!=0;++q);Z=-432940691,G=368529613,K=2;for(var Tt=1;yt.E9I(Tt.toString(),Tt.toString().length,95174)!==Z;Tt++)Y/=Math.pow(20,X),q/=Math.pow(96,X),yt.z6d(22),K+=yt.c6d("2",1292719616);if(yt.L9I(K.toString(),K.toString().length,43909)!==G&&(Y-=Math.pow(69,X),q*=Math.pow(67,X)),Y*=Math.pow(10,X),yt.p6d(20),(q*=Math.pow(yt.c6d("10",0),X))<Y){if(Y===V){J=1089199154,$=729911518,tt=2;for(var At=1;yt.L9I(At.toString(),At.toString().length,46223)!==J;At++)V=q,tt+=2;yt.L9I(tt.toString(),tt.toString().length,2091)!==$&&(V=q),Q=q}Y=q}}if(a.height>a.zoom){et=0,it=Number.MAX_VALUE,at=1253819944,rt=-409165869,nt=2;for(var Mt=1;yt.L9I(Mt.toString(),Mt.toString().length,27426)!==at;Mt++)u.context.save(),nt+=2;yt.E9I(nt.toString(),nt.toString().length,64485)!==rt&&u.context.save(),u.context.save(),this.canvasFont("stx_yaxis",u.context);for(var Pt=0;Pt<100&&(yt.z6d(15),!((st=yt.c6d(Y,V,et))>x));Pt++)if(V+=Q,et++,it-(ot=this.pixelFromTransformedValue(st,t,a))<O+1&&Q>0)Pt=et=0,it=Number.MAX_VALUE,V=Q,Q*=2,r.reset();else if(it=ot,!((lt=Math.round(ot)+.5)+O/2>t.bottom||lt-O/2<t.top||Math.abs(lt-a.bottom)<1)){if(a.displayGridLines&&(ht="g",ht+="rid",r.moveTo("grid",t.left+1,lt),r.lineTo(ht,t.right-1,lt)),D&&(yt.p6d(4),r.moveTo("border",yt.B6d(.5,L),lt),yt.z6d(16),r.lineTo("border",yt.c6d(I,L),lt)),st=a.priceFormatter?a.priceFormatter(this,t,st):this.formatYAxisPrice(st,t,null,a),ct=a.textBackground?this.containerColor:null,ut=3,yt.z6d(17),dt=yt.B6d(ut,T,I),"left"==P){yt.z6d(23);var Ft=yt.B6d(4,41,48);dt=a.left+Ft,!1!==a.justifyRight&&(dt=a.left+a.width+I-ut)}else a.justifyRight&&(dt=T+a.width);r.addText("text",st,dt,lt,ct,null,O),A&&(yt.z6d(16),pt=yt.B6d(" ",st),M=Math.max(M,u.context.measureText(pt).width+Math.abs(I)+ut))}u.context.restore(),Pt>=100&&(ft="drawY",ft+="AxisPretty: assertion",ft+=" error. zz reached 100",console.log(ft))}if(D&&(mt="b",mt+="or",mt+="der",gt="b",gt+="o",gt+="rde",gt+="r",vt=Math.round(a.bottom)+.5,r.moveTo(gt,L,a.top),r.lineTo(mt,L,vt),r.draw(this.getBackgroundCanvas(u).context,"border")),A&&M>a.width)throw a._dynamicWidth=M,this.calculateYAxisPositions(),new Error("reboot draw");if(!A&&a._dynamicWidth)throw this.resetDynamicYAxis({chartName:u.name}),new Error("reboot draw")}a==t.yAxis&&this.plotYAxisGrid(t)}this.runAppend("drawYAxis",arguments)}}};var k={};!function(t){t.timezoneJS={};function e(){}t.CIQ=e,e.inheritsFrom=function(t,e,i){var a=e.prototype||Object.getPrototypeOf(e);t.prototype=!1!==i&&"function"==typeof e?new e:Object.create(a),Object.defineProperties(t.prototype,{constructor:{configurable:!0,enumerable:!1,value:t,writable:!0},parent:{configurable:!0,enumerable:!1,value:a,writable:!0}})},e.extend=function(t,i,r){var n,s;for(n in i)t!==(s=i[n])&&void 0!==s&&(null===s||!0===r?t[n]=s:s.constructor==Array?t[n]=s.slice():s.constructor==Object?t[n]=e.extend("object"===a(t[n])&&null!==t[n]?t[n]:{},s):t[n]=s);return t},e.activateImports=function(){var e=this;e.activatedImports||(e.activatedImports={});for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];a.forEach((function(i){"function"==typeof i&&(i.__guid in e.activatedImports||(i.__guid=e.uniqueID(!0),e.activatedImports[i.__guid]=i.__name||i.name,i(t)))}))}}(k),function(e){var i="undefined"!=typeof window?window:void 0!==t?t:{},a=function(t,e){var i=document.createEvent("Event");return i.initEvent(t,!(!e||!e.bubbles),!(!e||!e.cancelable)),i};i.Event&&"function"!=typeof i.Event&&(a.prototype=i.Event.prototype,i.Event=a);var r=function(t,e){var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,!(!e||!e.bubbles),!(!e||!e.cancelable),e&&e.detail),i};i.CustomEvent&&"function"!=typeof i.CustomEvent&&(r.prototype=i.CustomEvent.prototype,i.CustomEvent=r),void 0!==t&&void 0===t.CanvasRenderingContext2D&&(t.CanvasRenderingContext2D=function(){})}(),function(t){var e=t.CIQ,i="undefined"!=typeof navigator?navigator:{userAgent:""},a=i.userAgent,r="undefined"!=typeof window?window:{},n="undefined"!=typeof document?document:{};e.ipad=-1!=a.indexOf("iPad")||"MacIntel"===i.platform&&i.maxTouchPoints>1,e.iphone=-1!=a.indexOf("iPhone"),e.isAndroid=a.toLowerCase().indexOf("android")>-1,e.isIE=a.toLowerCase().indexOf("msie")>-1||a.indexOf("Trident/")>-1,e.isEdge=a.indexOf("Edge/")>-1,e.isSafari=a.indexOf("Safari/")>-1,e.isIOS7=a.match(/(iPad|iPhone);.*CPU.*OS 7_\d/i),e.isIOS8=a.match(/(iPad|iPhone);.*CPU.*OS 8_\d/i),e.isIOS9=a.match(/(iPad|iPhone);.*CPU.*OS 9_\d/i),e.isIOS10=a.match(/(iPad|iPhone);.*CPU.*OS 10_\d/i),e.isIOS7or8=e.isIOS7||e.isIOS8||e.isIOS9||e.isIOS10,e.isMobile=e.isAndroid||e.ipad||e.iphone,e.touchDevice=void 0!==n.ontouchstart||i.maxTouchPoints>1,e.isSurface=e.touchDevice&&(e.isEdge||e.isIE),e.is_chrome=a.toLowerCase().indexOf("chrome")>-1&&!e.isEdge,e.isFF=a.toLowerCase().indexOf("firefox")>-1,e.isSurfaceApp=r.MSApp,e.isWebComponentsSupported="undefined"!=typeof document&&"registerElement"in document&&"import"in document.createElement("link")&&"content"in document.createElement("template"),e.noKeyboard=e.isMobile||e.isSurfaceApp}(k),function(t){t.SplinePlotter||(t.SplinePlotter={});var e=t.CIQ,i=t.SplinePlotter;t.SplinePlotter.plotSpline||(t.SplinePlotter.plotSpline=function(t,e,i,a){var r=0;function n(e){if(r!=a.length){var n=a[r];n.coord[0]==t[e]&&n.coord[1]==t[e+1]&&(i.stroke(),i.strokeStyle=n.color,i.setLineDash(n.pattern),i.lineDashOffset=0,i.lineWidth=n.width,i.beginPath(),i.moveTo(t[e],t[e+1]),r++)}}a||(a=[]),(!e||e<0)&&(e=0);var s=t.length;i.moveTo(t[0],t[1]);for(var o=0;o<s-3;o+=2){n(o);var l=[];l[0]={x:t[Math.max(0,o-2)],y:t[Math.max(1,o-1)]},l[1]={x:t[o],y:t[o+1]},l[2]={x:t[o+2],y:t[o+3]},l[3]={x:t[Math.min(s-2,o+4)],y:t[Math.min(s-1,o+5)]},4===s&&(e=0),h(o,l,e)}function h(t,e,a){[1,2].forEach((function(t){e[t].cp={},["x","y"].forEach((function(i){var r=1/(1+Math.sqrt(Math.pow(e[2*t-1].x-e[2*t-2].x,2)+Math.pow(e[2*t-1].y-e[2*t-2].y,2))/Math.sqrt(Math.pow(e[2].x-e[1].x,2)+Math.pow(e[2].y-e[1].y,2)));e[t].cp[i]=e[t][i]+(3-2*t)*(e[t+1][i]-e[t-1][i])*a*(r||0),e[t].cp[i]<Math.min(e[1][i],e[2][i])&&(e[t].cp[i]=Math.min(e[1][i],e[2][i])),e[t].cp[i]>Math.max(e[1][i],e[2][i])&&(e[t].cp[i]=Math.max(e[1][i],e[2][i]))}))})),0===t?i.quadraticCurveTo(e[2].cp.x,e[2].cp.y,e[2].x,e[2].y):t===s-4?i.quadraticCurveTo(e[1].cp.x,e[1].cp.y,e[2].x,e[2].y):i.bezierCurveTo(e[1].cp.x,e[1].cp.y,e[2].cp.x,e[2].cp.y,e[2].x,e[2].y)}}),e.clearCanvas=function(t,i){t.isDirty=!1;var a=t.context;if(a.clearRect(0,0,t.width,t.height),e.isAndroid&&!e.is_chrome&&!e.isFF){e.ChartEngine.useOldAndroidClear&&i&&(a.fillStyle=i.containerColor,a.fillRect(0,0,t.width,t.height),a.clearRect(0,0,t.width,t.height));var r=t.width;t.width=1,t.width=r}var n=i.chart.canvasShim.childNodes.length>0;(i.useBackgroundCanvas||n)&&(i.useBackgroundCanvas=n,t==i.chart.canvas&&e.clearCanvas(i.chart.backgroundCanvas,i))},e.fillTransparentCanvas=function(t,e,i,a){var r=t.globalCompositeOperation;t.globalCompositeOperation="destination-over",t.fillStyle=e,t.fillRect(0,0,i,a),t.globalCompositeOperation=r},e.convertBoxToPixels=function(t,e,i){var a=t.panels[e];return{x0:t.pixelFromTick(i.x0,a.chart),x1:t.pixelFromTick(i.x1,a.chart),y0:i.cy0||0===i.cy0?i.cy0:t.pixelFromValueAdjusted(a,i.x0,i.y0),y1:i.cy1||0===i.cy1?i.cy1:t.pixelFromValueAdjusted(a,i.x1,i.y1)}},e.fillArea=function(t,e,r){if(e.length){var n=t.chart.context,s=n.globalAlpha,o=arguments[2],l=arguments[3],h=arguments[4],c=0,u=null;r&&"object"==a(r)&&(o=r.color,l=r.opacity,c=r.tension,h=r.panelName,u=r.yAxis),l||0===l||(l=.2),"auto"==o&&(o=t.defaultColor),n.globalAlpha=l,o&&(n.fillStyle=o);var d,p=Number.MAX_VALUE,f=-1*p,m=t.panels[h];if(m&&(f=(u||m.yAxis).top,p=(u||m.yAxis).bottom,n.save(),n.beginPath(),n.rect(m.left,f,m.width,p-f),n.clip()),n.beginPath(),c){var g=[];for(d=0;d<e.length-2;d++)g.push(e[d][0],e[d][1]);for(i.plotSpline(g,c,n),d=e.length-2;d<e.length;d++)n.lineTo(Math.round(e[d][0]),Math.round(e[d][1]))}else for(n.moveTo(e[0][0],e[0][1]),d=1;d<e.length;d++)n.lineTo(e[d][0],e[d][1]);n.closePath(),n.fill(),m&&n.restore(),n.globalAlpha=s}},e.prepareChannelFill=function(t,i){(!i||i instanceof Array)&&(i=arguments[2]),i.gapDisplayStyle||!1===i.gapDisplayStyle||(i.gapDisplayStyle=i.gaps);var a=t.panels[i.panelName],r=t.chart,n=(r.context.strokeStyle,{noDraw:i.noDraw,gapDisplayStyle:i.gapDisplayStyle}),s=e.ensureDefaults(i,{noDraw:!0,gapDisplayStyle:{},yAxis:a.yAxis}),o=t.plotDataSegmentAsLine(i.topBand,a,s),l=t.plotDataSegmentAsLine(i.bottomBand,a,s);i.noDraw=n.noDraw,i.gapDisplayStyle=n.gapDisplayStyle;for(var h=[],c=0;c<o.points.length;c+=2)h.push([o.points[c],o.points[c+1]]);for(var u=l.points.length-1;u>=0;u-=2)h.push([l.points[u-1],l.points[u]]);e.fillArea(t,h,i)},e.preparePeakValleyFill=function(t,i){(!i||i instanceof Array)&&(i=arguments[2]),i.gapDisplayStyle||!1===i.gapDisplayStyle||(i.gapDisplayStyle=i.gaps);var a=t.panels[i.panelName],r=a.yAxis,n=t.chart,s=n.context,o=(s.strokeStyle,{noDraw:i.noDraw,gapDisplayStyle:i.gapDisplayStyle}),l=t.plotDataSegmentAsLine(i.band,a,e.ensureDefaults(i,{noDraw:!0,gapDisplayStyle:{}}));i.noDraw=o.noDraw,i.gapDisplayStyle=o.gapDisplayStyle;var h=i.threshold,c=i.direction,u=i.reverse,d=i.gapDisplayStyle;i.yAxis&&(r=i.yAxis);var p=-Number.MAX_VALUE,f=Number.MAX_VALUE,m=u?p:f;(h||0===h)&&(m=t.pixelFromPrice(h,a,r));for(var g=[],v=l.points.length,y=0;y<v;y+=2){var x,b,S=l.points[y],C=l.points[y+1];if(i.roundOffEdges&&(0===y?S=Math.floor(S):y+2==v&&(S=Math.ceil(S))),!isNaN(C)){var w=C>m&&c>0||C<m&&c<0;w||(g.push([S,C]),p=Math.max(C,p),f=Math.min(C,f)),y<v-3&&(x=l.points[y+2],b=l.points[y+3],(C<m&&b>m||C>m&&b<m)&&(S+=(m-C)*(x-S)/(b-C),g.push([S,m])))}}if(v=g.length){var k=i.edgeParameters,D=i.edgeHighlight;if(D){k.lineWidth>100&&(k.lineWidth=1),s.save(),s.beginPath();for(var T=0;T<v-1;T++){var A=g[T],M=g[T+1];if(A[1]!=m||M[1]!=m){if(A[0]==M[0]&&t.layout.candleWidth>=1){if(A[1]==m&&g[T-1]&&g[T-1][1]==m)continue;if(M[1]==m&&g[T+2]&&g[T+2][1]==m)continue}t.plotLine(e.extend({x0:A[0],x1:M[0],y0:A[1],y1:M[1],color:i.edgeHighlight,type:"segment",context:s,confineToPanel:a,deferStroke:!0},k))}}s.stroke(),s.restore()}h||0===h||(r.flipped&&(u=!u),m=u?Math.min(f,r.top):Math.max(p,r.bottom)),g.push([g[v-1][0],m],[g[0][0],m]);var P=i.opacity;if(P||0===P||(i.opacity=.3),e.fillArea(t,g,i),d&&d.color&&d.fillMountain&&!i.tension&&!e.isTransparent(d.color)&&!e.isTransparent(i.color)){if(s.save(),s.fillStyle instanceof CanvasGradient){var F=e.colorToHex(d.color),_=s.createLinearGradient(0,1===c?a.top:a.bottom,0,m);_.addColorStop(0,e.hexToRgba(F,60)),_.addColorStop(1,e.hexToRgba(F,10)),s.fillStyle=_}else s.fillStyle=d.color;var E=[],L={opacity:i.opacity,panelName:i.panelName};for(s.beginPath(),y=0;y<l.gapAreas.length;y++){var I=l.gapAreas[y],O=I.start,N=I.end,H=I.threshold;if(O?E=[[O[0],O[1]],[O[0],H]]:E.push([N[0],H],[N[0],i.step?E[0][1]:N[1]]),4==E.length){e.fillArea(t,E,L);var R=e.extend({x1:E[3][0],y0:E[0][1],type:"segment",deferStroke:!0,context:s,confineToPanel:a},d);i.step?(t.plotLine(e.extend({x0:E[0][0],y1:E[0][1]},R)),t.plotLine(e.extend({x0:E[3][0],y1:E[3][1]},R))):t.plotLine(e.extend({x0:E[0][0],y1:E[3][1]},R))}}s.stroke(),s.restore()}i.opacity=P}},e.fillIntersecting=function(t,i,a){(!a||a instanceof Array)&&(a=arguments[3]);var r=a.topBand,n=a.bottomBand,s=a.topSubBand,o=a.bottomSubBand,l=a.topColor,h=a.bottomColor,c=i;c.panel&&(c.outputs&&c.outputMap&&(l||(l=c.outputs[c.outputMap[r]]),h||(h=c.outputs[c.outputMap[n]])),c=c.panel),c=t.panels[c];var u=t.chart.context,d=u.canvas,p=t.scratchContext;p||(p=t.scratchContext=d.cloneNode(!0).getContext("2d"));var f=p.canvas;f.height=d.height,f.width=d.width,p.drawImage(d,0,0),e.clearCanvas(d,t);var m=.3;a.opacity&&(m=a.opacity),u.save(),u.globalCompositeOperation="xor";var g={band:r,subField:s,color:l,opacity:1,panelName:c.name,yAxis:a.topAxis,skipTransform:a.skipTransform,tension:a.tension,roundOffEdges:!0};e.preparePeakValleyFill(t,g),e.extend(g,{band:n,subField:o,color:h,yAxis:a.bottomAxis}),e.preparePeakValleyFill(t,g),u.globalAlpha=m,u.globalCompositeOperation="copy",u.scale(1/t.adjustedDisplayPixelRatio,1/t.adjustedDisplayPixelRatio),u.drawImage(d,0,0),u.globalAlpha=1,u.globalCompositeOperation="destination-over",u.drawImage(f,0,0),u.restore()},e.drawLegendItem=function(t,e,i,a,r){r||(r=1);var n=e[0],s=e[1],o=t.chart.context;return o.globalAlpha=r,o.fillStyle=a,o.fillRect(n,s,10,10),o.globalAlpha=1,n+=12,o.fillStyle=t.defaultColor,o.fillText(i,n,s),[n+=o.measureText(i).width+6,s]},e.drawLegend=function(t,i){var a=i.coordinates,r=t.chart.context;r.textBaseline="top";var n=r.font;t.canvasFont("stx-legend",r);var s=i.chart||t.chart;a||(a=s.legend);for(var o=[a.x,a.y],l=t.defaultColor,h=0;h<2;h++)for(var c in i.legendColorMap){var u=i.legendColorMap[c];if((!u.isBase||!h&&!i.noBase)&&(u.isBase||h)){var d;if(u.color instanceof Array){var p=u.color;for(d=p.length-1;d>=0;d--)e.isTransparent(p[d])&&p.splice(d,1);if(p.length>1){var f=r.createLinearGradient(o[0],o[1],o[0]+10,o[1]);for(d=0;d<p.length;d++)f.addColorStop(d/(p.length-1),p[d]);l=f}else l=p.length>0?p[0]:t.getCanvasColor("stx_line_chart")}else l=u.color?u.color:null;if(l){var m=c;u.display&&(m=u.display),m||(m=s.symbolDisplay?s.symbolDisplay:s.symbol),o[0]+r.measureText(m).width>s.panel.right&&(o=[a.x,a.y+r.measureText("M").width+6]),o=e.drawLegendItem(t,o,m,l,u.opacity)}}}r.font=n}}(k),function(t){var e=t.CIQ;e.colorsEqual=function(t,i){if(t==i)return!0;if(!t&&!i)return!0;if(!t||!i)return!1;"transparent"==t&&(t="rgba(0,0,0,0)"),"transparent"==i&&(i="rgba(0,0,0,0)");var a=/^rgba\(.*,(.+)\)/,r=t.match(a),n=i.match(a);if((r=r?parseFloat(r[1]):1)!=(n=n?parseFloat(n[1]):1))return!1;var s=e.colorToHex(t),o=e.colorToHex(i);return s.toLowerCase()==o.toLowerCase()},e.colorToHex=function(t){if(e.colorToHexMapping||(e.colorToHexMapping={}),t&&"transparent"!=t||(t="#000000"),e.colorToHexMapping[t])return e.colorToHexMapping[t];if("#"===t.substr(0,1))return 4==t.length&&(t=e.colorToHexMapping[t]="#"+Array(3).join(t.substr(1,1))+Array(3).join(t.substr(2,1))+Array(3).join(t.substr(3,1))),t;var i=/(.*?)rgb\((\d+), ?(\d+), ?(\d+)\)/.exec(t);if(i||(i=/(.*?)rgba\((\d+), ?(\d+), ?(\d+),.*\)/.exec(t)),!i){var a=function(t){if("undefined"==typeof document)return"#000000";var a,r=document.querySelector(".ciq_color_converter");return r||((r=document.createElement("textarea")).className="ciq_color_converter",r.style.display="none",document.body.appendChild(r)),r.style.color="#000000",r.style.color=t,a=getComputedStyle(r).getPropertyValue("color"),(i=/(.*?)rgb\((\d+), ?(\d+), ?(\d+)\)/.exec(a))?e.colorToHex(a):"#"===a.substr(0,1)?a:t}(t);return e.colorToHexMapping[t]=a,a}for(var r=parseFloat(i[2]),n=parseFloat(i[3]),s=(parseFloat(i[4])|n<<8|r<<16).toString(16),o=s.length;o<6;o++)s="0"+s;var l=i[1]+"#"+s;return e.colorToHexMapping[t]=l,l},e.hexToRgba=function(t,i){if(t&&"transparent"!=t||(t="rgba(0,0,0,0)"),"rgba"===t.substr(0,4)){var a=/(.*?)rgba\((\d+), ?(\d+), ?(\d+), ?(\d*\.?\d*)\)/.exec(t),r=a[5];return(i||0===i)&&(r=i),r>1&&(r/=100),"rgba("+a[2]+","+a[3]+","+a[4]+","+r+")"}"rgb"===t.substr(0,3)&&(t=e.colorToHex(t)),i||0===i||(i=100),i<=1&&(i*=100),t=t.replace("#","");var n=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16);return isNaN(n)||isNaN(s)||isNaN(o)?(console.log("CIQ.hexToRgba: invalid hex :",t),null):"rgba("+n+","+s+","+o+","+i/100+")"},e.convertToNativeColor=function(t){var e=document.createElement("DIV");e.style.color=t,e.style.display="none",document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i},e.isTransparent=function(t){if(!t)return!1;if("transparent"==t)return!0;var e=/(.*?)rgba\((\d+), ?(\d+), ?(\d+), ?(\d*\.?\d*)\)/.exec(t);return null!==e&&0===parseFloat(e[5])},e.hsv=function(t){var i=e.colorToHex(t);"#"===i.substr(0,1)&&(i=i.slice(1));for(var a=i.length;a<6;a++)i="0"+i;var r=parseInt(i.slice(0,2),16),n=parseInt(i.slice(2,4),16),s=parseInt(i.slice(4,6),16);if(r=parseInt((""+r).replace(/\s/g,""),10),n=parseInt((""+n).replace(/\s/g,""),10),s=parseInt((""+s).replace(/\s/g,""),10),null===r||null===n||null===s||isNaN(r)||isNaN(n)||isNaN(s))return console.log("CIQ.hsv: invalid color :",t),null;if(r<0||n<0||s<0||r>255||n>255||s>255)return null;r/=255,n/=255,s/=255;var o=Math.min(r,Math.min(n,s)),l=Math.max(r,Math.max(n,s));return o==l?[0,0,o]:[60*((r==o?3:s==o?1:5)-(r==o?n-s:s==o?r-n:s-r)/(l-o)),(l-o)/l,l]},e.hsl=function(t){var i=e.colorToHex(t);"#"===i.substr(0,1)&&(i=i.slice(1));for(var a=i.length;a<6;a++)i="0"+i;var r=parseInt(i.slice(0,2),16),n=parseInt(i.slice(2,4),16),s=parseInt(i.slice(4,6),16);r/=255,n/=255,s/=255;var o,l,h=Math.max(r,n,s),c=Math.min(r,n,s),u=(h+c)/2;if(h==c)o=l=0;else{var d=h-c;switch(l=u>.5?d/(2-h-c):d/(h+c),h){case r:o=(n-s)/d+(n<s?6:0);break;case n:o=(s-r)/d+2;break;case s:o=(r-n)/d+4}o/=6}return[o,l,u]},e.hslToRgb=function(t,e,i){var a,r,n;if(0===e)a=r=n=i;else{var s=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},o=i<.5?i*(1+e):i+e-i*e,l=2*i-o;a=s(l,o,t+1/3),r=s(l,o,t),n=s(l,o,t-1/3)}return[Math.round(255*a),Math.round(255*r),Math.round(255*n)]},e.chooseForegroundColor=function(t){var i=e.colorToHex(t);return.2126*parseInt(i.slice(1,3),16)+.7152*parseInt(i.slice(3,5),16)+.0722*parseInt(i.slice(5,7),16)<100?"#FFFFFF":"#000000"},e.borderPatternToArray=function(t,e){return e?e instanceof Array?e:"dotted"==e?[t,t]:"dashed"==e?[5*t,5*t]:("solid"!=e&&"none"!=e&&console.log('Unsupported pattern "'+e+'"; defaulting to "solid"'),[]):[]},e.getBackgroundColor=function(t){for(var i=null;!i||e.isTransparent(i);){var a=getComputedStyle(t);if(!a)return;if(i=a.backgroundColor,e.isTransparent(i)&&(i="transparent"),!(t=t.parentNode)||!t.tagName)break}return i&&"transparent"!=i||(i="#FFFFFF"),i}}(k),function(t){var e=t.CIQ,i=t.timezoneJS;e.monthLetters=["J","F","M","A","M","J","J","A","S","O","N","D"],e.monthAbv=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.MILLISECOND=1,e.SECOND=1e3,e.MINUTE=60*e.SECOND,e.HOUR=60*e.MINUTE,e.DAY=24*e.HOUR,e.WEEK=7*e.DAY,e.MONTH=31*e.DAY,e.YEAR=366*e.DAY,e.DECADE=10*e.YEAR-7*e.DAY,e.yyyymmddhhmmssmmmrx=new RegExp("\\d{17}"),e.strToDateTime=function(t){if(!t||t.getFullYear)return t;var i,a,r,n,s,o,l,h=[];if(12==t.length||14==t.length)return i=parseFloat(t.substring(0,4)),a=parseFloat(t.substring(4,6))-1,r=parseFloat(t.substring(6,8)),n=parseFloat(t.substring(8,10)),s=parseFloat(t.substring(10,12)),o=parseFloat(t.substring(12,14))||0,new Date(i,a,r,n,s,o,0);if(e.yyyymmddhhmmssmmmrx.test(t))return i=parseFloat(t.substring(0,4)),a=parseFloat(t.substring(4,6))-1,r=parseFloat(t.substring(6,8)),n=parseFloat(t.substring(8,10)),s=parseFloat(t.substring(10,12)),o=parseFloat(t.substring(12,14)),l=parseFloat(t.substring(14,17)),new Date(i,a,r,n,s,o,l);var c=[t],u=t.indexOf("T");if(-1!=u){var d=t.substring(u);if(-1!=d.indexOf("Z")||-1!=d.indexOf("-")||-1!=d.indexOf("+"))return new Date(t);c=t.split("T")}else-1!=t.indexOf(" ")&&(c=t.split(" "));if(-1!=c[0].indexOf("/"))h=c[0].split("/");else{if(-1==c[0].indexOf("-"))return e.strToDate(t);h=c[0].split("-")}var p=parseFloat(h[2],10);if(h[0]&&4==h[0].length&&(p=parseFloat(h[0],10),h[0]=h[1],h[1]=h[2]),c.length>1){var f=c[2];c=c[1].split(":"),f&&("12"==c[0]&&"AM"==f.toUpperCase()?c[0]=0:"12"!=c[0]&&"PM"==f.toUpperCase()&&(c[0]=parseInt(c[0],10)+12));var m=0,g=0;return 3==c.length&&(-1==c[2].indexOf(".")?m=parseInt(c[2],10):3==(m=c[2].split("."))[1].length&&(g=m[1],m=m[0])),new Date(p,h[0]-1,h[1],c[0],c[1],m,g)}return new Date(p,h[0]-1,h[1],0,0,0,0)},e.strToDate=function(t){var e;if(-1!=t.indexOf("/"))e=t.split("/");else{if(-1==t.indexOf("-"))return t.length>=8?new Date(parseFloat(t.substring(0,4)),parseFloat(t.substring(4,6))-1,parseFloat(t.substring(6,8))):new Date;e=t.split("-")}if(e.length<3)return new Date;-1!=e[2].indexOf(" ")?e[2]=e[2].substring(0,e[2].indexOf(" ")):-1!=e[2].indexOf("T")&&(e[2]=e[2].substring(0,e[2].indexOf("T")));var i=parseFloat(e[2],10);return i<20&&(i+=2e3),4==e[0].length&&(i=parseFloat(e[0],10),e[0]=e[1],e[1]=e[2]),new Date(i,e[0]-1,e[1])},e.mmddyyyy=function(t){"string"==typeof t&&(t=e.strToDate(t));var i=t.getMonth()+1;i<10&&(i="0"+i);var a=t.getDate();return a<10&&(a="0"+a),i+"/"+a+"/"+t.getFullYear()},e.yyyymmdd=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();return i<10&&(i="0"+i),t.getFullYear()+"-"+e+"-"+i},e.hhmm=function(t){var e=t.getHours();e<10&&(e="0"+e);var i=t.getMinutes();return i<10&&(i="0"+i),e+":"+i},e.hhmmss=function(t){var i=t.getSeconds();return i<10&&(i="0"+i),e.hhmm(t)+":"+i},e.yyyymmddhhmm=function(t){return e.yyyymmddhhmmssmmm(t).substr(0,12)},e.yyyymmddhhmmssmmm=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var a=t.getHours();a<10&&(a="0"+a);var r=t.getMinutes();r<10&&(r="0"+r);var n=t.getSeconds();n<10&&(n="0"+n);var s=t.getMilliseconds();return s<10?s="00"+s:s<100&&(s="0"+s),""+t.getFullYear()+e+i+a+r+n+s},e.friendlyDate=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var a=t.getHours();a<10&&(a="0"+a);var r=t.getMinutes();return r<10&&(r="0"+r),t.getFullYear()+"/"+e+"/"+i+" "+a+":"+r},e.mmddhhmm=function(t){var i=e.strToDateTime(t),a=i.getMonth()+1;a<10&&(a="0"+a);var r=i.getDate();r<10&&(r="0"+r);var n=i.getHours();n<10&&(n="0"+n);var s=i.getMinutes();s<10&&(s="0"+s);var o=i.getSeconds();o<10&&(o="0"+o);var l=i.getMilliseconds();return l<10?l="00"+l:l<100&&(l="0"+l),"00"==n&&"00"==s&&"00"==o&&"000"==l?a+"-"+r+"-"+i.getFullYear():"00"==o&&"000"==l?a+"-"+r+" "+n+":"+s:"000"==l?a+"-"+r+" "+n+":"+s+":"+o:a+"-"+r+" "+n+":"+s+":"+o+":"+l},e.getYearDay=function(t){var e=t;e||(e=new Date),e.setHours(0,0,0,0);var i=new Date(e.getFullYear(),0,0),a=e-i;return Math.round(a/864e5)},e.getETDateTime=function(){var t=new Date;return e.convertTimeZone(new Date(t.getTime()+6e4*t.getTimezoneOffset()),"UTC","America/New_York")},e.fromET=function(t){var e=new Date,i=4;(e.getMonth()<2||2==e.getMonth()&&e.getDate()<11||e.getMonth()>10||10==e.getMonth()&&e.getDate()>=4)&&(i=5);var a=t.getTime()+36e5*i;return new Date(a)},e.monthAsDisplay=function(t,i,a){return i?a&&a.monthLetters?a.monthLetters[t]:e.monthLetters[t]:a&&a.monthAbv?a.monthAbv[t]:e.monthAbv[t]},e.timeAsDisplay=function(t,i,a){var r=i?i.internationalizer:null;if(r)return a==e.SECOND?r.hourMinuteSecond.format(t):a==e.MILLISECOND?r.hourMinuteSecond.format(t)+"."+t.getMilliseconds():r.hourMinute.format(t);var n=t.getMinutes();n<10&&(n="0"+n);var s=t.getHours()+":"+n,o="";if(a<=e.SECOND&&((o=t.getSeconds())<10&&(o="0"+o),s+=":"+o),a==e.MILLISECOND){var l=t.getMilliseconds();l<10?l="00"+l:l<100&&(l="0"+l),s+="."+l}return s},e.displayableDate=function(t,i,a){function r(t){return t<10?"0"+t:t}var n="",s=t.layout.interval,o=e.ChartEngine.isDailyInterval(s);if(i.xAxis.formatter)n=i.xAxis.formatter(a);else if(t.internationalizer)n=t.internationalizer.monthDay.format(a),o?n="month"==s?t.internationalizer.yearMonth.format(a):t.internationalizer.yearMonthDay.format(a):n+=" "+t.internationalizer.hourMinute.format(a);else{var l=r(a.getMonth()+1),h=r(a.getDate()),c=r(a.getHours()),u=r(a.getMinutes());if(o)n="month"==s?l+"-":l+"-"+h+"-",n+=a.getFullYear();else{n=l+"/"+h+" "+c+":"+u;var d=i.xAxis.activeTimeUnit&&i.xAxis.activeTimeUnit<=e.SECOND||"second"==t.layout.timeUnit,p=i.xAxis.activeTimeUnit&&i.xAxis.activeTimeUnit<=e.MILLISECOND||"millisecond"==t.layout.timeUnit;if(d||p)if(n+=":"+r(a.getSeconds()),p){var f=r(a.getMilliseconds());f<100&&(f="0"+f),n+=":"+f}}}return n},e.convertTimeZone=function(t,e,a){if(!i.Date)return t;var r=new i.Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),e);return r.setTimezone(a),r},e.convertToLocalTime=function(t,e){if(!i.Date)return t;var a=t.getSeconds(),r=t.getMilliseconds(),n=new i.Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),e);return new Date(n.getTime()+1e3*a+r)}}(k),function(t){t.SplinePlotter||(t.SplinePlotter={});var e=t.CIQ;t.SplinePlotter;t.$$=function t(e,i){if(!i)return document.getElementById(e);if(i.id==e)return i;if(!i.hasChildNodes)return null;for(var a=0;a<i.childNodes.length;a++){var r=t(e,i.childNodes[a]);if(r)return r}return null};t.$$$=function(t,e){return e||(e=document),e.querySelectorAll(t)[0]},e.wheelEvent=function(){if("undefined"!=typeof document)return e.isIE||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}(),e.newChild=function(t,e,i,a){var r=document.createElement(e);return i&&(r.className=i),t.appendChild(r),a&&(r.innerHTML=a),r},e.innerHTML=function(t,e){window.MSApp&&window.MSApp.execUnsafeLocalFunction?window.MSApp.execUnsafeLocalFunction((function(){t.innerHTML=e})):t.innerHTML=e},e.focus=function(t,i){if(e.isSurface||i){var a=0;isNaN(parseInt(i,10))||(a=i),setTimeout((function(){t.focus()}),a)}else t.focus()},e.blur=function(t){t||(t=document.activeElement),t&&t.blur(),window.focus()},e.findNodesByText=function(t,i){if(t.innerHTML==i)return[t];for(var a=[],r=0;r<t.childNodes.length;r++){var n=e.findNodesByText(t.childNodes[r],i);n&&(a=a.concat(n))}return a.length?a:null},e.hideByText=function(t,i){for(var a=e.findNodesByText(t,i),r=0;r<a.length;r++)a[r].style.display="none"},e.outerWidth=function(t){var i=t.offsetWidth;return i+=e.stripPX(getComputedStyle(t).marginLeft),i+=e.stripPX(getComputedStyle(t).marginRight)},e.clearNode=function(t){if(t.hasChildNodes())for(;t.childNodes.length>=1;)t.removeChild(t.firstChild)},e.pageHeight=function(){var t=window,e=t.innerHeight,i=t.top,a=t.parent;if(i!=t.self)try{e>a.innerHeight&&(e=a.innerHeight)}catch(t){}return e},e.pageWidth=function(){var t=window,e=t.innerWidth,i=t.top,a=t.parent;if(i!=t.self)try{e>a.innerWidth&&(e=a.innerWidth)}catch(t){}return e},e.stripPX=function(t){return t?"number"==typeof t?t:parseInt(t.substr(0,t.indexOf("p")),10):0},e.withinElement=function(t,e,i){var a=t.getBoundingClientRect();return!(e<=a.left)&&(!(i<=a.top)&&(!(e>=a.left+t.offsetWidth)&&!(i>=a.top+t.offsetHeight)))},e.efficientDOMUpdate=function(t,e,i){t[e]!==i&&(t[e]=i)},e.safeMouseOut=function(t,i){t.addEventListener("mouseout",function(t,i){return function(a){void 0===a.pageX&&(a.pageX=a.clientX,a.pageY=a.clientY),e.withinElement(t,a.pageX,a.pageY)||(t.stxMouseOver=!1,i(a))}}(t,i))},e.safeMouseOver=function(t,i){t.addEventListener("mouseover",function(t,i){return function(a){if(void 0===a.pageX&&(a.pageX=a.clientX,a.pageY=a.clientY),e.withinElement(t,a.pageX,a.pageY)){if(t.stxMouseOver)return;t.stxMouseOver=!0,i(a)}}}(t,i))},e.installTapEvent=function(t,i){e.safeClickTouch(t,(function(t){var e=new Event("stxtap",{bubbles:!0,cancelable:!0});void 0===t.pageX&&(t.pageX=t.clientX,t.pageY=t.clientY),e.pageX=t.pageX,e.pageY=t.pageY,t.target.dispatchEvent(e),i&&i.stopPropagation&&t.stopPropagation()}),i)},e.safeClickTouch=function(t,i,a){a||(a={});var r={};function n(t,a,r){return function(n){if(!e.safeClickTouchEvent){if(!r.t)return;var s=r.t;if(r.t=null,s+1e3<(new Date).getTime())return}if(!(a.safety&&a.safety.recentlyDragged||n.which&&n.which>=2||n.button&&n.button>=2)){if(a.preventUnderlayClick)"INPUT"!==n.target.tagName&&n.preventDefault();else{if(a.lastType!=t&&Date.now()<a.allowAnotherDevice)return;a.lastType=t,a.allowAnotherDevice=Date.now()+1e3}i(n)}}}function s(t,e){return function(i){var a=i.clientX?i.clientX:i.pageX,r=i.clientY?i.clientY:i.pageY;e?(t.t=(new Date).getTime(),t.x=a,t.y=r):t.x&&Math.pow(t.x-a,2)+Math.pow(t.y-r,2)>16&&(t.t=null)}}a.allowMultiple||e.clearSafeClickTouches(t),!1!==a.preventUnderlayClick&&(a.preventUnderlayClick=!0),!1!==a.absorbDownEvent&&(a.absorbDownEvent=!0),a.allowAnotherDevice=0,a.registeredClick=!1;var o=t.safeClickTouchEvents;o||(o=t.safeClickTouchEvents=[]);var l=n("mouseup",a,r),h=n("touchend",a,r),c=n("pointerup",a,r),u=function(t){t.stopPropagation()},d={};if(e.safeClickTouchEvent){var p=n(e.safeClickTouchEvent,a);t.addEventListener(e.safeClickTouchEvent,p),d[e.safeClickTouchEvent]=p,o.push(d)}else"onpointerup"in document&&!e.noPointerEvents?(t.addEventListener("pointerdown",s(r,!0)),t.addEventListener("pointermove",s(r)),t.addEventListener("pointerup",c),d.pointerup=c,a.absorbDownEvent&&(t.addEventListener("pointerdown",u),d.pointerdown=u),o.push(d)):(t.addEventListener("mousedown",s(r,!0)),t.addEventListener("mousemove",s(r)),t.addEventListener("touchstart",s(r,!0)),t.addEventListener("touchmove",s(r)),t.addEventListener("mouseup",l),t.addEventListener("touchend",h),d.mouseup=l,d.touchend=h,a.absorbDownEvent&&(t.addEventListener("mousedown",u),d.mousedown=u,t.addEventListener("touchstart",u),d.touchstart=u),o.push(d))},e.clearSafeClickTouches=function(t){var e=t.safeClickTouchEvents;if(e){for(var i=0;i<e.length;i++){var a=e[i];for(var r in a){var n=a[r];t.removeEventListener(r,n)}}t.safeClickTouchEvents=null}},e.safeDrag=function(t,i){var a=function(t,e){return function(i){if(i.touches){if(i.touches.length>0)return i.touches[0][t];if(i.changedTouches&&i.changedTouches.length>0)return i.changedTouches[0][t]}return void 0!==i[t]?i[t]:i[e]}},r=a("pageX","clientX"),n=a("pageY","clientY");"function"==typeof i&&(i={down:arguments[1],move:arguments[2],up:arguments[3]}),i=i||{};var s=100,o=!1,l=0,h=0,c={recentlyDragged:!1};function u(t){return function(a){if(!o){o=!0,e.ChartEngine.ignoreTouch=!0;var u=function(t){t&&t.preventDefault&&t.preventDefault(),c.recentlyDragged=!0,t.displacementX=r(t)-l,t.displacementY=n(t)-h,i.move(t)};i.move&&document.body.addEventListener(t.move,u);document.body.addEventListener(t.up,(function a(s){e.ChartEngine.ignoreTouch=!1,i.move&&document.body.removeEventListener(t.move,u),document.body.removeEventListener(t.up,a),s.displacementX=r(s)-l,s.displacementY=n(s)-h,i.up&&i.up(s),setTimeout((function(){c.recentlyDragged=!1}),50)})),setTimeout((function(){o=!1}),s),l=r(a),h=n(a),i.down&&i.down(a)}}}return t.addEventListener("mousedown",u({down:"mousedown",move:"mousemove",up:"mouseup"})),t.addEventListener("pointerdown",u({down:"pointerdown",move:"pointermove",up:"pointerup"})),t.addEventListener("touchstart",u({down:"touchstart",move:"touchmove",up:"touchend"})),c},e.inputKeyEvents=function(t,e){t.addEventListener("keyup",(function(i){switch(i.keyCode){case 13:e();break;case 27:t.value=""}}),!1)},e.fixScreen=function(){window.scrollTo(0,0)},e.setCaretPosition=function(t,i){if(t.style.zIndex=5e3,t.setSelectionRange){e.focus(t);try{t.setSelectionRange(i,i)}catch(t){}}else if(t.createTextRange){var a=t.createTextRange();a.collapse(!0),a.moveEnd("character",i),a.moveStart("character",i),a.select()}},e.setValueIfNotActive=function(t,e){document.activeElement!=t&&(t.value=e)},e.hideKeyboard=function(t){var e=document.activeElement;"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName||(e.blur(),window.focus(),t&&(t===document.body||document.body.contains(t))&&t.focus())},e.smartHover=function(){if(document&&!document.documentElement.hasAttribute("ciq-last-interaction")){var t,e=!1;document.addEventListener("touchend",(function(a){clearTimeout(t),e=!0,"touch"!=document.documentElement.getAttribute("ciq-last-interaction")&&i("touch"),t=setTimeout((function(){e=!1}),500)}),!1),document.addEventListener("mouseover",(function(t){e||i("mouse")}),!1),i("")}function i(t){document.documentElement.setAttribute("ciq-last-interaction",t)}},e.translatableTextNode=function(t,e,i){if(t.translationCallback){var a=document.createElement("translate");return a.setAttribute("original",e),a.innerHTML=t.translationCallback(e,i),a}return document.createTextNode(e)},e.findClosestParent=function(t,e){var i,a;if(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some((function(t){return"function"==typeof document.body[t]&&(i=t,!0)})),!i)return!1;for(;t;){if((a=t.parentElement)&&a[i](e))return a;t=a}return null},e.resizeObserver=function(t,e,i,a){return a?"undefined"!=typeof ResizeObserver?i||(i=new ResizeObserver(e)).observe(t):(i&&clearInterval(i),i=setInterval(e,a)):(i&&("undefined"!=typeof ResizeObserver?i.disconnect():clearInterval(i)),i=null),i},e.getLines=function(t,e,i){for(var a=e.split(" "),r=[],n="",s=!1,o=0;o<a.length;o++){var l=a[o];if(t.measureText(n+l).width<i?(s&&(n+=" "),s=!0,n+=l):(r.push(n),n=l),o===a.length-1){r.push(n);break}}return r},e.alert=function(t){"undefined"!=typeof window?window.alert(t):console.log(t)},e.localStorage="undefined"!=typeof localStorage?localStorage:{},e.privateBrowsingAlert=!1,e.localStorageSetItem=function(t,i){try{e.localStorage.setItem(t,i)}catch(t){e.privateBrowsingAlert||(e.alert("No storage space available.  Possible causes include browser being in Private Browsing mode, or maximum storage space has been reached."),e.privateBrowsingAlert=!0)}}}(k),function(t){var e=t.CIQ;e.ChartEngine=function(t){if(t){if("undefined"!=typeof HTMLDivElement&&t.constructor==HTMLDivElement){t={container:t}}}else t={container:null};for(var a in i)this[a]=e.clone(e.ChartEngine.prototype[a]);this.container=null,this.createChartPanel=!0,this.markers={},this.panels={},this.overlays={},this.charts={},this.eventListeners=[],this.controls={},this.goneVertical=!1,this.pinchingScreen=!1,this.grabbingScreen=!1,this.grabStartX=0,this.grabStartY=0,this.grabStartScrollX=0,this.grabStartScrollY=0,this.swipe={},this.grabStartCandleWidth=0,this.grabStartZoom=0,this.grabOverrideClick=!1,this.grabMode="",this.vectorsShowing=!1,this.mouseMode=!0,this.lineTravelSpacing=!1,this.highlightedDataSetField=null,this.anyHighlighted=!1,this.accessoryTimer=null,this.lastAccessoryUpdate=(new Date).getTime(),this.displayCrosshairs=!0,this.hrPanel=null,this.editingAnnotation=!1,this.openDialog="",this.touches=[],this.changedTouches=[],this.crosshairTick=null,this.crosshairValue=null,this.pt={x1:-1,x2:-1,y1:-1,y2:-1},this.moveA=-1,this.moveB=-1,this.touchStartTime=-1,this.touchPointerType="",this.gestureStartDistance=-1,this.grabStartPeriodicity=1,this.grabEndPeriodicity=-1,this.scrollEvent=null,this.cmd=!1,this.ctrl=!1,this.shift=!1,this.userPointerDown=!1,this.cloneDrawing=!1,this.insideChart=!1,this.overXAxis=!1,this.overYAxis=!1,this.displayInitialized=!1,this.cx=null,this.isHistoricalModeSet=null,this.cy=null,this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},this.cancelTouchSingleClick=!1,this.locale=null,this.dataZone=null,this.displayZone=null,this.timeZoneOffset=0,this.masterData=null,this.transformDataSetPre=null,this.transformDataSetPost=null,this.dataCallback=null,this.drawingObjects=[],this.undoStamps=[],this.useBackgroundCanvas=!1,this.mainSeriesRenderer=null,this.styles={},this.plugins={},this.currentVectorParameters=e.clone(e.ChartEngine.currentVectorParameters);var r=this.chart=new e.ChartEngine.Chart;r.name="chart",r.yAxis.name="chart",r.canvas=null,r.tempCanvas=null,r.container=t.container,e.Market&&(r.market=new e.Market),this.charts.chart=r,e.extend(this,t),t.container&&(this.registerHTMLElements&&this.registerHTMLElements(),r.width=r.container.clientWidth-r.yAxis.width,this.setCandleWidth(this.layout.candleWidth,r),r.canvasHeight=r.container.clientHeight),this.construct()},e.ChartEngine.drawingLine=!1,e.ChartEngine.resizingPanel=null,e.ChartEngine.crosshairX=0,e.ChartEngine.crosshairY=0,e.ChartEngine.useAnimation=!0,e.ChartEngine.enableCaching=!1,e.ChartEngine.ignoreTouch=!1,e.ChartEngine.useOldAndroidClear=!0,e.ChartEngine.currentVectorParameters={},e.ChartEngine.defaultDisplayTimeZone=null,e.ChartEngine.pluginBasePath="plugins/",e.ChartEngine.registeredContainers=[],e.ChartEngine.prototype.construct=function(){this.createChartPanel&&(this.stackPanel("chart","chart",1),this.adjustPanelPositions(),this.chart.panel=this.panels[this.chart.name]),this.cx=0,this.cy=0,this.micropixels=0,this.callbackListeners={doubleTap:[],doubleClick:[],drawing:[],drawingEdit:[],layout:[],longhold:[],move:[],newChart:[],preferences:[],rightClick:[],scroll:[],studyOverlayEdit:[],studyPanelEdit:[],symbolChange:[],symbolImport:[],tap:[],theme:[],undoStamp:[]},this.longHoldTime=700};var i={yTolerance:100,minimumLeftBars:1,reverseMouseWheel:!1,mouseWheelAcceleration:!0,minimumCandleWidth:1,maximumCandleWidth:200,minimumZoomTicks:9,allowZoom:!0,allowScroll:!0,allowSideswipe:!0,allowThreeFingerTouch:!1,bypassRightClick:{series:!1,study:!1,drawing:!1},adjustHighlightedDataSetField:function(t){return t},displayIconsUpDown:!0,displayIconsSolo:!0,displayIconsClose:!0,displayPanelResize:!0,soloPanelToFullScreen:!1,markerDelay:null,useBackingStore:!0,disableBackingStoreDuringTouch:e.isMobile||e.isSurface&&e.isFF,captureTouchEvents:!0,captureMouseWheelEvents:!0,yaxisLabelStyle:"roundRectArrow",axisBorders:null,singleDrawingHighlight:!0,crosshairXOffset:-40,crosshairYOffset:-40,extendLastTick:!1,translationCallback:null,dontRoll:!1,allowEquations:!0,cleanupGaps:!1,staticRange:!1,maxDataSetSize:2e4,maxMasterDataSize:0,resizeDetectMS:1e3,xAxisAsFooter:!0,xaxisHeight:30,displayGridLinesInStudies:!1,escapeOnSerialize:!0,candleWidthPercent:.65,colorByCandleDirection:!1,noWicksOnCandles:{renko:!0,linebreak:!0},fetchMaximumBars:{rangebars:!0,kagi:!0,renko:!0,linebreak:!0,pandf:!0},startComparisonsAtFirstVisibleBar:!1,animations:{zoom:{isStub:!0,run:function(t,e,i){t(i)},stop:function(){},reset:function(){},running:!1,hasCompleted:!0}},staticRangePeriodicityMap:[{rangeInMS:e.WEEK,periodicity:1,interval:5,timeUnit:"minute"},{rangeInMS:e.MONTH,periodicity:1,interval:30,timeUnit:"minute"},{rangeInMS:e.YEAR,periodicity:1,interval:"day"},{rangeInMS:e.DECADE,periodicity:1,interval:"week"},{rangeInMS:10*e.DECADE,periodicity:1,interval:"month"},{rangeInMS:Number.MAX_VALUE,periodicity:12,interval:"month"}],dynamicRangePeriodicityMap:[{interval:1,timeUnit:"minute",rangeInMS:e.MINUTE},{interval:5,timeUnit:"minute",rangeInMS:5*e.MINUTE},{interval:30,timeUnit:"minute",rangeInMS:30*e.MINUTE},{interval:60,timeUnit:"minute",rangeInMS:60*e.MINUTE},{interval:"day",rangeInMS:e.DAY},{interval:"month",rangeInMS:e.MONTH},{interval:"year",rangeInMS:e.YEAR}],layout:{interval:"day",periodicity:1,timeUnit:null,candleWidth:8,flipped:!1,volumeUnderlay:!1,adj:!0,crosshair:!1,chartType:"candle",extended:!1,marketSessions:{},aggregationType:"ohlc",chartScale:"linear",studies:{},panels:{},setSpan:{},outliers:!1},preferences:{currentPriceLine:!1,dragging:{series:!0,study:!0,yaxis:!0},drawings:null,highlightsRadius:10,highlightsTapRadius:30,magnet:!1,horizontalCrosshairField:null,labels:!0,language:null,timeZone:null,whitespace:50,zoomInSpeed:null,zoomOutSpeed:null,zoomAtCurrentMousePosition:!1},streamParameters:{count:0,maxWait:1e3,maxTicks:100,timeout:-1},autoPickCandleWidth:{turnOn:!1,candleWidth:5}};e.extend(e.ChartEngine.prototype,i),e.ChartEngine.NONE=0,e.ChartEngine.CLOSEUP=1,e.ChartEngine.CLOSEDOWN=2,e.ChartEngine.CLOSEEVEN=4,e.ChartEngine.CANDLEUP=8,e.ChartEngine.CANDLEDOWN=16,e.ChartEngine.CANDLEEVEN=32}(k),function(t){var e=t.CIQ;e.convertFutureMonth=function(t){var e=t.toString();if(e.length<=0||e.length>2)return"";switch(e){case"1":return"F";case"2":return"G";case"3":return"H";case"4":return"J";case"5":return"K";case"6":return"M";case"7":return"N";case"8":return"Q";case"9":return"U";case"10":return"V";case"11":return"X";case"12":return"Z";case"F":return"1";case"G":return"2";case"H":return"3";case"J":return"4";case"K":return"5";case"M":return"6";case"N":return"7";case"Q":return"8";case"U":return"9";case"V":return"10";case"X":return"11";case"Z":return"12"}return e},e.money=function(t,i,a){return a||(a="$"),3==a.length&&(a+=" "),i||0===i||(i=2),a+e.commas((Math.round(1e4*t)/1e4).toFixed(i))},e.convertCurrencyCode=function(t){var e={JPY:"¥",USD:"$",AUD:"A$",BRL:"R$",CAD:"CA$",CNY:"CN¥",CZK:"Kč",DKK:"kr",EUR:"€",GBP:"£",HKD:"HK$",HUF:"Ft",ILS:"₪",INR:"₹",KRW:"₩",MXN:"MX$",NOK:"kr",NZD:"NZ$",PLN:"zł",RUB:"руб",SAR:"﷼",SEK:"kr",SGD:"S$",THB:"฿",TRY:"₺",TWD:"NT$",VND:"₫",XAF:"FCFA",XCD:"EC$",XOF:"CFA",XPF:"CFPF",ZAR:"R"}[t];return e||t},e.commas=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},e.cleanPeriodicity=function(t,e,i){return isNaN(t)&&(t=1),e||(e=1),!isNaN(e)&&i?"minute"!=i&&"second"!=i&&"millisecond"!=i&&(e=i,i=null):"tick"==e?i=null:i||isNaN(e)||(i="minute"),"year"==e&&(e="month",t||(t=1),t*=12),{period:t,interval:e,timeUnit:i}},e.readablePeriodicity=function(t){var i=t.layout.periodicity,a=t.layout.interval;return"number"==typeof t.layout.interval&&t.layout.timeUnit?(i=t.layout.interval*t.layout.periodicity,a=t.layout.timeUnit):"number"!=typeof t.layout.interval||t.layout.timeUnit||(i=t.layout.interval*t.layout.periodicity,a="minute"),i%60==0&&"minute"==a&&(i/=60,a="hour"),i+" "+t.translateIf(e.capitalize(a))},e.fixPrice=function(t){if(!t&&0!==t)return null;for(var e=t.toFixed(10),i=e.length-1;i>1&&"0"==e.charAt(i);i--);return e=e.substring(0,i+1),parseFloat(e)},e.condenseInt=function(t){if(null==t)return"";if(t===1/0||t===-1/0)return"n/a";var e=t<0;return t=isNaN(t)?t.toString():(t=Math.abs(t))>1e12?Math.round(t/1e11)/10+"t":t>1e11?Math.round(t/1e9)+"b":t>1e10?(Math.round(t/1e8)/10).toFixed(1)+"b":t>1e9?(Math.round(t/1e7)/100).toFixed(2)+"b":t>1e8?Math.round(t/1e6)+"m":t>1e7?(Math.round(t/1e5)/10).toFixed(1)+"m":t>1e6?(Math.round(t/1e4)/100).toFixed(2)+"m":t>1e5?Math.round(t/1e3)+"k":t>1e4?(Math.round(t/100)/10).toFixed(1)+"k":t>1e3?(Math.round(t/10)/100).toFixed(2)+"k":t.toString(),e&&(t="-"+t),t},e.calculateTradingDecimalPlaces=function(t){var e=t.chart,i=2,a=e.masterData;if(a&&a.length>50)for(var r=2;r<50;r++){var n=a.length-r;if(n<0)break;var s=a[n];if(s.Close&&"number"==typeof s.Close){var o=s.Close.toString(),l=o.indexOf(".");if(-1!=l){var h=o.length-l-1;h>i&&(i=h)}}}var c=e.yAxis.maxDecimalPlaces;return i>c&&null!==c&&(i=c),i},e.minMax=function(t,e,i,r){var n=Number.MAX_VALUE,s=-1*Number.MAX_VALUE;i||(i="Close");for(var o=r?"High":i,l=r?"Low":i,h=0;h<t.length;h++){var c=t[h];if(c){var u=c[e];if(u||0===u){var d=u;"object"===a(u)&&(d=u[o]),isNaN(d)||!d&&0!==d||(s=Math.max(s,d)),"object"===a(u)&&(d=u[l]),isNaN(d)||!d&&0!==d||(n=Math.min(n,d))}}}return[n,s]},e.symbolEqual=function(t,e){if(!t||!e)return!1;if("object"!=a(t)&&(t={symbol:t}),"object"!=a(e)&&(e={symbol:e}),"function"==typeof t.equals)return t.equals(e);var i=t.symbol,r=e.symbol;return i&&(i=i.toUpperCase()),r&&(r=r.toUpperCase()),i==r&&t.source==e.source},e.addMemberToMasterdata=function(t){t.constructor===e.ChartEngine&&(t={stx:arguments[0],label:arguments[1],data:arguments[2],fields:arguments[3],createObject:arguments[4],fieldForLabel:arguments[5]});var i=t.stx,r=t.label,n=t.data,s=t.fields,o=t.createObject,l=t.fieldForLabel,h=t.chart?t.chart:i.chart;t.noCleanupDates||i.doCleanupDates(n,i.layout.interval);var c=[];if(i.getSeries&&(c=i.getSeries({symbol:r,chart:h})),n&&n.constructor==Object&&(n=[n]),n&&n.length){var u,d,p=0,f=0,m=h.masterData,g=i.layout;m||(m=[]);var v=h&&h.defaultPlotField||null,y=i.mainSeriesRenderer&&!i.mainSeriesRenderer.highLowBars,x=g.chartType;if(!y&&x){var b=e.Renderer.produce(x,{});b&&(y=!b.highLowBars)}for(var S=e.yyyymmddhhmmssmmm;n&&p<m.length&&f<n.length;){if(d=n[f],u=m[p],d.DT&&void 0!==d.DT?("number"==typeof d.DT&&(d.DT=new Date(d.DT)),d.Date&&17==d.Date.length||(d.Date=S(d.DT))):d.DT=e.strToDateTime(d.Date),0===f)for(var C=0;C<c.length;C++)(!c[C].endPoints.begin||c[C].endPoints.begin>d.DT)&&(c[C].endPoints.begin=d.DT);+d.DT!=+u.DT?d.DT<u.DT?m.splice(p,0,{DT:d.DT,Date:d.Date}):F(d.DT):(P(u,d),f++,p++)}if(p>=m.length)for(;n&&f<n.length;)(d=n[f]).DT&&void 0!==d.DT?("number"==typeof d.DT&&(d.DT=new Date(d.DT)),d.Date&&17==d.Date.length||(d.Date=S(d.DT))):d.DT=e.strToDateTime(d.Date),P(u={DT:d.DT,Date:d.Date},d),m.push(u),f++;if(t.fillGaps&&m.length){var w={noCleanupDates:!0,cleanupGaps:t.fillGaps};if(s)for(var k=0;k<s.length;k++)w.field=s[k],i.doCleanupGaps(m,h,w);else w.field=r,i.doCleanupGaps(m,h,w)}for(var D=0;D<c.length;D++){var T=c[D].endPoints;if(!T.end||T.end<=u[r].DT){T.end=u[r].DT;var A=r||c[D].parameters&&c[D].parameters.field||h.defaultPlotField;c[D].lastQuote=i.getFirstLastDataRecord(m,A,!0)}}i.setMasterData(m,h,{noCleanupDates:!0})}function M(t,e){if(!t||"object"!=a(t))return t=e;var i={Close:t.Close,High:t.High,Low:t.Low,Open:t.Open,Volume:t.Volume};for(var r in t=e,i)null===t.Close?void 0!==t[r]&&(t[r]=null):"number"!=typeof t[r]?t[r]=i[r]:"number"==typeof i[r]&&("Open"==r?t.Open=i.Open:"Low"==r&&t.Low>i.Low?t.Low=i.Low:"High"==r&&t.High<i.High?t.High=i.High:"Volume"==r&&(t.Volume+=i.Volume));return t}function P(t,i){if(s&&s.length)if("*"==s[0])e.extend(t,i);else for(var a=0;a<s.length;a++)t[s[a]]=i[s[a]];else if(o){if(void 0!==i.Value)return void(t[r]=i.Value);t[r]="aggregate"==o?M(t[r],i):i;var n=t[r];if("number"==typeof n.Close){"number"!=typeof n.Open&&(n.Open=n.Close);var h=Math.max(n.Open,n.Close),c=Math.min(n.Open,n.Close);("number"!=typeof n.High||n.High<h)&&(n.High=h),("number"!=typeof n.Low||n.Low>c)&&(n.Low=c)}n.Volume&&"number"!=typeof n.Volume&&(n.Volume=parseInt(n.Volume,10))}else l?t[r]=i[l]:y&&v&&void 0!==i[v]?t[r]=i[v]:g.adj&&void 0!==i.Adj_Close?t[r]=i.Adj_Close:void 0!==i.Close?t[r]=i.Close:void 0!==i.Value?t[r]=i.Value:t[r]=i[r]}function F(t){var e=p,i=m.length-1;if(m[i].DT<t)p=i+1;else if(+m[i].DT!=+t){p++;for(var a=0;++a<100;){switch(+m[p].DT==+t?0:m[p].DT<t?1:m[p-1].DT>t?-1:(+m[p-1].DT==+t&&p--,0)){case 0:return;case 1:e=p;break;case-1:i=p}p=Math.round((i+e)/2)}a>=100&&(console.log("!!!Warning: addMemberToMasterdata() did not find insertion point."),p=m.length-1)}else p=i}}}(k),function(t){var e=t.CIQ;Math.easeInOutQuad=function(t,e,i,a){return(t/=a/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},Math.easeInOutCubic=function(t,e,i,a){return(t/=a/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},Math.easeOutCubic=function(t,e,i,a){return t/=a,i*(--t*t*t+1)+e},e.xor=function(t,e){return!t!==!e},e.round=function(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)},e.countDecimals=function(t){if("number"!=typeof t||isNaN(t))return 0;if(Math.floor(t)===Number(t))return 0;var i=t.toString().split("e-");return i.length>1?e.countDecimals(Number(i[0]))+Number(i[1]):i[0].indexOf(".")>-1?i[0].split(".")[1].length:0},e.isValidNumber=function(t){return isFinite(t)&&+t===t},e.log10=function(t){return Math.log(t)/Math.LN10},e.boxIntersects=function(t,e,i,a,r,n,s,o,l){void 0!==arguments[9]&&console.warn("CIQ.boxIntersects() no longer supports isLog argument, please be sure arguments are passed in as pixels.");var h=Math.min(t,i),c=Math.max(t,i),u=Math.min(e,a),d=Math.max(e,a),p="ray"==l;if(isNaN(r)||isNaN(s)||isNaN(n)||isNaN(o))return!1;if("line"!=l){if(r<h&&s<h&&(!p||r>s))return!1;if(r>c&&s>c&&(!p||r<s))return!1;if(n<u&&o<u&&(!p||n>o))return!1;if(n>d&&o>d&&(!p||n<o))return!1}function f(t,e){return(e-n)*(s-r)-(t-r)*(o-n)}var m={a:f(t,e),b:f(t,a),c:f(i,e),d:f(i,a)};return!(m.a>0&&m.b>0&&m.c>0&&m.d>0)&&!(m.a<0&&m.b<0&&m.c<0&&m.d<0)},e.linesIntersect=function(t,e,i,a,r,n,s,o,l){var h=(o-s)*(e-t)-(n-r)*(a-i),c=(n-r)*(i-s)-(o-s)*(t-r),u=(e-t)*(i-s)-(a-i)*(t-r);if(0===h)return 0===c&&0===u;var d=c/h,p=u/h;if("segment"==l){if(d>=0&&d<=1&&p>=0&&p<=1)return!0}else if("line"==l||"horizontal"==l||"vertical"==l){if(d>=0&&d<=1)return!0}else if("ray"==l&&d>=0&&d<=1&&p>=0)return!0;return!1},e.yIntersection=function(t,e){var i=t.x0,a=t.x1,r=e,n=e,s=t.y0,o=t.y1,l=1e4*(a-i)-(n-r)*(o-s),h=(n-r)*(s-0)-1e4*(i-r),c=h/l;if(0===l){if(0!==h)return null;c=1}return s+c*(o-s)},e.xIntersection=function(t,e){var i=t.x0,a=t.x1,r=t.y0,n=(e-e)*(a-i)-1e4*(t.y1-r),s=1e4*(r-e)-(e-e)*(i-0),o=s/n;if(0===n){if(0!==s)return null;o=1}return i+o*(a-i)},e.intersectLineLineX=function(t,e,i,a,r,n,s,o){return t+((n-r)*(i-s)-(o-s)*(t-r))/((o-s)*(e-t)-(n-r)*(a-i))*(e-t)},e.intersectLineLineY=function(t,e,i,a,r,n,s,o){return i+((n-r)*(i-s)-(o-s)*(t-r))/((o-s)*(e-t)-(n-r)*(a-i))*(a-i)}}(k),function(t){var e=t.CIQ;e.deleteRHS=function(t,e){var i=!1;for(var a in t)t[a]==e&&(delete t[a],i=!0);return i},e.scrub=function(t,e){for(var i in t)void 0===t[i]&&delete t[i],e&&null===t[i]&&delete t[i]},e.dataBindSafeAssignment=function(t,i){for(var a in e.extend(t,i),t)void 0===i[a]&&(t[a]=void 0)},e.clone=function(t,i){if(null===t||"object"!=a(t))return t;var r=t.constructor;if(r==Date||r==RegExp||r==String||r==Number||r==Boolean)return new r(t.valueOf());if(r==Function)return function(){return t.apply(this,arguments)};if(!i)try{i=new r}catch(e){i=Object.create(Object.getPrototypeOf(t))}for(var n in t)i[n]=i[n]!==t[n]?e.clone(t[n],null):i[n];return i},e.shallowClone=function(t){if(!t)return t;var e;if(t.constructor==Array){e=new Array(t.length);for(var i=0;i<t.length;i++)e[i]=t[i];return e}for(var a in e={},t)e[a]=t[a];return e},e.ensureDefaults=function(t,e){for(var i in e)void 0===t[i]&&(t[i]=e[i]);return t},e.transferObject=function(t,e){var i;for(i in t)t.hasOwnProperty(i)&&delete t[i];for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},e.equals=function(t,i,r){if(!t&&i)return!1;if(t&&!i)return!1;if(a(t)!==a(i))return!1;for(var n in t){if(!r||!r[n])if("object"!==a(t[n])){if(i[n]!=t[n])return!1}else if(!e.equals(t[n],i[n]))return!1}return!0},e.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},e.first=function(t){for(var e in t)return e;return null},e.last=function(t){var e=null;for(var i in t)e=i;return e},e.objLength=function(t){if(!t)return 0;var e=0;for(var i in t)e++;return e},e.deriveFromObjectChain=function(t,e){if(-1==e.indexOf("."))return{obj:t,member:e};for(var i=e.split("."),a=0;a<i.length-1;a++){var r=i[a];t[r]||0===t[r]||(t[r]={}),t=t[r]}return{obj:t,member:i[a]}},e.createObjectChainNames=function(t,e){for(var i=[],a=0;a<e.length;a++)i.push(t+"--\x3e"+e[a]);return i},e.existsInObjectChain=function(t,e){if(-1==e.indexOf("--\x3e"))return t[e]||0===t[e]?{obj:t,member:e}:null;for(var i,a=e.split("--\x3e"),r=0;r<a.length-1;r++){if(!t[i=a[r]]&&0!==t[i])return null;t=t[i]}return t[i=a[r]]||0===t[i]?{obj:t,member:i}:null},e.derivedFrom=function(t,e){return!!e.isPrototypeOf(t)||t instanceof e},e.replaceFields=function(t,i){if(!t)return t;var r={};for(var n in t){var s=t[n],o=i[n];if(o||(o=n),s&&"object"==a(s))if(s.constructor==Array)for(var l=r[o]=new Array(s.length),h=0;h<l.length;h++){var c=s[h];"object"==a(c)?l[h]=e.replaceFields(c,i):l[h]=c}else r[o]=e.replaceFields(s,i);else r[o]=s}return r},e.removeNullValues=function(t){var i=e.clone(t);for(var a in i)i[a]||delete i[a];return i},e.reverseObject=function(t){var e={};for(var i in t)e[t[i]]=i;return e},e.getFromNS=function(t,e,i){if(t){for(var a=t,r=e.split("."),n=0;n<r.length;n++){var s=r[n];if(void 0===a[s])break;a=a[s]}if(n===r.length)return a}return i},e.getFnFromNS=function(t,i,a){return e.getFromNS(t,i,(function(){return a}))},e.get=function(t,i){return e.getFromNS(e,t,i)},e.getFn=function(t,i){return e.getFromNS(e,t,(function(){return i}))}}(k),function(t){var e=t.CIQ;e.Plotter=function(){this.seriesArray=[],this.seriesMap={}},e.extend(e.Plotter.prototype,{Series:function(t,i,a,r,n,s){this.name=t,this.strokeOrFill=i,this.color=a,this.moves=[],this.text=[],(!r||r>1||r<0)&&(r=1),this.opacity=r,(!n||n>25||n<1)&&(n=1),this.width=n,this.pattern=e.borderPatternToArray(n,s)},newSeries:function(t,e,i,a,r){var n;n=i.constructor==String?new this.Series(t,e,i,a,r):new this.Series(t,e,i.color,i.opacity,r,i.borderTopStyle),this.seriesArray.push(n),this.seriesMap[t]=n},reset:function(t){for(var e in this.seriesMap)if(!t||t==e){var i=this.seriesMap[e];i&&(i.moves=[],i.text=[])}},moveTo:function(t,e,i){this.seriesMap[t].moves.push({action:"moveTo",x:e,y:i})},lineTo:function(t,e,i){var a=this.seriesMap[t],r=a.pattern;a.moves.push({action:"lineTo",x:e,y:i,pattern:r})},dashedLineTo:function(t,e,i,a){this.seriesMap[t].moves.push({action:"lineTo",x:e,y:i,pattern:a})},quadraticCurveTo:function(t,e,i,a,r){var n=this.seriesMap[t],s=n.pattern;n.moves.push({action:"quadraticCurveTo",x0:e,y0:i,x:a,y:r,pattern:s})},bezierCurveTo:function(t,e,i,a,r,n,s){var o=this.seriesMap[t],l=o.pattern;o.moves.push({action:"bezierCurveTo",x0:e,y0:i,x1:a,y1:r,x:n,y:s,pattern:l})},addText:function(t,e,i,a,r,n,s){this.seriesMap[t].text.push({text:e,x:i,y:a,bg:r})},drawText:function(t,e){for(var i=0;i<e.text.length;i++){var a=e.text[i];if(a.bg){var r=a.width?a.width:t.measureText(a.text).width,n=a.height?a.height:12,s=t.fillStyle;t.fillStyle=a.bg,"right"==t.textAlign?t.fillRect(a.x,a.y-n/2,-r,-n):t.fillRect(a.x,a.y-n/2,r,n),t.fillStyle=s}t.fillText(a.text,a.x,a.y)}},draw:function(t,e){for(var i=t.lineWidth,a=t.fillStyle,r=t.strokeStyle,n=t.globalAlpha,s=0;s<this.seriesArray.length;s++){var o=this.seriesArray[s];if(!e||o.name==e){t.beginPath(),t.lineWidth=o.width,t.globalAlpha=o.opacity,t.fillStyle=o.color,t.strokeStyle=o.color,t.save();for(var l=0;l<o.moves.length;l++){var h=o.moves[l];h.pattern?(t.setLineDash(h.pattern),t.lineDashOffset=0):t.setLineDash([]),"quadraticCurveTo"==h.action?t[h.action](h.x0,h.y0,h.x,h.y):"bezierCurveTo"==h.action?t[h.action](h.x0,h.y0,h.x1,h.y1,h.x,h.y):t[h.action](h.x,h.y)}"fill"==o.strokeOrFill?t.fill():t.stroke(),t.closePath(),t.restore(),this.drawText(t,o),t.lineWidth=1}}t.lineWidth=i,t.fillStyle=a,t.strokeStyle=r,t.globalAlpha=n}},!0)}(k),function(t){var e=t.CIQ;e.Renderer=function(){},e.Renderer.produce=function(t,i){var a=null;if(t)for(var r in e.Renderer){var n=e.Renderer[r];if(n.requestNew&&(a=n.requestNew(t.split("_"),i)),a)return a}return i.type="line",new e.Renderer.Lines({params:i})},e.Renderer.colorFunctions={},e.Renderer.registerColorFunction=function(t,i){e.Renderer.colorFunctions[t]=i},e.Renderer.unregisterColorFunction=function(t){delete e.Renderer.colorFunctions[t]},e.Renderer.prototype.adjustYAxis=function(){},e.Renderer.prototype.draw=function(){},e.Renderer.prototype.drawIndividualSeries=function(t,e){},e.Renderer.prototype.construct=function(t){t||(t={});var i=t.params?t.params:{};i.name||(i.name=e.uniqueID()),i.heightPercentage||(i.heightPercentage=.7),i.opacity||(i.opacity=1),!1!==i.highlightable&&(i.highlightable=!0),i.panel||(i.panel="chart"),i.yAxis&&(i.yAxis=new e.ChartEngine.YAxis(i.yAxis),i.yAxis.name||(i.yAxis.name=i.name)),this.cb=t.callback,this.params=i,this.seriesParams=[],this.caches={},this.colors={}},e.Renderer.prototype.attachSeries=function(t,i){var r=this.stx;if(!r)return this;var n=r.chart.series[t];n||(n={parameters:{}});var s=this.params,o=n.parameters,l={id:t,chartType:s.type,display:o.display,border_color_up:s.defaultBorders?"auto":null,fill_color_up:o.color,opacity_up:s.opacity,border_color_down:s.defaultBorders?"auto":null,fill_color_down:o.color,opacity_down:s.opacity,color:o.color,symbol:o.symbol,symbolObject:e.clone(o.symbolObject)};if("string"==typeof i)l.color=l.fill_color_down=l.fill_color_up=i;else if("object"==a(i)){for(var h in i)l[h]=i[h];var c=l.color,u=l.border_color;c&&(l.fill_color_up||(l.fill_color_up=c),l.fill_color_down||(l.fill_color_down=c),l.fill_color_even||(l.fill_color_even=c)),u&&(l.border_color_up||(l.border_color_up=u),l.border_color_down||(l.border_color_down=u),l.border_color_even||(l.border_color_even=u))}l.symbol&&l.field!=l.symbol&&(l.subField=l.field,l.field=l.symbol),l.id||(l.id=e.uniqueID());for(var d=0;d<this.seriesParams.length;++d)if(this.seriesParams[d].id===l.id){this.removeSeries(l.id,!0);break}this.seriesParams.splice(d,0,l),l.fill_color_up!=l.fill_color_down?(this.colors[t+" up"]={color:l.fill_color_up,opacity:l.opacity_up,display:l.display?l.display+" up":t+" up"},this.colors[t+" dn"]={color:l.fill_color_down,opacity:l.opacity_down,display:l.display?l.display+" down":t+" down"}):this.colors[t]={color:l.fill_color_up,opacity:l.opacity_up,display:l.display?l.display:t};var p=s.panel;if(r.panels[p])s.yAxis?(s.yAxis=r.addYAxis(r.panels[p],s.yAxis),s.yAxis.needsInitialPadding=!0,o.yAxis=s.yAxis,r.resizeChart()):l.yAxis&&(s.yAxis=l.yAxis);else{var f=s.yAxis;f||((f=new e.ChartEngine.YAxis).needsInitialPadding=!0),f.name=p,r.createPanel(p,p,null,null,f)}return this},e.Renderer.prototype.removeSeries=function(t,e){var i=null,a=!1,r=this.stx,n=r.chart;for(var s in n.seriesRenderers)for(var o=n.seriesRenderers[s],l=0;l<o.seriesParams.length;l++){var h=o.seriesParams[l];h.id==t&&this===o?i=l:!h.isComparison||h.panel!=n.panel.name||h.yAxis&&h.yAxis!=n.yAxis||(a=!0)}if(null!==i&&(n.forcePercentComparison&&!a&&this.seriesParams[i].isComparison&&"linear"!=r.layout.chartScale&&r.setChartScale(),this.seriesParams.splice(i,1)),delete this.colors[t+" up"],delete this.colors[t+" dn"],delete this.colors[t],!e){var c;for(var u in n.seriesRenderers){for(var d=n.seriesRenderers[u],p=0;p<d.seriesParams.length;p++){if(d.seriesParams[p].id==t){c=!0;break}c=!1}if(c)break}!1!==c&&null===i||r.deleteSeries(t,n)}return r.deleteYAxisIfUnused(r.panels[this.params.panel],this.params.yAxis),r.resizeChart(),r.layout.symbols=r.getSymbols({"include-parameters":!0,"exclude-studies":!0}),r.changeOccurred("layout"),this},e.Renderer.prototype.getDependents=function(t){var e=[];for(var i in t.chart.seriesRenderers){var a=t.chart.seriesRenderers[i];a.params.dependentOf==this.params.name&&e.push(a)}return e},e.Renderer.prototype.undraggable=function(t){return this==t.mainSeriesRenderer||this.params.dependentOf==t.mainSeriesRenderer.params.name},e.Renderer.prototype.removeAllSeries=function(t){if(t){for(var e=[],i=0;i<this.seriesParams.length;i++)e.push(this.seriesParams[i].id);for(var a=0;a<e.length;a++)this.removeSeries(e[a])}return this.seriesParams=[],this.colors={},this.stx.deleteYAxisIfUnused(this.stx.panels[this.params.panel],this.params.yAxis),this.stx.resizeChart(),this},e.Renderer.prototype.getYAxis=function(t){var e;if(this.params)if(this.params.yAxis)e=this.params.yAxis;else{var i=t.panels[this.params.panel];if(!i)return!1;e=i.yAxis}else e=t.chart.panel.yAxis;return e},e.Renderer.prototype.ready=function(){return this.stx.createDataSet(),this.stx.draw(),this},e.Renderer.Lines=function(t){this.construct(t);var e=this.params;if(e.type||(e.type="line"),!e.style)switch(e.type){case"mountain":e.baseline?e.style="stx_baseline_delta_mountain":e.colored?e.style="stx_colored_mountain_chart":e.style="stx_mountain_chart";break;default:e.style="stx_line_chart"}this.supportsAnimation=!0,"wave"==e.type||"channel"==e.type?(e.step=e.vertex=e.baseline=e.colored=!1,this.highLowBars=this.barsHaveWidth=!0,this.supportsAnimation=!1):"step"==e.type&&(e.step=!0)},e.inheritsFrom(e.Renderer.Lines,e.Renderer,!1),e.Renderer.Lines.requestNew=function(t,i){for(var a=null,r=i.step,n=i.colored,s=i.baseline,o=i.vertex,l=0;l<t.length;l++){var h=t[l];switch(h){case"line":case"mountain":case"wave":case"channel":a=h;break;case"baseline":s=!0;break;case"colored":n=!0;break;case"step":r=!0;break;case"vertex":o=!0;break;case"delta":break;default:return null}}return null!==a||s||r?new e.Renderer.Lines({params:e.extend(i,{type:a,step:r,colored:n,baseline:s,vertex:o})}):null},e.Renderer.Lines.prototype.draw=function(){var t,i=this.stx,a=this.stx.panels[this.params.panel].chart,r={},n=this.seriesParams,s=this.params.colorFunction;function o(t){var e=t.fill_color_up||i.getCanvasColor("stx_line_up"),a=t.fill_color_down||i.getCanvasColor("stx_line_down"),r=t.color||i.getCanvasColor("stx_line_chart");return function(t,i,n){return i.iqPrevClose||0===i.iqPrevClose?i.Close>i.iqPrevClose?e:i.Close<i.iqPrevClose?a:r:r}}for(t=0;t<n.length;t++){var l=n[t];if(this.params.colored){for(var h=["_color_up","_color_down","_color"],c=0;c<h.length;c++){var u=l["border"+h[c]];u&&"auto"!=u&&(l["fill"+h[c]]=u)}s||(s=o(l)),this.params.colorFunction=s}var d={};a.series[l.id]&&(d=e.clone(a.series[l.id].parameters)),r[l.id]={parameters:e.extend(e.extend(d,this.params),l),yValueCache:this.caches[l.id]},this==i.mainSeriesRenderer&&a.customChart&&a.customChart.colorFunction&&(r[l.id].parameters.colorFunction=a.customChart.colorFunction)}for(t in i.drawSeries(a,r,this.params.yAxis,this),r)this.caches[t]=r[t].yValueCache},e.Renderer.Lines.prototype.drawIndividualSeries=function(t,i){if(!i.invalid){var a=this.stx,r=t.context,n=null,s=i.colorFunction,o=a.panels[i.panel]||t.panel;if("string"!=typeof s||(s=e.Renderer.colorFunctions[s]))return i.vertex&&(r.save(),r.lineJoin="bevel"),"wave"==i.type?n=a.drawWaveChart(o,i):i.baseline?n=a.drawBaselineChart(o,i):"mountain"==i.type?(i.returnObject=!0,n=a.drawMountainChart(o,i,s)):"channel"==i.type?(i.returnObject=!0,n=a.drawChannelChart(o,s,i)):(i.returnObject=!0,n=a.drawLineChart(o,i.style,s,i)),i.vertex&&(a.scatter(o,{yAxis:i.yAxis,field:i.symbol||i.field,subField:i.subField,symbol:i.symbol,color:i.vertex_color,highlight:i.highlight}),r.restore()),n}},e.Renderer.OHLC=function(t){this.construct(t);var e=this.params;e.type||(e.type="candle"),this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.histogram&&(e.type="candle",this.highLowBars=!1,e.volume=e.hollow=!1),"bar"==e.type&&(e.volume=e.hollow=e.histogram=!1),"candle"==e.type&&(e.hlc=e.colored=!1),e.volume&&(e.hollow=!0)},e.inheritsFrom(e.Renderer.OHLC,e.Renderer,!1),e.Renderer.OHLC.requestNew=function(t,i){for(var a=null,r=i.histogram,n=0;n<t.length;n++){var s=t[n];switch(s){case"candle":a=s;break;case"histogram":r=!0,a="candle";break;default:return null}}return null===a?null:new e.Renderer.OHLC({params:e.extend(i,{type:a,histogram:r})})},e.Renderer.OHLC.getChartParts=function(t,e){return[{type:"histogram",drawType:"histogram",style:"stx_histogram_up",condition:8,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0,useBorderStyleProp:!0},{type:"histogram",drawType:"histogram",style:"stx_histogram_down",condition:16,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0,useBorderStyleProp:!0},{type:"histogram",drawType:"histogram",style:"stx_histogram_even",condition:32,fill:"fill_color_even",border:"border_color_even",skipIfPass:!0,useColorInMap:!0,useBorderStyleProp:!0},{type:"candle",drawType:"shadow",style:"stx_candle_shadow",border:"border_color_up"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_up",condition:8,border:"border_color_up"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_down",condition:16,border:"border_color_down"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_even",condition:32,border:"border_color_even",skipIfPass:!0},{type:"candle",drawType:"candle",style:"stx_candle_up",condition:8,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0,useBorderStyleProp:!0},{type:"candle",drawType:"candle",style:"stx_candle_down",condition:16,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0,useBorderStyleProp:!0}]},e.Renderer.OHLC.prototype.draw=function(){var t,i=this.stx,a=this.stx.panels[this.params.panel].chart,r={},n=this.seriesParams;for(t=0;t<n.length;t++){var s=n[t],o={};a.series[s.id]&&(o=e.clone(a.series[s.id].parameters)),r[s.id]={parameters:e.extend(e.extend(o,this.params),s)},this==i.mainSeriesRenderer&&a.customChart&&a.customChart.colorFunction&&(r[s.id].parameters.colorFunction=a.customChart.colorFunction)}for(t in i.drawSeries(a,r,this.params.yAxis,this),r)r[t].yValueCache&&(this.caches[t]=r[t].yValueCache)},e.Renderer.OHLC.prototype.getColor=function(t,i,a,r,n,s){var o=s||a.color,l=this.params.yAxis||i.yAxis;if(r&&!(o=s||a.borderLeftColor||a["border-left-color"]))return null;if(!n)return o;var h=t.pixelFromTransformedValue(l.highValue,i);isNaN(h)&&(h=0);var c=a.backgroundColor;if(o&&!e.isTransparent(o)){var u=t.chart.context.createLinearGradient(0,h,0,2*l[l.flipped?"top":"bottom"]-h);return u.addColorStop(0,o),u.addColorStop(1,c),u}return c},e.Renderer.OHLC.prototype.drawIndividualSeries=function(t,i){if(!i.invalid){var a=this.stx,r=t.context,n=i.colorFunction,s=a.panels[i.panel]||t.panel;if("string"!=typeof n||(n=e.Renderer.colorFunctions[n])){var o=a.layout.candleWidth-t.tmpWidth<=2&&t.tmpWidth<=3;t.state.chartType||(t.state.chartType={});var l=t.state.chartType.pass={},h=a.colorByCandleDirection;i.colorBasis&&(h="open"==i.colorBasis);var c=i.histogram,u=i.type,d=i.hollow,p=a.noWicksOnCandles[u];a.startClip(s.name);var f=null,m={colors:[],cache:[]},g=[];if(n){var v={isHistogram:c,field:i.field,yAxis:i.yAxis,isVolume:i.volume,highlight:i.highlight};c||"bar"!=u?("candle"!=u||p||a.drawShadows(s,n,v),m=a.drawCandles(s,n,v),v.isOutline=!0,!d&&o||a.drawCandles(s,n,v)):(v.type=i.hlc?"hlc":"bar",m=a.drawBarChart(s,"stx_bar_chart",n,v))}else for(var y=c&&!1!==i.gradient,x=e.Renderer.OHLC.getChartParts(i.style,h),b=0;b<x.length;b++){var S=x[b];if(!S.skipIfPass||l.even){if(c){if("histogram"!=S.type)continue}else if("bar"==u){if("bar"!=S.type)continue;if(i.colored&&!S.condition)continue;if(!i.colored&&S.condition)continue}else if(d){if("hollow"!=S.type)continue;if("shadow"==S.drawType&&p)continue}else{if("candle"!=u)continue;if("candle"!=S.type)continue;if("shadow"==S.drawType){if(p)continue;var C=i.border_color_up||a.getCanvasColor("stx_candle_shadow_up"),w=i.border_color_down||a.getCanvasColor("stx_candle_shadow_down"),k=i.border_color_even||a.getCanvasColor("stx_candle_shadow_even");if(e.colorsEqual(C,w)&&e.colorsEqual(C,k)&&e.colorsEqual(C,a.defaultColor)){if(S.condition)continue}else if(!S.condition)continue}}var D=a.canvasStyle(S.style),T=this.getColor(a,s,D,!1,!1,i[S.fill]),A=this.getColor(a,s,D,!1,y,i[S.fill]),M=this.getColor(a,s,D,S.useBorderStyleProp&&!o,y,i[S.border]);"candle"==S.drawType&&("hollow"==S.type?(!e.isTransparent(A)&&e.colorsEqual(M,A)&&(M=S.useColorInMap?"transparent":A),S.useColorInMap||(A=a.containerColor)):"candle"==S.type&&o&&(e.isTransparent(A)?A=M:M=A)),r.globalAlpha=i.opacity,g.push(a.drawBarTypeChartInner({fillColor:A,borderColor:M,condition:S.condition,style:S.style,type:"bar"==u&&i.hlc?"hlc":S.drawType,panel:s,field:i.field,yAxis:i.yAxis,volume:i.volume&&i.hollow,highlight:i.highlight})),f||(f={}),S.useColorInMap&&(f[T]=1)}}for(var P in a.endClip(),f)i.hollow&&e.equals(P,a.containerColor)||m.colors.push(P);for(P=0;P<g.length;P++)for(var F=0;F<g[P].cache.length;F++){var _=g[P].cache[F];(_||0===_)&&(m.cache[F]=_)}return m}}},e.Renderer.Candles=function(t){this.construct(t);var e=this.params;e.type="candle",this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.hlc=e.colored=e.histogram=!1,e.volume&&(e.hollow=!0)},e.inheritsFrom(e.Renderer.Candles,e.Renderer.OHLC,!1),e.Renderer.SimpleHistogram=function(t){this.construct(t);var e=this.params;e.type="candle",e.histogram=!0,this.barsHaveWidth=this.standaloneBars=!0,this.highLowBars=!1,e.hlc=e.colored=e.hollow=e.volume=!1},e.inheritsFrom(e.Renderer.SimpleHistogram,e.Renderer.Candles,!1)}(k),function(t){var e=t.CIQ;e.capitalize=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""},e.camelCaseRegExp=/-([a-z])/g,e.makeCamelCase=function(t){return t.replace(e.camelCaseRegExp,(function(t){return t[1].toUpperCase()}))},e.uniqueID=function(t){if(t){var e=(new Date).getTime();return"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now&&(e+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)}))}var i=(new Date).getTime().toString(36);return(i+=Math.floor(Math.random()*Math.pow(36,2)).toString(36)).toUpperCase()}}(k),function(t){var e=t.CIQ;e.getHostName=function(t){try{return t.match(/:\/\/(.[^/]+)/)[1]}catch(t){return""}},e.qs=function(t){var e={};t||(t=window.location.search.substring(1));for(var i=t.split("&"),a=0;a<i.length;a++){var r=i[a].indexOf("=");r>0?e[i[a].substring(0,r)]=i[a].substring(r+1):e[i[a]]=null}return e},e.postAjax=function(t,i,a,r,n){"string"==typeof t&&(t={url:t,payload:i,cb:a,contentType:r,noEpoch:n,method:null,responseHeaders:!1});var s=t.url,o=t.cb,l=t.payload;if(o||(o=function(){}),t.ungovernable||!e.Extras||!e.Extras.RequestLimiter||!e.Extras.RequestLimiter.hitRequestLimit(s)){var h=new XMLHttpRequest;if(!h)return!1;var c=new Date;t.noEpoch||(-1==s.indexOf("?")?s+="?ciqrandom="+c.getTime():s+="&ciqrandom="+c.getTime());var u=t.method,d=t.headers;if(u||(u=l?"POST":"GET"),h.open(u,s,!0),t.contentType||(t.contentType="application/x-www-form-urlencoded"),l&&h.setRequestHeader("Content-Type",t.contentType),d)for(var p in d)h.setRequestHeader(p,d[p]);t.timeout&&(h.timeout=t.timeout),h.ontimeout=function(){o(408,null,{})},h.onload=function(){0===this.status?this.status="0":this.status||(this.status=200),o(this.status,this.responseText,function(e){var i={};if(t.responseHeaders){for(var a=e.getAllResponseHeaders().split("\n"),r=0;r<a.length;r++){for(var n=a[r].split(":");n[1]&&" "==n[1].charAt(0);)n[1]=n[1].substring(1);""!==n[0]&&(i[n.shift()]=n.join(":"))}return i}}(this))},h.onerror=function(){o("0",null,{})};try{h.send(l)}catch(t){o("0",t,{})}return!0}o(429,null,{})},e.loadUI=function(t,i,a){i&&"function"!=typeof i||(a=i,i=document.body);var r=document.querySelector('iframe[original-url="'+t+'"]'),n=function(){var t=null;try{t=this.contentDocument}catch(t){return a(t)}if(t&&!t.title){var r=t.body.innerHTML,n=document.createElement("div");e.innerHTML(n,r);for(var s=0;s<n.children.length;s++){var o=n.children[s].cloneNode(!0);i.appendChild(o)}a(null)}else a(new Error("iFrame not found or document has a title"))};if(r){var s=null;try{s=r.contentDocument}catch(t){return a(t)}"complete"===s.readyState&&s.location&&"about:blank"!==s.location.href?n.call(r):r.addEventListener("load",n)}else(r=document.createElement("iframe")).setAttribute("original-url",t),r.src=t+(-1===t.indexOf("?")?"?":"&")+e.uniqueID(),r.hidden=!0,r.addEventListener("load",n),document.body.appendChild(r)},e.loadScript=function(t,i,a){if(e.loadedScripts||(e.loadedScripts={}),e.loadedScripts[t])i&&i();else{var r=document.createElement("SCRIPT");a?(r.type="module",r.crossOrigin="use-credentials"):r.async=!0,r.onload=function(){e.loadedScripts[t]=!0,i&&i()};var n=t;n=-1==n.indexOf("?")?n+"?"+Date.now():n+"&"+Date.now(),r.src=n;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(r,s.nextSibling)}},e.loadStylesheet=function(t,e){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.media="screen",i.href=t+(-1===t.indexOf("?")?"?":"&")+Date.now(),i.onload=function(){this.loaded||(this.loaded=!0,e&&e())};var a=document.getElementsByTagName("link"),r=a[a.length-1];r.parentNode.insertBefore(i,r.nextSibling)},e.loadWidget=function(t,i,a,r){i&&"function"!=typeof i||(a=i,i=document.body),e.loadStylesheet(t+".css",(function(){e.loadUI(t+".html",i,(function(i){i?a(i):e.loadScript(t+".js",a,r)}))}))},e.waitForPlugins=function(t,i){var a=0,r=t.length;if(r){for(var n=0;n<r;n++){var s="cq-"+t[n],o=document.getElementsByTagName(s)[0];o&&o.hasAttribute("loaded")&&a++}if(r!==a)return setTimeout((function(){e.waitForPlugins(t,i)}),0);i()}else i()},e.addInternalStylesheet=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t&&(t.default&&(t=t.default),!("string"!=typeof t||e&&document.querySelector('style[path="'+e+'"]')))){var i=document.createElement("style");i.setAttribute("type","text/css"),i.setAttribute("path",e),i.innerText=t,document.head.appendChild(i)}}}(k),function(t){var e=t.CIQ;e.ChartEngine.prototype.registerHTMLElements=function(){var t=this.chart.container;for(var i in e.ChartEngine.htmlControls)if(void 0===this.chart[i]&&void 0===this.controls[i]){if(!this.allowZoom&&"chartControls"==i)continue;var a=t.querySelector("."+i);if(a)this.chart[i]=a,this.controls[i]=a;else{var r=e.ChartEngine.htmlControls[i];if(!r)continue;var n=document.createElement("DIV");n.innerHTML=r,a=n.firstChild,t.appendChild(a),this.chart[i]=a,this.controls[i]=a,a.classList.add(i)}}var s,o=this.controls.chartControls,l=this.controls.home;if(o){var h=o.querySelector(".stx-zoom-in"),c=o.querySelector(".stx-zoom-out");e.safeClickTouch(h,(s=this,function(t){s.allowZoom&&s.zoomIn(t),t.stopPropagation()})),e.safeClickTouch(c,function(t){return function(e){t.allowZoom&&t.zoomOut(e),e.stopPropagation()}}(this)),e.touchDevice||(this.makeModal(h),this.makeModal(c))}l&&(e.safeClickTouch(l,function(t){return function(e){e.stopPropagation(),t.isHistoricalMode()?(delete t.layout.range,t.loadChart(t.chart.symbol,(function(){t.home({animate:!1})}))):t.home({animate:!0})}}(this)),e.touchDevice||this.makeModal(l))},e.ChartEngine.prototype.home=function(t){this.swipe.amplitude=0;var e=this.layout;function i(t){for(var e in t.panels)for(var i=t.panels[e].yaxisLHS.concat(t.panels[e].yaxisRHS),a=0;a<i.length;a++)t.calculateYAxisMargins(i[a])}function r(t,e,a){return function(){i(t),e.scroll=a,t.draw()}}if("object"!=a(t)&&(t={maintainWhitespace:t}),void 0===t.maintainWhitespace&&(t.maintainWhitespace=!0),this.cancelTouchSingleClick=!0,this.chart.dataSet&&this.chart.dataSet.length){this.micropixels=0;var n=Math.floor(this.chart.width/e.candleWidth);for(var s in this.charts){var o=this.charts[s];if(!t.chart||t.chart==o){var l=0;t.maintainWhitespace&&this.preferences.whitespace>=0&&(l=this.preferences.whitespace),(t.whitespace||0===t.whitespace)&&(l=t.whitespace);var h=this.getLabelOffsetInPixels(o,e.chartType);h>l&&(l=h);var c=Math.min(n,o.dataSet.length);for(this.chart.allowScrollPast&&(c=n),this.micropixels=this.chart.width-c*e.candleWidth-l,this.preferences.whitespace=l;this.micropixels>e.candleWidth;)c++,this.micropixels-=e.candleWidth;for(;this.micropixels<0;)c--,this.micropixels+=e.candleWidth;if(this.micropixels-=e.candleWidth,c++,this.mainSeriesRenderer&&this.mainSeriesRenderer.standaloneBars||(this.micropixels+=e.candleWidth/2),t.animate){this.scrollTo(o,c,r(this,o,c))}else o.scroll=c,i(this)}}this.draw()}else this.draw()},e.ChartEngine.prototype.headsUpHR=function(){if(!this.runPrepend("headsUpHR",arguments)){var t=this.currentPanel;if(t){var i=t.chart;this.updateFloatHRLabel(t);var a=this.controls.floatDate;if(a&&!i.xAxis.noDraw){var r=this.barFromPixel(this.cx),n=i.xaxis[r];n&&n.DT?s(e.displayableDate(this,i,n.DT)):n&&n.index?s(n.index):s("")}this.runAppend("headsUpHR",arguments)}}function s(t){e.efficientDOMUpdate(a,"innerHTML",t)}},e.ChartEngine.prototype.modalBegin=function(){this.openDialog="modal",this.undisplayCrosshairs()},e.ChartEngine.prototype.modalEnd=function(){this.cancelTouchSingleClick=!0,this.openDialog="",this.doDisplayCrosshairs()},e.ChartEngine.prototype.makeModal=function(t){var e=this;t.onmouseover=function(t){e.modalBegin()},t.onmouseout=function(t){e.modalEnd()}},e.ChartEngine.prototype.updateChartAccessories=function(){var t;if(null!==this.accessoryTimer&&clearTimeout(this.accessoryTimer),!e.ChartEngine.drawingLine&&e.touchDevice&&(new Date).getTime()-this.lastAccessoryUpdate<100)this.accessoryTimer=setTimeout((t=this,function(){t.updateChartAccessories()}),10);else if(this.chart.dataSet&&!this.runPrepend("updateChartAccessories",arguments)){this.accessoryTimer=null,this.lastAccessoryUpdate=(new Date).getTime();var i=this.controls.floatDate;if(i){var a=this.currentPanel;if(a||(a=this.chart.panel),a){var r=a.chart,n=!0===this.xAxisAsFooter?0:this.chart.canvasHeight-a.chart.bottom,s=i.offsetWidth/2-.5,o=this.pixelFromTick(this.crosshairTick,r)-s;o<0?o=0:o>this.width-2*s-1&&(o=this.width-2*s-1),e.efficientDOMUpdate(i.style,"left",o+"px"),e.efficientDOMUpdate(i.style,"bottom",n+"px")}}this.positionCrosshairsAtPointer(),this.headsUpHR(),this.runAppend("updateChartAccessories",arguments)}},e.ChartEngine.prototype.positionSticky=function(t){var e=Math.max(this.cy-t.offsetHeight-60,0),i=Math.min(this.chart.canvasWidth-(this.cx-50),this.chart.canvasWidth-t.offsetWidth);t.style.top=e+"px",t.style.right=i+"px"},e.ChartEngine.prototype.displaySticky=function(t){var i=this.controls.mSticky;if(i){var r=i.querySelector(".mStickyInterior");if(r){var n=i.querySelector(".overlayTrashCan"),s=i.querySelector(".overlayEdit"),o=i.querySelector(".mouseDeleteInstructions"),l=i.querySelector(".stickyLongPressText");o.classList.remove("no_edit"),t&&"object"==a(t)||(t={message:arguments[0],backgroundColor:arguments[1],forceShow:arguments[2],noDelete:arguments[3],type:arguments[4]});var h=t.message,c=t.backgroundColor,u=t.forceShow,d=t.noDelete,p=t.noEdit,f=t.type;if(u||h){h||(h="");var m=this.defaultColor;"auto"==c&&(c=m),u&&!h?(r.style.backgroundColor="",r.style.color="",r.style.display="none"):c?(r.style.backgroundColor=c,r.style.color=e.isTransparent(c)?m:e.chooseForegroundColor(c),r.style.display="inline-block"):(r.style.backgroundColor="",r.style.color="",r.style.display="inline-block"),r.innerHTML=h;var g=i.querySelector(".mStickyRightClick");if(g.className="mStickyRightClick",f&&g.classList.add("rightclick_"+f),g.style.display="",i.style.display="inline-block",d||!0===this.bypassRightClick||this.bypassRightClick[f])g.style.display="none";else if(this.highlightViaTap||this.touches.length)n&&(n.style.display="inline-block"),s&&!p&&(s.style.display="inline-block"),o&&(o.style.display="none"),l&&(l.style.display="none"),i.classList[""===h?"add":"remove"]("hide");else if(p&&o.classList.add("no_edit"),o&&(o.style.display="block"),l){l.style.display="none";var v=this.preferences.dragging;v&&t.panel&&!t.panel.noDrag&&((!0!==v&&!v.study||"study"!=f)&&(!0!==v&&!v.series||"series"!=f)||(l.style.display="block"))}var y=f||"default";i.setAttribute("cq-sticky-type",y);var x=t.positioner||this.positionSticky;x.call(this,i)}else r.innerHTML="",i.style.display="none",n&&(n.style.display="none"),s&&(s.style.display="none"),o&&(o.style.display="none"),l&&(l.style.display="none")}}},e.ChartEngine.prototype.displayNotification=function(t,e){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.controls.notificationTray){var r=a.callback,n=a.dismissalListeners,s=this.controls.notificationTray,o=s.querySelector("template").content.cloneNode(!0),l=o.firstElementChild;if(l.className=t,l.querySelector(".message").textContent=e,r){var h=window.PointerEvent?"pointerup":"touchend";l.handler=l.addEventListener(h,r)}n&&(l.listeners={},n.forEach((function(e){l.listeners[t]=i.addEventListener(e.type,e.callback)}))),this.makeModal(l),s.appendChild(l)}},e.ChartEngine.prototype.removeNotification=function(t){if(this.controls.notificationTray){var e=this.controls.notificationTray,i=e.querySelector(".".concat(t));if(i){if(i.handler&&i.removeEventListener(i.handler),i.listeners)for(var a in i.listeners)this.removeEventListener(i.listeners[a]);this.modalEnd(),e.removeChild(i)}}},e.ChartEngine.prototype.setMeasure=function(t,e,i,a,r){if(!this.runPrepend("setMeasure",arguments)){var n=(this.drawingContainer||document).querySelector(".mMeasure"),s="";if(t||0===t){if(!1!==e){var o,l=Math.round(Math.abs(t-e)*this.chart.roundit)/this.chart.roundit;l=l.toFixed(this.chart.yAxis.printDecimalPlaces),this.internationalizer?s+=this.internationalizer.numbers.format(l):s+=l,t>0&&e>0&&(o=(e-t)/t,o=Math.abs(o)>.1?Math.round(100*o):Math.abs(o)>.01?Math.round(1e3*o)/10:Math.round(1e4*o)/100,this.internationalizer?o=this.internationalizer.percent.format(o/100):o+="%",s+=" ("+o+")")}if(!1!==a){var h=Math.abs(a-i);h=Math.round(h)+1;var c=this.translateIf("Bars");s+=" "+h+" "+c}n&&(n.innerHTML=s)}else this.anyHighlighted||""!==this.currentVectorParameters.vectorType||this.clearMeasure();if(!this.activeDrawing){if(n=this.controls.mSticky){var u=n.querySelector(".mStickyInterior");r?(n.style.display="inline-block",u.style.display="inline-block",(t||0===t)&&(u.innerHTML=s),n.classList[""===s?"add":"remove"]("hide"),this.positionSticky(n)):(n.style.display="none",u.innerHTML="")}this.runAppend("setMeasure",arguments)}}},e.ChartEngine.prototype.clearMeasure=function(){var t=(this.drawingContainer||document).querySelector(".mMeasure");t&&(t.innerHTML="")},e.ChartEngine.prototype.zoomSet=function(t,i){t=this.constrainCandleWidth(t),"none"!=this.chart.tempCanvas.style.display&&e.clearCanvas(this.chart.tempCanvas,this);var a=this.mainSeriesRenderer||{};if(!a.params||!a.params.volume){var r;r=this.preferences.zoomAtCurrentMousePosition&&this.zoomInitiatedByMouseWheel&&this.crosshairTick<i.dataSet.length?this.crosshairTick||this.tickFromPixel(this.cx,i):this.isHome()?i.dataSet.length-1:this.chart.scroll>this.chart.dataSet.length?0:"zoom-x"==this.grabMode?this.tickFromPixel(this.chart.width,i):this.tickFromPixel(this.chart.width/2,i),this.animations.zoom.hasCompleted&&(this.zoomInitiatedByMouseWheel=!1);var n=i.dataSet.length-1-r,s=i.scroll;i.scroll=Math.round((this.pixelFromTick(r,i)-i.left)/t)+1+n,this.micropixels+=(s-n)*this.layout.candleWidth-(i.scroll-n)*t}this.setCandleWidth(t),i.spanLock=!1,this.draw(),this.doDisplayCrosshairs(),this.updateChartAccessories()}}(k),function(t){var e=t.CIQ;e.ChartEngine.Chart=function(){this.xAxis=new e.ChartEngine.XAxis,this.yAxis=new e.ChartEngine.YAxis,this.symbolObject={symbol:null},this.series={},this.seriesRenderers={},this.xaxis=[],this.state={},this.endPoints={},this.defaultChartStyleConfig={},this.baseline=e.clone(this.baseline)},e.extend(e.ChartEngine.Chart.prototype,{symbol:null,symbolObject:{symbol:null},symbolDisplay:null,series:{},seriesRenderers:{},scroll:0,isComparison:!1,forcePercentComparison:!0,maxTicks:0,tension:null,currentMarketData:{},masterData:null,dataSet:null,scrubbed:null,dataSegment:null,segmentImage:null,baseline:{includeInDataSegment:!1,defaultLevel:null,userLevel:null,actualLevel:null},xAxis:null,xaxis:[],xaxisFactor:30,decimalPlaces:2,dynamicYAxis:!1,roundit:100,legendRenderer:e.drawLegend,customChart:null,yaxisPaddingRight:null,yaxisPaddingLeft:null,tickCache:{},allowScrollPast:!0,allowScrollFuture:!0,whiteSpaceFutureTicks:0,hideDrawings:!1,defaultPlotField:"Close",defaultChartStyleConfig:{},lockScroll:!1,includeOverlaysInMinMax:!0,gaplines:null,lineStyle:null,lineApproximation:!0,highLowBars:!1,standaloneBars:!1,barsHaveWidth:!1,calculateTradingDecimalPlaces:e.calculateTradingDecimalPlaces},!0)}(k),function(t){var e=t.CIQ;e.ChartEngine.prototype.resolveY=function(t){return this.top+t},e.ChartEngine.prototype.resolveX=function(t){return this.left+t},e.ChartEngine.prototype.backOutY=function(t){return t-this.top},e.ChartEngine.prototype.backOutX=function(t){return t-this.left},e.ChartEngine.prototype.dateFromTick=function(t,i,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dataSet";i||(i=this.chart);var n,s,o,l=i[r],h=l.length,c=!1;return 0===h&&(l[0]={},l[0].DT=new Date,h=l.length,c=!0),n=t<0?(s=this.standardMarketIterator(l[0].DT))?s.previous(Math.abs(t)):l[0].DT:t>=h?(s=this.standardMarketIterator(l[h-1].DT))?s.next(t-(h-1)):l[h-1].DT:l[t].DT,o=a?new Date(n.getTime()):e.yyyymmddhhmmssmmm(n).substr(0,12),c&&delete l[0].DT,o},e.ChartEngine.prototype.tickFromDate=function(t,i,a,r){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dataSet";i||(i=this.chart);var s=i[n];if(!s||!s.length)return 0;a||(a=0);var o=t.constructor==Date?t:e.strToDateTime(t);e.ChartEngine.isDailyInterval(this.layout.interval)||o.setMinutes(o.getMinutes()+a);var l=o.getTime();i.tickCache[n]||(i.tickCache[n]={});var h=i.tickCache[n][l];if(h||0===h)return r?Math.ceil(h):Math.floor(h);var c=s[0].DT,u=s[s.length-1].DT;if(o>=c&&o<=u){for(var d=0,p=s.length,f=0;++f<100;){var m=Math.floor((p+d)/2),g=s[m].DT;if(+g==+o)return i.tickCache[n][l]=m,m;if(g<o&&(d=m),g>o){if(s[m-1].DT<o)return i.tickCache[n][l]=m-.5,r?m:m-1;if(+s[m-1].DT==+o)return i.tickCache[n][l]=m-1,m-1;p=m}}if(f>=100)return console.log("!!!Warning: tickFromDate() did not find match."),s.length}var v=o<c,y=v?c:u,x=this.standardMarketIterator(y),b=x?x.futureTick({end:o}):0;return h=v?-1*b:s.length-1+b,i.tickCache[n][l]=h,h},e.ChartEngine.prototype.pixelFromBar=function(t,e){e||(e=this.chart);var i=0,a=this.chart.segmentImage;return i=a&&a[t]&&a[t].leftOffset?a[t].leftOffset:(t+.5)*this.layout.candleWidth,i=e.panel.left+Math.floor(i+this.micropixels)-1},e.ChartEngine.prototype.barFromPixel=function(t,e){e||(e=this.chart);var i=this.chart.segmentImage,a=this.micropixels,r=this.layout.candleWidth;if(i){var n,s,o,l=t-e.panel.left-a,h=2,c=i.length,u=Math.round(c/h),d=i[c-1].leftOffset+i[c-1].candleWidth/2;if(l>d)return c+Math.floor((t-d-e.panel.left-a)/r);for(var p=1;p<c&&(h*=2,n=i[u]);p++){var f=(s=n.leftOffset)-(o=n.candleWidth/2);if(0===u||l>=f&&l<s+o)break;l<f?u-=Math.max(1,Math.round(c/h)):u+=Math.max(1,Math.round(c/h)),u=Math.max(0,Math.min(c-1,u))}if(!i[u])for(p=0;p<c;p++)if(n=i[p]){if(l<(s=n.leftOffset)-(o=n.candleWidth/2))return Math.max(0,p-1);if(l<s+o)return p;if(l>=s+o)return p+1}return u}return Math.floor((t-e.panel.left-a)/r)},e.ChartEngine.prototype.tickFromPixel=function(t,e){e||(e=this.chart);var i=e.dataSet.length-e.scroll;return e.segmentImage?i+=this.barFromPixel(t,e):i+=Math.floor((t-e.panel.left-this.micropixels)/this.layout.candleWidth),i},e.ChartEngine.prototype.pixelFromTick=function(t,e){e||(e=this.chart);var i=e.dataSegment,a=e.dataSet,r=e.segmentImage,n=this.micropixels,s=i?i.length:0,o=e.panel,l=e.scroll,h=t-a.length+l,c=s?i[h]:null;if(r&&(c=r[h]),c&&c.leftOffset)return o.left+Math.floor(c.leftOffset+n);var u=0,d=0;return c=s?i[s-1]:null,r&&(c=r[s-1]),c&&c.leftOffset&&s<t-a.length+l&&(u=c.leftOffset-c.candleWidth/2,d=s),u+o.left+Math.floor((t-d-a.length+l+.5)*this.layout.candleWidth+n)},e.ChartEngine.prototype.pixelFromDate=function(t,e,i,a){return this.pixelFromTick(this.tickFromDate(t,e,i,a),e)},e.ChartEngine.prototype.transformedPriceFromPixel=function(t,e,i){e||(e=this.chart.panel);var a,r=i||e.yAxis;if(t=r.bottom-t,r.semiLog){var n=t*r.logShadow/r.height;r.flipped?n=r.logHigh-n:n+=r.logLow,a=Math.pow(10,n)}else{if(!r.multiplier)return null;a=t/r.multiplier,r.flipped?a=r.high-a:a+=r.low}return a},e.ChartEngine.prototype.priceFromPixel=function(t,e,i){e||(e=this.chart.panel);var a=this.transformedPriceFromPixel(t,e,i);return this.charts[e.name]&&e.chart.untransformFunc&&(i&&i!=e.yAxis||(a=e.chart.untransformFunc(this,e.chart,a,i))),a},e.ChartEngine.prototype.valueFromPixel=function(t,e,i){if(e||(e=this.whichPanel(t)),!e){var a=Object.values(this.panels);a&&a.length&&(e=t<=0?a.shift():a.pop())}return this.priceFromPixel(t,e,i)},e.ChartEngine.prototype.valueFromInterpolation=function(t,i,r,n,s){if(null===t||t<0||!i)return null;n||(n=this.chart.panel),s||(s=n.yAxis),r||(r=this.chart.defaultPlotField);var o,l=this.getPreviousBar(this.chart,i,t);if(!l)return null;var h=e.existsInObjectChain(l,i);h&&(o=h.obj[h.member]),"object"==a(o)&&(o=o[r]);var c=this.getRendererFromSeries(i);if(c&&c.params.step||"step"===this.layout.chartType)return o;var u,d=this.getNextBar(this.chart,i,t);if((h=e.existsInObjectChain(d,i))&&(u=h.obj[h.member]),"object"==a(u)&&(u=u[r]),!d)return null;if(null==o||null==u)return null;var p=this.pixelFromPrice(o,n,s),f=this.pixelFromPrice(u,n,s),m=l.tick,g=(f-p)/(d.tick-m)*(this.chart.dataSegment[t].tick-m)+p;return this.priceFromPixel(g,n,s)},e.ChartEngine.prototype.pixelFromTransformedValue=function(t,e,i){e||(e=this.chart.panel);var a=i||e.yAxis,r=(a.high-t)*a.multiplier;if(a.semiLog){var n=Math.max(t,0),s=Math.log(n)/Math.LN10,o=a.height;r=o-o*(s-a.logLow)/a.logShadow}return r=a.flipped?a.bottom-r:a.top+r},e.ChartEngine.prototype.pixelFromPrice=function(t,e,i){return e||(e=this.chart.panel),this.charts[e.name]&&e.chart.transformFunc&&(i&&i!=e.yAxis||(t=e.chart.transformFunc(this,e.chart,t,i))),this.pixelFromTransformedValue(t,e,i)},e.ChartEngine.prototype.pixelFromValueAdjusted=function(t,e,i,a){if(this.layout.adj||!this.charts[t.name])return this.pixelFromPrice(i,t,a);var r,n=Math.round(e);return n>0&&n<t.chart.dataSet.length&&(r=t.chart.dataSet[n].ratio)?this.pixelFromPrice(i*r,t,a):this.pixelFromPrice(i,t,a)},e.ChartEngine.prototype.adjustIfNecessary=function(t,e,i){if(this.layout.adj)return i;if(!t||!this.charts[t.name])return i;var a,r=Math.round(e);return r>0&&r<t.chart.dataSet.length&&(a=t.chart.dataSet[r].ratio)?i/a:i}}(k),function(t){var e=t.CIQ;e.ChartEngine.prototype.positionCrosshairsAtPointer=function(){var t=this.currentPanel;if(t&&!(!this.manageTouchAndMouse||this.mainSeriesRenderer&&this.mainSeriesRenderer.nonInteractive||this.runPrepend("positionCrosshairsAtPointer",arguments))){var i=t.chart,a=this.container.getBoundingClientRect();this.top=a.top,this.left=a.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cy=this.crossYActualPos=this.backOutY(e.ChartEngine.crosshairY),this.cx=this.backOutX(e.ChartEngine.crosshairX);var r=this.crosshairTick=this.tickFromPixel(this.cx,i),n=this.pixelFromTick(r,i)-1;if(this.controls.crossX&&(this.controls.crossX.style.left=n+"px"),n>=t.right||n<=t.left)this.undisplayCrosshairs();else{var s="chart"==t.name?this.preferences.horizontalCrosshairField:t.horizontalCrosshairField,o=i.dataSet;s&&o&&r<o.length&&r>-1&&(this.crossYActualPos=this.pixelFromPrice(o[r][s],t)),this.controls.crossY&&(this.controls.crossY.style.top=this.crossYActualPos+"px"),this.runAppend("positionCrosshairsAtPointer",arguments)}}},e.ChartEngine.prototype.doDisplayCrosshairs=function(){if(!this.runPrepend("doDisplayCrosshairs",arguments)){if(this.displayInitialized){var t=this.floatCanvas,i=this.currentVectorParameters.vectorType;if(this.layout.crosshair||""!==i&&i)if(e.Drawing&&e.Drawing[i]&&(new e.Drawing[i]).dragToDraw)this.undisplayCrosshairs();else if(this.overXAxis||this.overYAxis||!this.insideChart&&!this.grabbingScreen)this.undisplayCrosshairs();else if(""!==this.openDialog)this.undisplayCrosshairs();else{var a=this.controls,r=a.crossX,n=a.crossY;r&&""!==r.style.display&&(r.style.display="",n&&(n.style.display=""),this.magnetizedPrice&&i?(this.container.classList.remove("stx-crosshair-on"),this.chart.tempCanvas.style.display="block"):this.container.classList.add("stx-crosshair-on")),a.floatDate&&!this.chart.xAxis.noDraw&&(a.floatDate.style.visibility="",this.currentPanel&&this.updateFloatHRLabel(this.currentPanel)),t&&("none"==t.style.display&&e.clearCanvas(t,this),t.style.display="block")}else this.undisplayCrosshairs()}this.runAppend("doDisplayCrosshairs",arguments)}},e.ChartEngine.prototype.undisplayCrosshairs=function(){if(!this.runPrepend("undisplayCrosshairs",arguments)){var t=this.controls,i=t.crossX,a=t.crossY;i&&"none"!=i.style.display&&(i.style.display="none",a&&(a.style.display="none")),this.displayInitialized&&t.floatDate&&(t.floatDate.style.visibility="hidden"),this.container.classList.remove("stx-crosshair-on");var r=this.floatCanvas;if(r&&r.isDirty&&"none"!=r.style.display&&(e.clearCanvas(r,this),"none"!=r.style.display&&(r.style.display="none")),!this.activeDrawing&&!this.repositioningDrawing&&!this.editingAnnotation){var n=this.chart.tempCanvas;n&&"none"!=n.style.display&&(n.style.display="none")}this.runAppend("undisplayCrosshairs",arguments)}},e.ChartEngine.prototype.hideCrosshairs=function(){this.displayCrosshairs=!1},e.ChartEngine.prototype.showCrosshairs=function(){this.displayCrosshairs=!0}}(k),function(t){var e=t.CIQ,i=t.timezoneJS;e.ChartEngine.prototype.loadChart=function(t,i,r){r||"function"!=typeof i?Array.isArray(i)&&(i={masterData:i}):(r=i,i={}),i||(i={});var n=i.chart||this.chart,s=this.layout,o=i.periodicity;if(o){var l=e.cleanPeriodicity(o.period?o.period:o.periodicity,o.interval,o.timeUnit);s.interval=l.interval,s.periodicity=l.period,s.timeUnit=l.timeUnit}var h=n.symbol,c=e.clone(n.symbolObject),u=n.market,d=n.masterData,p=n.dataSet,f=n.moreAvailable,m=n.upToDate;if(n.dataSet=[],n.masterData=[],n.moreAvailable=null,n.upToDate=null,t?"object"==a(t)?(n.symbol=t.symbol,n.symbolObject=t):(n.symbol=t,n.symbolObject.symbol=t):(n.symbol=null,n.symbolObject={symbol:null}),n.inflectionPoint=null,this.marketFactory){var g=this.marketFactory(n.symbolObject);this.setMarket(g,n)}this.setMainSeriesRenderer(!0);var v=i.span,y=i.range;y||v||!s?y&&v&&(v={}):(v=s.range?{}:s.setSpan,y=s.range||{}),this.clearCurrentMarketData(n);var x=this;if(!i.masterData&&this.quoteDriver){var b=function(t){t&&"orphaned"!=t&&(n.symbol=h,n.symbolObject=c,n.market=u,x.masterData=n.masterData=d,n.dataSet=p,n.moreAvailable=f,n.upToDate=m),x.dispatch(x.currentlyImporting?"symbolImport":"symbolChange",{stx:x,symbol:n.symbol,symbolObject:n.symbolObject,prevSymbol:h,prevSymbolObject:c,action:"master"}),r&&r.call(x,t)};y&&Object.keys(y).length&&this.setRange?(delete i.span,delete s.setSpan,this.chart.masterData=null,this.displayInitialized=!1,o&&(y.periodicity=o),y.forceLoad=!0,this.setRange(y,b)):v&&v.base&&this.setSpan?(v.multiplier=v.multiplier||1,this.chart.masterData=null,this.displayInitialized=!1,o&&(v.maintainPeriodicity=!0),v.forceLoad=!0,this.setSpan(v,b)):this.quoteDriver.newChart({symbol:n.symbol,symbolObject:n.symbolObject,chart:n,initializeChart:!0},(function(t){t||(x.adjustPanelPositions(),x.quoteDriver.updateSubscriptions(),i.stretchToFillScreen&&x.fillScreen()),b.apply(x,arguments)}))}else{i.masterData||console.log("Warning: No masterData specified and no QuoteFeed configured"),n.symbol||(n.symbol=""),this.initializeChart();var S=this.doCleanupGaps(i.masterData,n);this.setMasterData(S,n,{noCleanupDates:!0}),n.endPoints={},S&&S.length&&(n.endPoints={begin:S[0].DT,end:S[S.length-1].DT}),this.createDataSet(),y&&Object.keys(y).length&&this.setRange?this.setRange(y):v&&v.multiplier&&v.base&&this.setSpan?this.setSpan({maintainPeriodicity:!0,multiplier:v.multiplier,base:v.base}):i.stretchToFillScreen?this.fillScreen():S&&S.length?this.home():this.clear(),this.adjustPanelPositions(),x.dispatch(x.currentlyImporting?"symbolImport":"symbolChange",{stx:x,symbol:n.symbol,symbolObject:n.symbolObject,prevSymbol:h,prevSymbolObject:c,action:"master"}),r&&r.call(x)}},e.ChartEngine.prototype.loadBlankChart=function(){this.loadChart(null,[])},e.ChartEngine.prototype.getDataFields=function(t){t||(t=this.chart);var e=t.defaultPlotField||"Close",i=["Open","High","Low"];for(var a in i.push(e),t.series){var r=t.series[a].parameters;i.push(r.symbol)}return i},e.ChartEngine.prototype.cleanMasterData=function(t,e){var i=t.symbol,a=e.masterData;if(a&&a.length){var r=this.getDataFields(e),n=0;do{var s=a[n];delete s[i],o.call(this,s,r)?a.splice(n,1):n++}while(n<a.length);a=this.doCleanupGaps(a,e,{noCleanupDates:!0}),this.setMasterData(a,e,{noCleanupDates:!0}),this.clearCurrentMarketData(e,i)}function o(t,e){for(var i=0;i<e.length;i++){if(void 0!==t[e[i]])return!1}return!0}},e.ChartEngine.prototype.calculateATR=function(t,e,i){i||(i=t.dataSet);var a=t.state.calculations.atr;a||(a=t.state.calculations.atr={}),e||(e=20);var r,n=[];a.accum&&(n=a.accum);for(var s=0;s<i.length;s++){var o=i[s];if(r=s?i[s-1]:a.q1){var l=Math.max(o.High-o.Low,Math.abs(o.High-r.Close),Math.abs(o.Low-r.Close));if(n.length<e){if(n.push(l)==e){for(var h=0,c=0;c<n.length;c++)h+=n[c];o.atr=h/e}}else o.atr=(r.atr*(e-1)+l)/e;o.trueRange=l}}t.state.calculations.atr={accum:n,q1:r}},e.ChartEngine.prototype.calculateMedianPrice=function(t,e){var i;e||(e=t.dataSet);for(var a=0;a<e.length;++a)(i=e[a])["hl/2"]=(i.High+i.Low)/2},e.ChartEngine.prototype.calculateTypicalPrice=function(t,e){var i;e||(e=t.dataSet);for(var a=0;a<e.length;++a)(i=e[a])["hlc/3"]=(i.High+i.Low+i.Close)/3},e.ChartEngine.prototype.calculateWeightedClose=function(t,e){var i;e||(e=t.dataSet);for(var a=0;a<e.length;++a)(i=e[a])["hlcc/4"]=(i.High+i.Low+2*i.Close)/4},e.ChartEngine.prototype.calculateOHLC4=function(t,e){var i;e||(e=t.dataSet);for(var a=0;a<e.length;++a)(i=e[a])["ohlc/4"]=(i.Open+i.High+i.Low+i.Close)/4},e.ChartEngine.prototype.currentQuote=function(t){if(!this.chart.dataSet)return null;for(var e=this.chart.dataSet.length-1;e>=0;e--)if(this.chart.dataSet[e]){if(!t)return this.chart.dataSet[e];var i=this.chart.dataSet[e][t];if(i||0===i)return this.chart.dataSet[e]}return null},e.ChartEngine.prototype.mostRecentClose=function(t){if(!this.chart.dataSet)return null;for(var e=this.chart.dataSet.length-1;e>=0;e--){var i=this.chart.dataSet[e];if(i&&(!t||(i=i[t])||0===i)){var r=i.iqPrevClose;if("object"==a(i)&&(i=i.Close),"number"==typeof i)return i;if("number"==typeof r)return r}}return null},e.ChartEngine.prototype.createDataSegment=function(t){if(!this.runPrepend("createDataSegment",arguments)){var i;for(var a in this.charts){i=this.charts[a],t&&(i=t),e.Comparison&&i.isComparison&&e.Comparison.createComparisonSegmentInner(this,i);var r=i.dataSet,n=i.baseline,s=i.scroll,o=i.maxTicks,l=this.layout,h=l.candleWidth;n.actualLevel=n.userLevel?n.userLevel:n.defaultLevel;for(var c,u=n.includeInDataSegment&&(!this.mainSeriesRenderer||!this.mainSeriesRenderer.standaloneBars),d=i.dataSegment=[],p=r.length-1-s-1,f=i.defaultPlotField,m=-1;m<s&&m<o;m++)if(p++,-1!=m||u)if(p<r.length&&p>=0){if((c=r[p]).candleWidth=null,d.push(c),null===n.actualLevel&&m>=0)if(f&&"Close"!=f){var g=r[p-1];g&&(g[f]||0===g[f])&&(n.actualLevel=g[f])}else(c.iqPrevClose||0===c.iqPrevClose)&&(n.actualLevel=c.iqPrevClose)}else p<0&&d.push(null);i.segmentImage=null;var v=this.mainSeriesRenderer||{};if(v.params&&v.params.volume){for(var y=0,x=i.width-(o-d.length-1)*l.candleWidth,b=0;b<d.length;b++)(c=d[b])&&(y+=c.Volume||1);var S=0;i.segmentImage=[];for(var C=0;C<d.length;C++){c=d[C],i.segmentImage[C]={};var w=null;c?(c.Volume?(c.candleWidth=x*c.Volume/y,w=S+c.candleWidth/2,S+=c.candleWidth):(c.candleWidth=h,w=S+h/2,S+=h),i.segmentImage[C]={tick:c.tick,candleWidth:c.candleWidth,leftOffset:w}):S+=h}}if(t)break}i&&i.isComparison&&this.clearPixelCache(),this.positionCrosshairsAtPointer(),this.runAppend("createDataSegment",arguments)}},e.ChartEngine.prototype.getDataSegment=function(t){t||(t=this.chart);var e=t.dataSegment;if(!e||!e.length)return[];var i=0,a=e.length;return this.pixelFromBar(i,t)<t.panel.left&&i++,this.pixelFromBar(a-1,t)>t.panel.right&&a--,e.slice(i,a)},e.ChartEngine.prototype.setMasterData=function(t,i,a){if(i||(i=this.chart),this.marketFactory){var r=this.marketFactory(i.symbolObject);this.setMarket(r,i)}var n;a||(a={}),a.noCleanupDates||this.doCleanupDates(t,this.layout.interval),i.masterData=t,"chart"==i.name&&(this.masterData=t);var s=null;for(n=0;t&&n<t.length;n++){var o=t[n];null===s&&("number"==typeof o.Close?s="Close":"number"==typeof o.Value&&(s="Value")),"Value"===s&&"number"==typeof o.Value&&(o.Close=o.Value),o.DT?("[object Date]"!=Object.prototype.toString.call(o.DT)&&(o.DT=new Date(o.DT)),o.Date&&17==o.Date.length||(o.Date=e.yyyymmddhhmmssmmm(o.DT))):o.Date?o.DT=e.strToDateTime(o.Date):console.log("setMasterData : Missing DT and Date on masterData object"),o.Volume&&"number"!=typeof o.Volume&&(o.Volume=parseInt(o.Volume,10)),t.length-n<50&&this.updateCurrentMarketData(o,i,null,{fromTrade:!0})}for(n in i.calculateTradingDecimalPlaces&&(i.decimalPlaces=i.calculateTradingDecimalPlaces({stx:this,chart:i,symbol:i.symbolObject.symbol,symbolObject:i.symbolObject})),this.setDisplayDates(t),i.roundit=Math.pow(10,i.decimalPlaces),this.plugins){var l=this.plugins[n];l.display&&l.setMasterData&&l.setMasterData(this,i)}},e.ChartEngine.prototype.setMasterDataRender=function(t,e,i){i||(i=this.chart),i.symbol||(i.symbol=""),this.setMasterData(e,i),e&&(i.endPoints={},e.length&&(i.endPoints={begin:e[0].DT,end:e[e.length-1].DT},i.symbol=t)),this.createDataSet(),this.initializeChart(),this.draw(),e&&e.length||(i.symbol=null,this.clear()),this.adjustPanelPositions()},e.ChartEngine.prototype.getSymbols=function(t){t||(t={});var i,a,r,n=[],s=this.layout;function o(t,e,i){return{symbol:t,symbolObject:e,periodicity:i.periodicity,interval:i.interval,timeUnit:i.timeUnit,setSpan:i.setSpan}}for(var l in this.charts){var h=this.charts[l];for(var c in h.symbolObject&&h.symbolObject.symbol&&n.push(o(h.symbol,h.symbolObject,s)),h.series){var u=h.series[c].parameters;u.data&&!u.data.useDefaultQuoteFeed||(r=u.symbolObject,(i=o(a=u.symbol,r,s)).id=c,t["include-parameters"]&&(i.parameters=u),t["exclude-studies"]&&"study"==u.bucket||t["exclude-generated"]&&r.generator||n.push(i))}}if(t["breakout-equations"]){for(var d={},p=0;p<n.length;p++)if(a=n[p].symbol,this.isEquationChart(a)){var f=e.formatEquation(a);if(f)for(var m=f.symbols,g=0;g<m.length;g++)d[m[g]]=o(m[g],n[p].symbolObject,n[p])}else d[a]=o(a,n[p].symbolObject,n[p]);for(var v in n=[],d)n.push(d[v])}return n},e.ChartEngine.prototype.setDisplayDate=function(t){if(!e.ChartEngine.isDailyInterval(this.layout.interval)){var a,r=t.DT,n=1e3*r.getSeconds()+r.getMilliseconds();i.Date&&this.displayZone&&(a=new i.Date(r.getTime(),this.displayZone),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()),r=new Date(r.getTime()+n)),t.displayDate=r}},e.ChartEngine.prototype.setDisplayDates=function(t){if(t&&!e.ChartEngine.isDailyInterval(this.layout.interval))for(var i=0;i<t.length;i++){var a=t[i];a.DT&&this.setDisplayDate(a)}},e.ChartEngine.prototype.setTimeZone=function(t,e){if(i.Date){var a=new Date,r=a.getTimezoneOffset(),n=r,s=r;for(var o in t&&(this.dataZone=t),this.dataZone&&(n=new i.Date(a,this.dataZone).getTimezoneOffset()),e&&(this.displayZone=e),this.displayZone&&(s=new i.Date(a,this.displayZone).getTimezoneOffset()),this.timeZoneOffset=n-r-(s-r),this.charts){var l=this.charts[o];this.setDisplayDates(l.masterData)}this.preferences.timeZone=e,this.changeOccurred("preferences"),this.createDataSet()}else this.timeZoneOffset=0},e.ChartEngine.prototype.updateChartData=function(t,i,a){a||(a={}),i||(i=this.chart);var r,n,s=!1,o=!1,l=i.masterData,h=this.layout,c=(this.dataZone,this),u=a.secondarySeries,d=e.isValidNumber;function p(){if(e.Market&&i.market){var r={market_tz:e.getFromNS(i,"market.market_def.market_tz",null)},n=h.interval;"month"!=n&&"week"!=n||(c.dontRoll||(n="day"),r=c.chart.market.market_def);var s,o,u=new e.Market(r),d={begin:l&&l.length?l[l.length-1].DT:t.DT,interval:n,periodicity:1,timeUnit:h.timeUnit},p=u.newIterator(d),f=p.next();if(l){if(t.DT<f){s=0;var m=p.previous();for(o=t.DT,a.appending=!0;o<m&&s<1e3;)a.appending=!1,m=p.previous(),s++;t.DT=m,a.updating=!a.appending}else if(t.DT>=f){for(s=0,o=t.DT;o>f&&s<1e3;)t.DT=f,f=p.next(),s++;a.appending=!0}}else t.DT=new Date(+p.previous())}}function f(){if(s=!0,a.useAsLastSale&&a.useAsLastSale.aggregatedVolume&&(o=!0),t.constructor===Array){var e=t[t.length-1];(t={}).DT=e.DT,t.Close=e.Close,t.Volume=e.Volume}else t.Last&&(t.Close=t.Last,delete t.Last);t.DT&&"[object Date]"!=Object.prototype.toString.call(t.DT)&&(t.DT=new Date(t.DT)),t.DT&&"Invalid Date"!=t.DT||(t.DT=new Date),"tick"!=h.interval&&p(),t.Open=t.Close,t.High=t.Close,t.Low=t.Close}function m(){var e=null,a=0;if(l.length&&(e=c.getFirstLastDataRecord(l,u||i.defaultPlotField,!0))){if(t[t.length-1].DT<=e.DT)return;for(;a<t.length;a++){if(+t[a].DT==+e.DT){c.getFirstLastDataRecord([t[a]],u||i.defaultPlotField)&&(e=null);break}if(t[a].DT>e.DT)break}}var r=t.slice(a);e&&r.unshift(u?e[u]:e),r=c.doCleanupGaps(r,i),e&&r.shift(),t=t.slice(0,a).concat(r)}function g(t,e){var a;if(u)delete l[t][u],c.cleanupGaps&&(a={DT:e,Close:null},"gap"!=c.cleanupGaps&&l[t-1]&&l[t-1][u]&&(a.Close=l[t-1][u].Close,a.High=a.Low=a.Open=a.Close,a.Volume=0),l[t][u]=a);else{var s=l.splice(t,1)[0];for(r in a={DT:s.DT,Close:null,needed:!1},i.series)void 0!==s[n=i.series[r].parameters.symbolObject.symbol]&&(a[n]=s[n],delete a.needed);c.cleanupGaps&&"gap"!=c.cleanupGaps&&(delete a.needed,"gap"!=c.cleanupGaps&&l[t-1]&&(a.Close=l[t-1].Close,a.High=a.Low=a.Open=a.Close,a.Volume=0)),!1!==a.needed&&(l.splice(t,0,a),c.setDisplayDate(a))}}function v(t,e){var h=l[t];if(u&&(h=h[u]||{}),null===e.Close)void 0!==h.Open&&(e.Open=null),void 0!==h.High&&(e.High=null),void 0!==h.Low&&(e.Low=null),void 0!==h.Volume&&(e.Volume=null);else for(r in s?(e.Volume&&(e.Volume=parseInt(e.Volume,10)),o||(e.Volume+=h.Volume)):!d(e.Volume)&&h.Volume&&(e.Volume=h.Volume),a.allowReplaceOHL||(d(h.Open)&&(e.Open=h.Open),d(h.High)&&d(e.High)&&h.High>e.High&&(e.High=h.High),d(h.Low)&&d(e.Low)&&h.Low<e.Low&&(e.Low=h.Low)),["Close","Open","High","Low","Bid","Ask"].forEach((function(t){d(e[t])||(e[t]=h[t])})),i.series)n=i.series[r].parameters.symbolObject.symbol,void 0===e[n]&&void 0!==h[n]&&(e[n]=h[n])}if(a.noCleanupDates||this.doCleanupDates(t,h.interval),(a.useAsLastSale||t.constructor==Object&&(t.Last||0===t.Last))&&f(),t&&t.constructor==Object&&(t=[t]),t&&t.length&&!this.runPrepend("appendMasterData",[t,i,a])&&!this.runPrepend("updateChartData",[t,i,a])){l||(l=[]);var y=l.length-1,x=!1;if(a.fillGaps&&m(),t.length){for(var b=0;b<t.length;b++){var S=t[b],C=S.DT,w=S.Date;for(C&&"[object Date]"!=Object.prototype.toString.call(C)&&(S.DT=C=new Date(C)),C&&(w&&17==w.length||(S.Date=e.yyyymmddhhmmssmmm(S.DT))),C||(C=S.DT=e.strToDateTime(w)),!d(S.Close)&&d(S.Value)&&(S.Close=S.Value);y>=0&&y<l.length;){var k=l[y].DT;if(k||(k=e.strToDateTime(l[y].Date)),k.getTime()<=C.getTime()){x=!0;var D=0;if(k.getTime()<C.getTime()){if(y<l.length-1){var T=l[y+1].DT||e.strToDateTime(l[y+1].Date);if(T.getTime()<=C.getTime()){y++;continue}}D=1}if(a.deleteItems){D||g(y,C);break}if("tick"==h.interval&&!1!==a.firstLoop&&(D=1),D||v(y,S),d(S.Close)){d(S.Open)||(S.Open=S.Close);var A=Math.max(S.Open,S.Close),M=Math.min(S.Open,S.Close);(!d(S.High)||S.High<A)&&(S.High=A),(!d(S.Low)||S.Low>M)&&(S.Low=M)}S.Volume&&!d(S.Volume)&&(S.Volume=parseInt(S.Volume,10)),y+=D,u?(t.length-b<50&&this.updateCurrentMarketData(S,i,u,{fromTrade:!0}),"tick"==h.interval&&void 0===S.Close||(D&&(l.splice(y,0,{DT:S.DT}),this.setDisplayDate(l[y])),l[y][u]=S)):(t.length-b<50&&this.updateCurrentMarketData(S,i,null,{fromTrade:!0}),"tick"==h.interval&&void 0===S.Close||(l.splice(y,D?0:1,S),this.setDisplayDate(S)));break}y+=x?1:-1}y<0&&(u?(this.updateCurrentMarketData(S,i,u,{fromTrade:!0}),"tick"==h.interval&&void 0===S.Close||(l.splice(0,0,{DT:S.DT}),this.setDisplayDate(l[0]),l[0][u]=S)):(this.updateCurrentMarketData(S,i,null,{fromTrade:!0}),"tick"==h.interval&&void 0===S.Close||(l.splice(0,0,S),this.setDisplayDate(S))),x=!0,y=0)}l.length&&(this.masterData=i.masterData=l),this.maxMasterDataSize&&(l=i.masterData=this.masterData=l.slice(-this.maxMasterDataSize));for(var P=u?this.getSeries({symbol:u,chart:i}):[i],F=0;F<P.length;F++){var _=P[F];(!_.endPoints.begin||_.endPoints.begin>t[0].DT)&&(_.endPoints.begin=t[0].DT),(!_.endPoints.end||_.endPoints.end<t[t.length-1].DT)&&(_.endPoints.end=t[t.length-1].DT);var E=_.parameters&&_.parameters.field||i.defaultPlotField,L=this.getFirstLastDataRecord(t,E,!0);L&&(!_.lastQuote||_.lastQuote.DT<=L.DT)&&(_.lastQuote=L),u&&a.deleteItems&&(_.lastQuote=this.getFirstLastDataRecord(l,u,!0)[u])}for(var I in this.plugins){var O=this.plugins[I];O.display&&O.appendMasterData&&O.appendMasterData(this,t,i)}if(this.masterData&&this.masterData.length||(this.masterData=l),!a.noCreateDataSet){var N=this.streamParameters;++N.count>N.maxTicks||a.bypassGovernor?(clearTimeout(N.timeout),H()):-1==N.timeout&&(N.timeout=setTimeout(H,N.maxWait))}this.runAppend("appendMasterData",arguments),this.runAppend("updateChartData",arguments)}}function H(){c.createDataSet(null,null,a),c.draw(),c.updateChartAccessories(),c.streamParameters.count=0,c.streamParameters.timeout=-1}},e.ChartEngine.prototype.updateCurrentMarketData=function(t,i,a,r){if(t&&t.DT){i||(i=this.chart);var n=r&&r.fromTrade,s=t.DT;if(!n&&"tick"!=this.layout.interval&&i.market){if(i.market.market_def){if(!i.market.isMarketDate(t.DT))return;if(!e.ChartEngine.isDailyInterval(this.layout.interval)&&null===i.market.getSession(t.DT))return}var o={begin:t.DT,interval:this.layout.interval,periodicity:this.layout.periodicity,timeUnit:this.layout.timeUnit},l=new e.Market(i.market.market_def);this.extendedHours&&this.extendedHours.filter&&l.enableAllAvailableSessions();var h=l.newIterator(o);h.next(),t.DT=h.previous()}if(!this.runPrepend("updateCurrentMarketData",arguments)){var c=i.currentMarketData;if(a&&(c[a]||(c[a]={}),c=c[a]),["Last","Bid","Ask"].forEach((function(e){t[e]&&"number"==typeof t[e]&&(!c[e]||!c[e].DT||c[e].DT<=t.DT)&&(c[e]={DT:t.DT,Price:t[e],Size:t[e+"Size"],Timestamp:s})})),["BidL2","AskL2"].forEach((function(e){t[e]&&t[e]instanceof Array&&(!c[e]||!c[e].DT||c[e].DT<=t.DT)&&(c[e]={DT:t.DT,Price_Size:t[e],Timestamp:s})})),t.Close&&(!c.Last||c.Last.DT<=t.DT)){var u=t.Close,d=r&&r.finalClose;(d||0===d)&&(u=d),c.Last={DT:t.DT,Price:u,Size:void 0===t.LastSize&&"tick"==this.layout.interval?t.Volume:t.LastSize,Timestamp:t.LastTime||s}}c.touched=new Date,n||delete t.Last,this.runAppend("updateCurrentMarketData",arguments)}}},e.ChartEngine.prototype.clearCurrentMarketData=function(t,e){if(!this.runPrepend("clearCurrentMarketData",arguments)){var i,a=[];if(t)a.push(t);else for(i in this.charts)a.push(this.charts[i]);for(i=0;i<a.length;i++){var r=a[i].currentMarketData;if(e)delete r[e];else for(var n in r)r[n]=void 0}this.runAppend("clearCurrentMarketData",arguments)}}}(k),function(t){var e=t.CIQ;e.ChartEngine.prototype.changeOccurred=function(t){var e={stx:this,symbol:this.chart.symbol,symbolObject:this.chart.symbolObject,layout:this.layout,drawings:this.drawingObjects};"theme"==t&&this.dispatch("theme",e),this.currentlyImporting||("layout"==t?this.dispatch("layout",e):"vector"==t?this.dispatch("drawing",e):"preferences"==t&&this.dispatch("preferences",e))},e.ChartEngine.prototype.startAsyncAction=function(){this.pendingAsyncs||(this.pendingAsyncs=[]),this.pendingAsyncs.push(!0)},e.ChartEngine.prototype.registerChartDrawnCallback=function(t){return this.asyncCallbacks||(this.asyncCallbacks=[]),this.asyncCallbacks.push(t),{fc:t}},e.ChartEngine.prototype.unregisterChartDrawnCallback=function(t){for(var e=0;e<this.asyncCallbacks.length;e++)if(this.asyncCallbacks[e]==t.fc)return void this.asyncCallbacks.splice(e,1)},e.ChartEngine.prototype.makeAsyncCallbacks=function(){if(this.asyncCallbacks&&(!this.pendingAsyncs||!this.pendingAsyncs.length))for(var t=0;t<this.asyncCallbacks.length;t++)this.asyncCallbacks[t]()},e.ChartEngine.prototype.completeAsyncAction=function(){this.pendingAsyncs.pop(),this.makeAsyncCallbacks()},e.ChartEngine.prototype.addDomEventListener=function(t,e,i,a){t.addEventListener(e,i,a),this.eventListeners.push({element:t,event:e,function:i,options:a})},e.ChartEngine.prototype.addEventListener=function(t,e){if("*"===t)for(var i in this.callbackListeners)this.callbackListeners[i].push(e);else if(t instanceof Array)for(var a=0;a<t.length;a++)this.callbackListeners[t[a]].push(e);else{var r=this.callbackListeners[t];if(!r)throw new Error("Attempted to add an invalid listener.");r.push(e)}return{type:t,cb:e}},e.ChartEngine.prototype.removeEventListener=function(t,e){t&&"object"==a(t)||(t={type:t,cb:e});var i=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return void t.splice(i,1)},r=this.callbackListeners;if("*"!==t.type){if(!r[t.type])throw new Error("Attempted to remove an invalid listener.");i(r[t.type],t.cb)}else for(var n in r)i(r[n],t.cb)},e.ChartEngine.prototype.dispatch=function(t,e){var i=this.callbackListeners[t];if(i)for(var a=0;a<i.length;a++)if(!0===i[a].call(this,e))return!0;if(i=this.callbackListeners["*"])for(var r=0;r<i.length;r++)if(!0===i[r].call(this,e))return!0;return!1},e.ChartEngine.prototype.updateListeners=function(t){for(var e in this.plugins){var i=this.plugins[e];i.display&&i.listener&&i.listener(this,t)}}}(k),function(t){var e=t.CIQ;e.ChartEngine.prototype.prepend=function(t,i){var a,r="prepend"+t;return this instanceof e.ChartEngine?(a=this.hasOwnProperty(r)?this[r]:[],this[r]=[i].concat(a)):(a=e.ChartEngine.prototype[r]||[],e.ChartEngine.prototype[r]=[i].concat(a)),{method:r,func:i}},e.ChartEngine.prototype.append=function(t,i){var a,r="append"+t;return this instanceof e.ChartEngine?(a=this.hasOwnProperty(r)?this[r]:[],this[r]=a.concat(i)):(a=e.ChartEngine.prototype[r]||[],e.ChartEngine.prototype[r]=a.concat(i)),{method:r,func:i}},e.ChartEngine.prototype.runPrepend=function(t,i,a){var r="prepend"+t,n=this.hasOwnProperty(r)?this[r]:[];if(!(n=n.concat(e.ChartEngine.prototype[r]||[])).length)return!1;a||(a=this);for(var s=0;s<n.length;s++){var o=n[s].apply(a,i);if(o)return o}return!1},e.ChartEngine.prototype.runAppend=function(t,i,a){var r="append"+t,n=this.hasOwnProperty(r)?this[r]:[];if(!(n=n.concat(e.ChartEngine.prototype[r]||[])).length)return!1;a||(a=this);for(var s=0;s<n.length;s++){var o=n[s].apply(a,i);if(o)return o}return!1},e.ChartEngine.prototype.removeInjection=function(t){var i,a=t.method;if(this instanceof e.ChartEngine){if(!this[a])return;for(i=0;i<this[a].length;i++)if(this[a][i]==t.func)return void this[a].splice(i,1)}else{if(!e.ChartEngine.prototype[a])return;for(i=0;i<e.ChartEngine.prototype[a].length;i++)if(e.ChartEngine.prototype[a][i]==t.func)return void e.ChartEngine.prototype[a].splice(i,1)}},e.ChartEngine.prototype.remove=function(t){this instanceof e.ChartEngine?(delete this["append"+t],delete this["prepend"+t]):(delete e.ChartEngine.prototype["append"+t],delete e.ChartEngine.prototype["prepend"+t])}}(k),function(t){var e=t.CIQ,i=t.timezoneJS;e.ChartEngine.prototype.convertToDataZone=function(t){if((t||0===t)&&this.dataZone){var i=e.convertTimeZone(t,null,this.dataZone);t=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())}return t},e.ChartEngine.prototype.debug=function(){},e.ChartEngine.prototype.fps=function(t,i){t=t||5;var a=(new Date).getTime(),r=0,n=this;console.log("Running fps() for "+t+" seconds"),function s(){var o=((new Date).getTime()-a)/1e3;if(o>t){var l=r/o;return console.log("FPS="+l),void(i&&i(l))}n.draw(),r++,e.ChartEngine.useAnimation?requestAnimationFrame(s):setTimeout(s,0)}()},e.ChartEngine.htmlControls={mSticky:'<div class="stx_sticky"> <span class="mStickyInterior"></span></div>',iconsTemplate:'<div class="stx-panel-control"><div class="stx-panel-title"></div><div class="stx-panel-legend"></div></div>'},e.ChartEngine.prototype.setChartType=function(t){var e=this.layout,i=this.chart;"ohlc"!=e.aggregationType&&(e.aggregationType="ohlc",i.canvas&&this.createDataSet()),e.chartType=t,this.setMainSeriesRenderer(),i.defaultChartStyleConfig={type:t},this.displayInitialized&&this.draw(),this.changeOccurred("layout")},e.ChartEngine.prototype.setChartScale=function(t){t||(t="linear");this.layout.chartScale=t,this.chart.canvas&&this.draw(),this.changeOccurred("layout")},e.ChartEngine.prototype.setAdjusted=function(t){this.layout.adj=t,this.chart.canvas&&(this.createDataSet(),this.draw()),this.changeOccurred("layout")},e.ChartEngine.prototype.padOutPrice=function(t,e){if(0!==t&&(!t||"number"!=typeof t))return"";e||0===e||(e=t);var i=""+e,a=0;i.indexOf(".")>-1&&(a=i.substring(i.indexOf(".")).length-1),a=e>=1e3?Math.max(a,0):e<2?Math.max(a,4):Math.max(a,2);var r=this.internationalizer;if(r){var n=r.priceFormatters.length;a>=n&&(a=n-1),t=r.priceFormatters[a].format(t)}else t=t.toFixed(a);return t},e.ChartEngine.prototype.formatPrice=function(t,e){if(0!==t&&(!t||void 0===t))return"";if(e||(e=this.currentPanel),e||(e=this.chart.panel),!e)return t.toString();var i=e.decimalPlaces;if(i||0===i||(i=e.chart.decimalPlaces),!i&&0!==i)return t.toString();var a=this.internationalizer;if(a){var r=a.priceFormatters.length;i>=r&&(i=r-1),t=a.priceFormatters[i].format(t)}else t=t.toFixed(i);return t},e.ChartEngine.prototype.determineMinMax=function(t,i,a,r,n,s,o,l,h){var c=-1*Number.MAX_VALUE,u=Number.MAX_VALUE,d=!1,p=t.length;h||(h=[]);var f=[];n&&(p=n);for(var m=0;m<=p+1;m++){var g;if(i.length&&(g=m==p?this.getPreviousBar(this.chart,i[0],0):m==p+1?this.getNextBar(this.chart,i[0],p-1):t[m]),g){if(!r)if(g.transform)d=!0,g=g.transform;else if(d)continue;for(var v=0,y=0;y<i.length;y++){var x=e.existsInObjectChain(g,i[y]);if(x){var b=x.obj[x.member];"number"==typeof b&&(b=[b]);for(var S=0;S<b.length;S++){var C=b[S];s&&C instanceof Array&&(C=C[0]),(C||0===C)&&(!0===a||a instanceof Array&&a.indexOf(i[y])>-1?((v+=C)>c&&(c=v),v<u&&(u=v)):(C>c&&(c=C),C<u&&(u=C),f.push({value:C,quote:g})))}}}(!0===a||a instanceof Array&&a.indexOf(i[y])>-1)&&f.push({value:v,quote:g})}}var w=[u,c];return h.forEach((function(t){w=t(f,o,l)||w})),w[1]==-1*Number.MAX_VALUE&&(w[1]=0),w[0]==Number.MAX_VALUE&&(w[0]=0),w},e.ChartEngine.prototype.initializeDisplay=function(t){if(!this.runPrepend("initializeDisplay",arguments)){var i,a=[],r=[],n=!1,s=this,o=["Close","Open","High","Low"],l=[t.defaultPlotField||"Close"],h=null,c=Math.floor((t.width-this.micropixels)/this.layout.candleWidth);t.scroll>t.maxTicks&&t.maxTicks>c+1&&(h=t.dataSegment.length-1);var u=[];for(var d in this.panels){var p=this.panels[d];u=p.yaxisLHS.concat(p.yaxisRHS);for(var f=0;f<u.length;f++){var m=u[f];a=[],r=[];var g=t.transformFunc&&m==t.panel.yAxis;if(S(m,p),this.currentlyImporting||m.renderers.length||m.studies.length){if(i=this.mainSeriesRenderer&&this.mainSeriesRenderer.determineMax?this.mainSeriesRenderer.determineMax(t.dataSegment,a,r,!g,h,n,p,m):this.determineMinMax(t.dataSegment,a,r,!g,h,n,p,m),this.mainSeriesRenderer&&t.yAxis==m&&!this.mainSeriesRenderer.highLowBars){var v=this.mainSeriesRenderer||{};if(t.panel==p&&v.params&&v.params.baseline&&"mountain"!=v.params.type){var y=t.baseline.actualLevel;if(y||0===y){g&&(y=t.transformFunc(this,t,y));var x=Math.max(y-i[0],i[1]-y);this.repositioningBaseline?i=[t.lowValue,t.highValue]:(i[0]=y-x,i[1]=y+x)}}}m.lowValue=i[0],m.highValue=i[1],m==t.panel.yAxis&&(t.lowValue=m.lowValue,t.highValue=m.highValue)}else this.deleteYAxisIfUnused(p,m)}}var b=t.state.aggregation;b&&b.box&&(t.lowValue-=b.box/2,t.highValue+=b.box/2),this.runAppend("initializeDisplay",arguments)}function S(i,h){var c=!1,u=s.layout&&s.layout.studies&&s.layout.studies[i.name];if(u&&(!h||h.name==u.panel)){for(var d in u.outputMap)a.push(d);u.study&&(u.study.renderer?a=a.concat(e.createObjectChainNames(d,o)):u.study.seriesFN||(a=a.concat(e.createObjectChainNames(d,l))));for(var p=0;p<=2;p++)a.push(u.name+"_hist"+(p||""));c=!0}if(h){for(var f in i.studies=[],i.renderers=[],c&&i.studies.push(i.name),t.seriesRenderers){var m=t.seriesRenderers[f],g=m.params,v=g.panel;if((g.yAxis||!s.panels[v]||s.panels[v].yAxis)==i&&v==h.name){var y=m.highLowBars?o:l;n=m.bounded;for(var x=0;x<m.seriesParams.length;x++){var b,C=m.seriesParams[x];if(!C.hidden)C.subField?b=e.createObjectChainNames(C.symbol,[C.subField]).concat(C.symbol):C.symbol?b=e.createObjectChainNames(C.symbol,y).concat(C.symbol):C.field?b=C.field:i==t.panel.yAxis&&(b=y),a=a.concat(b),m.useSum&&(r=r.concat(b))}i.renderers.push(f)}}for(var w in s.overlays){var k=s.overlays[w];if(k.panel==h.name)if(k.name!=i.name)k.getYAxis(s)==i&&(i.studies.push(k.name),t.includeOverlaysInMinMax&&S({name:k.name}))}}}},e.ChartEngine.prototype.setMarket=function(t,i){if(e.Market)for(var a in i||(i=this.chart),i.market=new e.Market(t),this.layout.marketSessions)i.market.disableSession(a,this.layout.marketSessions[a])},e.ChartEngine.prototype.setMarketFactory=function(t){this.marketFactory=t},e.ChartEngine.prototype.setResizeTimer=function(t){var i,a;this.resizeDetectMS=t,this.resizeHandle=e.resizeObserver(this.chart.container,(i=this,a=function(){i.chart.canvas&&(e.isAndroid||i.chart.canvas.height==Math.floor(i.devicePixelRatio*i.chart.container.clientHeight)&&i.chart.canvas.width==Math.floor(i.devicePixelRatio*i.chart.container.clientWidth)||i.resizeChart())},function(){"undefined"!=typeof ResizeObserver?e.ChartEngine.useAnimation?requestAnimationFrame(a):setTimeout(a,0):a()}),this.resizeHandle,t)},e.ChartEngine.prototype.getRenderedItems=function(){var t=this.chart,i=this.currentPanel;if(i){var a=["Open","High","Low","Close"],r=["Close"],n=[];for(var s in this.overlays)this.overlays[s].panel===i.name&&(n=n.concat(Object.keys(this.overlays[s].outputMap)));for(var o in t.seriesRenderers){var l=t.seriesRenderers[o];if(l.params.panel==i.name)for(var h in l.seriesParams){var c=l.seriesParams[h],u=l.highLowBars?a:r;c.subField?n=n.concat(e.createObjectChainNames(c.symbol,[c.subField])).concat(c.symbol):c.symbol?n=n.concat(e.createObjectChainNames(c.symbol,u)).concat(c.symbol):c.field?n.push(c.field):i==t.panel&&(n=n.concat(u))}}return n}},e.ChartEngine.prototype.setTransform=function(t,e,i){t.transformFunc=e,t.untransformFunc=i},e.ChartEngine.prototype.unsetTransform=function(t){delete t.transformFunc,delete t.untransformFunc;for(var e=0;t.dataSet&&e<t.dataSet.length;e++)t.dataSet[e].transform=null},e.ChartEngine.prototype.isEquationChart=function(t){return!(!t||"="!=t[0])&&(!(!this.allowEquations||!e.fetchEquationChart)||(console.warn("Error, equation chart option requires equationsAdvanced.js"),!1))},e.ChartEngine.prototype.correctIfOffEdge=function(t){if(!this.runPrepend("correctIfOffEdge",arguments)){for(var e in this.charts){var i=this.charts[e],a=i.dataSet,r=i.maxTicks,n=this.layout,s=this.minimumLeftBars,o=Math.min(s,r);if(i.allowScrollPast){var l=r-o;o>a.length&&(l=r-a.length),i.scroll-l>=a.length&&(i.scroll=a.length+l-1,this.micropixels=0),i.scroll<=o&&(i.scroll=o,this.micropixels=0)}else i.scroll<o&&(i.scroll=o),i.scroll>a.length&&(i.scroll=a.length);if(!1===i.allowScrollFuture){var h=this.getLabelOffsetInPixels(i,n.chartType)+n.candleWidth*i.whiteSpaceFutureTicks,c=r-Math.round(h/n.candleWidth)-1,u=this.micropixels<0?i.scroll-1:i.scroll;u<c&&(i.scroll=c,this.micropixels=0)}}this.runAppend("correctIfOffEdge",arguments)}},e.ChartEngine.prototype.getStartDateOffset=function(){for(var t=0;t<this.chart.dataSegment.length;t++)if(this.chart.dataSegment[t])return t;return 0},e.ChartEngine.prototype.setStartDate=function(t){for(var e=0;e<this.chart.dataSet.length;e++){if(this.chart.dataSet[e].DT.getTime()==t.getTime())return this.chart.scroll=this.chart.dataSet.length-e,void this.draw()}},e.ChartEngine.prototype.clearPixelCache=function(){for(var t in this.panels){var e=this.panels[t];e.cacheHigh=null,e.cacheLow=null,e.cacheLeft=1e6,e.cacheRight=-1}for(var i in this.charts){var a=this.charts[i];if(a.dataSet)for(var r=0;r<a.dataSet.length;r++)a.dataSet[r].cache={}}},e.ChartEngine.prototype.adjustBackingStore=function(t,i){this.devicePixelRatio=window.devicePixelRatio||1,this.devicePixelRatio<1&&(this.devicePixelRatio=1);var a=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1,r=this.devicePixelRatio/a;if(this.useBackingStore){if(!e.isAndroid||e.is_chrome||e.isFF){var n=t.width,s=t.height;t.width=n*r,t.height=s*r,t.style.width=n+"px",t.style.height=s+"px",i.scale(r,r),this.adjustedDisplayPixelRatio=r,this.backing={ratio:r,width:t.width,height:t.height,styleWidth:n,styleHeight:s}}}else this.devicePixelRatio=this.adjustedDisplayPixelRatio=1},e.ChartEngine.prototype.reconstituteBackingStore=function(){if(this.useBackingStore){var t=[this.chart.canvas];this.useBackgroundCanvas&&t.push(this.chart.backgroundCanvas);var e=this.backing;t.forEach((function(t){t.width!=e.width&&(t.width=e.width,t.height=e.height,t.context.scale(e.ratio,e.ratio))})),this.adjustedDisplayPixelRatio=e.ratio,this.draw()}},e.ChartEngine.prototype.disableBackingStore=function(){if(this.useBackingStore){var t=[this.chart.canvas];this.useBackgroundCanvas&&t.push(this.chart.backgroundCanvas);var e=this.backing;t.forEach((function(t){t.width!=e.styleWidth&&(t.width=e.styleWidth,t.height=e.styleHeight,t.context.scale(1,1))})),this.adjustedDisplayPixelRatio=1,this.draw()}},e.ChartEngine.prototype.getBackgroundCanvas=function(t){return t||(t=this.chart),this.useBackgroundCanvas?t.backgroundCanvas:t.canvas},e.ChartEngine.prototype.resizeCanvas=function(){var t=this.chart.canvas,e=this.chart.context;t&&e&&(this.floatCanvas.height=this.chart.tempCanvas.height=this.chart.backgroundCanvas.height=t.height=this.chart.container.clientHeight,this.floatCanvas.width=this.chart.tempCanvas.width=this.chart.backgroundCanvas.width=t.width=this.chart.container.clientWidth,this.adjustBackingStore(t,e),this.adjustBackingStore(this.chart.tempCanvas,this.chart.tempCanvas.context),this.adjustBackingStore(this.floatCanvas,this.floatCanvas.context),this.adjustBackingStore(this.chart.backgroundCanvas,this.chart.backgroundCanvas.context));var i=this.container.getBoundingClientRect();this.top=i.top,this.left=i.left,this.canvasWidth=this.chart.canvasWidth=this.chart.container.clientWidth,this.right=this.left+this.canvasWidth,this.height=this.chart.container.clientHeight,this.width=this.right-this.left,0!==this.width||this.container.dimensionlessCanvas||console.log("warning: zero width chart. Check CSS for chart container."),this.bottom=this.top+this.height,this.calculateYAxisPositions(),this.chart.canvasRight=this.right,this.chart.canvasHeight=this.height;var a=this.layout.candleWidth;for(var r in void 0===a&&(a=8),this.charts){var n=this.charts[r];if(this.setCandleWidth(a,n),n.scroll<n.width/a){n.scroll=Math.floor(n.width/a);var s=Math.round(this.preferences.whitespace/this.layout.candleWidth);n.scroll-=s}var o,l=10;try{o=2*e.measureText("10:00").width}catch(t){o=100}for(;l>1&&!(this.chart.width/o>l);)l/=1.5;n.xAxis.autoComputedTickSizePixels=Math.round(this.chart.width/l),n.xAxis.autoComputedTickSizePixels<1&&(n.xAxis.autoComputedTickSizePixels=1)}},e.ChartEngine.prototype.setCandleWidth=function(t,e){e||(e=this.chart),t=this.constrainCandleWidth(t),this.layout.candleWidth=t,e.maxTicks=Math.round(e.width/t)+1},e.ChartEngine.prototype.constrainCandleWidth=function(t){var e=this.minimumCandleWidth,i=this.maximumCandleWidth,a=this.animations.zoom;return e&&t<e&&(t=e,a&&a.running&&a.stop()),i&&t>i&&(t=i,a&&a.running&&a.stop()),t},e.ChartEngine.prototype.resizeChart=function(t){if(!this.runPrepend("resizeChart",arguments)){!1!==t&&(t=!0),t&&this.preAdjustScroll();var e=this.chart.canvasHeight;this.resizeCanvas(),t&&this.postAdjustScroll(),(this.displayInitialized||0!==this.chart.canvasHeight&&0===e)&&(this.adjustPanelPositions(),this.draw()),this.doDisplayCrosshairs(),this.updateChartAccessories(),this.runAppend("resizeChart",arguments)}},e.ChartEngine.prototype.clear=function(){for(var t in this.displayInitialized=!1,this.layout.studies){var i=this.layout.studies[t];e.getFn("Studies.removeStudy")(this,i)}this.controls.chartControls&&(this.controls.chartControls.style.display="none"),this.chart.panel.title.innerHTML="",this.chart.panel.title.appendChild(document.createTextNode(this.chart.panel.display))},e.ChartEngine.prototype.fillScreen=function(){var t=this.chart,e=this.layout.candleWidth,i=t.width-this.preferences.whitespace,a=t.dataSet.length;if(a*e>=i)this.draw();else{this.mainSeriesRenderer&&this.mainSeriesRenderer.standaloneBars||a--;var r=i/a;this.setCandleWidth(r,t),this.home({maintainWhitespace:!0})}},e.ChartEngine.prototype.setMaxTicks=function(t,e){e||(e={}),(t=Math.round(t))<2&&(t=2);var i=e.padding?e.padding:0;this.layout.candleWidth=(this.chart.width-i)/t,this.layout.candleWidth||(this.layout.candleWidth=8),this.chart.maxTicks=Math.round(this.chart.width/this.layout.candleWidth-.499),(e.padding||0===e.padding)&&(this.chart.scroll=t+1)},e.ChartEngine.prototype.initializeChart=function(t){if(!this.runPrepend("initializeChart",arguments)){var i=this.chart;i.symbolObject.symbol||(i.symbolObject.symbol=i.symbol),this.locale&&this.setLocale(this.locale),!this.displayZone&&e.ChartEngine.defaultDisplayTimeZone&&this.setTimeZone(null,e.ChartEngine.defaultDisplayTimeZone),this.resetDynamicYAxis({noRecalculate:!0}),this.calculateYAxisPositions(),this.micropixels=0,t?i.container=t:t=i.container,t.stx=this,t.CIQRegistered||(t.CIQRegistered=!0,e.ChartEngine.registeredContainers.push(t)),this.registerHTMLElements&&this.registerHTMLElements();var a=i.canvas,r=i.backgroundCanvas,n=i.tempCanvas,s=this.floatCanvas,o=i.canvasShim;a&&document.createElement("canvas").getContext?(a.id||(t.removeChild(a),i.canvas=null),n&&!n.id&&(t.removeChild(n),i.tempCanvas=null),s&&!s.id&&(t.removeChild(s),this.floatCanvas=null),r&&!r.id&&(t.removeChild(r),i.backgroundCanvas=null)):this.setCandleWidth(this.layout.candleWidth),i.backgroundCanvas||(r=i.backgroundCanvas=document.createElement("canvas")),t.appendChild(r),w(r),i.canvasShim||(o=i.canvasShim=document.createElement("div")),o.className="stx-canvas-shim",t.appendChild(o),i.canvas||(a=i.canvas=document.createElement("canvas")),t.appendChild(a),w(a),i.context=a.context,i.tempCanvas||(n=i.tempCanvas=document.createElement("canvas")),t.appendChild(n),w(n,!0),this.floatCanvas||(s=this.floatCanvas=document.createElement("canvas")),t.appendChild(s),w(s,!0),this.resizeCanvas(),e.isAndroid&&(n.ontouchstart=s.ontouchstart=function(t){t.preventDefault&&t.preventDefault()});var l=this.panels;for(var h in i.panel.display=i.symbol,i.symbolDisplay&&(i.panel.display=i.symbolDisplay),this.adjustPanelPositions(),i.panel=l[i.name],l)for(var c=l[h].yaxisLHS.concat(l[h].yaxisRHS),u=0;u<c.length;u++)c[u].height=l[h].yAxis.height,this.calculateYAxisMargins(c[u]);if(this.initialWhitespace=this.preferences.whitespace,i.dataSet&&i.dataSet.length>0){i.scroll=Math.floor(i.width/this.layout.candleWidth);var d=Math.round(this.preferences.whitespace/this.layout.candleWidth);i.scroll-=d}if(e.touchDevice){var p=t.querySelector(".overlayEdit"),f=t.querySelector(".overlayTrashCan"),m=t.querySelector(".vectorTrashCan"),g=function(t,e,i){return function(a){t.deleteHighlighted(e,i)}};p?(e.safeClickTouch(p,g(this,!0,!0)),f&&e.safeClickTouch(f,g(this,!1))):f&&e.safeClickTouch(f,g(this,!0)),m&&e.safeClickTouch(m,g(this,!0))}for(var v in this.manageTouchAndMouse&&this.registerTouchAndMouseEvents(),this.handleMouseOut&&(t.onmouseout=function(t){return function(e){t.handleMouseOut(e)}}(this),e.smartHover()),this.abortDrawings&&this.abortDrawings(),this.undoStamps=[],l){var y=l[v];y.markerHolder&&(t.removeChild(y.markerHolder),y.markerHolder=null)}for(var x in this.plugins){var b=this.plugins[x];b.display&&b.initializeChart&&b.initializeChart(this)}if(!this.resizeListenerInitialized){var S=this;this.resizeListenerInitialized=!0;var C=function(){return function(t){S.resizeChart()}};this.addDomEventListener(window,"resize",C(),!0)}i.baseline.userLevel&&(i.baseline.userLevel=null),this.setResizeTimer(this.resizeDetectMS),this.runAppend("initializeChart",arguments)}function w(t,e){t.context=t.getContext("2d"),t.context.lineWidth=1;var i=t.style;i.position="absolute",i.left="0px",e&&(i.display="none")}},e.ChartEngine.prototype.destroy=function(){this.setResizeTimer(0),this.quoteDriver&&this.quoteDriver.die(),this.styles={};for(var t=0;t<this.eventListeners.length;t++){var i=this.eventListeners[t];i.element.removeEventListener(i.event,i.function,i.options)}this.touchAndMouseEventsRegistered=!1,this.eventListeners=[],this.streamParameters.timeout&&clearTimeout(this.streamParameters.timeout);var a=e.ChartEngine.registeredContainers,r=a.indexOf(this.chart.container);if(r>-1&&a.splice(r,1),this.slider){var n=a.indexOf(this.slider.slider.chart.container);n>-1&&a.splice(n,1)}},e.ChartEngine.prototype.preAdjustScroll=function(t){t||(t=this.chart),this.previousAdjust={chart:t,scroll:t.scroll,maxTicks:t.maxTicks}},e.ChartEngine.prototype.postAdjustScroll=function(){if(this.previousAdjust){var t=this.previousAdjust.chart;t.scroll=this.previousAdjust.scroll+(t.maxTicks-this.previousAdjust.maxTicks),this.displayInitialized&&this.draw()}},e.ChartEngine.prototype.translateIf=function(t){return this.translationCallback?this.translationCallback(t):t},e.ChartEngine.prototype.doCleanupDates=function(t,a){if(t&&t.length)for(var r=0;r<t.length;r++){var n=t[r],s=n.DT;if(s||n.Date){if(n.DT&&"[object String]"==Object.prototype.toString.call(s)&&s.length<=10)(s=new Date(s)).setMinutes(s.getMinutes()+s.getTimezoneOffset());else{var o=!0;if(n.DT||(s=e.strToDateTime(n.Date),n.Date.length<=10&&(o=!1)),"[object Date]"!=Object.prototype.toString.call(s)&&(s=new Date(s)),i.Date&&this.dataZone&&o){var l=new i.Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),this.dataZone),h=1e3*s.getSeconds()+s.getMilliseconds();s=new Date(l.getTime()+h)}e.ChartEngine.isDailyInterval(a)&&s.setHours(0,0,0,0)}n.DT||(n.Date=e.yyyymmddhhmmssmmm(s)),n.DT=s}}},e.ChartEngine.prototype.doCleanupGaps=function(t,i,a){if(!t||!t.length)return t;var r=this.layout.interval;if(a=a||{},i||(i=this.chart),!e.Market||!i.market)return t;a.noCleanupDates||this.doCleanupDates(t,r);var n=a.cleanupGaps;if(!1===n)return t;n&&!0!==n||(n=this.cleanupGaps||n);var s="gap"==n;if(!n)return t;if("tick"==r)return t;if("month"==r||"week"==r){if(this.dontRoll)return t;r="day"}var o=function(t){return t.DT?"[object Date]"!=Object.prototype.toString.call(t.DT)?new Date(t.DT):new Date(+t.DT):e.strToDateTime(t.Date)},l=[],h=t[0];l.push(h);var c={begin:o(h),interval:r,periodicity:1,timeUnit:this.layout.timeUnit},u=new e.Market(i.market.market_def).newIterator(c);this.extendedHours&&this.extendedHours.filter&&u.market.enableAllAvailableSessions();for(var d,p=i.defaultPlotField,f=0;f<t.length&&void 0===t[f][p];f++)if(void 0!==t[f].Value){p="Value";break}function m(t,i){var r=a.field,n=r?h[r]:h;void 0===n&&(n={});for(var o=s?null:n[p],c=s?null:n.Adj_Close;+t<+i;){var d={DT:t};r||(l.push(d),e.extend(d,{Open:o,High:o,Low:o,Close:o,Volume:0,Adj_Close:c})),t=u.next()}}function g(t,i){var r=a.field;if(r)void 0!==t[r]&&void 0===i[r]&&(i[r]=s?null:t[r]);else if(!s){var n=t[p],o=i[p];void 0!==n&&void 0===o&&e.ensureDefaults(i,{Close:n,Open:n,High:n,Low:n,Volume:0,Adj_Close:t.Adj_Close})}}for(var v=1;v<t.length;v++){var y=t[v];d=u.next();var x=o(y);for(m(d,x),d=u.begin;x<d;){if(++v==t.length)return l;g(h,y),l.push(y),h=y,x=o(y=t[v])}d<x?(v--,d=u.previous()):(g(h,y),l.push(y),h=y)}return l},e.ChartEngine.prototype.getCreatingLibrary=function(){return t}}(k),function(t){var e=t.CIQ;e.ChartEngine.Panel=function(t,i){this.yAxis=i||new e.ChartEngine.YAxis,this.name=t,this.state={}},e.extend(e.ChartEngine.Panel.prototype,{name:null,display:null,chart:null,yAxis:null,shareChartXAxis:null,top:null,bottom:null,height:null,percent:null,displayEdgeIfPadded:!0,noDrag:!1,exportable:!0},!0),e.ChartEngine.prototype.whichPanel=function(t){for(var e in this.panels){var i=this.panels[e];if(!i.hidden&&(t>=i.top&&t<i.bottom))return i}return null},e.ChartEngine.prototype.panelExists=function(t){for(var e in this.panels){if(this.panels[e].name==t)return!0}return!1},e.ChartEngine.prototype.storePanels=function(){this.layout||(this.layout={});var t=this.layout;for(var e in t.panels={},this.panels){var i=this.panels[e];t.panels[i.name]={percent:i.percent,display:i.display,yAxis:i.yAxis}}},e.ChartEngine.prototype.savePanels=function(t){this.storePanels(),!1!==t&&this.changeOccurred("layout")},e.ChartEngine.prototype.privateDeletePanel=function(t){for(var e in this.layout.studies){var i=this.layout.studies[e];i.panel==t.name&&this.cleanupRemovedStudy(i)}for(var a in delete this.panels[t.name],this.overlays)this.overlays[a].panel==t.name&&(this.layout.studies&&this.cleanupRemovedStudy(this.layout.studies[a]),delete this.overlays[a]);for(var r in this.chart.series)this.chart.series[r].parameters.panel==t.name&&this.removeSeries(this.chart.series[r],this.chart);if(t.holder&&(this.chart.container.removeChild(t.holder),this.getMarkerArray))for(var n=this.getMarkerArray("panelName",t.name),s=0;s<n.length;s++)this.removeFromHolder(n[s]);t.handle&&t.handle.parentNode.removeChild(t.handle),this.currentPanel=null},e.ChartEngine.prototype.plotsInPanel=function(t){var e=[],i=t;for(var r in"object"==a(t)&&(i=t.name),this.layout.studies){var n=this.layout.studies[r];i===n.panel&&e.push(n)}for(var s in this.chart.seriesRenderers){var o=this.chart.seriesRenderers[s];i===o.params.panel&&e.push(o)}return e},e.ChartEngine.prototype.checkForEmptyPanel=function(t,e,i){if(!t)return!1;var r=t;if("object"==a(t)&&(r=t.name),r===this.chart.name)return!1;i?i instanceof Array||(i=[i]):i=[];for(var n=this.plotsInPanel(t),s=0;s<n.length;s++)if(-1==i.indexOf(n[s]))return!1;return e||this.panelClose(this.panels[r]),!0},e.ChartEngine.prototype.panelClose=function(t){if(t&&!this.runPrepend("panelClose",arguments)){if(this.cancelTouchSingleClick=!0,e.ChartEngine.drawingLine=!1,t.soloing&&this.panelSolo(t),this.charts[t.name]){for(var i in this.panels){var a=this.panels[i];a.chart.name==t.name&&this.privateDeletePanel(a)}delete this.charts[t.name]}else this.privateDeletePanel(t);this.currentlyImporting||(this.showCrosshairs(),this.resetDynamicYAxis({noRecalculate:!0}),this.calculateYAxisPositions(),this.draw(),this.savePanels()),this.userPointerDown=this.grabbingScreen=!1,this.openDialog&&(this.openDialog=""),this.runAppend("panelClose",arguments)}},e.ChartEngine.prototype.deleteAllPanels=function(){for(var t in this.panels){var e=this.panels[t];this.privateDeletePanel(e)}this.layout.panels={},this.panels={}},e.ChartEngine.prototype.panelUp=function(t){this.cancelTouchSingleClick=!0,e.ChartEngine.drawingLine=!1,this.showCrosshairs();var i,a={},r=0;for(i in this.panels){if(i==t.name)break;r++}if(r){var n=0;for(i in this.panels)n==r-1&&(a[t.name]=t),i!=t.name&&(a[i]=this.panels[i],n++);this.panels=a,this.adjustPanelPositions(),this.draw(),this.savePanels()}},e.ChartEngine.prototype.panelDown=function(t){this.cancelTouchSingleClick=!0,e.ChartEngine.drawingLine=!1,this.showCrosshairs();var i,a={},r=0;for(i in this.panels){if(i==t.name)break;r++}var n=0;for(i in this.panels)n++;if(r!=n-1){var s=0;for(i in this.panels)i!=t.name?(a[i]=this.panels[i],s==r+1&&(a[t.name]=t),s++):s++;this.panels=a,this.adjustPanelPositions(),this.draw(),this.savePanels()}},e.ChartEngine.prototype.panelSolo=function(t){this.cancelTouchSingleClick=!0,e.ChartEngine.drawingLine=!1,this.showCrosshairs();var i,a=!0;if(t.soloing){if(a=!1,t.soloing=!1,t.solo.classList.remove("stx_solo_lit"),t.percent=t.oldPercent,"chart"!=t.name)if(this.soloPanelToFullScreen){if(1==t.percent)for(i in this.panels){var r=this.panels[i];r!=t&&(t.percent-=r.percent)}}else this.chart.panel.percent=this.chart.panel.oldPercent;this.soloPanelToFullScreen&&(this.xAxisAsFooter=this.chart.panel.oldXAxisAsFooter)}else t.soloing=!0,t.solo.classList.add("stx_solo_lit"),t.oldPercent=t.percent,this.chart.panel.oldXAxisAsFooter=this.xAxisAsFooter,"chart"!=t.name&&(this.soloPanelToFullScreen?this.xAxisAsFooter=!0:(this.chart.panel.oldPercent=this.chart.panel.percent,t.percent=1-this.chart.panel.percent));for(i in this.panels)this.panels[i].hidden=a;this.soloPanelToFullScreen||(this.chart.panel.hidden=!1),t.hidden=!1,this.resetDynamicYAxis({noRecalculate:!0}),this.calculateYAxisPositions(),this.draw(),this.savePanels()},e.ChartEngine.prototype.calculatePanelPercent=function(t){var e=t.bottom-t.top;t.percent=e/this.chart.canvasHeight},e.ChartEngine.prototype.resizePanels=function(){if(e.ChartEngine.resizingPanel){var t,i,a,r,n=e.ChartEngine.crosshairY>this.resolveY(e.ChartEngine.resizingPanel.top);for(var s in this.panels){if(this.panels[s]==e.ChartEngine.resizingPanel)break;this.panels[s].hidden||(t=this.panels[s])}var o=this.backOutY(e.ChartEngine.crosshairY);if(n)for(a=e.ChartEngine.resizingPanel.yaxisLHS.concat(e.ChartEngine.resizingPanel.yaxisRHS),r=0;r<a.length;r++)i=a[r].initialMarginTop+a[r].initialMarginBottom+10,o>a[r].bottom-i&&(o=a[r].bottom-i);else for(a=t.yaxisLHS.concat(t.yaxisRHS),r=0;r<a.length;r++)i=a[r].initialMarginTop+a[r].initialMarginBottom+10,o<a[r].top+i&&(o=a[r].top+i);e.ChartEngine.crosshairY=this.resolveY(o),t.bottom=o,e.ChartEngine.resizingPanel.top=o,this.calculatePanelPercent(t),this.calculatePanelPercent(e.ChartEngine.resizingPanel),this.adjustPanelPositions(),this.draw(),this.savePanels()}},e.ChartEngine.prototype.isPanelAboveChart=function(t){for(var e in this.panels){if("chart"==e)return!1;if(e==t.name)return!0}return!1},e.ChartEngine.prototype.adjustPanelPositions=function(){var t=this.chart,i=this.panels;if(t.tempCanvas&&e.clearCanvas(t.tempCanvas,this),!this.runPrepend("adjustPanelPositions",arguments)){var a,r,n=0,s=t.canvasHeight,o=!1,l=0,h=0,c=!1;for(a in i)r=i[a],(isNaN(r.percent)||r.percent<=0)&&(r.percent=.05),r.hidden||(l+=r.percent,h++,r.soloing&&(c=!0));for(a in i){var u=0;if((r=i[a]).hidden)r.markerHolder&&(r.markerHolder.style.display="none");else{if(this.manageTouchAndMouse&&(r.up&&(o?this.displayIconsUpDown&&r.up.classList.add("stx-show"):(o=!0,r.up.classList.remove("stx-show"))),r.solo&&(c?r.soloing&&this.displayIconsSolo?r.solo.classList.add("stx-show"):r.solo.classList.remove("stx-show"):1==h?r.solo.classList.remove("stx-show"):2!=h||this.soloPanelToFullScreen?this.displayIconsSolo&&r.solo.classList.add("stx-show"):r.solo.classList.remove("stx-show")),r.down&&(1==h?r.down.classList.remove("stx-show"):this.displayIconsUpDown&&r.down.classList.add("stx-show")),r.edit&&(r.editFunction?r.edit.classList.add("stx-show"):r.edit.classList.remove("stx-show")),r.close&&(this.displayIconsClose?r.close.classList.add("stx-show"):r.close.classList.remove("stx-show"))),r.percent=r.percent/l,r.top=n,r.bottom=r.top+s*r.percent,r.height=r.bottom-r.top,r.chart.name==r.name&&(r.chart.top=r.top,r.chart.bottom=r.bottom,r.chart.height=r.height),n=r.bottom,r.yaxisLHS)for(var d=r.yaxisLHS.concat(r.yaxisRHS),p=0;p<d.length;p++){var f=d[p];f.zoom&&f.height>0&&(u=f.zoom/f.height),this.adjustYAxisHeightOffset(r,f),f.height=f.bottom-f.top,u&&(f.scroll*=u*f.height/f.zoom,f.zoom=u*f.height,f.zoom>f.height&&(f.zoom=0,f.scroll=0)),f.high||0===f.high||(f.high=100,f.low=0,f.shadow=100),f.multiplier=f.height/f.shadow,"none"===f.position&&this.calculateYAxisMargins(f)}r.holder&&(r.holder.style.right="0px",r.holder.style.top=r.top+"px",r.holder.style.left="0px",r.holder.style.height=r.height+"px",r.subholder.style.left=r.left+"px",r.subholder.style.width=r.width+"px",r.subholder.style.top="0px",r.yAxis.height>=0&&(r.subholder.style.height=r.yAxis.height+"px"))}}if(a&&i[a].down&&i[a].down.classList.remove("stx-show"),this.manageTouchAndMouse&&2==h&&!c&&t.panel.solo&&t.panel.solo.classList.add("stx-show"),t.panel){var m;m=c&&this.soloPanelToFullScreen?t.canvasHeight-r.yAxis.bottom+12:t.canvasHeight-t.panel.yAxis.bottom+12;var g=this.controls,v=g.chartControls,y=g.home,x=g.notificationTray,b=this.width-t.panel.right;v&&(v.style.bottom=m+"px"),y&&(y.style.bottom=m+"px",y.style.marginRight=b+"px"),x&&(x.style.bottom=m+"px",x.style.marginRight=b+"px")}this.clearPixelCache(),this.drawingObjects.length&&this.adjustDrawings(),this.runAppend("adjustPanelPositions",arguments)}},e.ChartEngine.prototype.createPanel=function(t,e,i,a,r,n){if(!this.runPrepend("createPanel",arguments)){a||(a="chart");var s=this.chart.canvasHeight;i||(i=.2*s),i>s&&(i=.5*s);var o=i/s,l=1-o,h=!1;for(var c in this.panels){var u=this.panels[c];u.percent*=l,u.soloing&&(h=!0)}return this.stackPanel(t,e,o,a,r),this.panels[e].hidden=h,this.panels[e].exportable=!n,this.adjustPanelPositions(),this.savePanels(!1),this.runAppend("createPanel",arguments),this.panels[e]}},e.ChartEngine.prototype.modifyPanel=function(t,i){var a=t.name,r=this.layout.studies,n=this.chart.series,s=i||{},o=s.name,l=s.display,h=s.yAxis;o||(o=e.uniqueID()),l||(l=o),h||((h=t.yAxis).name=o);var c={};for(var u in this.panels)if(u===t.name){var d=this.panels[u];d.name=o,d.display=l,d.yAxis=h,t=c[o]=d,this.moveMarkers&&a!==o&&this.moveMarkers(a,o)}else c[u]=this.panels[u];this.panels=c;var p=!1;for(var f in r){var m=r[f];m.panel===a&&(m.panel=o,m.parameters&&m.parameters.panelName&&(p=!0,m.parameters.panelName=o))}for(var g in n)if(n[g].parameters.panel===a){p=!0;var v={panel:o};n[g].parameters.yAxis&&n[g].parameters.yAxis.name===a&&(v.yAxis=h),this.modifySeries(g,v,!0)}p&&this.changeOccurred("layout");for(var y=!1,x=0;x<this.drawingObjects.length;x++){var b=this.drawingObjects[x];a===b.panelName&&(b.panelName=o,y=!0)}y&&this.changeOccurred("vector"),this.calculateYAxisPositions()},e.ChartEngine.prototype.setPanelHeight=function(t,e){if(e){Object.values(this.panels).slice(-1)[0]===t&&(e+=this.xaxisHeight);var i=e/this.chart.canvasHeight,a=(1-t.percent)/(1-i);Object.values(this.panels).forEach((function(t){t.percent/=a})),t.percent=i,this.adjustPanelPositions(),this.savePanels()}},e.ChartEngine.prototype.electNewPanelOwner=function(t,i){var a;"string"==typeof t&&(t=this.panels[t]);var r=t.yAxis;if(t&&t!=this.chart.panel){var n=t.yAxis,s=n.studies[0];if(s&&s!=r.name||(s=n.renderers[0]),s&&s!=r.name||(s=n.studies[1]),s||(s=n.renderers[1]),i)n=t.yAxis=i,a=i.name;else if(s)(n=this.addYAxis(t,new e.ChartEngine.YAxis({name:s,position:n.position}))).renderers=t.yAxis.renderers,n.studies=t.yAxis.studies,a=s;else if(t.yaxisLHS){for(var o=t.yaxisRHS.concat(t.yaxisLHS).filter((function(t){return t.name!=r.name})),l=o[0],h=0;h<o.length;h++)if(!o[h].position){l=o[h];break}l&&(n=t.yAxis=l,a=l.studies[0]||l.renderers[0])}if(a){s=a,r.name!=t.name&&(s=t.name);var c,u=this.layout.studies;u&&u[a]&&(c=u[a].inputs.display),this.modifyPanel(t,{name:s,display:c||a,yAxis:n}),this.deleteYAxisIfUnused(t,r),this.calculateYAxisMargins(this.panels[s].yAxis)}else this.checkForEmptyPanel(t)}return a},e.ChartEngine.prototype.configurePanelControls=function(t){var i=t.icons;if(i){var a,r=t.name==t.chart.name;if(i.classList.add("stx-show"),t.title=i.querySelector(".stx-panel-title"),t.up=i.querySelector(".stx-ico-up"),t.up&&(t.up=t.up.parentNode),t.solo=i.querySelector(".stx-ico-focus"),t.solo&&(t.solo=t.solo.parentNode),t.down=i.querySelector(".stx-ico-down"),t.down&&(t.down=t.down.parentNode),t.edit=i.querySelector(".stx-ico-edit"),t.edit&&(t.edit=t.edit.parentNode),t.close=i.querySelector(".stx-ico-close"),t.close&&(t.close=t.close.parentNode),t.title&&(t.title.innerHTML="",t.display&&t.title.appendChild(document.createTextNode(t.display)),r&&(t.title.classList.add("chart-title"),i.classList.add("stx-chart-panel"))),e.touchDevice&&!e.isSurface||this.makeModal(i),t.handle){e.touchDevice&&!e.isSurface||(t.handle.onmouseover=(a=this,function(){a.hideCrosshairs()})),e.touchDevice&&!e.isSurface||(t.handle.onmouseout=function(t){return function(){t.showCrosshairs()}}(this));var n=function(t,i){return function(a){e.ChartEngine.resizingPanel||""!==t.openDialog||t.grabHandle(i)}};e.isSurface?t.handle.onpointerdown=n(this,t):t.handle.onmousedown=n(this,t),e.touchDevice&&(t.handle.ontouchstart=n(this,t))}t.up&&e.safeClickTouch(t.up,function(t,e){return function(){t.panelUp(e)}}(this,t)),t.down&&e.safeClickTouch(t.down,function(t,e){return function(){t.panelDown(e)}}(this,t)),t.solo&&e.safeClickTouch(t.solo,function(t,e){return function(){t.panelSolo(e)}}(this,t)),t.close&&("chart"==t.name?t.close.style.display="none":e.safeClickTouch(t.close,function(t,e){return function(){t.panelClose(e)}}(this,t)))}},e.ChartEngine.prototype.stackPanel=function(t,i,a,r,n){if(!this.runPrepend("stackPanel",arguments)){r||(r="chart");var s=this.charts[r],o=i==r;o&&(t=s.symbol,s.symbolDisplay&&(t=s.symbolDisplay),n||(n=s.yAxis));var l=this.panels[i]=new e.ChartEngine.Panel(i,n);!o&&s.yAxis&&l.yAxis.position==s.yAxis.position&&(l.yAxis.width=s.yAxis.width),o&&!s.panel&&(s.panel=l),l.percent=a,l.chart=s,l.display=t,l.holder=e.newChild(this.container,"div","stx-holder"),l.subholder=e.newChild(l.holder,"div","stx-subholder"),l.subholder.style.zIndex=1,l.holder.panel=l;var h=o?"stx-panel-chart":"stx-panel-study";l.holder.classList.add(h),this.controls.handleTemplate&&this.manageTouchAndMouse&&(l.handle=this.controls.handleTemplate.cloneNode(!0),this.container.appendChild(l.handle),l.handle.panel=l),this.controls.iconsTemplate&&(l.icons=this.controls.iconsTemplate.cloneNode(!0),l.subholder.appendChild(l.icons),this.configurePanelControls(l)),this.currentlyImporting||this.resizeCanvas(),this.runAppend("stackPanel",arguments)}},e.ChartEngine.prototype.setPanelEdit=function(t,i){t.editFunction=i,t.edit&&e.safeClickTouch(t.edit,i),this.adjustPanelPositions()},e.ChartEngine.prototype.drawPanels=function(){if(!this.runPrepend("drawPanels",arguments)){var t=!1;for(var e in this.panels){var i=this.panels[e];i.state={};var a=this.translateIf(i.display);if(i.title&&i.title.textContent!=a&&(i.title.innerHTML="",i.title.appendChild(document.createTextNode(a))),i.icons&&i.icons.classList.add("stx-show"),i.hidden)i.icons&&i.icons.classList.remove("stx-show"),i.handle&&(i.handle.style.display="none"),i.holder.style.display="none";else{if("chart"!=i.name){var r=this.manageTouchAndMouse;i.up&&(i.up.style.display=this.displayIconsUpDown&&r?"":"none"),i.down&&(i.down.style.display=this.displayIconsUpDown&&r?"":"none"),i.solo&&(i.solo.style.display=this.displayIconsSolo&&r?"":"none"),i.close&&(i.close.style.display=this.displayIconsClose&&r?"":"none"),i.edit&&(i.edit.style.display=i.editFunction&&r?"":"none")}if(i.holder.style.display="block",i.displayEdgeIfPadded){var n=Math.round(i.left)+.5,s=i.yAxis.top-.5,o=i.yAxis.bottom+.5;i.yaxisCalculatedPaddingLeft&&!i.yaxisTotalWidthLeft&&this.plotLine(n,n,s,o,this.canvasStyle("stx_grid_border"),"segment",this.chart.context,!1,{lineWidth:1}),n=Math.round(i.right)+.5,i.yaxisCalculatedPaddingRight&&!i.yaxisTotalWidthRight&&this.plotLine(n,n,s,o,this.canvasStyle("stx_grid_border"),"segment",this.chart.context,!1,{lineWidth:1})}if(t){var l=i.top;l=Math.round(l)+.5,this.plotLine(i.left-.5,i.right+.5,l,l,this.canvasStyle("stx_panel_border"),"segment",this.chart.context,!1,{}),i.handle&&(this.displayPanelResize?i.handle.style.display="":i.handle.style.display="none",i.handle.style.top=l-i.handle.offsetHeight/2+"px")}else i.handle&&(i.handle.style.display="none"),t=!0}}this.runAppend("drawPanels",arguments)}}}(k),function(t){var e=t.CIQ;e.ChartEngine.isDailyInterval=function(t){return"day"==t||("week"==t||"month"==t)},e.ChartEngine.prototype.setPeriodicity=function(t,i){if(!this.runPrepend("setPeriodicity",arguments)){var r,n,s=null;t&&"object"==a(t)?(r=t.period,n=t.interval,s=t.timeUnit):(r=t,n=i,i=arguments[arguments.length-1],arguments.length>3&&(s=arguments[2])),"function"!=typeof i&&(i=null);var o=e.cleanPeriodicity(r,n,s);r=o.period,n=o.interval,s=o.timeUnit;var l=this.layout,h=l.candleWidth;l.setSpan={},l.range={},this.chart.inflectionPoint=null;var c=!1;if(this.chart.symbol&&(c=this.needDifferentData({period:r,interval:n,timeUnit:s})),l.periodicity=r,l.interval=n,l.timeUnit=s,c){if(this.changeOccurred("layout"),this.clearCurrentMarketData(),this.quoteDriver)for(var u in this.charts){var d=this.charts[u];d.symbol&&(this.displayInitialized?this.quoteDriver.newChart({symbol:d.symbol,symbolObject:d.symbolObject,chart:d},i):this.loadChart(d.symbol,{chart:d},i))}else this.dataCallback?(this.dataCallback(),i&&i(null)):console.log("cannot change periodicity because neither dataCallback or quoteDriver are set");this.home()}else{var p,f;for(p in this.charts){var m,g=(f=this.charts[p]).dataSegment,v=f.dataSet,y=f.maxTicks,x=f.scroll,b=g?g.length:0,S=v?v.length:0,C=Math.round(f.maxTicks/2);this.setCandleWidth(h,f);var w=!0,k=!1;if(x<=y?w=!1:g&&!g[C]&&(w=!1,k=x-S),w&&b>0&&(y<(Math.round(this.chart.width/h-.499)-1)/2&&(C=b-1),C>=b?(m=g[b-1].DT,C=b-1):m=g[C].DT),this.createDataSet(),w){if(b>0)for(var D=S-1;D>=0;D--){var T=v[D].DT;if(T.getTime()<m.getTime()){f.scroll=S-1-D+C;break}}}else if(k)f.scroll=v.length+k;else{var A=Math.round(this.preferences.whitespace/h);f.scroll=y-A-1}}if(this.displayInitialized&&this.draw(),this.changeOccurred("layout"),this.quoteDriver)for(p in this.charts)!(f=this.charts[p]).symbol||!f.moreAvailable&&f.upToDate||this.quoteDriver.checkLoadMore(f);i&&i(null),this.runAppend("setPeriodicity",arguments)}}},e.ChartEngine.prototype.needDifferentData=function(t){var i=this.layout,a=e.ChartEngine.isDailyInterval(t.interval),r=e.ChartEngine.isDailyInterval(i.interval),n=!1;return this.dontRoll||!r?i.interval!=t.interval&&(n=!0):a!=r&&(n=!0),a||t.timeUnit||(t.timeUnit="minute"),r||i.timeUnit||(i.timeUnit="minute"),t.timeUnit!=i.timeUnit&&(n=!0),this.masterData&&this.masterData.length||(n=!0),n},e.ChartEngine.prototype.getPeriodicity=function(){var t=this.layout,e=t.interval,i=t.timeUnit;return i||(i=e,e=1),{period:t.periodicity,interval:e,timeUnit:i}}}(k),function(t){var e=t.CIQ;e.ChartEngine.prototype.isHistoricalMode=function(){var t=new Date,i=!0,a=this.masterData;if(!this.isHistoricalModeSet)return!1;if(a.length){var r=this.getFirstLastDataRecord(a,"DT",!0),n=this.standardMarketIterator(r.DT);if((i=(n?n.next():r.DT)<=t)&&e.ChartEngine.isDailyInterval(n.interval)){var s=this.chart.market.getOpen();s&&t<s&&(t.setHours(0,0,0,0),+t==+n.begin&&(i=!1))}}return i},e.ChartEngine.prototype.isHome=function(){var t=this.chart,e=t.dataSet,i=t.animatingHorizontalScroll;return this.pixelFromTick(e.length-(i?2:1),t)<t.width+t.panel.left},e.ChartEngine.prototype.getPreviousBar=function(t,e,i){return this.getNextBarInternal(t,e,i,-1)},e.ChartEngine.prototype.getNextBar=function(t,e,i){return this.getNextBarInternal(t,e,i,1)},e.ChartEngine.prototype.getNextBarInternal=function(t,i,a,r){var n=t.dataSegment&&t.dataSegment[a];if(n)for(var s=n.tick;s>0&&s<t.dataSet.length;){s+=r;var o=t.dataSet[s];if(o){var l=e.existsInObjectChain(o,i);if(l&&l.obj[l.member])return o}}return null},e.ChartEngine.prototype.getFirstLastDataRecord=function(t,e,i){if(t&&t.length)for(var a=i?t.length-1:0;a>=0&&a<t.length;){if(t[a]&&void 0!==t[a][e])return t[a];i?a--:a++}return null},e.ChartEngine.prototype.leftTick=function(){return this.chart.dataSet.length-this.chart.scroll},e.ChartEngine.prototype.getNextInterval=function(t,e,i){e||(e=1),!1!==i&&(i=!0);var a=this.standardMarketIterator(t,i?this.dataZone:this.displayZone);return a?e<1?a.previous(-1*e):a.next(e):t},e.ChartEngine.prototype.standardMarketIterator=function(t,e,i){var a=i||this.chart;if(!a.market)return null;var r={begin:t,interval:this.layout.interval,periodicity:"tick"==this.layout.interval?this.chart.xAxis.futureTicksInterval:this.layout.periodicity,timeUnit:this.layout.timeUnit,outZone:e};return a.market.newIterator(r)}}(k),function(t){t.SplinePlotter||(t.SplinePlotter={});var e=t.CIQ,i=t.SplinePlotter;e.ChartEngine.prototype.draw=function(){this.debug();var t=this.chart,i=this.layout;if(t.canvas&&t.dataSet&&t.canvasHeight&&(this.offset=i.candleWidth*this.candleWidthPercent/2,e.clearCanvas(t.canvas,this),this.masterData&&!this.runPrepend("draw",arguments))){var a,r;this.defaultColor||this.getDefaultColor(),this.vectorsShowing=!1,this.drawPanels(),this.yAxisLabels=[],this.correctIfOffEdge(),this.createDataSegment();var n=this.createXAxis(t);this.initializeDisplay(t),this.drawXAxis(t,n);try{this.renderYAxis(t)}catch(t){if(t&&"reboot draw"===t.message)return this.draw();throw t}for(a in t.tmpWidth=Math.floor(i.candleWidth*this.candleWidthPercent),t.tmpWidth%2==0&&(t.tmpWidth+=1,t.tmpWidth>i.candleWidth&&(t.tmpWidth-=2)),t.tmpWidth<.5&&(t.tmpWidth=.5),this.plugins)(r=this.plugins[a]).display&&r.drawUnder&&r.drawUnder(this,t);for(a in t.legend&&(t.legend.colorMap=null),this.controls.baselineHandle&&(this.controls.baselineHandle.style.display="none"),this.rendererAction(t,"underlay"),e.getFn("Studies.displayStudies")(this,t,!0),this.displayChart(t),e.getFn("Studies.displayStudies")(this,t,!1),this.rendererAction(t,"overlay"),t.legend&&t.legend.colorMap&&t.legendRenderer&&t.legendRenderer(this,{chart:t,legendColorMap:t.legend.colorMap,coordinates:{x:t.legend.x,y:t.legend.y+t.panel.yAxis.top}}),this.plugins)(r=this.plugins[a]).display&&r.drawOver&&r.drawOver(this,t);for(var s in this.panels)this.panels[s].hidden||this.plotYAxisText(this.panels[s]);for(var o=0;o<this.yAxisLabels.length;o++){var l=this.yAxisLabels[o];"series"==l.src&&l.args[6]&&!1===l.args[6].drawSeriesPriceLabels||this.createYAxisLabel.apply(this,l.args)}this.createCrosshairs&&this.createCrosshairs(),this.drawVectors&&this.drawVectors(),this.drawCurrentHR(),this.displayInitialized=!0;var h=this.controls;if(h){var c=this.manageTouchAndMouse&&(!this.mainSeriesRenderer||!this.mainSeriesRenderer.nonInteractive);h.home&&(h.home.style.display=c&&!this.isHome()?"block":"none"),h.chartControls&&(h.chartControls.style.display=c?"block":"none")}e.Marker&&this.positionMarkers(),this.quoteDriver&&this.animations.zoom.hasCompleted&&this.quoteDriver.checkLoadMore(t),this.runAppend("draw",arguments),this.makeAsyncCallbacks()}},e.ChartEngine.prototype.setSeriesRenderer=function(t){var e=t.params;return this.chart.seriesRenderers[e.name]?this.chart.seriesRenderers[e.name]:(e.yAxis&&(e.yAxis=this.addYAxis(this.panels[e.panel],e.yAxis),this.resizeChart()),t.stx=this,this.chart.seriesRenderers[e.name]=t,t)},e.ChartEngine.prototype.setMainSeriesRenderer=function(t){var i=this.layout.chartType,a=this.layout.aggregationType,r=this.chart.customChart,n=this.mainSeriesRenderer,s=this.displayInitialized;n&&(t&&this.setMasterData(),this.displayInitialized=!1,n.removeAllSeries(t),this.removeSeriesRenderer(n),n=this.mainSeriesRenderer=null);var o={panel:this.chart.panel.name,name:"_main_series",highlightable:!1,useChartLegend:!0};if(r&&r.chartType&&(i=r.chartType),"none"!=i){a&&"ohlc"!=a&&(i=a);var l=e.Renderer.produce(i,o);l&&(this.setSeriesRenderer(l).attachSeries(null,{display:this.chart.symbol}),this.mainSeriesRenderer=l),this.displayInitialized=s,["highLowBars","standaloneBars","barsHaveWidth"].forEach(function(t){this.chart[t]=this.mainSeriesRenderer&&this.mainSeriesRenderer[t]}.bind(this))}},e.ChartEngine.prototype.removeSeriesRenderer=function(t){for(var e in this.chart.seriesRenderers)if(t.params.name===this.chart.seriesRenderers[e].params.name){var i=this.chart.seriesRenderers[t.params.name];i.params.yAxis,this.panels[i.params.panel];delete this.chart.seriesRenderers[t.params.name];break}},e.ChartEngine.prototype.getSeriesRenderer=function(t){return this.chart.seriesRenderers[t]},e.ChartEngine.prototype.getRendererFromSeries=function(t){var e=this.chart.seriesRenderers;for(var i in e)for(var a in e[i].seriesParams)if(e[i].seriesParams[a].id==t)return e[i];return null},e.ChartEngine.prototype.startClip=function(t,e){t||(t=this.chart.panel.name);var i=this.panels[t],a=i.yAxis,r=this.chart;r.context.save(),r.context.beginPath();var n=i.left,s=i.width;e?(n=0,s=this.width):i.yaxisLHS&&i.yaxisLHS.length&&(n++,s--),r.context.rect(n,a.top,s,a.height),r.context.clip()},e.ChartEngine.prototype.endClip=function(){this.chart.context.restore()},e.ChartEngine.prototype.setLineStyle=function(t,i){var r={};t&&"object"==a(t)?r=t:r.color=t,r.color||r.pattern||r.width||(r=null),i||(i=this.chart);var n=1;r&&r.width&&(n=r.width),r&&r.pattern&&(r.pattern=e.borderPatternToArray(n,r.pattern)),i.lineStyle=r},e.ChartEngine.prototype.setGapLines=function(t,i){i||(i=this.chart);var r={};if(t&&"object"==a(t))r=t;else{if("boolean"==typeof t)return i.gaplines=t;r.color=t}r.color||r.pattern||r.fillMountain||(r=null),r&&r.pattern&&(r.pattern=e.borderPatternToArray(r.pattern)),r&&r.width<=0&&(r.width=null),i.gaplines=r},e.ChartEngine.prototype.getGapColorFunction=function(t,e,i,r,n){return"object"!=a(i)&&(i={color:i}),function(s,o,l){var h=n?n(s,o,l):i;h.color&&(h=h.color);var c=o[t];return c||0===c||(c=o[e]),l||!c&&0!==c?r?("object"!=a(r)&&(r="string"==typeof r?{color:r}:{}),{color:r.color||h,pattern:r.pattern||i.pattern,width:r.width||i.width}):null:{color:h,pattern:i.pattern,width:i.width}}},e.ChartEngine.prototype.drawLineChart=function(t,i,a,r){var n=this.chart,s=n.context,o=n.lineStyle||{},l=this.canvasStyle(i);r||(r={}),this.startClip(t.name);var h=r.width||o.width||l.width;h&&parseInt(h,10)<=25?s.lineWidth=Math.max(1,e.stripPX(h)):s.lineWidth=1,r.pattern=r.pattern||o.pattern||l.borderTopStyle,r.pattern=e.borderPatternToArray(s.lineWidth,r.pattern),this.canvasColor(i);var c=r.color||o.color;c&&("auto"==c&&(c=this.defaultColor),r.opacity&&1!==r.opacity&&(c=e.hexToRgba(e.colorToHex(c),parseFloat(r.opacity))),s.strokeStyle=c),r.skipProjections=!0;var u=r.field||n.defaultPlotField,d=r.subField||n.defaultPlotField||"Close",p=r.gapDisplayStyle;p||!1===p||(p=r.gaps),p||!1===p||(p=n.gaplines),p||(p="transparent"),r.gapDisplayStyle=p;var f=this.getGapColorFunction(u,d,{color:s.strokeStyle,pattern:r.pattern,width:s.lineWidth},p,a);t.chart.tension&&(r.tension=t.chart.tension);var m=this.plotDataSegmentAsLine(u,t,r,f);return m.colors.length||m.colors.push(s.strokeStyle),s.lineWidth=1,this.endClip(),r.returnObject?m:m.colors},e.ChartEngine.prototype.drawChannelChart=function(t,i,a){var r=e.clone(a);r.color=a.color;var n=this.drawLineChart(t,r.style,i,r),s=r.border_color_up||this.getCanvasColor("stx_channel_up"),o=r.border_color_down||this.getCanvasColor("stx_channel_down");r[a.field?"subField":"field"]=r.field_high||"High",r.color=s;var l=this.drawLineChart(t,r.style,i,r);r[a.field?"subField":"field"]=r.field_low||"Low",r.color=o;var h=this.drawLineChart(t,r.style,i,r);r[a.field?"subField":"field"]=a.subField||this.chart.defaultPlotField||"Close";var c,u=[],d=[];for(c=0;c<l.points.length;c+=2)u.push([l.points[c],l.points[c+1]]);for(c=0;c<h.points.length;c+=2)d.push([h.points[c],h.points[c+1]]);var p=this.chart.context.lineWidth/2;for(c=n.points.length-2;c>=0;c-=2)u.push([n.points[c],n.points[c+1]-p]),d.push([n.points[c],n.points[c+1]+p]);return this.startClip(t.name),r.color=s,e.fillArea(this,u,r),r.color=o,e.fillArea(this,d,r),this.endClip(),n.colors=n.colors.concat(l.colors).concat(h.colors),a.returnObject?n:n.colors},e.ChartEngine.prototype.connectTheDots=function(t,i,r,n,s,o){if(o||(o={}),"none"!=o.pattern&&(!0===s&&(s=this.chart.panel),null==n&&(n=this.chart.context),!(t.length<4))){var l=0,h=this.chart.canvasHeight,c=this.chart.width;s&&(h=s.yAxis.bottom,l=s.yAxis.top),n.lineWidth=1.1,"object"==a(i)?(n.strokeStyle=i.color,i.opacity?n.globalAlpha=i.opacity:n.globalAlpha=1,n.lineWidth=e.stripPX(i.width)):!i||"auto"==i||e.isTransparent(i)?n.strokeStyle=this.defaultColor:n.strokeStyle=i,o.opacity&&(n.globalAlpha=o.opacity),o.lineWidth&&(n.lineWidth=o.lineWidth);var u=e.borderPatternToArray(n.lineWidth,o.pattern);n.beginPath();for(var d=0;d<t.length-2;d+=2){var p=t[d],f=t[d+1],m=t[d+2],g=t[d+3];if(isNaN(p)||isNaN(m)||isNaN(f)||isNaN(g))return;for(var v,y,x,b=0,S=1,C=m-p,w=g-f,k=0;k<4;k++){if(0===k&&(v=-C,y=-(0-p)),1==k&&(v=C,y=c-p),2==k&&(v=-w,y=-(l-f)),3==k&&(v=w,y=h-f),x=y/v,(g||0===g)&&0===v&&y<0)return!1;if(v<0){if(x>S)return!1;x>b&&(b=x)}else if(v>0){if(x<b)return!1;x<S&&(S=x)}}var D=p+b*C,T=f+b*w,A=p+S*C,M=f+S*w;try{n.setLineDash(u&&u.length?u:[]),n.moveTo(D,T),n.lineTo(A,M)}catch(t){}}n.stroke(),n.closePath(),n.globalAlpha=1,n.lineWidth=1}},e.ChartEngine.prototype.plotSpline=function(t,r,n,s,o,l,h){if(h||(h={}),"none"!=h.pattern){!0===l&&(l=this.chart.panel),null==o&&(o=this.chart.context),o.save(),o.lineWidth=1.1,"object"==a(n)?(o.strokeStyle=n.color,n.opacity?o.globalAlpha=n.opacity:o.globalAlpha=1,o.lineWidth=e.stripPX(n.width)):!n||"auto"==n||e.isTransparent(n)?o.strokeStyle=this.defaultColor:o.strokeStyle=n,h.opacity&&(o.globalAlpha=h.opacity),h.lineWidth&&(o.lineWidth=h.lineWidth);var c=e.borderPatternToArray(o.lineWidth,h.pattern);h.pattern&&o.setLineDash&&(o.setLineDash(c),o.lineDashOffset=0),o.beginPath(),i.plotSpline(t,r,o),o.stroke(),o.closePath(),o.restore()}},e.ChartEngine.prototype.rawWatermark=function(t,e,i,a){this.canvasFont("stx_watermark",t),t.fillStyle=this.defaultColor,t.globalAlpha=.5,this.chart.context.textBaseline="alphabetic",t.fillText(a,e,i),t.globalAlpha=1},e.ChartEngine.prototype.watermark=function(t,e){e&&"object"!=a(e)&&(e={h:arguments[1],v:arguments[2],text:arguments[3]});var i=(e={h:e.h||"left",v:e.v||"bottom",text:e.text||"",hOffset:e.hOffset||10,vOffset:e.vOffset||20,context:e.context||this.chart.context}).context;if(i){var r=this.panels[t];if(r&&!r.hidden){var n=r.yAxis.bottom-e.vOffset;"top"==e.v?n=r.top+e.vOffset:"middle"==e.v&&(n=(r.top+r.yAxis.bottom)/2),i.save(),this.canvasFont("stx_watermark",i),this.canvasColor("stx_watermark",i),i.textBaseline="alphabetic";var s=r.left+e.hOffset;"right"==e.h?s=r.right-e.hOffset:"center"==e.h&&(s=(r.right+r.left-i.measureText(e.text).width)/2),i.globalAlpha=.5,this.highlightedDraggable&&(i.globalAlpha*=.3),i.fillText(e.text,s,n),i.restore()}}},e.ChartEngine.prototype.displayErrorAsWatermark=function(t,e){if(e){t||(t="chart");var i=this.panels[t];if(i&&!i.hidden){var a=i.state;a||(i.state=a={});var r=a.studyErrors;if(r||(a.studyErrors=r=new Set),!r.has(e)){var n=0;"chart"===t&&this.chart&&this.chart.chartControls&&(n+=2*this.chart.chartControls.offsetHeight);var s=this.getCanvasFontSize("stx_watermark");n+=r.size*(s+10),r.add(e);var o={h:"center",v:"bottom",text:e,vOffset:n};this.watermark(t,o)}}}},e.ChartEngine.prototype.displayChart=function(t){this.runPrepend("displayChart",arguments)||(this.rendererAction(t,"main"),this.runAppend("displayChart",arguments))}}(k),function(t){var e=t.CIQ;e.ChartEngine.prototype.cloneStyle=function(t){var i={},a=!1;function r(t){return t[1].toUpperCase()}for(var n in t){var s=t[n];if("backgroundAttachment"==n&&(a=!0),a)s&&s.constructor==String&&isNaN(n)&&(i[n]=s);else if(isNaN(n)){i[n.replace(e.camelCaseRegExp,r)]=s}else{var o=t.getPropertyValue(s);if(o){for(var l=0,h=(s=s.split("-")).length,c=s[0];++l<h;)c+=s[l].charAt(0).toUpperCase()+s[l].slice(1);i[c]=o}}}return i},e.ChartEngine.prototype.canvasStyle=function(t){var e=this.styles[t];if(!e){var i=document.createElement("div");i.className=t,this.container.appendChild(i);var a=getComputedStyle(i);e=this.styles[t]=this.cloneStyle(a),this.container.removeChild(i),a||(this.styles[t]=null)}return e},e.ChartEngine.prototype.colorOrStyle=function(t){return-1!=t.indexOf("#")||-1!=t.indexOf("(")||"transparent"==t?t:this.canvasStyle(t)},e.ChartEngine.prototype.clearStyles=function(){this.styles={},this.defaultColor=""},e.ChartEngine.prototype.setStyle=function(t,i,a){this.styles[t]||this.canvasStyle(t),this.styles[t]||(this.styles[t]={}),this.styles[t][e.makeCamelCase(i)]=a},e.ChartEngine.prototype.canvasFont=function(t,e){e||(e=this.chart.context);var i=this.canvasStyle(t);if(i){var a=i.fontStyle+" "+i.fontWeight+" "+i.fontSize+" "+i.fontFamily;-1==a.indexOf("undefined")?e.font=a:(this.styles[t]=null,console.log("bad css style for class "+t))}},e.ChartEngine.prototype.canvasColor=function(t,e){e||(e=this.chart.context);var i=this.canvasStyle(t);if(i){var a=i.color;a||(a=this.defaultColor),e.globalAlpha=1,e.fillStyle=a,e.strokeStyle=a;var r=i.opacity;void 0!==r&&(e.globalAlpha=r)}},e.ChartEngine.prototype.getCanvasFontSize=function(t){var i=this.canvasStyle(t).fontSize;return i||(i="12"),parseInt(e.stripPX(i),10)},e.ChartEngine.prototype.getCanvasColor=function(t){return this.canvasStyle(t).color},e.ChartEngine.prototype.getDefaultColor=function(){this.defaultColor="#000000";for(var t=null,i=this.chart.container;!t||e.isTransparent(t);){var a=getComputedStyle(i);if(!a)return;if(t=a.backgroundColor,e.isTransparent(t)&&(t="transparent"),!(i=i.parentNode)||!i.tagName)break}if(t)if("transparent"==t&&(t="#FFFFFF"),this.containerColor=t,e.isTransparent(t))this.defaultColor="#000000";else{var r=e.hsv(t)[2];this.defaultColor=r>.65?"#000000":"#FFFFFF"}else this.containerColor="#FFFFFF"}}(k),function(t){var e=t.CIQ;e.ChartEngine.XAxis=function(t){for(var e in t)this[e]=t[e]},e.extend(e.ChartEngine.XAxis.prototype,{formatter:null,adjustTimeZone:!0,idealTickSizePixels:null,timeUnit:null,timeUnitMultiplier:null,displayBorder:!0,displayGridLines:!0,noDraw:null,minimumLabelWidth:50,futureTicks:!0,futureTicksInterval:1},!0),e.ChartEngine.XAxisLabel=function(t,e,i){this.hz=t,this.grid=e,this.text=i},e.ChartEngine.prototype.createXAxis=function(t){if(t.dataSegment.length<=0)return null;if(t.xAxis.noDraw)return null;var e=[t],i=this.runPrepend("createXAxis",e);return i||(i=this.mainSeriesRenderer&&this.mainSeriesRenderer.createXAxis?this.mainSeriesRenderer.createXAxis(t):this.createTickXAxisWithDates(t),this.headsUpHR(),this.runAppend("createXAxis",e),i)},e.ChartEngine.prototype.createXAxisLabel=function(t,i,a,r,n,s){var o,l=this.chart.context,h=this.getCanvasFontSize("stx-float-date")+4;this.canvasFont("stx-float-date",l);try{o=l.measureText(i).width+4}catch(t){o=0}var c=t.top+t.height-h;if(!(a+o/2<t.left||a-o/2>t.right)){s||(a+o/2>t.right&&(a=t.right-o/2),a-o/2<t.left&&(a=t.left+o/2)),l.fillStyle=r,e.roundRect({ctx:l,x:a-o/2,top:c,width:o,height:h,radius:3,fill:!0});var u=t.bottom-t.yAxis.bottom-h;l.beginPath(),s?(l.moveTo(a-u,c),l.lineTo(a,c-u-1),l.lineTo(a+u,c),l.closePath(),l.fill()):(l.moveTo(a,c),l.lineTo(a,c-u),l.strokeStyle=r,l.stroke()),l.textBaseline="top",l.fillStyle=n||e.chooseForegroundColor(r),l.fillStyle==r&&("#FFFFFF"==r.toUpperCase()?l.fillStyle="#000000":l.fillStyle="#FFFFFF"),l.fillText(i,a-o/2+2,c+2)}}}(k),function(t){var e=t.CIQ;e.createLabel=function(t){t.ctx.textBaseline="middle",t.ctx.fillStyle=t.color?t.color:e.chooseForegroundColor(t.backgroundColor),t.ctx.fillStyle===t.backgroundColor&&("#FFFFFF"==t.backgroundColor.toUpperCase()?t.ctx.fillStyle="#000000":t.ctx.fillStyle="#FFFFFF"),t.ctx.fillText(t.txt,t.x+t.margin.left,t.y+t.margin.top),t.ctx.textAlign="left"},e.roundRectArrow=function(t){e.roundRect(t,"arrow")},e.semiRoundRect=function(t){e.roundRect(t,"flush")},e.rect=function(t){t.radius=0,e.roundRect(t)},e.noop=function(t){t.color=t.backgroundColor,e.createLabel(t)},e.tickedRect=function(t){e.rect(t);var i=Math.round(t.top+t.height/2)+.5;t.ctx.beginPath(),t.ctx.moveTo(t.x-2,i),t.ctx.lineTo(t.x,i),t.ctx.stroke(),t.ctx.closePath()},e.roundRect=function(t,i){9===arguments.length&&(t={ctx:arguments[0],x:arguments[1],top:arguments[2],width:arguments[3],height:arguments[4],radius:arguments[5],fill:arguments[6],stroke:arguments[7],edge:arguments[8]});var a=t.stroke,r=t.x,n=t.top,s=t.width,o=t.height,l=t.radius,h=t.fill,c=t.ctx;void 0===a&&(a=!0),void 0===l&&(l=5,s<0&&(l=-5));var u=s<0?-1*l:l;l&&!i&&(r-=1);var d=r+l,p=r+s,f=n+u,m=n+o,g=p-l,v=m-u;if(c.beginPath(),c.moveTo(d,n),c.lineTo(g,n),c.quadraticCurveTo(p,n,p,f),c.lineTo(p,v),c.quadraticCurveTo(p,m,g,m),c.lineTo(d,m),"flush"==i)c.lineTo(r,m),c.lineTo(r,n);else if("arrow"==i){c.quadraticCurveTo(r,m,r-l,v);var y=s<0?1:-1;c.lineTo(r+o/2*y,n+o/2),c.lineTo(r-l,f),c.quadraticCurveTo(r,n,d,n)}else c.quadraticCurveTo(r,m,r,v),c.lineTo(r,f),c.quadraticCurveTo(r,n,d,n);c.closePath(),t.backgroundColor&&(c.fillStyle=t.backgroundColor),a&&c.stroke(),h&&c.fill(),t.txt&&e.createLabel(t)},e.ChartEngine.YAxis=function(t){for(var i in t)this[i]=t[i];this.name||(this.name=e.uniqueID()),"none"==this.position&&(this.width=0)},e.extend(e.ChartEngine.YAxis.prototype,{high:null,low:null,shadow:null,logHigh:null,logLow:null,logShadow:null,multiplier:null,bottom:null,top:null,height:null,left:null,width:null,renderers:[],studies:[]},!0),e.ChartEngine.YAxis.prototype.maxDecimalPlaces=null,e.ChartEngine.YAxis.prototype.max=null,e.ChartEngine.YAxis.prototype.min=null,e.ChartEngine.YAxis.prototype.decimalPlaces=null,e.ChartEngine.YAxis.prototype.idealTickSizePixels=null,e.ChartEngine.YAxis.prototype.minimumPriceTick=null,e.ChartEngine.YAxis.prototype.fractional=null,e.ChartEngine.YAxis.prototype.displayBorder=!0,e.ChartEngine.YAxis.prototype.displayGridLines=!0,e.ChartEngine.YAxis.prototype.noDraw=null,e.ChartEngine.YAxis.prototype.drawCurrentPriceLabel=!0,e.ChartEngine.YAxis.prototype.drawSeriesPriceLabels=!0,e.ChartEngine.YAxis.prototype.drawPriceLabels=!0,e.ChartEngine.YAxis.prototype.goldenRatioYAxis=!0,e.ChartEngine.YAxis.prototype.yaxisLabelStyle=null,e.ChartEngine.YAxis.prototype.justifyRight=null,e.ChartEngine.YAxis.prototype.flipped=!1,e.ChartEngine.YAxis.prototype.textBackground=!1,e.ChartEngine.YAxis.prototype.priceFormatter=null,e.ChartEngine.YAxis.prototype.bottomOffset=0,e.ChartEngine.YAxis.prototype.topOffset=0,e.ChartEngine.YAxis.prototype.initialMarginTop=10,e.ChartEngine.YAxis.prototype.initialMarginBottom=10,e.ChartEngine.YAxis.prototype.zoom=0,e.ChartEngine.YAxis.prototype.scroll=0,e.ChartEngine.YAxis.prototype.heightFactor=1,Object.defineProperty(e.ChartEngine.YAxis.prototype,"width",{configurable:!0,enumerable:!0,get:function(){return this._dynamicWidth||this._width},set:function(t){this._width=t,this._dynamicWidth<t&&(this._dynamicWidth=NaN)}}),e.ChartEngine.YAxis.prototype.width=50,e.ChartEngine.YAxis.prototype.textStyle=null,e.ChartEngine.YAxis.prototype.position=null,e.ChartEngine.YAxis.defaultShadowBreaks=[[1e3,2],[5,4],[.001,8]],e.ChartEngine.YAxis.smallChartShadowBreaks=[[10,2],[1,4]],e.ChartEngine.YAxis.prototype.pretty=!0,e.ChartEngine.YAxis.prototype.increments=[1,2.5,5],e.ChartEngine.YAxis.prototype.prettySemiLog=!0,e.ChartEngine.YAxis.prototype.shadowBreaks=e.ChartEngine.YAxis.defaultShadowBreaks,e.ChartEngine.YAxis.prototype.getYAxis=function(t){return this},e.ChartEngine.YAxis.prototype.isShared=function(t,e){var i=this.studies.length,a=this.renderers.length;if(i>1)return!0;if(a&&i)return!0;if(!a)return!1;if(a>1&&e)return!0;for(var r=a-1;r>=0;r--)t.chart.seriesRenderers[this.renderers[r]].params.dependentOf&&a--;return a>1},e.ChartEngine.YAxis.prototype.setBackground=function(t,i){i||(i={}),i.color||(i.color="auto");var a=[[this.left,this.top],[this.left,this.bottom],[this.left+this.width,this.bottom],[this.left+this.width,this.top]];e.fillArea(t,a,{color:i.color,opacity:i.opacity})},e.ChartEngine.prototype.getLabelOffsetInPixels=function(t,e){var i=!this.mainSeriesRenderer||!this.mainSeriesRenderer.standaloneBars;if(!("roundRectArrow"!=this.yaxisLabelStyle||i&&this.extendLastTick&&0!==t.yaxisPaddingRight)){return.66*(this.getCanvasFontSize("stx_yaxis")+6)}return 0},e.ChartEngine.prototype.flipChart=function(t){this.layout.flipped!=t&&(this.layout.flipped=t,this.chart.yAxis.flipped=t,this.changeOccurred("layout"),this.draw())},e.ChartEngine.prototype.calculateYAxisMargins=function(t){t.heightFactor&&(t.zoom=t.height*(1-t.heightFactor)),t.zoom+=t.initialMarginTop+t.initialMarginBottom,t.scroll=(t.initialMarginTop-t.initialMarginBottom)/2,t.zoom>t.height&&(t.zoom=0,t.scroll=0)},e.ChartEngine.prototype.resetDynamicYAxis=function(t){if(!this.runPrepend("resetDynamicYAxis",arguments)){var e=!1;for(var i in this.panels){var a=this.panels[i];if((!t||!t.chartName||a.chart.name===t.chartName)&&(a.yaxisLHS&&a.yaxisRHS))for(var r=a.yaxisLHS.concat(a.yaxisRHS),n=0;n<r.length;n++)r[n]._dynamicWidth&&(r[n]._dynamicWidth=NaN,e=!0)}!e||t&&t.noRecalculate||this.calculateYAxisPositions(),this.runAppend("resetDynamicYAxis",arguments)}},e.ChartEngine.prototype.adjustYAxisHeightOffset=function(t,e){var i=e.topOffset,a=e.bottomOffset;i+a>t.height&&(console.log("The sum of yAxis.topOffset and yAxis.bottomOffset cannot be greater than the panel height. Both values will be reset to 0."),e.bottomOffset=0,e.topOffset=0),this.xaxisHeight||0===this.xaxisHeight||(this.xaxisHeight=this.getCanvasFontSize("stx_xaxis")+4,(this.chart.xAxis.displayBorder||this.axisBorders)&&(this.xaxisHeight+=3)),(this.xAxisAsFooter&&t.bottom>this.chart.canvasHeight-this.xaxisHeight||!this.xAxisAsFooter&&t==this.chart.panel)&&(a+=this.xaxisHeight),e.top=t.top+i,e.bottom=t.bottom-a},e.ChartEngine.prototype.plotYAxisGrid=function(t){if(!this.runPrepend("plotYAxisGrid",arguments)){var e=this.getBackgroundCanvas().context,i=t.yAxis;i.yAxisPlotter&&i.yAxisPlotter.draw(e,"grid"),this.runAppend("plotYAxisGrid",arguments)}},e.ChartEngine.prototype.plotYAxisText=function(t){if(!this.runPrepend("plotYAxisText",arguments)){var e=this.getBackgroundCanvas().context;this.canvasFont("stx_yaxis",e),this.canvasColor("stx_yaxis",e),e.textBaseline="middle";var i,a=t.yaxisLHS;for(i=0;i<a.length;i++)e.textAlign="right",r(a[i]);for(a=t.yaxisRHS,i=0;i<a.length;i++)e.textAlign="left",r(a[i]);e.textAlign="left",e.textBaseline="alphabetic",this.runAppend("plotYAxisText",arguments)}function r(t){t.yAxisPlotter&&!t.noDraw&&t.width&&(t.justifyRight?e.textAlign="right":!1===t.justifyRight&&(e.textAlign="left"),t.yAxisPlotter.draw(e,"text"))}},e.ChartEngine.prototype.decimalPlacesFromPriceTick=function(t){return t<1e-4?8:t<.01?4:t<.1?2:t<1?1:0},e.ChartEngine.prototype.formatYAxisPrice=function(t,i,a,r,n){if(null==t||isNaN(t))return"";i||(i=this.chart.panel);var s=r||i.yAxis,o=a;o||0===o||(o=s.printDecimalPlaces),o||0===o||(o=this.decimalPlacesFromPriceTick(s.priceTick));var l=s==i.chart.yAxis?2e4:1e3;if(s.priceTick>=l)return t=t.toFixed(o),e.condenseInt(t);var h=this.internationalizer;if(h&&!1!==n){var c=h.priceFormatters.length;o>=c&&(o=c-1),t=h.priceFormatters[o].format(t)}else t=t.toFixed(o);return t},e.ChartEngine.prototype.calculateYAxisRange=function(t,e,i,a){i==Number.MAX_VALUE&&(i=0,a=0);var r=t.height,n=null,s=null;this.adjustYAxisHeightOffset(t,e),e.height=e.bottom-e.top;var o=Math.round(Math.abs(r/5));e.zoom>=0&&r-Math.abs(e.scroll)<o&&(e.scroll=(r-o)*(e.scroll<0?-1:1));var l=t.chart.name===t.name&&t.yAxis.name===e.name,h=i>0&&(this.layout.semiLog||"log"==this.layout.chartScale)&&!t.chart.isComparison&&"pandf"!=this.layout.aggregationType;if(i||0===i){if(a-i==0){var c=Math.pow(10,-(i.toString()+".").split(".")[1].length);1==c&&(c=100),n=i+c,s=i-c}else if(l&&h&&(a||0===a)){var u=Math.log(i)/Math.LN10,d=Math.log(a)/Math.LN10;n=Math.pow(10,d),s=Math.pow(10,u)}else n=a,s=i;e.high=n,e.low=s}(e.max||0===e.max)&&(e.high=e.max),(e.min||0===e.min)&&(e.low=e.min),e.shadow=e.high-e.low,l&&(e.semiLog!=h&&(this.clearPixelCache(),e.semiLog=h),e.flipped=this.layout.flipped)},e.ChartEngine.prototype.renderYAxis=function(t){if(!this.runPrepend("renderYAxis",arguments)){this.rendererAction(t,"yAxis");var i=this.getBackgroundCanvas(t).context;for(var a in this.panels){var r=this.panels[a];if(r.chart==t){var n,s,o=r.yaxisRHS.concat(r.yaxisLHS);for(n=0;n<o.length;n++){s=o[n],this.calculateYAxisRange(r,s,s.lowValue,s.highValue);var l=e.getFn("Studies.getYAxisParameters",{})(this,s);l.yAxis=s,this.createYAxis(r,l),this.drawYAxis(r,l),e.getFn("Studies.doPostDrawYAxis")(this,s)}for(n=0;n<o.length;n++)if((s=o[n]).dropzone){var h=this.canvasStyle("stx-subholder dropzone left");if(h)if(i.strokeStyle=h.borderLeftColor,i.lineWidth=parseFloat(h.borderLeftWidth),i.beginPath(),"all"==s.dropzone)i.strokeRect(s.left,s.top,s.width,s.height);else{var c=s.left+("left"==s.dropzone?0:s.width);i.moveTo(c,s.top),i.lineTo(c,s.top+s.height),i.stroke()}}this.displayDragOK&&this.displayDragOK(!0)}}this.runAppend("renderYAxis",arguments)}},e.ChartEngine.prototype.updateFloatHRLabel=function(t){if(this.floatCanvas){var i=t.yaxisLHS.concat(t.yaxisRHS),a=this.crossYActualPos?this.crossYActualPos:this.cy;if(this.floatCanvas.isDirty&&e.clearCanvas(this.floatCanvas,this),!this.controls.crossX||"none"!=this.controls.crossX.style.display){if(this.controls.crossY){var r=t.width;"roundRectArrow"==this.yaxisLabelStyle&&(r-=7),this.controls.crossY.style.left=t.left+"px",this.controls.crossY.style.width=r+"px"}for(var n=0;n<i.length;n++){var s=i[n],o=this.transformedPriceFromPixel(a,t,s);if(!isNaN(o)&&!((s.min||0===s.min)&&o<s.min||(s.max||0===s.max)&&o>s.max)){var l=null;s!==t.chart.yAxis&&(l=this.decimalPlacesFromPriceTick(s.priceTick),(s.decimalPlaces||0===s.decimalPlaces)&&(l=s.decimalPlaces)),o=s.priceFormatter?s.priceFormatter(this,t,o,l):this.formatYAxisPrice(o,t,l,s);var h=this.canvasStyle("stx-float-price");this.createYAxisLabel(t,o,a,h.backgroundColor,h.color,this.floatCanvas.context,s),this.floatCanvas.isDirty=!0}}}}},e.ChartEngine.prototype.whichYAxis=function(t,e,i){void 0===e&&(e=this.cx),void 0===i&&(i=this.cy);var a=this.whichPanel(i);if(t&&t==a)for(var r=t.yaxisLHS.concat(t.yaxisRHS),n=0;n<r.length;n++){var s=r[n];if(s.left<=e&&s.left+s.width>=e)return s}return null},e.ChartEngine.prototype.yaxisMatches=function(t,i){return!!(t&&t.getYAxis&&i&&i instanceof e.ChartEngine.YAxis)&&t.getYAxis(this).name==i.name},e.ChartEngine.prototype.createYAxisLabel=function(t,i,a,r,n,s,o){if(!1!==t.yAxis.drawPriceLabels&&!t.yAxis.noDraw){var l=o||t.yAxis;if(!l.noDraw&&l.width){var h=s||this.chart.context,c=this.getCanvasFontSize("stx_yaxis")+6;this.canvasFont("stx_yaxis",h);l.displayBorder;var u,d=this.drawBorders?3:0;try{u=h.measureText(i).width+d+6}catch(t){u=l.width}var p=l.left-3+3;l.width<0&&(p+=l.width-u);var f=p+3+d,m=3;"left"===(null===l.position?t.chart.yAxis.position:l.position)&&(p=l.left+l.width+3-3,u*=-1,l.width<0&&(p-=l.width+u),f=p-3-d,m=-3,h.textAlign="right"),a+c/2>l.bottom&&(a=l.bottom-c/2),a-c/2<l.top&&(a=l.top+c/2),void 0===e[this.yaxisLabelStyle]&&(this.yaxisLabelStyle="roundRectArrow");var g=this.yaxisLabelStyle;l.yaxisLabelStyle&&(g=l.yaxisLabelStyle);var v={ctx:h,x:p,y:a,top:a-c/2,width:u,height:c,radius:m,backgroundColor:r,fill:!0,stroke:!1,margin:{left:f-p,top:1},txt:i,color:n};e[g](v)}}},e.ChartEngine.prototype.drawCurrentHR=function(){if(!this.runPrepend("drawCurrentHR",arguments)){var t,e,i=this.mainSeriesRenderer||{};if(!i.noCurrentHR){var a=i.highLowBars;for(var r in this.charts){var n=this.charts[r],s=n.panel,o=s.yAxis;if(!s.hidden&&(!1!==o.drawCurrentPriceLabel&&!o.noDraw&&i.params)){var l=o.whichSet;if(l||(l="dataSet"),!this.isHistoricalModeSet||"dataSegment"===l){var h=n[l].length,c=this.layout.candleWidth;if("dataSegment"==l)for(;h>(n.width-this.micropixels+c/2+1)/c;)h--;if(h&&n[l][h-1]){var u,d,p,f=n.defaultPlotField;f&&!a||(f="Close");do{if(d=u=n[l][--h][f],0===h)break}while(null==d);if("dataSet"==l&&n.currentQuote)d=n.currentQuote[f];else if(n[l].length>=2){var m=n[l][h-1];m&&(u=m[f])}d<u?(t=this.canvasStyle("stx_current_hr_down").backgroundColor,e=this.canvasStyle("stx_current_hr_down").color):(t=this.canvasStyle("stx_current_hr_up").backgroundColor,e=this.canvasStyle("stx_current_hr_up").color),n.transformFunc&&(d=n.transformFunc(this,n,d));var g=Math.max(s.yAxis.printDecimalPlaces,s.chart.decimalPlaces);(o.maxDecimalPlaces||0===o.maxDecimalPlaces)&&(g=Math.min(g,o.maxDecimalPlaces)),p=o.priceFormatter?o.priceFormatter(this,s,d,g):this.formatYAxisPrice(d,s,g);var v=this.pixelFromTransformedValue(d,s);this.createYAxisLabel(s,p,v,t,e),!0===this.preferences.currentPriceLine&&this.isHome()&&this.plotLine(s.left,s.right,v,v,t,"line",s.chart.context,s,{pattern:"dashed",lineWidth:1,opacity:.8,globalCompositeOperation:"destination-over"})}}}}this.runAppend("drawCurrentHR",arguments)}}},e.ChartEngine.prototype.getYAxisByName=function(t,e){if("string"==typeof t&&(t=this.panels[t]),t&&e){if(e===t.yAxis.name)return t.yAxis;var i;for(i=0;t.yaxisLHS&&i<t.yaxisLHS.length;i++)if(t.yaxisLHS[i].name===e)return t.yaxisLHS[i];for(i=0;t.yaxisRHS&&i<t.yaxisRHS.length;i++)if(t.yaxisRHS[i].name===e)return t.yaxisRHS[i]}},e.ChartEngine.prototype.getYAxisByField=function(t,e){if(e){var i,a;for(i in this.layout.studies){var r=this.layout.studies[i];if(r.panel==t.name&&(r.outputMap&&r.outputMap.hasOwnProperty(e)))return r.getYAxis(this)}for(i in this.chart.seriesRenderers)for(var n=this.chart.seriesRenderers[i],s=0;s<n.seriesParams.length;s++)if(n.params.panel==t.name){var o=n.seriesParams[s],l=o.field;if(l||n.highLowBars||(l=this.defaultPlotField||"Close"),o.symbol&&o.subField&&(l+="--\x3e"+o.subField),e==l)return n.params.yAxis||t.yAxis;o.field&&o.field==e.split("--\x3e")[0]&&(a=n.params.yAxis||t.yAxis)}if(a)return a}},e.ChartEngine.prototype.deleteYAxisIfUnused=function(t,e){if("string"==typeof t&&(t=this.panels[t]),e&&t){for(var i=0;i<e.renderers.length;i++){var a=this.chart.seriesRenderers[e.renderers[i]];if(a&&a.params.panel==t.name)return}if(e.name!==t.yAxis.name||t.yaxisRHS.length+t.yaxisLHS.length!==1){var r,n;for(r=0;t.yaxisRHS&&r<t.yaxisRHS.length;r++)t.yaxisRHS[r]===e?t.yaxisRHS[r]=null:n||(n=t.yaxisRHS[r]);for(r=0;t.yaxisLHS&&r<t.yaxisLHS.length;r++)t.yaxisLHS[r]===e?t.yaxisLHS[r]=null:n||(n=t.yaxisLHS[r]);t.yaxisRHS=t.yaxisRHS.filter(s),t.yaxisLHS=t.yaxisLHS.filter(s),n&&e.name===t.yAxis.name&&(t.yAxis=n),this.calculateYAxisPositions()}}function s(t){return null!==t}},e.ChartEngine.prototype.addYAxis=function(t,e){if("string"==typeof t&&(t=this.panels[t]),e&&t){t.yaxisLHS||(t.yaxisLHS=[],t.yaxisRHS=[],"left"==t.yAxis.position||"right"!=t.yAxis.position&&"left"==t.chart.panel.yAxis.position?t.yaxisLHS.push(t.yAxis):t.yaxisRHS.push(t.yAxis));var i,a=[],r=t.yaxisLHS;for(i=r.length-1;i>=0;i--)if(r[i].name===e.name){if("right"!=e.position)return r[i];a=r.splice(i,1)}for(i=(r=t.yaxisRHS).length-1;i>=0;i--)if(r[i].name===e.name){if("left"!=e.position)return r[i];a=r.splice(i,1)}return"left"===e.position||"right"!=e.position&&"left"==t.chart.panel.yAxis.position?t.yaxisLHS.unshift(e):t.yaxisRHS.push(e),e.height=t.yAxis.height,e.idealTickSizePixels=null,a[0]==t.yAxis&&(t.yAxis=e),this.calculateYAxisMargins(e),e}},e.ChartEngine.prototype.calculateYAxisPositions=function(){var t=[];for(var e in this.charts)this.charts[e].hidden||this.charts[e].panel.hidden||t.push(e);for(var i in this.panels){var a=this.panels[i];a.name===a.chart.name||a.hidden||t.push(i)}this.drawBorders;var r,n,s,o,l=0,h=0;for(n=0;n<t.length;n++)if(s=this.panels[t[n]]){s.yaxisLHS||(s.yaxisLHS=[],s.yaxisRHS=[]);var c=s.yaxisLHS,u=s.yaxisRHS,d=s.yAxis.position;d&&"none"!=d||(d=s.chart.yAxis.position||"right"),c.length||u.length||("left"==d?c.push(s.yAxis):u.push(s.yAxis));var p=[],f=[];for(r=c.length-1;r>=0;r--)("right"==c[r].position||"left"!=c[r].position&&"right"==d)&&(p=p.concat(c.splice(r,1)));for(r=u.length-1;r>=0;r--)("left"==u[r].position||"right"!=u[r].position&&"left"==d)&&(f=f.concat(u.splice(r,1)));s.yaxisLHS=f.concat(c),s.yaxisRHS=u.concat(p),s.yAxis.width||0===s.yAxis.width||(s.yAxis.width=this.yaxisWidth),s.yaxisTotalWidthRight=0,s.yaxisTotalWidthLeft=0;var m=s.yaxisLHS.concat(s.yaxisRHS);for(r=0;r<m.length;r++)!(o=m[r]).noDraw&&o.width&&("left"==o.position||"left"==d&&!o.position?s.yaxisTotalWidthLeft+=o.width:s.yaxisTotalWidthRight+=o.width);s.yaxisTotalWidthLeft>l&&(l=s.yaxisTotalWidthLeft),s.yaxisTotalWidthRight>h&&(h=s.yaxisTotalWidthRight)}for(n=0;n<t.length;n++)if(s=this.panels[t[n]]){var g=s.name===s.chart.name,v=l;for(r=s.yaxisLHS.length-1;r>=0;r--)(o=s.yaxisLHS[r]).noDraw||(v-=o.width,o.left=v);for(v=this.width-h,r=0;r<s.yaxisRHS.length;r++)(o=s.yaxisRHS[r]).noDraw||(o.left=v,v+=o.width);void 0!==this.yaxisLeft&&(s.chart.yaxisPaddingRight=this.yaxisLeft),s.yaxisCalculatedPaddingRight=h,(s.chart.yaxisPaddingRight||0===s.chart.yaxisPaddingRight)&&(s.yaxisCalculatedPaddingRight=s.chart.yaxisPaddingRight),s.yaxisCalculatedPaddingLeft=l,(s.chart.yaxisPaddingLeft||0===s.chart.yaxisPaddingLeft)&&(s.yaxisCalculatedPaddingLeft=s.chart.yaxisPaddingLeft),g||s.chart.panel.hidden?(s.left=s.yaxisCalculatedPaddingLeft,s.right=this.width-s.yaxisCalculatedPaddingRight):(s.left=s.chart.panel.left,s.right=s.chart.panel.right),s.width=s.right-s.left,s.handle&&(s.handle.style.left=s.left+"px",s.handle.style.width=s.width+"px"),(g||s.chart.panel.hidden)&&(s.chart.panel.left=s.chart.left=s.left,s.chart.panel.right=s.chart.right=s.right,s.chart.panel.width=s.chart.width=Math.max(s.right-s.left,0))}this.setCandleWidth(this.layout.candleWidth),this.adjustPanelPositions()},e.ChartEngine.prototype.getYAxisCurrentPosition=function(t,e){if(!t.width)return"none";for(var i=e.yaxisLHS,a=0;a<i.length;a++)if(i[a].name==t.name)return"left";return"right"},e.ChartEngine.prototype.setYAxisPosition=function(t,i){t.position=i,t.width="none"==i?0:e.ChartEngine.YAxis.prototype.width,this.calculateYAxisPositions(),this.draw()},e.ChartEngine.prototype.electNewYAxisOwner=function(t){var e=t.studies[0];e&&e!=t.name||(e=t.renderers[0]),e&&e!=t.name||(e=t.studies[1]),e||(e=t.renderers[1]);for(var i=0;i<t.studies.length;i++){var a=this.layout.studies[t.studies[i]];a.parameters&&a.parameters.yaxisDisplayValue==t.name&&(a.parameters.yaxisDisplayValue=e)}return e}}(k),s(k),h(k),d(k),m(k),y(k);var D=k.CIQ,T=k.SplinePlotter,A=k.timezoneJS,M=k.$$,P=k.$$$}).call(this,i(56))},326:function(t,e,i){"use strict";(function(t){i.d(e,"e",(function(){return g})),i.d(e,"f",(function(){return h})),i.d(e,"g",(function(){return v})),i.d(e,"h",(function(){return y})),i.d(e,"i",(function(){return x})),i.d(e,"j",(function(){return b})),i.d(e,"k",(function(){return S})),i.d(e,"l",(function(){return C})),i.d(e,"m",(function(){return w})),i.d(e,"n",(function(){return d})),i.d(e,"o",(function(){return k})),i.d(e,"p",(function(){return D})),i.d(e,"q",(function(){return T})),i.d(e,"r",(function(){return A})),i.d(e,"s",(function(){return M})),i.d(e,"t",(function(){return P})),i.d(e,"u",(function(){return F})),i.d(e,"v",(function(){return _})),i.d(e,"w",(function(){return E})),i.d(e,"x",(function(){return L})),i.d(e,"z",(function(){return m})),i.d(e,"A",(function(){return I}));var a=i(325);i.d(e,"c",(function(){return a.c})),i.d(e,"d",(function(){return a.d})),i.d(e,"y",(function(){return a.e})),i.d(e,"a",(function(){return a.a})),i.d(e,"b",(function(){return a.b}));function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],a=!0,r=!1,n=void 0;try{for(var s,o=t[Symbol.iterator]();!(a=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);a=!0);}catch(t){r=!0,n=t}finally{try{a||null==o.return||o.return()}finally{if(r)throw n}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var o,l,h,c,u,d,p,f,m,g=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ,i={get:function(t,i){return i(null,e.localStorage.getItem(t))},set:function(t,i){return e.localStorageSetItem(t,i)},remove:function(t){return e.localStorage.removeItem(t)}};e.ChartEngine.create=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.container,r=t.config,s=t.deferLoad;a||(a=document.querySelector(".chartContainer")||document.body),r||(r={});var o=Object.assign({container:a},r.chartEngineParams),l=new this(o),h=r,c=h.quoteFeeds,u=h.marketFactory,d=h.addOns,p=h.chartId;c&&l.attachQuoteFeed&&c.forEach((function(t){var e=t.quoteFeed,i=t.behavior,a=t.filter;l.attachQuoteFeed(e,i,a)})),u&&l.setMarketFactory(u),d&&Object.entries(d).filter((function(t){return!!n(t,2)[1]})).forEach((function(t){var i=n(t,2),a=i[0],s=i[1];if(r.enabledAddOns[a]){var o=s.moduleName||e.capitalize(a);e[o]?new e[o](Object.assign({stx:l},s)):e.debug&&console.log("".concat(o," not available for addons with params:"),s)}}));var f=e.ensureDefaults(r.callbacks||{},{layout:this.getSaveLayout(r),symbolChange:this.getSaveLayout(r),drawing:this.getSaveDrawings(r),preferences:this.getSavePreferences(r),newChart:this.getRetoggleEvents(r)});for(var m in f)f[m]&&l.addEventListener(m,f[m]);return e.NameValueStore&&Object.assign(i,e.NameValueStore),s||(r.restore?(this.restorePreferences(l,p),this.restoreLayout(l,null,p)):(l.loadChart(r.initialSymbol,{masterData:r.initialData}),l.draw())),l},e.ChartEngine.getSaveLayout=function(t){return function(e){var a=e.stx;if(t.restore&&a.exportLayout){var r=JSON.stringify(a.exportLayout(!0));i.set("myChartLayout"+(t.chartId||""),r)}}},e.ChartEngine.restoreLayout=function(t,e,a){var r=this.restoreDrawings;function n(){r(t,t.chart.symbol,a),e&&e()}a||(a=""),i.get("myChartLayout"+a,(function(e,i){e||(t.importLayout&&t.importLayout(JSON.parse(i),{managePeriodicity:!0,cb:n}),t.termStructure&&t.setCandleWidth(1))}))},e.ChartEngine.getSaveDrawings=function(t){return function(e){var a=e.stx,r=e.symbol;if(t.restore&&a.exportDrawings){var n=a.exportDrawings(),s=t.chartId?t.chartId+"~"+r:r;0===n.length?i.remove(s):i.set(s,JSON.stringify(n))}}},e.ChartEngine.restoreDrawings=function(t,a,r){e.Drawing&&i.get(r?r+"~"+a:a,(function(e,i){if(!e&&null!==i){var a=JSON.parse(i);a&&(t.importDrawings(a),t.draw())}}))},e.ChartEngine.getSavePreferences=function(t){return function(e){var a=e.stx;if(t.restore&&a.exportPreferences){var r=JSON.stringify(a.exportPreferences());i.set("myChartPreferences"+(t.chartId||""),r)}}},e.ChartEngine.restorePreferences=function(t,e){e||(e=""),i.get("myChartPreferences"+e,(function(e,i){e||i&&t.importPreferences&&t.importPreferences(JSON.parse(i))}))},e.ChartEngine.getRetoggleEvents=function(t){return function(i){var a=i.stx,r=document.getElementById(t.chartId);r||(r=(e.getFn("UI.getMyContext")(a.container)||{}).topNode),r||(r=document),r.querySelectorAll("".concat(t.selector.markersMenuItem,":not(.span-event).ciq-active")).forEach((function(t){t.dispatchEvent(new Event("stxtap"))}))}}},v=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ,i="undefined"!=typeof _timezoneJS?_timezoneJS:t.timezoneJS;e.ChartEngine.drawingTools={},e.ChartEngine.currentVectorParameters={vectorType:null,pattern:"solid",lineWidth:1,fillColor:"#7DA6F5",currentColor:"auto",axisLabel:!0,fibonacci:{trend:{color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},fibs:[{level:-.786,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:-.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:-.5,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:-.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:-.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:0,color:"auto",parameters:{pattern:"solid",lineWidth:1},display:!0},{level:.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.5,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.786,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:1,color:"auto",parameters:{pattern:"solid",lineWidth:1},display:!0},{level:1.272,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:1.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:1.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:2.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:4.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}}],extendLeft:!1,printLevels:!0,printValues:!1,timezone:{color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}}},annotation:{font:{style:null,size:null,weight:null,family:null}}},e.ChartEngine.registerDrawingTool=function(t,i){e.ChartEngine.drawingTools[t]=i},e.ChartEngine.prototype.setDrawingContainer=function(t){this.drawingContainer=t},e.ChartEngine.prototype.exportDrawings=function(){for(var t=[],e=0;e<this.drawingObjects.length;e++)t.push(this.drawingObjects[e].serialize());return t},e.ChartEngine.prototype.abortDrawings=function(t){!1!==t&&(t=!0);for(var e=this.drawingObjects.length-1;e>=0;e--){var i=this.drawingObjects[e];i.abort(!0),!t&&i.permanent||this.drawingObjects.splice(e,1)}},e.ChartEngine.prototype.importDrawings=function(t){if(e.Drawing)for(var i=0;i<t.length;i++){var a=t[i];"fibonacci"==a.name&&(a.name="retracement");var r=e.ChartEngine.drawingTools[a.name];if(r||e.Drawing[a.name]&&(r=e.Drawing[a.name],e.ChartEngine.registerDrawingTool(a.name,r)),r){var n=new r;n.reconstruct(this,a),this.drawingObjects.push(n)}}},e.ChartEngine.prototype.clearDrawings=function(t,i){!1!==i&&(i=!0);var a=this.exportDrawings();this.abortDrawings(i),t?this.undoStamps=[]:this.undoStamp(a,this.exportDrawings()),this.changeOccurred("vector"),this.cancelTouchSingleClick=!0,e.clearCanvas(this.chart.tempCanvas,this),this.draw();var r=this.controls.mSticky;r&&(r.style.display="none",r.children[0].innerHTML="")},e.ChartEngine.prototype.createDrawing=function(t,i){if(e.Drawing){var a=new e.Drawing[t];a.reconstruct(this,i);var r=new e.Drawing[t];for(var n in r.stx=this,r.copyConfig(),r)a[n]=a[n]||r[n];return this.drawingObjects.push(a),this.draw(),a}},e.ChartEngine.prototype.removeDrawing=function(t){for(var e=0;e<this.drawingObjects.length;e++)if(this.drawingObjects[e]==t)return this.drawingObjects.splice(e,1),this.changeOccurred("vector"),void this.draw()},e.ChartEngine.prototype.undo=function(){this.runPrepend("undo",arguments)||(this.activeDrawing&&(this.activeDrawing.abort(),this.activeDrawing.hidden=!1,this.drawingSnapshot=null,this.activateDrawing(null),e.clearCanvas(this.chart.tempCanvas,this),this.draw(),this.controls.crossX.classList.replace("stx_crosshair_drawing","stx_crosshair"),this.controls.crossY.classList.replace("stx_crosshair_drawing","stx_crosshair"),e.ChartEngine.drawingLine=!1),this.runAppend("undo",arguments))},e.ChartEngine.prototype.undoStamp=function(t,e){this.undoStamps.push(t),this.dispatch("undoStamp",{before:t,after:e,stx:this})},e.ChartEngine.prototype.undoLast=function(){this.activeDrawing?this.undo():this.undoStamps.length&&(this.drawingObjects=[],this.importDrawings(this.undoStamps.pop()),this.changeOccurred("vector"),this.draw())},e.ChartEngine.prototype.addDrawing=function(t){var e=this.exportDrawings();this.drawingObjects.push(t),this.undoStamp(e,this.exportDrawings())},e.ChartEngine.prototype.repositionDrawing=function(t,i){var a=this.panels[t.panelName],r=this.adjustIfNecessary(a,this.crosshairTick,this.valueFromPixel(this.backOutY(e.ChartEngine.crosshairY),a)),n=this.chart.tempCanvas;e.clearCanvas(n,this),i?(this.drawingSnapshot=this.exportDrawings(),t.render(n.context)):(t.reposition(n.context,t.repositioner,this.crosshairTick,r),this.drawingSnapshot&&this.undoStamp(e.shallowClone(this.drawingSnapshot),this.exportDrawings()),this.drawingSnapshot=null),t.measure&&t.measure()},e.ChartEngine.prototype.activateRepositioning=function(t){this.repositioningDrawing=t;t&&(this.draw(),this.repositionDrawing(t,!0)),this.chart.tempCanvas.style.display=t?"block":"none"},e.ChartEngine.prototype.activateDrawing=function(t,i){function a(t){if(t.layout.studies){var e=t.layout.studies[i.name];e&&!e.overlay&&delete t.overlays[e.name]}}if(i||(i=this.currentPanel),!t)return this.activeDrawing=null,this.chart.tempCanvas.style.display="none",a(this),!1;var r=e.ChartEngine.drawingTools[t];return r||e.Drawing[t]&&(r=e.Drawing[t],e.ChartEngine.registerDrawingTool(t,r)),r&&(this.activeDrawing=new r,this.activeDrawing.construct(this,i),!this.charts[i.name]&&this.activeDrawing.chartsOnly)?(this.activeDrawing=null,a(this),!1):(this.chart.tempCanvas.style.display="block",this.controls.drawOk&&(this.controls.drawOk.style.display="none"),a(this),!0)},e.ChartEngine.prototype.drawingClick=function(t,i,a){if(e.Drawing&&t&&""===this.openDialog&&(this.activeDrawing||this.activateDrawing(this.currentVectorParameters.vectorType,t))){if(this.activeDrawing){if(this.userPointerDown&&!this.activeDrawing.dragToDraw)return void(e.ChartEngine.drawingLine||this.activateDrawing(null));var r=this.tickFromPixel(i,t.chart),n=this.panels[this.activeDrawing.panelName],s=this.adjustIfNecessary(n,r,this.valueFromPixel(a,n));return this.magnetizedPrice&&(s=this.adjustIfNecessary(n,r,this.magnetizedPrice)),this.activeDrawing.click(this.chart.tempCanvas.context,r,s)?this.activeDrawing&&(e.ChartEngine.drawingLine=!1,e.clearCanvas(this.chart.tempCanvas,this),this.addDrawing(this.activeDrawing),this.activateDrawing(null),this.adjustDrawings(),this.draw(),this.changeOccurred("vector"),this.controls.crossX.classList.replace("stx_crosshair_drawing","stx_crosshair"),this.controls.crossY.classList.replace("stx_crosshair_drawing","stx_crosshair")):(this.changeOccurred("drawing"),e.ChartEngine.drawingLine=!0,this.controls.crossX.classList.replace("stx_crosshair","stx_crosshair_drawing"),this.controls.crossY.classList.replace("stx_crosshair","stx_crosshair_drawing")),!0}return!1}},e.ChartEngine.prototype.rightClickDrawing=function(t,e){if(!this.runPrepend("rightClickDrawing",arguments)&&!t.permanent){if(this.callbackListeners.drawingEdit.length)this.dispatch("drawingEdit",{stx:this,drawing:t,forceEdit:e});else{var i=t.abort();if(!i){var a=this.exportDrawings();this.removeDrawing(t),this.undoStamp(a,this.exportDrawings())}this.changeOccurred("vector")}this.runAppend("rightClickDrawing",arguments)}},e.ChartEngine.prototype.magnetize=function(){if(this.magnetizedPrice=null,this.preferences.magnet&&!this.runPrepend("magnetize",arguments)&&!this.repositioningDrawing){var t=this.currentVectorParameters.vectorType;if(t&&"projection"!=t&&"freeform"!=t&&("annotation"!=t&&"callout"!=t||!e.ChartEngine.drawingLine)){var i=this.currentPanel,a=i.chart,r=this.crosshairTick;if(!(r>a.dataSet.length)){var n=a.dataSet[r];if(n){var s,o=a.transformFunc&&i.yAxis===a.yAxis;o&&n.transform&&(n=n.transform);var l=this.getRenderedItems(),h=["Open","High","Low","Close"];this.magneticHold&&this.activeDrawing&&this.activeDrawing.penDown?l=-1!=h.indexOf(this.magneticHold)&&-1!=l.indexOf("High")?h:[this.magneticHold]:this.magneticHold=null;for(var c=1e9,u=parseFloat(this.preferences.magnet),d=0;d<l.length;d++){var p=n[l[d]],f=this.getYAxisByField(i,l[d]),m=e.existsInObjectChain(n,l[d]);if(m&&(p=m.obj[m.member]),p||0===p){var g=this.pixelFromTransformedValue(p,i,f);if(Math.abs(this.cy-g)<c){if(c=Math.abs(this.cy-g),u&&u<=c)continue;this.magnetizedPrice=o?this.valueFromPixel(g,i):p,s=g,this.magneticHold=l[d]}}}var v=this.pixelFromTick(r,a),y=s;e.clearCanvas(a.tempCanvas,this);var x=a.tempCanvas.context;x.beginPath(),x.lineWidth=1;var b=Math.max(this.layout.candleWidth,12)/3;x.arc(v,y,Math.min(b,8),0,2*Math.PI,!1),x.fillStyle="#398dff",x.strokeStyle="#398dff",x.fill(),x.stroke(),x.closePath(),a.tempCanvas.style.display="block",this.anyHighlighted&&this.container.classList.remove("stx-draggable"),this.activeDrawing&&this.activeDrawing.move(x,this.crosshairTick,this.magnetizedPrice),this.runAppend("magnetize",arguments)}}}}},e.ChartEngine.prototype.changeVectorType=function(t){this.currentVectorParameters.vectorType=t,e.Drawing&&e.Drawing.initializeSettings(this,t),e.ChartEngine.drawingLine&&this.undo(),this.insideChart&&this.doDisplayCrosshairs()},e.ChartEngine.prototype.changeVectorParameter=function(t,e){"axisLabel"==t?e="true"===e.toString()||Number(e):"lineWidth"==t?e=Number(e):"fontSize"==t&&(e=parseInt(e,10)+"px");var i=this.currentVectorParameters;return(void 0!==i[t]||"font"==t.substr(0,4)&&("family"==(t=t.substr(4).toLowerCase())&&"default"==e.toLowerCase()&&(e=null),void 0!==(i=i.annotation.font)[t]))&&(i[t]=e,!0)},e.ChartEngine.prototype.drawVectors=function(){if(!this.vectorsShowing&&!this.runPrepend("drawVectors",arguments)){if(this.vectorsShowing=!0,!this.chart.hideDrawings&&!this.highlightedDraggable){var t,e,i={};for(e=0;e<this.drawingObjects.length;e++){var a=this.drawingObjects[e];a.hidden||this.repositioningDrawing!==a&&(t=a.panelName,this.panels[a.panelName]&&!this.panels[a.panelName].hidden&&(i[t]||(i[t]=[]),i[t].push(a)))}for(t in i){this.startClip(t);var r=i[t];for(e=0;e<r.length;e++)r[e].render(this.chart.context);this.endClip()}}this.runAppend("drawVectors",arguments)}},e.ChartEngine.prototype.adjustDrawings=function(){for(var t=0;t<this.drawingObjects.length;t++){var e=this.drawingObjects[t];this.panels[e.panelName]&&e.adjust()}},e.Drawing=e.Drawing||function(){this.chartsOnly=!1,this.penDown=!1},e.Drawing.getDrawingParameters=function(t,i){var a;try{a=new e.Drawing[i]}catch(t){}if(!a)return null;a.stx=t,a.copyConfig(!0);for(var r={},n=a.configs,s=0;s<n.length;s++)r[n[s]]=a[n[s]];var o=t.canvasStyle("stx_annotation");return o&&r.font&&(r.font.size=o.fontSize,r.font.family=o.fontFamily,r.font.style=o.fontStyle,r.font.weight=o.fontWeight),r},e.Drawing.saveConfig=function(t,i){if(i){var a=t.preferences;a.drawings||(a.drawings={}),a.drawings[i]={};var r=new e.Drawing[i];r.stx=t,e.Drawing.copyConfig(r),r.configs.forEach((function(t){a.drawings[i][t]=r[t]})),t.changeOccurred("preferences")}},e.Drawing.restoreDefaultConfig=function(t,i,a){a?t.preferences.drawings=null:t.preferences.drawings[i]=null,t.changeOccurred("preferences"),t.currentVectorParameters=e.clone(e.ChartEngine.currentVectorParameters),t.currentVectorParameters.vectorType=i},e.Drawing.initializeSettings=function(t,i){var a=e.Drawing[i];if(a){var r=new a;r.initializeSettings&&r.initializeSettings(t)}},e.Drawing.updateSource=function(t,e,i,a){if(e){var r=!1;for(var n in t.drawingObjects){var s=t.drawingObjects[n];s.field&&(i?s.field==e?(s.field=i,r=!0):s.field.indexOf(e)>-1&&-1==s.field.indexOf(e+"-")&&(s.field=s.field.replace(e,i),r=!0):s.field.split("--\x3e")[0]!=e&&s.panelName!=e||(s.panelName=a,r=!0))}r&&t.changeOccurred("vector")}},e.Drawing.prototype.copyConfig=function(t){e.Drawing.copyConfig(this,t)},e.Drawing.copyConfig=function(t,i){var a,r,n=t.stx.currentVectorParameters,s=t.configs;for(a=0;a<s.length;a++)"color"==(r=s[a])?t.color=n.currentColor:"parameters"==r?t.parameters=e.clone(n.fibonacci):"font"==r?t.font=e.clone(n.annotation.font):t[r]=n[r];if(i){var o=t.stx.preferences;if(o&&o.drawings)for(e.extend(t,o.drawings[n.vectorType]),a=0;a<s.length;a++)"color"==(r=s[a])?n.currentColor=t.color:"parameters"==r?n.fibonacci=e.clone(t.parameters):"font"==r?n.annotation.font=e.clone(t.font):n[r]=t[r]}},e.Drawing.prototype.dragToDraw=!1,e.Drawing.prototype.permanent=!1,e.Drawing.prototype.chartsOnly=!1,e.Drawing.prototype.abort=function(t){},e.Drawing.prototype.measure=function(){},e.Drawing.prototype.construct=function(t,e){this.stx=t,this.panelName=e.name},e.Drawing.prototype.render=function(t){console.warn("must implement render function!")},e.Drawing.prototype.click=function(t,e,i){console.warn("must implement click function!")},e.Drawing.prototype.move=function(t,e,i){console.warn("must implement move function!")},e.Drawing.prototype.reposition=function(t,e,i,a){},e.Drawing.prototype.intersected=function(t,e,i){console.warn("must implement intersected function!")},e.Drawing.prototype.reconstruct=function(t,e){console.warn("must implement reconstruct function!")},e.Drawing.prototype.serialize=function(){console.warn("must implement serialize function!")},e.Drawing.prototype.adjust=function(){console.warn("must implement adjust function!")},e.Drawing.prototype.highlight=function(t){return(t&&!this.highlighted||!t&&this.highlighted)&&(this.highlighted=t),this.highlighted},e.Drawing.prototype.littleCircleRadius=function(){return 6},e.Drawing.prototype.littleCircle=function(t,i,a,r){if(!this.permanent){var n=this.stx.defaultColor,s=e.chooseForegroundColor(n);t.beginPath(),t.lineWidth=1,t.arc(i,a,this.littleCircleRadius(),0,2*Math.PI,!1),t.fillStyle=r?n:s,t.strokeStyle=n,t.setLineDash([]),t.fill(),t.stroke(),t.closePath()}},e.Drawing.prototype.rotator=function(t,e,i,a){if(!this.permanent){var r=this.littleCircleRadius(),n=this.stx.defaultColor;t.beginPath(),t.lineWidth=2,a||(t.globalAlpha=.5);var s=4+r;t.arc(e,i,s,0,3*Math.PI/2,!1),t.moveTo(e+2+s,i+2),t.lineTo(e+s,i),t.lineTo(e-2+s,i+2),t.moveTo(e-2,i+2-s),t.lineTo(e,i-s),t.lineTo(e-2,i-2-s),t.strokeStyle=n,t.stroke(),t.closePath(),t.globalAlpha=1}},e.Drawing.prototype.mover=function(t,e,i,a){if(!this.permanent){var r=this.littleCircleRadius(),n=this.stx.defaultColor,s=r+1;t.save(),t.lineWidth=2,t.strokeStyle=n,t.translate(e,i),a||(t.globalAlpha=.5);for(var o=0;o<4;o++)t.rotate(Math.PI/2),t.beginPath(),t.moveTo(0,s),t.lineTo(0,s+5),t.moveTo(-2,s+5-2),t.lineTo(0,s+5),t.lineTo(2,s+5-2),t.closePath(),t.stroke();t.globalAlpha=1,t.restore()}},e.Drawing.prototype.resizer=function(t,e,i,a){if(!this.permanent){var r=this.littleCircleRadius(),n=this.stx.defaultColor,s=5*Math.sqrt(2),o=r+1;t.save(),t.lineWidth=2,t.strokeStyle=n,t.translate(e,i),t.rotate(-e*i/Math.abs(e*i)*Math.PI/4),a||(t.globalAlpha=.5);for(var l=0;l<2;l++)t.rotate(Math.PI),t.beginPath(),t.moveTo(0,o),t.lineTo(0,o+s),t.moveTo(-2,o+s-2),t.lineTo(0,o+s),t.lineTo(2,o+s-2),t.closePath(),t.stroke();t.globalAlpha=1,t.restore()}},e.Drawing.prototype.pointIntersection=function(t,e,i,a){if(!this.stx.panels[this.panelName])return!1;if(a){if(t>=i.cx0&&t<=i.cx1&&e>=i.cy0&&e<=i.cy1)return!0}else if(t>=i.x0&&t<=i.x1&&e>=Math.min(i.y0,i.y1)&&e<=Math.max(i.y0,i.y1))return!0;return!1},e.Drawing.prototype.setPoint=function(t,i,a,r){var n,s=null,o=null;if("number"==typeof i?s=i:i.length>=8?o=i:s=Number(i),(a||0===a)&&(this["v"+t]=a),null!==s)n=this.stx.dateFromTick(s,r,!0),this["tzo"+t]=n.getTimezoneOffset(),this["d"+t]=e.yyyymmddhhmmssmmm(n),this["p"+t]=[s,a];else if(null!==o){n=e.strToDateTime(o),this["tzo"+t]||0===this["tzo"+t]||(this["tzo"+t]=n.getTimezoneOffset()),this["d"+t]=o;var l=this["tzo"+t]-n.getTimezoneOffset();n.setMinutes(n.getMinutes()+l);var h=!1;"freeform"==this.name||e.ChartEngine.isDailyInterval(this.stx.layout.interval)||n.getHours()||n.getMinutes()||n.getSeconds()||n.getMilliseconds()||(h=!0),this["p"+t]=[this.stx.tickFromDate(e.yyyymmddhhmmssmmm(n),r,null,h),a]}},e.Drawing.prototype.getLineColor=function(t){t||(t=this.color);var i=this.stx,a=t;if(this.highlighted)a=i.getCanvasColor("stx_highlight_vector");else if(e.isTransparent(a))a=i.defaultColor;else if("auto"==a&&(a=i.defaultColor,this.field)){var r,n;for(r in i.layout.studies){var s=i.layout.studies[r],o=s.outputs[s.outputMap[this.field]];if(o){a=o.color||o;break}}for(r in i.chart.seriesRenderers)for(var l=i.chart.seriesRenderers[r],h=0;h<l.seriesParams.length;h++){var c=l.seriesParams[h],u=c.field;if(u||l.highLowBars||(u=this.defaultPlotField||"Close"),c.symbol&&c.subField&&(u+="--\x3e"+c.subField),this.field==u){a=c.color;break}c.field&&c.field==this.field.split("--\x3e")[0]&&(n=c.color)}n&&(a=n)}return"auto"==a&&(a=i.defaultColor),a},e.Drawing.BaseTwoPoint=function(){this.p0=null,this.p1=null,this.color=""},e.inheritsFrom(e.Drawing.BaseTwoPoint,e.Drawing),e.Drawing.BaseTwoPoint.prototype.configs=[],e.Drawing.BaseTwoPoint.prototype.lineIntersection=function(t,i,a,r,n,s,o){n||(n=this.p0),s||(s=this.p1);var l=this.stx;if(!n||!s)return!1;var h=e.convertBoxToPixels(l,this.panelName,a);if(void 0===h.x0)return!1;var c={x0:n[0],x1:s[0],y0:n[1],y1:s[1]};return o||(c=e.convertBoxToPixels(l,this.panelName,c)),e.boxIntersects(h.x0,h.y0,h.x1,h.y1,c.x0,c.y0,c.x1,c.y1,r)},e.Drawing.BaseTwoPoint.prototype.boxIntersection=function(t,e,i){return!(!this.p0||!this.p1)&&(!(i.x0>Math.max(this.p0[0],this.p1[0])||i.x1<Math.min(this.p0[0],this.p1[0]))&&!(i.y1>Math.max(this.p0[1],this.p1[1])||i.y0<Math.min(this.p0[1],this.p1[1])))},e.Drawing.BaseTwoPoint.prototype.accidentalClick=function(t,e){var i=this.stx.panels[this.panelName],a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(t,i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,t,e),o=Math.abs(r-a),l=Math.abs(s-n);if(Math.sqrt(o*o+l*l)<10)return this.penDown=!1,this.dragToDraw&&this.stx.undo(),!0},e.Drawing.BaseTwoPoint.prototype.click=function(t,e,i){this.copyConfig();var a=this.stx.panels[this.panelName];return this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,a.chart),this.penDown=!1,!0):(this.setPoint(0,e,i,a.chart),this.penDown=!0,!1)},e.Drawing.BaseTwoPoint.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart))},e.Drawing.BaseTwoPoint.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),this.p1=[e,i],this.render(t))},e.Drawing.BaseTwoPoint.prototype.measure=function(){if(this.p0&&this.p1){this.stx.setMeasure(this.p0[1],this.p1[1],this.p0[0],this.p1[0],!0,this.name);var t=this.stx.controls.mSticky,i=t&&t.querySelector(".mStickyInterior");if(i){var a=[];a.push(e.capitalize(this.name)),this.getYValue&&a.push(this.field||this.stx.defaultPlotField||"Close"),a.push(i.innerHTML),i.innerHTML=a.join("<br>")}}},e.Drawing.BaseTwoPoint.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i,s=e.value-a;"move"==e.action?(this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.setPoint(1,e.p1[0]-n,e.p1[1]-s,r.chart),this.render(t)):"drag"==e.action&&(this[e.point]=[i,a],this.setPoint(0,this.p0[0],this.p0[1],r.chart),this.setPoint(1,this.p1[0],this.p1[1],r.chart),this.render(t))}},e.Drawing.BaseTwoPoint.prototype.drawDropZone=function(t,e,i,a,r){var n=this.stx.panels[this.panelName];if(n){var s=n.left,o=n.width;(a||0===a)&&(s=this.stx.pixelFromTick(a,n.chart)),(r||0===r)&&(o=this.stx.pixelFromTick(r,n.chart));var l=this.stx.pixelFromPrice(e,n),h=this.stx.pixelFromPrice(i,n);t.fillStyle="#008000",t.globalAlpha=.2,t.fillRect(s,l,o-s,h-l),t.globalAlpha=1}},e.Drawing.annotation=function(){this.name="annotation",this.arr=[],this.w=0,this.h=0,this.padding=4,this.text="",this.ta=null,this.fontSize=0,this.font={}},e.inheritsFrom(e.Drawing.annotation,e.Drawing.BaseTwoPoint),e.Drawing.annotation.prototype.getFontString=function(){this.fontDef={style:null,weight:null,size:"12px",family:null};var t=this.stx.canvasStyle("stx_annotation");t&&(t.fontStyle&&(this.fontDef.style=t.fontStyle),t.fontWeight&&(this.fontDef.weight=t.fontWeight),t.fontSize&&(this.fontDef.size=t.fontSize),t.fontFamily&&(this.fontDef.family=t.fontFamily)),this.font.style&&(this.fontDef.style=this.font.style),this.font.weight&&(this.fontDef.weight=this.font.weight),this.font.size&&(this.fontDef.size=this.font.size),this.font.family&&(this.fontDef.family=this.font.family),this.fontString="";var e=!0;for(var i in this.fontDef)this.fontDef[i]&&(e?e=!1:this.fontString+=" ",this.fontString+=this.fontDef[i])},e.Drawing.annotation.prototype.configs=["color","font"],e.Drawing.annotation.prototype.measure=function(){},e.Drawing.annotation.prototype.render=function(t){if(!this.ta){var e=this.stx.panels[this.panelName];if(e){var i=this.stx.pixelFromTick(this.p0[0],e.chart),a=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]);t.font=this.fontString,t.textBaseline="middle";var r,n,s,o,l=i,h=a,c=this.w,u=this.h,d=this.getLineColor();if(this.stem)this.stem.d?(r=this.stx.pixelFromTick(this.stem.t),s=this.stx.pixelFromValueAdjusted(e,this.stem.t,this.stem.v),n=l+c/2,o=h+u/2):this.stem.x&&(r=l,s=h,n=(l+=this.stem.x)+c/2,o=(h+=this.stem.y)+u/2),t.beginPath(),this.borderColor?t.strokeStyle=this.borderColor:t.strokeStyle=d,t.moveTo(r,s),t.lineTo(n,o),t.stroke();var p=t.lineWidth;if(this.highlighted?(this.stx.canvasColor("stx_annotation_highlight_bg",t),t.fillRect(l-p,h-u/2-p,c+2*p,u+2*p)):this.fillColor?(t.fillStyle=this.fillColor,t.fillRect(l,h-u/2,c,u)):this.stem&&(t.fillStyle=this.stx.containerColor,t.fillRect(l,h-u/2,c,u)),this.borderColor&&(t.beginPath(),t.strokeStyle=this.highlighted?this.stx.getCanvasColor("stx_highlight_vector"):this.borderColor,t.rect(l-p,h-u/2-p,c+2*p,u+2*p),t.stroke()),this.highlighted?this.stx.canvasColor("stx_annotation_highlight",t):t.fillStyle=d,h+=this.padding/2,!this.ta)for(var f=0;f<this.arr.length;f++)t.fillText(this.arr[f],l+this.padding,h-u/2+this.fontSize/2),h+=this.fontSize+2;t.textBaseline="alphabetic"}}},e.Drawing.annotation.prototype.onChange=function(t){},e.Drawing.annotation.prototype.edit=function(t,i){var a=this.stx.panels[this.panelName];if(a){var r=this.stx.controls.annotationSave,n=this.stx.controls.annotationCancel;if(r&&n){var s=this.stx,o=this.ta;s.editingAnnotation=!0,s.undisplayCrosshairs(),s.openDialog="annotation",o||((o=this.ta=document.createElement("TEXTAREA")).className="stx_annotation",o.onkeyup=f(this),o.onmouseup=function(t){return function(i){t.manageTouchAndMouse&&e.ChartEngine.drawingLine&&t.mouseup(i)}}(s),o.setAttribute("wrap","hard"),e.isIOS7or8&&o.setAttribute("placeholder","Enter Text"),s.chart.container.appendChild(o),o.style.position="absolute",o.style.width="100px",o.style.height="20px",o.value=this.text,e.touchDevice&&(o.ontouchstart=function(t){t.stopPropagation()}));var l=this;if(o.oninput=function(t){"historyUndo"!=t.inputType&&"historyRedo"!=t.inputType&&l.onChange(t)},o.style.font=this.fontString,this.color)if("transparent"==this.color||"auto"==this.color){var h=getComputedStyle(o);h&&e.isTransparent(h.backgroundColor)?o.style.color=s.defaultColor:o.style.color="#000"}else o.style.color=this.color;var c=s.pixelFromTick(this.p0[0],a.chart),u=s.pixelFromValueAdjusted(a,this.p0[0],this.p0[1]);if(o.style.left=c+140<s.chart.canvasRight?c+"px":s.chart.canvasRight-200+"px",o.style.top=u+60<s.chart.canvasHeight?u-(isNaN(this.h)?this.defaultHeight:this.h/2)+"px":u-60+"px","callout"==this.name&&(o.style.left=e.stripPX(o.style.left)-(isNaN(this.w)?this.defaultWidth:this.w/2)+"px"),e.safeClickTouch(r,function(t){return function(i){if(""!==t.ta.value){t.text=t.ta.value;var a=t.stx;a.editingAnnotation=!1,t.adjust(),a.drawingSnapshot?a.undoStamp(e.shallowClone(a.drawingSnapshot),a.exportDrawings()):a.addDrawing(t),a.undo(),a.cancelTouchSingleClick=!0,a.changeOccurred("vector")}}}(this)),e.safeClickTouch(n,function(t){return function(e){var i=t.stx;i.editingAnnotation=!1,i.undo(),i.cancelTouchSingleClick=!0}}(this)),f(this)(),r.style.display="inline-block",n.style.display="inline-block",i&&(s.drawingSnapshot=s.exportDrawings(),this.hidden=!0,s.draw(),s.activeDrawing=this,e.ChartEngine.drawingLine=!0,t=s.chart.tempCanvas.context,s.chart.tempCanvas.style.display="block",this.w=o.clientWidth,this.h=o.clientHeight,e.clearCanvas(t.canvas,s),this.render(t),this.edit(t)),o.focus(),e.isAndroid&&!e.is_chrome&&!e.isFF){this.priorBottom=s.chart.container.style.bottom;var d=s.resolveY(u)+100;if(d>e.pageHeight()-400){var p=400-(e.pageHeight()-d);s.chart.container.style.bottom=p+"px"}}}}function f(t){return function(i){if(i)switch(i.keyCode){case 27:return void t.stx.undo()}var a=t.stx,s=t.ta,o=s.value.split("\n"),l=0;a.chart.context.font=t.fontString;for(var h=0;h<o.length;h++){var c=a.chart.context.measureText(o[h]).width;c>l&&(l=c)}var u=(o.length+1)*(t.fontSize+3);l<50&&(l=50),s.style.width=l+30+"px",s.style.height=u+"px";var d=parseInt(e.stripPX(s.style.top),10),p=e.stripPX(s.style.left);l=s.clientWidth,u=s.clientHeight,p+l+100<t.stx.chart.canvasWidth?(r.style.top=d+"px",n.style.top=d+"px",r.style.left=p+l+10+"px",n.style.left=p+l+60+"px"):d+u+30<t.stx.chart.canvasHeight?(r.style.top=d+u+10+"px",n.style.top=d+u+10+"px",r.style.left=p+"px",n.style.left=p+50+"px"):(r.style.top=d-35+"px",n.style.top=d-35+"px",r.style.left=p+"px",n.style.left=p+50+"px")}}},e.Drawing.annotation.prototype.click=function(t,e,i){if(!this.stx.overXAxis&&!this.stx.overYAxis){var a=this.stx.panels[this.panelName];return this.copyConfig(),this.setPoint(0,e,i,a.chart),this.adjust(),this.edit(t),!1}},e.Drawing.annotation.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName],n=e.tick-i,s=e.value-a;this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.render(t)}},e.Drawing.annotation.prototype.intersected=function(t,i,a){var r=this.stx.panels[this.panelName];if(!this.p0)return null;var n=this.stx.pixelFromTick(this.p0[0],r.chart),s=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1])-this.h/2,o=n+this.w,l=s+this.h;this.stem&&this.stem.x&&(n+=this.stem.x,o+=this.stem.x,s+=this.stem.y,l+=this.stem.y);var h=this.stx.pixelFromTick(t,r.chart),c=this.stx.pixelFromValueAdjusted(r,t,i);return h+a.r>=n&&h-a.r<=o&&c+a.r>=s&&c-a.r<=l&&(this.highlighted=!0,{p0:e.clone(this.p0),tick:t,value:i})},e.Drawing.annotation.prototype.abort=function(){var t=this.stx.controls.annotationSave,i=this.stx.controls.annotationCancel;t&&(t.style.display="none"),i&&(i.style.display="none"),this.ta&&this.stx.chart.container.removeChild(this.ta),this.ta=null,this.stx.openDialog="",this.stx.showCrosshairs(),this.stx.editingAnnotation=!1,e.clearCanvas(this.stx.chart.tempCanvas,this.stx),!e.isAndroid||e.is_chrome||e.isFF||(this.stx.chart.container.style.bottom=this.priorBottom),e.fixScreen()},e.Drawing.annotation.prototype.reconstruct=function(t,i){this.stx=t,this.color=i.col,this.panelName=i.pnl,this.d0=i.d0,this.tzo0=i.tzo0,this.v0=i.v0,this.text=t.escapeOnSerialize?decodeURIComponent(i.text):i.text,this.stem=i.stem,this.borderColor=i.bc,this.fillColor=i.bg,this.lineWidth=i.lw,this.pattern=i.ptrn,this.font=e.replaceFields(i.fnt,{st:"style",sz:"size",wt:"weight",fl:"family"}),this.font||(this.font={}),this.adjust()},e.Drawing.annotation.prototype.serialize=function(){var t={name:this.name,pnl:this.panelName,col:this.color,d0:this.d0,tzo0:this.tzo0,v0:this.v0,text:this.stx.escapeOnSerialize?encodeURIComponent(this.text):this.text};if(this.font){var i=e.removeNullValues(e.replaceFields(this.font,{style:"st",size:"sz",weight:"wt",family:"fl"}));e.isEmpty(i)||(t.fnt=i)}return this.stem&&(t.stem={d:this.stem.d,v:this.stem.v,x:this.stem.x,y:this.stem.y}),this.borderColor&&(t.bc=this.borderColor),this.fillColor&&(t.bg=this.fillColor),this.lineWidth&&(t.lw=this.lineWidth),this.pattern&&(t.ptrn=this.pattern),t},e.Drawing.annotation.prototype.renderText=function(){this.getFontString();var t=this.stx.panels[this.panelName];if(t){this.arr=this.text.split("\n");var i=0;this.stx.chart.context.font=this.fontString;for(var a=0;a<this.arr.length;a++){var r=this.stx.chart.context.measureText(this.arr[a]).width;r>i&&(i=r)}0===i&&(i=2*this.defaultWidth),this.fontSize=e.stripPX(this.fontDef.size);var n=this.arr.length*(this.fontSize+2);e.touchDevice&&(n+=5),this.w=i+2*this.padding,this.h=n+2*this.padding;var s=this.stx.pixelFromTick(this.p0[0],t.chart)+i,o=this.stx.pixelFromValueAdjusted(t,this.p0[0],this.p0[1])+n;this.p1=[this.stx.tickFromPixel(s,t.chart),this.stx.valueFromPixel(o,t)],this.stem&&this.stem.d&&(this.stem.t=this.stx.tickFromDate(this.stem.d,t.chart))}},e.Drawing.annotation.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.renderText())},e.Drawing.segment=function(){this.name="segment"},e.inheritsFrom(e.Drawing.segment,e.Drawing.BaseTwoPoint),e.Drawing.segment.prototype.render=function(t){var a=this.stx.panels[this.panelName];if(a){var r=this.stx.pixelFromTick(this.p0[0],a.chart),n=this.stx.pixelFromTick(this.p1[0],a.chart),s=this.stx.pixelFromValueAdjusted(a,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(a,this.p1[0],this.p1[1]),l=this.lineWidth,h=this.getLineColor(),c={pattern:this.pattern,lineWidth:l};if("none"==c.pattern&&(c.pattern="solid"),this.stx.plotLine(r,n,s,o,h,this.name,t,a,c),this.axisLabel&&!this.repositioner)if("horizontal"==this.name){this.stx.endClip();var u=this.p0[1];a.chart.transformFunc&&(u=a.chart.transformFunc(this.stx,a.chart,u)),u=a.yAxis.priceFormatter?a.yAxis.priceFormatter(this.stx,a,u):this.stx.formatYAxisPrice(u,a),this.stx.createYAxisLabel(a,u,s,h),this.stx.startClip(a.name)}else if("vertical"==this.name&&this.p0[0]>=0&&!this.stx.chart.xAxis.noDraw){var d,p;if(d=this.stx.dateFromTick(this.p0[0],a.chart,!0),e.ChartEngine.isDailyInterval(this.stx.layout.interval))d.setHours(0,0,0,0);else{var f=1e3*d.getSeconds()+d.getMilliseconds();i.Date&&this.stx.displayZone&&(p=new i.Date(d.getTime(),this.stx.displayZone),d=new Date(p.getFullYear(),p.getMonth(),p.getDate(),p.getHours(),p.getMinutes()),d=new Date(d.getTime()+f))}var m=e.mmddhhmm(e.yyyymmddhhmm(d));if(a.chart.xAxis.formatter)m=a.chart.xAxis.formatter(d,this.name,null,null,m);else if(this.stx.internationalizer){var g;0!==d.getHours()||0!==d.getMinutes()?(g=this.stx.internationalizer.monthDay.format(d),g+=" "+this.stx.internationalizer.hourMinute.format(d)):g=this.stx.internationalizer.yearMonthDay.format(d),m=g}this.stx.endClip(),this.stx.createXAxisLabel(a,m,r,h,null,!0),this.stx.startClip(a.name)}if(this.highlighted&&"horizontal"!=this.name&&"vertical"!=this.name){var v="p0"==this.highlighted,y="p1"==this.highlighted;this.littleCircle(t,r,s,v),this.littleCircle(t,n,o,y)}}},e.Drawing.segment.prototype.abort=function(){this.stx.setMeasure(null,null,null,null,!1)},e.Drawing.segment.prototype.intersected=function(t,i,a){if(!this.p0||!this.p1)return null;var r=this.name;if("horizontal"!=r&&"vertical"!=r&&"gartley"!=r){var n={0:this.p0,1:this.p1};for(var s in n)if(this.pointIntersection(n[s][0],n[s][1],a))return this.highlighted="p"+s,{action:"drag",point:"p"+s}}return"horizontal"!=r&&"vertical"!=r||(r="line"),this.lineIntersection(t,i,a,r)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},e.Drawing.segment.prototype.configs=["color","lineWidth","pattern"],e.Drawing.segment.prototype.copyConfig=function(t){e.Drawing.copyConfig(this,t),"none"==this.pattern&&-1==this.configs.indexOf("fillColor")&&(this.pattern="solid")},e.Drawing.segment.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.segment.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.line=function(){this.name="line"},e.inheritsFrom(e.Drawing.line,e.Drawing.segment),e.Drawing.line.prototype.dragToDraw=!1,e.Drawing.line.prototype.calculateOuterSet=function(t){if(this.p0[0]!=this.p1[0]&&this.p0[1]!=this.p1[1]&&!e.ChartEngine.isDailyInterval(this.stx.layout.interval)){var i={x0:this.p0[0],y0:this.p0[1],x1:this.p1[0],y1:this.p1[1]};i.x0>i.x1&&(i={x0:this.p1[0],y0:this.p1[1],x1:this.p0[0],y1:this.p0[1]});var a=i.x0-1e3,r=i.x1+1e3;this.v0B=e.yIntersection(i,a),this.v1B=e.yIntersection(i,r),this.d0B=this.stx.dateFromTick(a,t.chart),this.d1B=this.stx.dateFromTick(r,t.chart)}},e.Drawing.line.prototype.click=function(t,e,i){var a=this.stx.panels[this.panelName];if(a)return this.copyConfig(),this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,a.chart),this.calculateOuterSet(a),this.penDown=!1,!0):(this.setPoint(0,e,i,a.chart),this.penDown=!0,!1)},e.Drawing.line.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.v0=e.v0,this.v1=e.v1,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,e.d0B&&(this.d0B=e.d0B,this.d1B=e.d1B,this.v0B=e.v0B,this.v1B=e.v1B),this.adjust()},e.Drawing.line.prototype.serialize=function(){var t={name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1};return this.d0B&&(t.d0B=this.d0B,t.d1B=this.d1B,t.v0B=this.v0B,t.v1B=this.v1B),t},e.Drawing.line.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),e.ChartEngine.isDailyInterval(this.stx.layout.interval)&&this.d0B&&(this.setPoint(0,this.d0B,this.v0B,t.chart),this.setPoint(1,this.d1B,this.v1B,t.chart)))},e.Drawing.horizontal=function(){this.name="horizontal"},e.inheritsFrom(e.Drawing.horizontal,e.Drawing.segment),e.Drawing.horizontal.prototype.dragToDraw=!1,e.Drawing.horizontal.prototype.measure=function(){},e.Drawing.horizontal.prototype.click=function(t,e,i){var a=this.stx.panels[this.panelName];if(a)return this.copyConfig(),this.setPoint(0,e,i,a.chart),!0},e.Drawing.horizontal.prototype.intersected=function(t,e,i){if(this.lineIntersection(t,e,i,"line")){var a=this.stx.chart.dataSet.length,r=this.p0[1];return this.highlighted=!0,{action:"move",p0:[a-2,r],p1:[a-1,r],tick:t,value:e}}return null},e.Drawing.horizontal.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.v0=e.v0,this.d0=e.d0,this.tzo0=e.tzo0,this.axisLabel=e.al,this.adjust()},e.Drawing.horizontal.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,v0:this.v0,d0:this.d0,tzo0:this.tzo0,al:this.axisLabel}},e.Drawing.horizontal.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=[this.p0[0]+100,this.p0[1]])},e.Drawing.horizontal.prototype.configs=["color","lineWidth","pattern","axisLabel"],e.Drawing.vertical=function(){this.name="vertical"},e.inheritsFrom(e.Drawing.vertical,e.Drawing.horizontal),e.Drawing.vertical.prototype.measure=function(){},e.Drawing.vertical.prototype.intersected=e.Drawing.segment.prototype.intersected,e.Drawing.vertical.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=[this.p0[0],this.p0[1]+1])},e.Drawing.measure=function(){this.name="measure"},e.inheritsFrom(e.Drawing.measure,e.Drawing.segment),e.Drawing.measure.prototype.click=function(t,e,i){return this.copyConfig(),this.penDown?(this.stx.undo(),this.penDown=!1,!0):(this.p0=[e,i],this.penDown=!0,!1)},e.Drawing.rectangle=function(){this.name="rectangle"},e.inheritsFrom(e.Drawing.rectangle,e.Drawing.BaseTwoPoint),e.Drawing.rectangle.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromTick(this.p1[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=Math.round(Math.min(a,r))+.5,l=Math.min(n,s),h=Math.max(a,r)-o,c=Math.max(n,s)-l,u=this.color;this.highlighted&&(u=this.stx.getCanvasColor("stx_highlight_vector"));var d=this.fillColor;d&&!e.isTransparent(d)&&"auto"!=d&&(t.beginPath(),t.rect(o,l,h,c),t.fillStyle=d,t.globalAlpha=.2,t.fill(),t.closePath(),t.globalAlpha=1);var p={pattern:this.pattern,lineWidth:this.lineWidth};if(this.highlighted&&"none"==p.pattern&&(p.pattern="solid",.1==p.lineWidth&&(p.lineWidth=1)),this.stx.plotLine(a,r,n,n,u,"segment",t,i,p),this.stx.plotLine(r,r,n-.5,s+.5,u,"segment",t,i,p),this.stx.plotLine(r,a,s,s,u,"segment",t,i,p),this.stx.plotLine(a,a,s+.5,n-.5,u,"segment",t,i,p),this.highlighted){var f="p0"==this.highlighted,m="p1"==this.highlighted;this.littleCircle(t,a,n,f),this.littleCircle(t,r,s,m)}}},e.Drawing.rectangle.prototype.intersected=function(t,i,a){if(!this.p0||!this.p1)return null;var r={0:this.p0,1:this.p1};for(var n in r)if(this.pointIntersection(r[n][0],r[n][1],a))return this.highlighted="p"+n,{action:"drag",point:"p"+n};return this.boxIntersection(t,i,a)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},e.Drawing.rectangle.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.rectangle.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.rectangle.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.shape=function(){this.name="shape",this.radians=0,this.a=0,this.rotating=!1,this.textMeasure=!1,this.configurator="shape",this.dimension=[0,0],this.points=[]},e.inheritsFrom(e.Drawing.shape,e.Drawing.BaseTwoPoint),e.Drawing.shape.prototype.setRotationOnInitialDraw=!1,e.Drawing.shape.prototype.measure=function(){},e.Drawing.shape.prototype.render=function(t){if(this.points.length){var i=this.stx.panels[this.panelName];if(i){var a=this.stx.pixelFromTick(this.p0[0],i.chart),r=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]);if(this.p1){var n=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);t.globalAlpha=.5,t.fillStyle="#000000",this.rotating?(this.radians=Math.atan((s-r)/(n-a)),n<a?this.radians+=Math.PI:s<r&&(this.radians+=2*Math.PI),this.a=5*parseInt((36*this.radians/Math.PI).toFixed(0),10),this.a%=360,this.radians=this.a*Math.PI/180,this.textMeasure&&t.fillText(this.a+"°",n+10,s+10)):this.penDown&&(this.sx=Math.max(1,parseFloat(Math.abs(2*(n-a)/this.dimension[0]).toFixed(1))),n<a&&(this.sx*=-1),this.sy=Math.max(1,parseFloat(Math.abs(2*(s-r)/this.dimension[1]).toFixed(1))),s<r&&(this.sy*=-1),this.textMeasure&&t.fillText(this.sx+"x,"+this.sy+"x",n+this.sx+5,s+this.sy+5)),t.globalAlpha=1}var o=this.lineWidth;o||(o=1.1);var l={pattern:this.pattern,lineWidth:o};this.highlighted&&"none"==l.pattern&&(l.pattern="solid",.1==l.lineWidth&&(l.lineWidth=1));var h=this.color;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),this.highlighted&&(h=this.stx.getCanvasColor("stx_highlight_vector"),.1==o&&(o=1.1));var c,u,d=this.fillColor;o/=2*Math.abs(this.sx*this.sy)/(Math.abs(this.sx)+Math.abs(this.sy)),t.save(),t.translate(a,r),t.rotate(this.radians),t.scale(this.sx,i.yAxis.flipped?-this.sy:this.sy);var p=(this.dimension[0]-1)/2,f=(this.dimension[1]-1)/2;for(c=0;c<this.points.length;c++){for(t.beginPath(),u=0;u<this.points[c].length;u++){var m,g,v,y,x,b;"M"==this.points[c][u]?(m=this.points[c][++u]-p,g=this.points[c][++u]-f,t.moveTo(m,g)):"L"==this.points[c][u]?(m=this.points[c][++u]-p,g=this.points[c][++u]-f,t.lineTo(m,g)):"Q"==this.points[c][u]?(v=this.points[c][++u]-p,x=this.points[c][++u]-f,m=this.points[c][++u]-p,g=this.points[c][++u]-f,t.quadraticCurveTo(v,x,m,g)):"B"==this.points[c][u]&&(v=this.points[c][++u]-p,x=this.points[c][++u]-f,y=this.points[c][++u]-p,b=this.points[c][++u]-f,m=this.points[c][++u]-p,g=this.points[c][++u]-f,t.bezierCurveTo(v,x,y,b,m,g))}t.closePath(),d&&!e.isTransparent(d)&&"auto"!=d&&(t.fillStyle=d,t.fill()),h&&"none"!=this.pattern&&(t.strokeStyle=h,t.lineWidth=o,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(o,this.pattern)),t.lineDashOffset=0),t.stroke())}if(t.restore(),t.save(),t.translate(a,r),t.rotate(this.radians),this.highlighted){var S="p0"==this.highlighted,C="p1"==this.highlighted,w="p2"==this.highlighted;this.littleCircle(t,0,0,S),this.mover(t,0,0,S),this.littleCircle(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,C),this.resizer(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,C),this.littleCircle(t,this.sx*this.dimension[0]/2,0,w),this.rotator(t,this.sx*this.dimension[0]/2,0,w),t.globalAlpha=.5,t.fillStyle="#000000",this.textMeasure&&(t.fillText(this.sx+"x,"+this.sy+"x",this.sx*this.dimension[0]/2+12,this.sy*this.dimension[1]/2+5),t.fillText(this.a+"°",this.sx*this.dimension[0]/2+12,5)),t.globalAlpha=1}else this.penDown&&(this.rotating?this.rotator(t,this.sx*this.dimension[0]/2,0,!0):this.resizer(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,!0));t.restore()}}},e.Drawing.shape.prototype.reposition=function(t,e,i,a){if(e){var r=this.stx.panels[this.panelName];if("move"==e.action){var n=e.tick-i,s=e.value-a;this.setPoint(0,e.p0[0]-n,e.p0[1]-s,r.chart),this.render(t)}else{var o=this.stx.pixelFromTick(this.p0[0],r.chart),l=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]),h=this.stx.pixelFromTick(i,r.chart),c=this.stx.pixelFromValueAdjusted(r,i,a);"scale"==e.action?(this[e.point]=[i,a],this.sx=parseFloat((((h-o)*Math.cos(this.radians)+(c-l)*Math.sin(this.radians))/(this.dimension[0]/2)).toFixed(1)),Math.abs(this.sx)<1&&(this.sx/=Math.abs(this.sy)),this.sy=parseFloat((((c-l)*Math.cos(this.radians)-(h-o)*Math.sin(this.radians))/(this.dimension[1]/2)).toFixed(1)),Math.abs(this.sy)<1&&(this.sy/=Math.abs(this.sy)),this.render(t)):"rotate"==e.action&&(this[e.point]=[i,a],this.radians=Math.atan((c-l)/(h-o)),h<o?this.radians+=Math.PI:c<l&&(this.radians+=2*Math.PI),this.a=5*parseInt((36*this.radians/Math.PI).toFixed(0),10),this.sx<0&&(this.a=this.a+180),this.a%=360,this.radians=this.a*Math.PI/180,this.render(t))}}},e.Drawing.shape.prototype.intersected=function(t,i,a){if(!this.p0)return null;if(this.stx.repositioningDrawing==this&&this.stx.repositioningDrawing.repositioner)return this.stx.repositioningDrawing.repositioner;var r=this.stx.panels[this.panelName],n=this.stx.pixelFromTick(this.p0[0],r.chart),s=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]),o=this.stx.pixelFromTick(t,r.chart),l=this.stx.pixelFromValueAdjusted(r,t,i),h=l-=s,c=o-=n;o=Math.cos(this.radians)*c+Math.sin(this.radians)*h,l=Math.cos(this.radians)*h-Math.sin(this.radians)*c,o/=this.sx,l/=this.sy,this.padding=e.ensureDefaults(this.padding||{},{left:0,right:0,top:0,bottom:0});var u=this.padding.right+this.padding.left,d=this.padding.bottom+this.padding.top,p=Math.pow(e.touchDevice?25:5+this.littleCircleRadius(),2),f=Math.abs(p/(this.sx*this.sy)),m=Math.pow((this.dimension[0]-u)/2,2)+Math.pow((this.dimension[1]-d)/2,2)>Math.pow(o-u/2,2)+Math.pow(l-d/2,2),g=(p-(Math.pow(o*this.sx,2)+Math.pow(l*this.sy,2)))/Math.abs(this.sx*this.sy),v=f-Math.pow(o-this.dimension[0]/2,2)-Math.pow(l-this.dimension[1]/2,2),y=f-Math.pow(o-this.dimension[0]/2,2)-Math.pow(l,2);return m?v>=y&&v>=g?(this.highlighted="p1",{action:"scale"}):y>=v&&y>=g?(this.highlighted="p2",{action:"rotate"}):(this.highlighted="p0",{action:"move",p0:e.clone(this.p0),tick:t,value:i}):null},e.Drawing.shape.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.shape.prototype.littleCircleRadius=function(){return 3},e.Drawing.shape.prototype.click=function(t,e,i){if(!this.points.length)return!1;this.copyConfig();var a=this.stx.panels[this.panelName];return this.penDown?(this.setPoint(1,e,i,a.chart),this.rotating||!this.setRotationOnInitialDraw?(this.penDown=!1,this.rotating=!1,!0):(this.rotating=!0,!1)):(this.setPoint(0,e,i,a.chart),this.penDown=!0,!1)},e.Drawing.shape.prototype.adjust=function(){var t=this.stx.panels[this.panelName];if(t){var i=this.name+"_v"+(this.version||0);if(e.Drawing[i]){var a=new e.Drawing[i];this.name=a.name,this.dimension=a.dimension,this.padding=a.padding,this.points=a.points,this.version=a.version}this.setPoint(0,this.d0,this.v0,t.chart),this.radians=Math.round(this.a/5)*Math.PI/36}},e.Drawing.shape.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.v0=e.v0,this.tzo0=e.tzo0,this.a=e.a,this.sx=e.sx,this.sy=e.sy,this.version=e.ver,this.adjust()},e.Drawing.shape.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,v0:this.v0,tzo0:this.tzo0,a:this.a,sx:this.sx,sy:this.sy,ver:this.version}},e.Drawing.arrow=function(){this.name="arrow",this.version=1,this.dimension=[11,22],this.padding={left:0,right:0,top:11,bottom:0},this.points=[["M",3,21,"L",7,21,"L",7,16,"L",10,16,"L",5,11,"L",0,16,"L",3,16,"L",3,21]]},e.inheritsFrom(e.Drawing.arrow,e.Drawing.shape),e.Drawing.getDrawingToolList=function(t){var i={},a={arrow_v0:!0,BaseTwoPoint:!0,fibonacci:!0,shape:!0};for(var r in e.extend(a,t),e.Drawing)!a[r]&&e.Drawing[r].prototype.render&&(i[(new e.Drawing[r]).name]=r);return i}},y=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.EaseMachine=function(t,e,i,a){this.fc=t,this.ms=e,(i||0===i)&&this.reset(i,a)},e.EaseMachine.prototype.reset=function(t,e){for(var i in t||0===t||(t=this.currentValues),this.hasCompleted=!1,this.running=!1,this.okayToRun=!0,this.useNameValuePairs="object"==r(e),this.startTime=Date.now(),this.useNameValuePairs?(this.startValues=t,this.endValues=e):(this.startValues={default:t},this.endValues={default:e}),this.changeValues={},this.currentValues={},this.startValues)this.changeValues[i]=this.endValues[i]-this.startValues[i]},e.EaseMachine.prototype.next=function(){var t=Date.now();for(var e in t>=this.startTime+this.ms&&(t=this.startTime+this.ms,this.hasCompleted=!0,this.running=!1),this.currentValues={},this.changeValues)this.currentValues[e]=this.fc(t-this.startTime,this.startValues[e],this.changeValues[e],this.ms);return this.useNameValuePairs?this.currentValues:this.currentValues.default},e.EaseMachine.prototype.hasCompleted=!0,e.EaseMachine.prototype.run=function(t,e,i,a){this.afid&&cancelAnimationFrame(this.afid),e||0===e?this.reset(e,i):(i||0===i)&&this.reset(this.currentValues,i);var r=this;function n(){if(r.afid=null,r.okayToRun){var e=r.next();t(e),r.hasCompleted||(r.afid=requestAnimationFrame(n))}}this.running=!0,a?this.afid=requestAnimationFrame(n):n()},e.EaseMachine.prototype.stop=function(){return this.afid&&cancelAnimationFrame(this.afid),this.afid=null,this.okayToRun=!1,this.hasCompleted=!0,this.running=!1,void 0===this.useNameValuePairs?{}:this.useNameValuePairs?this.currentValues:this.currentValues.default},e.ChartEngine.prototype.animations.zoom.isStub&&(e.ChartEngine.prototype.animations.zoom=new e.EaseMachine(Math.easeOutCubic,400))},x=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;
/*!
	 Based on ndef.parser, by Raphael Graf(r@undefined.ch)
	 http://www.undefined.ch/mparser/index.html
	 Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)
	 You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
	 to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
	 but don't feel like you have to let me know or ask permission.
	*/e.computeEquationChart=function(t,i){t=t.replace(/[:]/,"/").toUpperCase();var a=0;for(var r in i){var n=new RegExp("\\["+r.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\$/g,"\\$").replace(/\^/g,"\\^").replace(/[+\-*/%()]/g,"\\$&")+"\\]","g");t=t.replace(n,"symbol"+a),a++}var s,o=function(){function t(t){function e(){}return e.prototype=t,new e}function i(t,e,i,a){this.type_=t,this.index_=e||0,this.prio_=i||0,this.number_=null!=a?a:0,this.toString=function(){switch(this.type_){case 0:return this.number_;case 1:case 2:case 3:return this.index_;case 4:return"CALL";default:return"Invalid Token"}}}function a(t,e,i,a){this.tokens=t,this.ops1=e,this.ops2=i,this.functions=a}var r=/[\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};function s(t,e){return Number(t)+Number(e)}function o(t,e){return t-e}function l(t,e){return t*e}function h(t,e){return t/e}function c(t,e){return t%e}function u(t,e){return""+t+e}function d(t,e){return t==e}function p(t,e){return t!=e}function f(t,e){return t>e}function m(t,e){return t<e}function g(t,e){return t>=e}function v(t,e){return t<=e}function y(t,e){return Boolean(t&&e)}function x(t,e){return Boolean(t||e)}function b(t){return Math.sinh?Math.sinh(t):(Math.exp(t)-Math.exp(-t))/2}function S(t){return Math.cosh?Math.cosh(t):(Math.exp(t)+Math.exp(-t))/2}function C(t){return Math.tanh?Math.tanh(t):t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function w(t){return Math.asinh?Math.asinh(t):t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function k(t){return Math.acosh?Math.acosh(t):Math.log(t+Math.sqrt(t*t-1))}function D(t){return Math.atanh?Math.atanh(t):Math.log((1+t)/(1-t))/2}function T(t){return Math.log(t)*Math.LOG10E}function A(t){return-t}function M(t){return Math.trunc?Math.trunc(t):t<0?Math.ceil(t):Math.floor(t)}function P(t){return Math.random()*(t||1)}function F(t){for(var e=t=Math.floor(t);t>1;)e*=--t;return e}function _(){if(Math.hypot)return Math.hypot.apply(this,arguments);for(var t=0,e=arguments.length,i=0;i<e;i++){if(arguments[i]===1/0||arguments[i]===-1/0)return 1/0;t+=arguments[i]*arguments[i]}return Math.sqrt(t)}function E(t,e,i){return t?e:i}function L(t,e){return"[object Array]"!=Object.prototype.toString.call(t)?[t,e]:((t=t.slice()).push(e),t)}function I(){this.success=!1,this.errormsg="",this.expression="",this.pos=0,this.tokennumber=0,this.tokenprio=0,this.tokenindex=0,this.tmpprio=0,this.ops1={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:b,cosh:S,tanh:C,asinh:w,acosh:k,atanh:D,sqrt:Math.sqrt,log:Math.log,lg:T,log10:T,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:M,"-":A,exp:Math.exp},this.ops2={"+":s,"-":o,"*":l,"/":h,"%":c,"^":Math.pow,",":L,"||":u,"==":d,"!=":p,">":f,"<":m,">=":g,"<=":v,and:y,or:x},this.functions={random:P,fac:F,min:Math.min,max:Math.max,hypot:_,pyt:_,pow:Math.pow,atan2:Math.atan2,if:E},this.consts={E:Math.E,PI:Math.PI}}e.extend(a.prototype,{simplify:function(e){e=e||{};var r,n,s,o=[],l=[],h=this.tokens.length,c=0;for(c=0;c<h;c++){var u=(s=this.tokens[c]).type_;if(0===u)o.push(s);else if(3===u&&s.index_ in e)s=new i(0,0,0,e[s.index_]),o.push(s);else if(2===u&&o.length>1)n=o.pop(),r=o.pop(),s=new i(0,0,0,(0,this.ops2[s.index_])(r.number_,n.number_)),o.push(s);else if(1===u&&o.length>0)r=o.pop(),s=new i(0,0,0,(0,this.ops1[s.index_])(r.number_)),o.push(s);else{for(;o.length>0;)l.push(o.shift());l.push(s)}}for(;o.length>0;)l.push(o.shift());return new a(l,t(this.ops1),t(this.ops2),t(this.functions))},substitute:function(e,r){r instanceof a||(r=(new I).parse(String(r)));var n,s=[],o=this.tokens.length,l=0;for(l=0;l<o;l++){if(3===(n=this.tokens[l]).type_&&n.index_===e)for(var h=0;h<r.tokens.length;h++){var c=r.tokens[h],u=new i(c.type_,c.index_,c.prio_,c.number_);s.push(u)}else s.push(n)}return new a(s,t(this.ops1),t(this.ops2),t(this.functions))},evaluate:function(t){t=t||{};var e,i,a,r,n=[],s=this.tokens.length,o=0;for(o=0;o<s;o++){var l=(r=this.tokens[o]).type_;if(0===l)n.push(r.number_);else if(2===l)i=n.pop(),e=n.pop(),a=this.ops2[r.index_],n.push(a(e,i));else if(3===l)if(r.index_ in t)n.push(t[r.index_]);else{if(!(r.index_ in this.functions))throw new Error("undefined variable: "+r.index_);n.push(this.functions[r.index_])}else if(1===l)e=n.pop(),a=this.ops1[r.index_],n.push(a(e));else{if(4!==l)throw new Error("invalid Expression");if(e=n.pop(),!(a=n.pop()).apply||!a.call)throw new Error(a+" is not a function");"[object Array]"==Object.prototype.toString.call(e)?n.push(a.apply(void 0,e)):n.push(a.call(void 0,e))}}if(n.length>1)throw new Error("invalid Expression (parity)");return n[0]},toString:function(t){var e,i,a,s,o,l=[],h=this.tokens.length,c=0;for(c=0;c<h;c++){var u=(s=this.tokens[c]).type_;if(0===u)l.push("string"==typeof(o=s.number_)?(r.lastIndex=0,r.test(o)?"'"+o.replace(r,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+"'":"'"+o+"'"):o);else if(2===u)i=l.pop(),e=l.pop(),a=s.index_,t&&"^"==a?l.push("Math.pow("+e+","+i+")"):l.push("("+e+a+i+")");else if(3===u)l.push(s.index_);else if(1===u)e=l.pop(),"-"===(a=s.index_)?l.push("("+a+e+")"):l.push(a+"("+e+")");else{if(4!==u)throw new Error("invalid Expression");e=l.pop(),a=l.pop(),l.push(a+"("+e+")")}}if(l.length>1)throw new Error("invalid Expression (parity)");return l[0]},variables:function(){for(var t=this.tokens.length,e=[],i=0;i<t;i++){var a=this.tokens[i];3===a.type_&&-1==e.indexOf(a.index_)&&e.push(a.index_)}return e}},!0),I.parse=function(t){return(new I).parse(t)},I.evaluate=function(t,e){return I.parse(t).evaluate(e)},I.Expression=a,I.values={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:b,cosh:S,tanh:C,asinh:w,acosh:k,atanh:D,sqrt:Math.sqrt,log:Math.log,lg:T,log10:T,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:M,random:P,fac:F,exp:Math.exp,min:Math.min,max:Math.max,hypot:_,pyt:_,pow:Math.pow,atan2:Math.atan2,if:E,E:Math.E,PI:Math.PI};return e.extend(I.prototype,{parse:function(e){this.errormsg="",this.success=!0;var r=[],n=[];this.tmpprio=0;var s=77,o=0;for(this.expression=e,this.pos=0;this.pos<this.expression.length;){var l;if(this.isOperator())this.isSign()&&64&s?(this.isNegativeSign()&&(this.tokenprio=2,this.tokenindex="-",o++,this.addfunc(n,r,1)),s=77):this.isComment()||(0==(2&s)&&this.error_parsing(this.pos,"unexpected operator"),o+=2,this.addfunc(n,r,2),s=77);else if(this.isNumber())0==(1&s)&&this.error_parsing(this.pos,"unexpected number"),l=new i(0,0,0,this.tokennumber),n.push(l),s=50;else if(this.isString())0==(1&s)&&this.error_parsing(this.pos,"unexpected string"),l=new i(0,0,0,this.tokennumber),n.push(l),s=50;else if(this.isLeftParenth())0==(8&s)&&this.error_parsing(this.pos,'unexpected "("'),128&s&&(o+=2,this.tokenprio=-2,this.tokenindex=-1,this.addfunc(n,r,4)),s=333;else if(this.isRightParenth())256&s?(l=new i(0,0,0,[]),n.push(l)):0==(16&s)&&this.error_parsing(this.pos,'unexpected ")"'),s=186;else if(this.isComma())0==(32&s)&&this.error_parsing(this.pos,'unexpected ","'),this.addfunc(n,r,2),o+=2,s=77;else if(this.isConst()){0==(1&s)&&this.error_parsing(this.pos,"unexpected constant");var h=new i(0,0,0,this.tokennumber);n.push(h),s=50}else if(this.isOp2())0==(4&s)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(n,r,2),o+=2,s=8;else if(this.isOp1())0==(4&s)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(n,r,1),o++,s=8;else if(this.isVar()){0==(1&s)&&this.error_parsing(this.pos,"unexpected variable");var c=new i(3,this.tokenindex,0,0);n.push(c),s=186}else this.isWhite()||(""===this.errormsg?this.error_parsing(this.pos,"unknown character"):this.error_parsing(this.pos,this.errormsg))}for((this.tmpprio<0||this.tmpprio>=10)&&this.error_parsing(this.pos,'unmatched "()"');r.length>0;){var u=r.pop();n.push(u)}return o+1!==n.length&&this.error_parsing(this.pos,"parity"),new a(n,t(this.ops1),t(this.ops2),t(this.functions))},evaluate:function(t,e){return this.parse(t).evaluate(e)},error_parsing:function(t,e){throw this.success=!1,this.errormsg="parse error [column "+t+"]: "+e,this.column=t,new Error(this.errormsg)},addfunc:function(t,e,a){for(var r=new i(a,this.tokenindex,this.tokenprio+this.tmpprio,0);e.length>0&&r.prio_<=e[e.length-1].prio_;)t.push(e.pop());e.push(r)},isNumber:function(){for(var t=!1,e="";this.pos<this.expression.length;){var i=this.expression.charCodeAt(this.pos);if(!(i>=48&&i<=57||46===i))break;e+=this.expression.charAt(this.pos),this.pos++,this.tokennumber=parseFloat(e),t=!0}return t},unescape:function(t,e){for(var i=[],a=!1,r=0;r<t.length;r++){var n=t.charAt(r);if(a){switch(n){case"'":i.push("'");break;case"\\":i.push("\\");break;case"/":i.push("/");break;case"b":i.push("\b");break;case"f":i.push("\f");break;case"n":i.push("\n");break;case"r":i.push("\r");break;case"t":i.push("\t");break;case"u":var s=parseInt(t.substring(r+1,r+5),16);i.push(String.fromCharCode(s)),r+=4;break;default:throw this.error_parsing(e+r,"Illegal escape sequence: '\\"+n+"'")}a=!1}else"\\"==n?a=!0:i.push(n)}return i.join("")},isString:function(){var t=!1,e="",i=this.pos;if(this.pos<this.expression.length&&"'"==this.expression.charAt(this.pos))for(this.pos++;this.pos<this.expression.length;){if("'"==this.expression.charAt(this.pos)&&"\\"!=e.slice(-1)){this.pos++,this.tokennumber=this.unescape(e,i),t=!0;break}e+=this.expression.charAt(this.pos),this.pos++}return t},isConst:function(){for(var t in this.consts){var e=t.length;if(t===this.expression.substr(this.pos,e))return this.tokennumber=this.consts[t],this.pos+=e,!0}return!1},isOperator:function(){var t=this.expression.charCodeAt(this.pos);if(43===t)this.tokenprio=2,this.tokenindex="+";else if(45===t)this.tokenprio=2,this.tokenindex="-";else if(62===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex=">="):(this.tokenprio=1,this.tokenindex=">");else if(60===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex="<="):(this.tokenprio=1,this.tokenindex="<");else if(124===t){if(124!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="||"}else if(61===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="=="}else if(33===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="!="}else if(97===t){if(110!==this.expression.charCodeAt(this.pos+1)||100!==this.expression.charCodeAt(this.pos+2))return!1;this.pos++,this.pos++,this.tokenprio=0,this.tokenindex="and"}else if(111===t){if(114!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="or"}else if(42===t||8729===t||8226===t)this.tokenprio=3,this.tokenindex="*";else if(47===t)this.tokenprio=4,this.tokenindex="/";else if(37===t)this.tokenprio=4,this.tokenindex="%";else{if(94!==t)return!1;this.tokenprio=5,this.tokenindex="^"}return this.pos++,!0},isSign:function(){var t=this.expression.charCodeAt(this.pos-1);return 45===t||43===t},isPositiveSign:function(){return 43===this.expression.charCodeAt(this.pos-1)},isNegativeSign:function(){return 45===this.expression.charCodeAt(this.pos-1)},isLeftParenth:function(){return 40===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio+=10,!0)},isRightParenth:function(){return 41===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio-=10,!0)},isComma:function(){return 44===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tokenprio=-1,this.tokenindex=",",!0)},isWhite:function(){var t=this.expression.charCodeAt(this.pos);return(32===t||9===t||10===t||13===t)&&(this.pos++,!0)},isOp1:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&t in this.ops1&&(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0)},isOp2:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&t in this.ops2&&(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0)},isVar:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&(this.tokenindex=t,this.tokenprio=4,this.pos+=t.length,!0)},isComment:function(){return 47===this.expression.charCodeAt(this.pos-1)&&42===this.expression.charCodeAt(this.pos)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)}},!0),I}().parse(t),l=[],h={},c=0,u=null,d=!1,p=[];for(r in i){var f={sym:r,map:i[r]};i[r]?p.unshift(f):p.push(f)}for(var m=0;m<p.length;m++){var g=p[m];h[g.sym]={i:0,s:g.sym},g.map?(c++,s=g.map[0]):1==c&&(d=g.sym),s.DT||(s.DT=e.strToDateTime(s.Date)),h[g.sym].d=s.DT,u||(u=h[g.sym])}var v=0===c,y=1==c&&-1==t.indexOf("%");function x(t){if(t.i++,i[t.s]){if(t.i>=i[t.s].length)return 0;s=i[t.s][t.i]}return s.DT||(s.DT=e.strToDateTime(s.Date)),t.d=s.DT,1}function b(){var t=null,e=null;for(var i in h)e?h[i].d.getTime()<e.d.getTime()?t=e=h[i]:h[i].d.getTime()>e.d.getTime()&&(t=e):e=h[i];return t?x(t)?-1:0:1}t:for(;;){var S=b();if(!S)break;if(1==S){var C;if(d){var w=i[u.s][u.i][d];w&&(w.Close||0===w.Close)&&(w=w.Close);var k=o.evaluate({symbol0:i[u.s][u.i].Close,symbol1:w});k=Number(k.toFixed(8)),(C={DT:u.d,Close:k,Adj_Close:k})[u.s]=i[u.s][u.i].Close,isNaN(k)||k==1/0||l.push(C)}else{if(v){var D=o.evaluate({});throw e.alert(t+"="+D),{name:"NoException",message:""}}a=0;var T={Adj_Close:{},Close:{},Open:{},High:{},Low:{},Volume:{}};for(r in i){for(var A in T)T[A]["symbol"+a]=i[r][h[r].i][A];a++}(C={DT:u.d}).Adj_Close=o.evaluate(T.Adj_Close),C.Close=o.evaluate(T.Close),C.Open=o.evaluate(T.Open),C.Volume=o.evaluate(T.Volume),isNaN(C.Volume)&&(C.Volume=0),y?(C.High=o.evaluate(T.High),C.Low=o.evaluate(T.Low)):(C.High=Math.max(C.Open,C.Close),C.Low=Math.min(C.Open,C.Close)),isNaN(C.Close)||C.Close==1/0||l.push(C),isNaN(C.High)||(C.High=Number(C.High.toFixed(8))),isNaN(C.Low)||(C.Low=Number(C.Low.toFixed(8))),isNaN(C.Open)||(C.Open=Number(C.Open.toFixed(8))),isNaN(C.Close)||(C.Close=Number(C.Close.toFixed(8))),isNaN(C.Adj_Close)?C.Adj_Close=C.Close:C.Adj_Close=Number(C.Adj_Close.toFixed(8))}for(r in i)if(!x(h[r]))break t}}return l}},b=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine.prototype.setLocale=function(t,i){if("undefined"!=typeof Intl&&this.locale!=t){this.locale=t;var a,r=this.internationalizer={};for(r.hourMinute=new Intl.DateTimeFormat(this.locale,{hour:"numeric",minute:"numeric",hour12:!1}),r.hourMinuteSecond=new Intl.DateTimeFormat(this.locale,{hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}),r.mdhm=new Intl.DateTimeFormat(this.locale,{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),r.monthDay=new Intl.DateTimeFormat(this.locale,{month:"numeric",day:"numeric"}),r.yearMonthDay=new Intl.DateTimeFormat(this.locale,{year:"numeric",month:"numeric",day:"numeric"}),r.yearMonth=new Intl.DateTimeFormat(this.locale,{year:"numeric",month:"numeric"}),r.month=new Intl.DateTimeFormat(this.locale,{month:"short"}),r.numbers=new Intl.NumberFormat(this.locale),r.priceFormatters=[],i||(i=8),a=0;a<i+1;a++)r.priceFormatters.push(new Intl.NumberFormat(this.locale,{maximumFractionDigits:a,minimumFractionDigits:a}));for(a=0;a<5;a++){var n=a,s=a;a||(n="",s=2),r["percent"+n]=new Intl.NumberFormat(this.locale,{style:"percent",minimumFractionDigits:s,maximumFractionDigits:s})}e.I18N.createMonthArrays&&e.I18N.createMonthArrays(this,r.month,this.locale)}},e.I18N=function(){},e.I18N.hereDoc=function(t){return t.toString().replace(/^[^/]+\/\*!?/,"").replace(/\*\/[^/]+$/,"")},e.I18N.language="en",e.I18N.longMonths={zh:!0},e.I18N.reverseColorsByLocale={zh:!0,ja:!0},e.I18N.findAllTextNodes=function(t){if(t||(t=document.body),t==document.body&&!document.querySelector(".ciq_stashed_texts")){var i=document.createElement("div");i.className="ciq_stashed_texts",i.style.display="none",t.appendChild(i);for(var a=document.querySelectorAll("input,textarea,.editable_content"),r=0;r<a.length;r++){var n=a[r].getAttribute("placeholder");if(n){var s=i.appendChild(document.createElement("translate"));s.setAttribute("original",n),s.placeholderFor=a[r],s.appendChild(document.createTextNode(n))}}}for(var o=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),l=o.nextNode(),h=new RegExp("^\\s*$"),c=new RegExp("\n|\t|\f","g"),u={},d={SCRIPT:!0,STYLE:!0,TEXTAREA:!0};l;){var p=l.nodeValue;if(!h.test(p)){var f=l.parentNode,m=f.tagName;if(!d[m]){if("TRANSLATE"!=m){var g=document.createElement("translate");g.setAttribute("original",p),g.appendChild(l),f.appendChild(g)}else p=f.getAttribute("original");c.test(p)&&(p=p.replace(c,"")),u[p]||(u[p]=[]),u[p].push(l)}}l=o.nextNode()}if(t==document.body){var v=e.Studies?e.Studies.studyLibrary:null;if(v)for(var y in v){null===u[y]&&(u[y]=[]);var x=v[y];if(x.inputs)for(var b in x.inputs)u[b]||(u[b]=[]);if(x.outputs)for(var S in x.outputs)u[S]||(u[S]=[])}}return u},e.I18N.missingWordList=function(t){t||(t=e.I18N.language);var i=e.I18N.findAllTextNodes(),a={},r=e.I18N.wordLists[t];r||(r={});var n,s,o=function(t){void 0===r[t]&&(a[t]="")};for(var l in i)o(l);if(!e.Studies||!e.Studies.studyLibrary)return a;for(var h in e.Studies.studyLibrary){for(var c in o((n=e.Studies.studyLibrary[h]).name),n.inputs)switch(o(c),s=n.inputs[c],Object.prototype.toString.call(s)){case"[object String]":o(s);break;case"[object Array]":for(var u=0;u<s.length;++u)o(s[u])}for(var d in n.outputs)o(d)}return o("Show Zones"),o("OverBought"),o("OverSold"),o("Panel"),o("Show as Underlay"),o("Y-Axis"),o("Invert Y-Axis"),a},e.I18N.printableMissingWordList=function(t){var i=JSON.stringify(e.I18N.missingWordList(t));return i=i.replace(/","/g,'",\n"')},e.I18N.translateUI=function(t,i){if("pu"==t&&(t="pt"),e.I18N.wordLists){t||(t=e.I18N.language);var a=e.I18N.findAllTextNodes(i),r=e.I18N.wordLists[t];if(r)for(var n in a)for(var s=e.I18N.translateSections(n,r),o=a[n],l=0;l<o.length;l++){var h=o[l],c=h.parentNode,u=c.getAttribute("original");","!==s&&s||(s=u);var d=c.placeholderFor;d?d.placeholder=s:h.data=s}}},e.I18N.translate=function(t,i){if(i||(i=e.I18N.language),!e.I18N.wordLists)return console.log("Must include translations.js in order to use CIQ.I18N.translate()"),t;var a=e.I18N.wordLists[i],r=null;return a&&(r=e.I18N.translateSections(t,a)||t),","===r?t:r},e.I18N.translateSections=function(t,e){if("string"==typeof t&&-1!=t.indexOf("‌")){var i=(t=t.replace(/([(),])/g,"‌$1‌")).split("‌");return i.forEach((function(t,i,a){var r=t.match(/^(\s*).*\S(\s*)$/),n=e[t.trim()];n&&(r&&(n=r[1]+n+r[2]),a[i]=n)})),i.join("")}return e[t]},e.I18N.convertCSV=function(t){var i=new RegExp("[“”]|[‘’]","g"),a=new RegExp('^(")|(")$',"g"),r=e.I18N.wordLists;if(t||(t=e.I18N.csv),t){for(var n=t.split("\n"),s=n[0].split(","),o=0;o<s.length;o++){var l=s[o];r[l]||(r[l]={})}for(var h=1;h<n.length;h++){var c=n[h].match(/(".*?"|[^",]+)(?=\s*,|\s*$)|(,(?=,))/g)||[],u=c[0];a.test(u)&&(u=u.replace(a,"")),i.test(u)&&(u=u.replace(i,'"'));for(var d=1;d<c.length;d++){var p=c[d];a.test(p)&&(p=p.replace(a,"")),r[s[d]][u]=p}}}},e.I18N.setLanguage=function(t,i,a,r,n){"pu"==i&&(i="pt"),e.I18N.convertCSV(r),e.I18N.language=i,e.I18N.translateUI(i,n),a||(a=e.I18N.translate),t.translationCallback=a},e.I18N.setLocale=function(t,e,i,a,r){if("undefined"==typeof Intl||!Intl.__addLocaleData)return t.setLocale(e,r),void(i&&i(null));var n=(a=void 0===a?"locale-data/jsonp":a)+"/"+e+".js",s=document.createElement("SCRIPT");s.async=!0,s.src=n;var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(s,o.nextSibling),s.onload=function(){t.setLocale(e,r),i&&i(null)},s.onerror=function(){i&&i("cannot load script")}},e.I18N.createMonthArrays=function(t,i,a){t.monthAbv=[],t.monthLetters=[];var r=new Date,n=!0;e.I18N.longMonths&&e.I18N.longMonths[a]&&(n=!1);for(var s=0;s<12;s++){r.setDate(1),r.setMonth(s);var o=i.format(r);if(n){for(var l="",h=0;h<o.length;h++){var c=o.charAt(h);c.charCodeAt(0)<65||(l+=c)}t.monthAbv[s]=l,t.monthLetters[s]=l[0]}else t.monthAbv[s]=o,t.monthLetters[s]=o}},e.I18N.localize=function(t,e){var i=t.locale,a=this.reverseColorsByLocale[e],r=this.reverseColorsByLocale[i];this.setLocale(t,e),this.setLanguage(t,e),a&&r||(a||r)&&this.reverseCandles(t)},e.I18N.reverseCandles=function(t){var e=t.styles,i=t.cloneStyle(e.stx_candle_down),a=t.cloneStyle(e.stx_candle_up);e.stx_candle_up=i,e.stx_candle_down=a},e.I18N.wordLists={en:{}},e.I18N.languages={en:"English"}},S=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine.prototype.pointerEvents={down:[],up:[]},e.ChartEngine.prototype.doubleClickTime=250,e.ChartEngine.prototype.manageTouchAndMouse=!0,e.ChartEngine.prototype.registerTouchAndMouseEvents=function(){if(!this.touchAndMouseEventsRegistered){this.touchAndMouseEventsRegistered=!0;var t=this.controls.chartControls||document,i=t.querySelector(".stx-zoom-in"),a=t.querySelector(".stx-zoom-out"),r=this.chart.container,n=this,s=function(t,e,i){n.addDomEventListener(r,t,(function(t){n.mainSeriesRenderer&&n.mainSeriesRenderer.nonInteractive||e(t)}),i)};e.touchDevice?e.isSurface?(s("mousemove",(function(t){n.msMouseMoveProxy(t)})),s("mouseenter",(function(t){n.msMouseMoveProxy(t)})),s("mousedown",(function(t){n.msMouseDownProxy(t)})),s("mouseup",(function(t){n.msMouseUpProxy(t)})),s("pointerdown",(function(t){return n.startProxy(t)})),s("pointermove",(function(t){n.moveProxy(t)})),s("pointerenter",(function(t){return n.moveProxy(t)})),s("pointerup",(function(t){return n.endProxy(t)}))):(e.isMobile||(s("mousemove",(function(t){n.iosMouseMoveProxy(t)})),s("mouseenter",(function(t){n.iosMouseMoveProxy(t)})),s("mousedown",(function(t){n.iosMouseDownProxy(t)})),s("mouseup",(function(t){n.iosMouseUpProxy(t)}))),s("touchstart",(function(t){n.touchstart(t)})),s("touchmove",(function(t){n.touchmove(t)})),s("touchend",(function(t){n.touchend(t)})),s("pointerdown",(function(t){n.touchPointerType=t.pointerType})),i&&(i.removeAttribute("onMouseOver"),i.removeAttribute("onMouseOut")),a&&(a.removeAttribute("onMouseOver"),a.removeAttribute("onMouseOut"))):(s("mousemove",(function(t){n.mousemove(t)})),s("mouseenter",(function(t){n.mousemove(t)})),s("mousedown",(function(t){n.mousedown(t)})),s("mouseup",(function(t){n.mouseup(t)})));var o=e.wheelEvent;this.captureMouseWheelEvents&&s(o,(function(t){n.mouseWheel(t)}),{passive:!1})}},e.ChartEngine.prototype.mousedown=function(t){if(!this.runPrepend("mousedown",arguments)&&(this.grabOverrideClick=!1,this.displayInitialized&&this.displayCrosshairs&&!this.repositioningDrawing&&!(this.editingAnnotation||t.button&&t.button>=2))){var i=this.container.getBoundingClientRect();if(this.top=i.top,this.left=i.left,this.right=this.left+this.width,this.bottom=this.top+this.height,t.clientX>=this.left&&t.clientX<=this.right&&t.clientY>=this.top&&t.clientY<=this.bottom){if(this.insideChart=!0,this.currentPanel){this.manageTouchAndMouse&&t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),this.mouseTimer=Date.now(),this.longHoldTookEffect=!1,this.hasDragged=!1,this.userPointerDown=!0,""===this.openDialog&&this.registerPointerEvent({x:t.clientX,y:t.clientY,time:this.mouseTimer},"down");for(var a=this.currentPanel.chart,r=0;r<this.drawingObjects.length;r++){var n=this.drawingObjects[r];if(n.highlighted&&!n.permanent){if(this.cloneDrawing){var s=e.ChartEngine.drawingTools[n.name],o=new s;return o.reconstruct(this,n.serialize()),this.drawingObjects.push(o),this.activateRepositioning(o),void(o.repositioner=n.repositioner)}var l=this.currentVectorParameters.vectorType;if(!(e.Drawing&&l&&e.Drawing[l]&&(new e.Drawing[l]).dragToDraw))return void this.activateRepositioning(n)}}var h,c=this.mainSeriesRenderer||{};if(c.params&&c.params.baseline&&!1!==a.baseline.userLevel&&this.controls.baselineHandle){var u=this.valueFromPixel(this.cy-5,this.currentPanel),d=this.valueFromPixel(this.cy+5,this.currentPanel),p=this.chart.right-parseInt(getComputedStyle(this.controls.baselineHandle).width,10);if(a.baseline.actualLevel<Math.max(u,d)&&a.baseline.actualLevel>Math.min(u,d)&&this.cx>p)return this.repositioningBaseline={lastDraw:Date.now()},void this.controls.baselineHandle.classList.add("stx-grab")}if(!(this.drawingClick&&(this.currentPanel.subholder===t.target&&this.drawingClick(this.currentPanel,this.cx,this.cy),this.activeDrawing&&this.activeDrawing.dragToDraw)))this.grabbingScreen=!0,a.spanLock=!1,this.yToleranceBroken=!1,this.grabStartX=t.clientX,this.grabStartY=t.clientY,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=a.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartCandleWidth=this.layout.candleWidth,this.grabStartYAxis=this.whichYAxis(this.currentPanel),this.grabStartZoom=this.grabStartYAxis?this.grabStartYAxis.zoom:0,this.grabStartPanel=this.currentPanel,setTimeout((h=this,function(){h.grabbingHand()}),100),this.swipeStart&&this.swipeStart(a),(this.longHoldTime||0===this.longHoldTime)&&this.startLongHoldTimer(),this.runAppend("mousedown",arguments)}}else this.insideChart=!1}},e.ChartEngine.prototype.mousemove=function(t){var i=t;e.ChartEngine.crosshairX=i.clientX,e.ChartEngine.crosshairY=i.clientY,i.type.toLowerCase().indexOf("enter")>-1?this.positionCrosshairsAtPointer():this.runPrepend("mousemove",arguments)||this.displayInitialized&&""===this.openDialog&&(this.grabbingScreen&&1!==i.buttons&&(this.cancelLongHold=!0,this.displayDragOK(),this.grabbingScreen=!1,this.findHighlights(!1,!0)),this.mousemoveinner(i.clientX,i.clientY),this.runAppend("mousemove",arguments))},e.ChartEngine.prototype.mouseup=function(t){if(!this.runPrepend("mouseup",arguments)){if(this.swipe.end=!0,this.cancelLongHold=!0,this.repositioningDrawing){if(!this.currentVectorParameters.vectorType||Date.now()-this.mouseTimer>250)return this.changeOccurred("vector"),e.clearCanvas(this.chart.tempCanvas,this),this.activateRepositioning(null),this.adjustDrawings(),void this.draw();this.activateRepositioning(null)}if(this.repositioningBaseline){this.repositioningBaseline=null,this.controls.baselineHandle.classList.remove("stx-grab");var i=this.mainSeriesRenderer||{};return i.params&&i.params.baseline&&i.params.type,void this.draw()}var a=this.userPointerDown;if(this.userPointerDown=!1,this.displayInitialized){var r=this.backOutY(t.clientY),n=this.backOutX(t.clientX),s=t.which&&t.which>=2||t.button&&t.button>=2,o=""!==this.openDialog;o||s||this.registerPointerEvent({x:t.clientX,y:t.clientY,time:Date.now()},"up");var l=this.isDoubleClick();this.grabbingScreen=!1,this.highlightedDraggable&&(this.dragPlotOrAxis&&this.dragPlotOrAxis(n,r),this.currentPanel=this.whichPanel(r));var h=this.currentPanel;if(this.grabStartYAxis=null,this.displayDragOK(),""===this.openDialog){if(this.grabOverrideClick)return this.overXAxis||this.overYAxis||!this.swipeRelease||this.swipeRelease(),this.container.classList.remove("stx-drag-chart"),this.grabOverrideClick=!1,this.doDisplayCrosshairs(),void this.updateChartAccessories();if(this.insideChart&&this.container.classList.remove("stx-drag-chart"),e.ChartEngine.resizingPanel)this.releaseHandle();else{if(s||t.ctrlKey)return this.anyHighlighted&&!0!==this.bypassRightClick?(this.rightClickHighlighted(),t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),t.stopPropagation(),!1):(this.dispatch("rightClick",{stx:this,panel:h,x:n,y:r}),!0);if(!(t.clientX<this.left||t.clientX>this.right||t.clientY<this.top||t.clientY>this.bottom)){var c=h&&h.subholder===t.target;l&&(c||this.overYAxis||this.overXAxis)?this.doubleClick({button:t.button,x:n,y:r}):(a&&c&&(this.longHoldTookEffect&&!this.activeDrawing||this.drawingClick(h,n,r),!this.longHoldTookEffect&&this.activeMarker&&this.activeMarker.click({cx:n,cy:r,panel:h})),this.longHoldTookEffect||this.activeDrawing||this.dispatch("tap",{stx:this,panel:h,x:n,y:r})),this.runAppend("mouseup",arguments)}}}else this.insideChart&&this.container.classList.remove("stx-drag-chart")}}},e.ChartEngine.prototype.registerPointerEvent=function(t,e){this.pointerEvents[e].length>1&&this.pointerEvents[e].pop(),this.pointerEvents[e].unshift(t)},e.ChartEngine.prototype.resetPointerEvent=function(t){this.pointerEvents[t].splice(0)},e.ChartEngine.prototype.isDoubleClick=function(){var t=this.pointerEvents,e=t.up,i=t.down;if(e.length<2||i.length<2)return!1;var a=i[0].time-e[1].time<this.doubleClickTime&&Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)<=400&&e[1].time-i[1].time<this.longHoldTime&&e[0].time-i[0].time<this.longHoldTime;return a&&(this.resetPointerEvent("up"),this.resetPointerEvent("down")),a},e.ChartEngine.prototype.doubleClick=function(t,i,a){if(!this.runPrepend("doubleClick",arguments)&&!this.editingAnnotation){if(e.ChartEngine.drawingLine)return this.undo();if(!this.activeDrawing){var r=this.activeMarker&&this.activeMarker.doubleClick({cx:i,cy:a,panel:this.currentPanel});r||this.dispatch("doubleClick",{stx:this,button:t,x:i,y:a}),this.runAppend("doubleClick",arguments)}}},e.ChartEngine.prototype.handleMouseOut=function(t){if(t=t||window.event,!e.withinElement(this.chart.container,t.pageX,t.pageY)){if(this.runPrepend("handleMouseOut",arguments))return;if(this.grabbingScreen||this.findHighlights(null,!0),this.undisplayCrosshairs(),this.touches=[],this.touching=!1,this.activeDrawing&&this.userPointerDown){this.userPointerDown=!1,this.drawingLine=!1;var i=this.backOutY(t.pageY),a=this.backOutX(t.pageX);this.drawingClick(this.currentPanel,a,i)}this.insideChart=!1,this.overYAxis=!1,this.overXAxis=!1,this.displaySticky(),this.runAppend("handleMouseOut",arguments)}},e.ChartEngine.prototype.startLongHoldTimer=function(){var t=this;this.cancelLongHold=!1,this.longHoldTimeout&&clearTimeout(this.longHoldTimeout);var e=function(){t.cancelLongHold||(t.longHoldTookEffect=!0,t.dispatch("longhold",{stx:t,panel:t.currentPanel,x:t.cx,y:t.cy}),t.displayDragOK())};this.longHoldTime?this.longHoldTimeout=setTimeout(e,this.longHoldTime):0===this.longHoldTime&&e()},e.ChartEngine.prototype.grabHandle=function(t){this.runPrepend("grabHandle",arguments)||t&&(e.ChartEngine.crosshairY=t.top+this.top,e.ChartEngine.resizingPanel=t,t.handle.classList.add("stx-grab"),this.runAppend("grabHandle",arguments))},e.ChartEngine.prototype.grabbingHand=function(){this.allowScroll&&this.grabbingScreen&&(e.touchDevice||this.container.classList.add("stx-drag-chart"))},e.ChartEngine.prototype.releaseHandle=function(){if(this.runPrepend("releaseHandle",arguments))return!0;e.clearCanvas(this.chart.tempCanvas,this),this.resizePanels(),e.ChartEngine.resizingPanel&&e.ChartEngine.resizingPanel.handle.classList.remove("stx-grab"),e.ChartEngine.resizingPanel=null,this.runAppend("releaseHandle",arguments)},e.ChartEngine.prototype.findHighlights=function(t,i){var a=this.preferences[t?"highlightsTapRadius":"highlightsRadius"];this.highlightViaTap=t;var r=this.cy,n=this.cx;if(this.anyHighlighted=!1,this.currentPanel){this.activeDrawing&&(i=!0);var s=!1,o=null,l=i?{}:{forceShow:!0,type:"drawing"},h=this.currentPanel.chart,c={x0:this.tickFromPixel(n-a,h),x1:this.tickFromPixel(n+a,h),y0:this.valueFromPixel(r-a,this.currentPanel),y1:this.valueFromPixel(r+a,this.currentPanel),cx0:n-a,cx1:n+a,cy0:r-a,cy1:r+a,r:a};this.repositioningDrawing&&c.x1-c.x0<2?(c.x1++,c.x0--):c.x1==c.x0&&(c.x0-=.5,c.x1+=.5);var u,d,p,f,m,g,v=this.markerHelper&&this.markerHelper.chartMap[h.name]&&this.markerHelper.chartMap[h.name].markers;if(!h.hideDrawings)for(var y=this.drawingObjects.length-1;y>=0;y--){var x=this.drawingObjects[y];if(this.panels[x.panelName]&&(!this.repositioningDrawing||this.repositioningDrawing==x)){var b=x.highlighted,S=x.panelName==this.currentPanel.name;x.repositioner=x.intersected(this.crosshairTick,this.crosshairValue,c),S=S&&x.repositioner,!i&&S?(b?(o=x,this.anyHighlighted&&this.singleDrawingHighlight&&(x.highlighted=!1),x.highlighted&&x.highlighted!=b&&(s=!0)):b!=x.highlight(!0)&&(o||(o=x),this.anyHighlighted&&this.singleDrawingHighlight&&(x.highlighted=!1),s=!0),this.anyHighlighted=!0):b!=x.highlight(!1)&&(s=!0),x.highlighted&&(l.noDelete=x.permanent,l.noEdit=!this.callbackListeners.drawingEdit.length)}}for(u in this.layout.studies)(d=this.layout.studies[u]).prev=d.highlight,d.highlight=this.yaxisMatches(d,this.grabStartYAxis);for(u in h.seriesRenderers){var C=h.seriesRenderers[u];C.params.highlight=this.yaxisMatches(C,this.grabStartYAxis);for(var w=0;w<C.seriesParams.length;w++)(m=C.seriesParams[w]).prev=m.highlight,m.highlight=C.params.highlight}for(p=0;v&&p<v.length;p++)(f=v[p]).params.box&&(this.activeMarker=null,f.prev=v[p].highlight,f.highlight=!1);if(this.markerHelper&&(this.markerHelper.highlighted=[]),this.highlightedDataSetField=null,this.highlightedDraggable=null,!i&&!this.anyHighlighted&&h.dataSegment){var k=this.barFromPixel(n);if(k>=0&&k<h.dataSegment.length){var D;for(u in this.overlays){if((d=this.overlays[u]).panel==this.currentPanel.name)if(!1!==d.study.isHighlighted)if("function"!=typeof d.study.isHighlighted){if(h.dataSegment[k]){for(var T in d.outputMap)if(X.call(this,k,c,T,d.getYAxis(this))){d.name!=d.panel&&(this.anyHighlighted=!0),d.highlight=T;break}if(d.highlight){this.highlightedDataSetField=T;break}}}else d.study.isHighlighted(this,n,r)&&(d.highlight=!0,this.anyHighlighted=!0)}for(u in h.seriesRenderers){if(this.highlightedDataSetField)break;var A=h.seriesRenderers[u],M=A.params.panel;if(A!=this.mainSeriesRenderer&&((A.params.highlightable||this.currentVectorParameters.vectorType)&&M==this.currentPanel.name))for(p=0;p<A.seriesParams.length;p++){var P=(m=A.seriesParams[p]).field;P||A.highLowBars||(P=this.defaultPlotField||"Close"),m.symbol&&m.subField&&(P+="--\x3e"+m.subField);var F=A.params.yAxis;if(!F&&M&&(F=this.panels[M].yAxis),A.params.step&&k>0){if(!A.caches[m.id])continue;if(!(D=A.caches[m.id][k])&&0!==D)continue;var _=A.caches[m.id][k-1];((_||0===_)&&r+a>=D&&r-a<=_||r-a<=D&&r+a>=_)&&(m.highlight=!0,this.anyHighlighted=!0)}else X.call(this,k,c,P,F,A,m.id)&&(m.highlight=!0,this.anyHighlighted=!0);if(m.highlight){this.highlightedDataSetField=P;break}}}}}var E,L=this.preferences.dragging;for(u in this.overlays){if((d=this.overlays[u]).highlight){this.anyHighlighted=!0;var I=d.inputs.display||d.name;l={message:I=this.translateIf(I),noDelete:d.permanent,noEdit:!d.editFunction,type:"study"},o=null,(!0===L||L&&L.study)&&(g=d),E=d.getYAxis(this)}d.prev!=d.highlight&&(s=!0)}for(u in h.seriesRenderers)for(var O=h.seriesRenderers[u],N=O.params.yAxis?O.params.yAxis.textStyle:null,H=0;H<O.seriesParams.length;H++){if(m=O.seriesParams[H],O.params.highlightable&&m.highlight){this.anyHighlighted=!0;var R=m.color||N;"auto"==R&&(R=this.defaultColor),m.opacity&&1!==m.opacity&&(R=e.hexToRgba(e.colorToHex(R),parseFloat(m.opacity))),l={message:m.display||m.symbol,backgroundColor:R,noDelete:m.permanent,type:"series"},o=null,(!0===L||L&&L.series)&&(g=O,O.params.highlight=!0),E=O.getYAxis(this)}m.prev!=m.highlight&&(s=!0)}for(u in this.plugins){var z=this.plugins[u],j={};z.findHighlights&&((j=z.findHighlights(this,t,i)).somethingChanged&&(s=!0),j.anyHighlighted&&(this.anyHighlighted=!0,l=j.stickyArgs||{}))}var V=this.whichPanel(r),B=this.whichYAxis(V,n);E||(E=B),E&&(E.highlight||(s=!0),E.highlight=!0);var W=[];for(var U in this.panels)W=W.concat(this.panels[U].yaxisLHS).concat(this.panels[U].yaxisRHS);for(u=0;u<W.length;u++)(E!=W[u]||i)&&(W[u].highlight&&(s=!0),W[u].highlight=!1);for(p=0;v&&p<v.length;p++){var Y=(f=v[p]).params.box;if(Y&&f.params.panelName===this.currentPanel.name){var Q=e.convertBoxToPixels(this,this.currentPanel.name,c);e.boxIntersects(Q.x0,Q.y0,Q.x1,Q.y1,Y.x0,Y.y0,Y.x1,Y.y1)&&(this.activeMarker=f,f.highlight=!0,this.markerHelper.highlighted.push(f)),f.prev!=f.highlight&&(s=!0)}}if(s&&(this.draw(),l.panel=V,this.anyHighlighted&&!this.grabStartYAxis?l.panel=V:l={},this.displaySticky(l),this.clearMeasure(),o&&o.measure()),(!0===L||L&&L.yaxis)&&B&&!B.noDraw&&(this.anyHighlight=!0,g=B),this.anyHighlighted||this.setMeasure(),g&&!V.noDrag){if(this.longHoldTookEffect&&!this.cancelLongHold){if(g.params)for(u in g.params.dependentOf&&((g=h.seriesRenderers[g.params.dependentOf]).params.highlight=!0),h.seriesRenderers)h.seriesRenderers[u].params.dependentOf==g.params.name&&(h.seriesRenderers[u].params.highlight=!0);if(this.highlightedDraggable=g,g.getDependents){var q=g.getDependents(this,!0);for(u in this.overlays)d=this.overlays[u],q.indexOf(d)>-1&&(d.highlight=!0)}}this.container.classList.add("stx-draggable")}else this.container.classList.remove("stx-draggable");this.highlightedDataSetField=this.adjustHighlightedDataSetField(this.highlightedDataSetField),this.displayDrawOK()}function X(t,i,a,r,n,s){var o=this.chart,l=this.currentPanel;r||(r=l.yAxis);var h=a.split("--\x3e"),c=h[0],u=h[1];function d(t){if(!t)return null;var e=t[c];return e&&(e[u]||0===e[u])&&(e=e[u]),n&&n.getBasis&&(e+=n.getBasis(t,c,u)),o.transformFunc&&r==o.yAxis?t.transform&&c in t.transform?((e=t.transform[c])&&(e[u]||0===e[u])&&(e=e[u]),e):o.transformFunc(this,o,e):e}u||(u="Close");var p,f,m,g,v,y=o.dataSegment[k],x=null,b=null,S=null,C=new Array(3),w=n&&n.caches[s];if(y&&w){var D;for(m=w[k],x=y.tick,(m||0===m)&&(C[0]=1),D=k-1;D>=0;D--)if(w[D]||0===w[D]){g=w[D],b=x-(k-D),C[1]=1;break}for(D=k+1;D<o.dataSegment.length;D++)if(w[D]||0===w[D]){v=w[D],S=x-(k-D),C[2]=1;break}}if(null===b&&(p=this.getPreviousBar.call(this,o,a,k))&&(b=p.tick,g=d(p)),null===S&&(f=this.getNextBar.call(this,o,a,k))&&(S=f.tick,v=d(f)),null===b&&null===S)return!1;w||(m=d(y),g=d(p),v=d(f),x=y.tick,p&&(b=p.tick),f&&(S=f.tick)),g||0===g||(g=0,b=0),v||0===v||(m||0===m?(v=m,C[2]=C[0]):(v=g,C[2]=C[1]),S=s&&o.series[s].parameters.extendToEndOfDataSet?o.dataSet.length-1:b),m||0===m||(m=v,x=S,C[0]=C[2],0===g&&0===b&&(g=m,b=x,C[1]=C[0]));var T=this.pixelFromTransformedValue.bind(this),A=this.valueFromPixel.bind(this);m=A(C[0]?m:T(m,l,r),l),g=A(C[1]?g:T(g,l,r),l),v=A(C[2]?v:T(v,l,r),l);var M=e.convertBoxToPixels(this,l.name,i),P=e.convertBoxToPixels(this,l.name,{x0:b,y0:g,x1:x,y1:m}),F=e.convertBoxToPixels(this,l.name,{x0:x,y0:m,x1:S,y1:v});return!(!e.boxIntersects(M.x0,M.y0,M.x1,M.y1,P.x0,P.y0,P.x1,P.y1,"segment")&&!e.boxIntersects(M.x0,M.y0,M.x1,M.y1,F.x0,F.y0,F.x1,F.y1,"segment"))}},e.ChartEngine.prototype.rightClickHighlighted=function(){this.runPrepend("rightClickHighlighted",arguments)||(this.deleteHighlighted(!0),this.runAppend("rightClickHighlighted",arguments))},e.ChartEngine.prototype.deleteHighlighted=function(t,i){if(!this.runPrepend("deleteHighlighted",arguments)){this.cancelTouchSingleClick=!0,e.clearCanvas(this.chart.tempCanvas,this);var a=!1===this.bypassRightClick;if(a||!this.bypassRightClick.drawing)for(var r=this.drawingObjects.length-1;r>=0;r--){var n=this.drawingObjects[r];if(n.highlighted)if(t)this.rightClickDrawing(n,i);else if(!n.permanent){var s=n.abort();if(!s){var o=this.exportDrawings();this.drawingObjects.splice(r,1),this.undoStamp(o,this.exportDrawings())}this.changeOccurred("vector")}}if(a||!this.bypassRightClick.study)for(var l in this.overlays){var h=this.overlays[l];(h.overlay||h.underlay)&&h.highlight&&!h.permanent&&(t||i?this.rightClickOverlay(l,i):this.removeOverlay(l))}var c=this.currentPanel.chart;if(a||!this.bypassRightClick.series)for(var u in c.seriesRenderers){var d=c.seriesRenderers[u];if(d.params.highlightable)for(var p=this.panels[d.params.panel],f=p&&p.yAxis.name,m=d.seriesParams.length-1;m>=0;m--){var g=d.seriesParams[m];if((d.params.highlight||g.highlight)&&!g.permanent&&(d.removeSeries(g.id),d.seriesParams.length<1))if(this.removeSeriesRenderer(d),d.params.name==f)this.electNewPanelOwner(d.params.panel);else{this.checkForEmptyPanel(d.params.panel);var v=this.getYAxisByName(p,d.params.name);v&&(v.name=v.studies[0]||v.renderers[1])}}}this.draw(),this.resizeChart(),this.clearMeasure();var y=this.controls.mSticky;y&&(y.style.display="none",y.children[0].innerHTML=""),this.runAppend("deleteHighlighted",arguments)}},e.ChartEngine.prototype.displayDragOK=function(t){function e(t){var e=this.translateIf(t.querySelector(".field").getAttribute("text")),i=this.whichYAxis(this.whichPanel(this.cy),this.cx,this.cy);i&&"all"==i.dropzone&&(e+="--\x3e"+this.translateIf(i.name)),t.querySelector(".field").innerHTML=e}var i=this.controls.dragOk;if(i){t||this.findHighlights(this.highlightViaTap);var a=this.highlightedDraggable,r=a&&a.undraggable&&a.undraggable(this),n=this.cx,s=this.cy;if(!t){if(a&&!r&&this.longHoldTookEffect&&!this.cancelLongHold){var o=a.inputs&&a.inputs.display||a.params&&(a.params.display||a.params.name)||a.name;i.querySelector(".field").setAttribute("text",o),e.call(this,i),i.style.display="inline-block",this.draw(),this.displaySticky(),this.grabStartYAxis?this.container.classList.replace("stx-drag-chart","stx-drag-axis"):this.container.classList.replace("stx-drag-chart","stx-drag-series")}else for(var l in i.style.display="none",this.draw(),this.container.classList.remove("stx-drag-series"),this.container.classList.remove("stx-drag-axis"),this.panels){var h,c=this.panels[l].subholder.classList;for(c.remove("dropzone"),c.remove("all"),c.remove("left"),c.remove("right"),c.remove("top"),c.remove("bottom"),h=0;h<this.panels[l].yaxisLHS.length;h++)this.panels[l].yaxisLHS[h].dropzone=null;for(h=0;h<this.panels[l].yaxisRHS.length;h++)this.panels[l].yaxisRHS[h].dropzone=null}this.draw()}if(a){var u=s+i.offsetHeight,d=Math.max(0,n-i.offsetWidth);i.style.top=u+"px",i.style.left=d+"px",e.call(this,i)}}},e.ChartEngine.prototype.displayDrawOK=function(){var t=this.controls.drawOk;if(t&&e.Drawing){var i=e.Drawing[this.currentVectorParameters.vectorType];if(i&&(i=new i),this.highlightedDataSetField&&i&&i.getYValue){t.style.display="inline-block";var a=this.cy+t.offsetHeight,r=this.cx-t.offsetWidth;t.style.top=a+"px",t.style.left=r+"px",t.querySelector(".field").innerHTML=this.translateIf(this.highlightedDataSetField)}else t.style.display="none"}},e.ChartEngine.prototype.mouseWheel=function(t){if(!this.runPrepend("mouseWheel",arguments)){t.preventDefault&&t.preventDefault();var i=t.deltaX,a=t.deltaY;if(Math.abs(a)>Math.abs(i)?i=0:a=0,this.lastMouseWheelEvent=Date.now(),0!==Math.abs(i)||0!==Math.abs(a)){if(this.allowSideswipe&&0!==i){this.lastMove="horizontal";var r=i;return r>50&&(r=50),r<-50&&(r=-50),this.grabbingScreen=!0,this.currentPanel||(this.currentPanel=this.chart.panel),this.grabStartX=e.ChartEngine.crosshairX,this.grabStartY=e.ChartEngine.crosshairY,this.grabStartScrollX=this.chart.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartMicropixels=this.micropixels,this.grabStartPanel=this.currentPanel,this.mousemoveinner(e.ChartEngine.crosshairX-r,e.ChartEngine.crosshairY),this.updateChartAccessories(),void(this.grabbingScreen=!1)}if(this.lastMove="vertical",this.allowZoom&&this.displayInitialized){a||("mousewheel"==e.wheelEvent?(a=-1/40*t.wheelDelta,t.wheelDeltaX&&(i=-1/40*t.wheelDeltaX)):a=t.detail),void 0===t.deltaMode&&(t.deltaMode="MozMousePixelScroll"==t.type?0:1);var n=-a;1==t.deltaMode&&(n*=33);var s=null,o=null;if(this.mouseWheelAcceleration){var l=Math.max(Math.pow(Math.abs(n),.3),1);s=1-.1*l,o=1+.2*l}if(this.zoomInitiatedByMouseWheel=!0,n>0?this.reverseMouseWheel?this.zoomOut(null,o):this.zoomIn(null,s):n<0&&(this.reverseMouseWheel?this.zoomIn(null,s):this.zoomOut(null,o)),!this.runAppend("mouseWheel",arguments))return!1}}}},e.ChartEngine.handleContextMenu=function(t){for(var i=0;i<e.ChartEngine.registeredContainers.length;i++){var a=e.ChartEngine.registeredContainers[i].stx;if(a&&a.anyHighlighted)return t.preventDefault&&t.preventDefault(),!1}},"undefined"!=typeof document&&document.addEventListener("contextmenu",e.ChartEngine.handleContextMenu),e.ChartEngine.htmlControls={annotationSave:'<span class="stx-btn stx_annotation_save" style="display: none;">save</span>',annotationCancel:'<span class="stx-btn stx_annotation_cancel" style="display: none; margin-left:10px;">cancel</span>',mSticky:'<div class="stx_sticky"> <span class="mStickyInterior"></span> <span class="mStickyRightClick"><span class="overlayEdit stx-btn" style="display:none"><span>&nbsp;</span></span> <span class="overlayTrashCan stx-btn" style="display:none"><span>&nbsp;</span></span> <span class="mouseDeleteInstructions"><span>(</span><span class="mouseDeleteText">right-click to delete</span><span class="mouseManageText">right-click to manage</span><span>)</span></span></span><span class="stickyLongPressText">(long-press to drag)</span></div>',drawOk:'<div class="stx_draw_ok"><div class="icon"></div><div class="field"></div></div>',dragOk:'<div class="stx_drag_ok"><div class="icon"></div><div class="field"></div></div>',crossX:'<div class="stx_crosshair stx_crosshair_x" style="display: none;"></div>',crossY:'<div class="stx_crosshair stx_crosshair_y" style="display: none;"></div>',chartControls:'<div class="stx_chart_controls" style="display: none; bottom: 22px;"><div class="chartSize"><span class="stx-zoom-out"></span><span class="stx-zoom-in"></span></div></div>',home:'<div class="stx_jump_today" style="display:none"><span></span></div>',floatDate:'<div class="stx-float-date" style="visibility: hidden;"></div>',handleTemplate:'<div class="stx-ico-handle" style="display: none;"><span></span></div> ',iconsTemplate:'<div class="stx-panel-control"><div class="stx-panel-title"></div><div class="stx-panel-legend"></div><div class="stx-btn-panel"><span class="stx-ico-up"></span></div><div class="stx-btn-panel"><span class="stx-ico-focus"></span></div><div class="stx-btn-panel"><span class="stx-ico-down"></span></div><div class="stx-btn-panel"><span class="stx-ico-edit"></span></div><div class="stx-btn-panel"><span class="stx-ico-close"></span></div></div>',baselineHandle:'<div class="stx-baseline-handle" style="display: none;"></div>',notificationTray:'<div class="stx_notification_tray"><template><div><span class="icon"></span><span class="message"></span></div></template></div>'},e.ChartEngine.prototype.registerChartControl=function(t,i,a){var r=this.controls;if(r&&r.chartControls&&!r.chartControls.querySelector("."+t)){var n=null,s=r.chartControls.querySelector(".stx-zoom-in");return s?((n=document.createElement("span")).innerHTML='<span class="stx-tooltip">'+i+"</span>",n.className="stx-chart-control-button "+t,s.parentNode.appendChild(n),a&&e.safeClickTouch(n,a),e.touchDevice||this.makeModal(n),n):void 0}},e.ChartEngine.prototype.zoomOut=function(t,e){if(!this.runPrepend("zoomOut",arguments)){this.preferences.zoomOutSpeed?e=this.preferences.zoomOutSpeed:e||(e=1.3),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var i=this;for(var a in this.charts){var r=this.charts[a],n=Math.floor(r.maxTicks*e);!1===r.allowScrollFuture&&!1===r.allowScrollPast&&n>r.dataSet.length&&(n=r.dataSet.length);var s=this.chart.width/n;this.layout.setSpan=null,this.layout.range=null,this.animations.zoom.run(o(r),this.layout.candleWidth,s)}}function o(t){return function(e){if(i.zoomSet(e,t),i.animations.zoom.hasCompleted){if(i.runAppend("zoomOut",arguments))return;i.changeOccurred("layout"),i.continuousZoom&&i.continuousZoom.execute(!0)}}}},e.ChartEngine.prototype.zoomIn=function(t,e){if(!this.runPrepend("zoomIn",arguments)){this.preferences.zoomInSpeed?e=this.preferences.zoomInSpeed:e||(e=.7),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var i=this;for(var a in this.charts){var r=this.charts[a],n=Math.floor(r.maxTicks*e);r.maxTicks-n<1&&(n=r.maxTicks-1),n<this.minimumZoomTicks&&(n=this.minimumZoomTicks);var s=this.chart.width/n;this.layout.setSpan=null,this.layout.range=null,this.animations.zoom.run(o(r),this.layout.candleWidth,s)}}function o(t){return function(e){if(i.zoomSet(e,t),i.animations.zoom.hasCompleted){if(i.runAppend("zoomIn",arguments))return;i.changeOccurred("layout"),i.continuousZoom&&i.continuousZoom.execute()}}}},e.ChartEngine.prototype.createCrosshairs=function(){if(!this.runPrepend("createCrosshairs",arguments)&&!(!this.manageTouchAndMouse||this.mainSeriesRenderer&&this.mainSeriesRenderer.nonInteractive)){var t=this.controls.crossX,e=this.controls.crossY;t&&(t.onmousedown||(t.onmousedown=function(t){return t.preventDefault&&t.preventDefault(),!1})),e&&(e.onmousedown||(e.onmousedown=function(t){return t.preventDefault&&t.preventDefault(),!1})),this.runAppend("createCrosshairs",arguments)}};var i=!1;e.ChartEngine.prototype.mousemoveinner=e.ChartEngine.prototype.mousemoveinner||function(t,e){i||console.error("interaction feature requires activating movement feature."),i=!0}},C=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine.prototype.makeMarkerHelper=function(){this.markerHelper={chartMap:{},classMap:{},domMarkers:[],highlighted:[]}},e.ChartEngine.prototype.addToHolder=function(t){var e=this.panels[t.params.panelName];if(e){this.markerHelper||this.makeMarkerHelper();var i=t.params,a=t.node,r=t.stxNodeCreator;r&&r.prepareForHolder&&(a=r.prepareForHolder(t)),i.chartContainer?this.container.appendChild(t.node):i.includeAxis?e.holder.appendChild(t.node):e.subholder.appendChild(a),t.chart=e.chart,r&&r.addToHolder&&r.addToHolder(t)}},e.ChartEngine.prototype.getMarkerArray=function(t,e){var i=[];for(var a in this.markers)for(var r=0;r<this.markers[a].length;r++){var n=this.markers[a][r];"panelName"==t?n.params.panelName==e&&i.push(n):"label"==t?a==e&&i.push(n):"all"==t&&i.push(n)}return i},e.ChartEngine.prototype.removeFromHolder=function(t){var e=this.panels[t.params.panelName];e&&(t.node.parentNode==e.holder?e.holder.removeChild(t.node):t.node.parentNode==e.subholder?e.subholder.removeChild(t.node):t.node.parentNode==this.container&&this.container.removeChild(t.node));var i=this.markers[t.params.label];if(i){var a;for(a=0;a<i.length;a++)if(i[a]===t){i.splice(a,1);break}var r=this.markerHelper.chartMap[t.chart.name];if(r)for(a=0;a<r.markers.length;a++)if(r.markers[a]===t){r.markers.splice(a,1);break}var n=this.markerHelper.classMap[t.className];if(n){var s=n[t.params.panelName];if(s)for(a=0;a<s.length;a++)if(s[a]===t){s.splice(a,1);break}}}},e.ChartEngine.prototype.moveMarkers=function(t,e){for(var i=this.getMarkerArray("panelName",t),a=0;a<i.length;a++)i[a].params.panelName=e;for(var r in this.markerHelper.classMap){var n=this.markerHelper.classMap[r][t];n&&(this.markerHelper.classMap[r][e]=n,delete this.markerHelper.classMap[r][t])}},e.ChartEngine.prototype.establishMarkerTicks=function(){this.markerHelper||this.makeMarkerHelper();var t=this.markerHelper.chartMap;for(var e in t){var i=t[e];if(i.dataSetLength!=this.charts[e].dataSet.length)for(var a=0;a<i.markers.length;a++)this.setMarkerTick(i.markers[a])}},e.ChartEngine.prototype.futureTickIfDisplayed=function(t){var e=t.chart;if(!(e.dataSet.length<1)){var i=e.xaxis[e.xaxis.length-1].DT;if(i=new Date(i.getTime()-6e4*this.timeZoneOffset),!(t.params.x>i))for(var a,r,n=e.maxTicks-e.dataSegment.length,s=e.dataSet.length+n,o=new Date(+e.dataSet[e.dataSet.length-1].DT),l=this.standardMarketIterator(o,null,e),h=t.params.x.getTime(),c=e.dataSet.length;c<s;c++){if(a=o.getTime(),(r=(o=l.next()).getTime())==h)return void(t.tick=c);if(r>h&&a<h)return void(t.tick=Math.max(c-1,0))}}},e.ChartEngine.prototype.setMarkerTick=function(t){var e=t.chart;if("master"==t.params.xPositioner&&t.params.x)t.tick=Math.floor(t.params.x/this.layout.periodicity);else if("date"==t.params.xPositioner&&t.params.x){for(var i,a,r=t.params.x.getTime(),n=0;n<e.dataSet.length;n++){if(i=a=e.dataSet[n].DT.getTime(),n>0&&(i=e.dataSet[n-1].DT.getTime()),a==r)return void(t.tick=n);if(a>r&&i<r)return void(t.tick=Math.max(n-1,0));if(r<a)return void(t.tick=null)}if(e.dataSet.length<1)return;new Date(+e.dataSet[n-1].DT).getTime()<r&&(t.params.future=!0),t.tick=null}},e.ChartEngine.prototype.positionMarkers=function(){var t=this,e=this.chart;if(t.markerHelper){this.markerDelay||0===this.markerDelay?this.markerTimeout||(this.markerTimeout=setTimeout(l,this.markerDelay)):l();for(var i=this.getMarkerArray("all"),a=0;a<i.length;a++){var r=i[a],n=r.stxNodeCreator,s=this.getFirstLastDataRecord(e.dataSegment,"tick"),o=this.getFirstLastDataRecord(e.dataSegment,"tick",!0);s&&o&&(s.tick<=r.tick&&r.tick<=o.tick?n&&n.drawMarker&&n.drawMarker(r):r.attached&&n.expand&&(n.expand.style.visibility="hidden"))}}function l(){if(!t.runPrepend("positionMarkers",arguments)){for(var e in t.markerTimeout=null,t.markerHelper.classMap)for(var i in t.markerHelper.classMap[e]){var a=t.markerHelper.classMap[e][i],r=t.panels[i];if(a.length){var n={stx:t,arr:a,panel:r};n.firstTick=r.chart.dataSet.length-r.chart.scroll,n.lastTick=n.firstTick+r.chart.dataSegment.length;var s=a[0].constructor.placementFunction;s?s(n):t.defaultMarkerPlacement(n)}}t.runAppend("positionMarkers",arguments)}}},e.Marker=e.Marker||function(t){this.params={xPositioner:"date",yPositioner:"value",panelName:"chart",permanent:!1,label:"generic",includeAxis:!1},e.extend(this.params,t),this.params.node||(this.params.node=document.createElement("DIV"));var i=this.params.stx;if(i){this.className||(this.className="CIQ.Marker"),e.derivedFrom(this.params.node,e.Marker.NodeCreator)?(this.stxNodeCreator=this.params.node,this.node=this.stxNodeCreator.node):this.node=this.params.node,i.markerHelper||i.makeMarkerHelper();var a=this.params.label;i.markers[a]||(i.markers[a]=[]),i.markers[a].push(this);var r=i.panels[this.params.panelName];this.chart=r.chart,i.markerHelper.chartMap[this.chart.name]||(i.markerHelper.chartMap[this.chart.name]={dataSetLength:0,markers:[]}),i.markerHelper.chartMap[this.chart.name].markers.push(this);var n=i.markerHelper.classMap[this.className];n||(n=i.markerHelper.classMap[this.className]={}),n[this.params.panelName]||(n[this.params.panelName]=[]),n[this.params.panelName].push(this),this.stxNodeCreator&&this.stxNodeCreator.deferAttach||i.addToHolder(this),i.setMarkerTick(this),this.stxNodeCreator&&this.stxNodeCreator.drawMarker&&this.stxNodeCreator.drawMarker(this)}else console.log("Marker created without specifying stx")},e.Marker.prototype.remove=function(){this.params.stx.removeFromHolder(this)},e.Marker.prototype.click=function(t){"number"==typeof arguments[0]&&(t={cx:arguments[0],cy:arguments[1],panel:arguments[3]});var e=t,i=e.cx,a=e.cy,r=e.panel;if(this.params.stx){var n=this.params.node;n.click&&n.click(i,a,this,r)}},e.Marker.prototype.doubleClick=function(t){t.cx,t.cy,t.panel;return!1},e.Marker.prototype.render=function(){var t=[this],e={stx:this.params.stx,arr:t,panel:this.params.stx.panels[this.params.panelName],showClass:this.showClass};this.constructor.placementFunction(e)},e.Marker.removeByLabel=function(t,e){for(var i=t.getMarkerArray("label",e),a=0;a<i.length;a++){var r=i[a];t.removeFromHolder(r),r.stxNodeCreator&&r.stxNodeCreator.remove&&r.stxNodeCreator.remove(r)}t.draw()},e.Marker.positionContentVerticalAndHorizontal=function(t){var e=t.querySelectorAll(".stx-marker-expand")[0];if(e){var i=e.offsetWidth,a=e.offsetHeight;if(!i||!a)return;var r=e.style;r.left=r.right="",r.bottom=r.top="";var n=getComputedStyle(e),s=n.left,o=n.bottom,l=t.offsetLeft+parseInt(s,10),h=parseInt(o,10),c=t.offsetTop-(h+e.offsetHeight-t.offsetHeight),u=t.parentNode.offsetWidth,d=t.parentNode.offsetHeight;l+i>u&&(r.right=s,r.left="auto"),t.offsetTop<=d?c>d-a&&(r.top=d-t.offsetTop-a+"px",r.bottom="auto"):r.top=d+"px",t.offsetTop+t.offsetHeight>=0?c<0&&(r.top=-t.offsetTop+"px",r.bottom="auto"):r.bottom="0px"}},e.ChartEngine.prototype.getBarBounds=function(t){var e,i,a,r;this.layout.chartType;return e="pandf"==this.layout.aggregationType?{high:Math.max(t.pfOpen,t.pfClose),low:Math.min(t.pfOpen,t.pfClose)}:{high:t.High,low:t.Low},t.markerHigh&&(e.high=t.markerHigh),t.markerLow&&(e.low=t.markerLow),void 0===t.Open&&(i=t.Close),void 0===t.High&&(a=Math.max(t.Open||i,t.Close)),void 0===t.Low&&(r=Math.min(t.Open||i,t.Close)),e.high||0===e.high||(e.high=a),e.low||0===e.low||(e.low=r),e},e.ChartEngine.prototype.defaultMarkerPlacement=function(t){var i=t.panel,a=t.yAxis?t.yAxis:t.panel.yAxis,r=i.chart,n=t.stx,s=n.chart.highLowBars,o=r.defaultPlotField;o&&!s||(o="Close");for(var l={},h=0;h<t.arr.length;h++){var c=t.arr[h],u=c.params;if(!c.params.box){var d=c.node;c.clientWidth||(c.clientWidth=d.clientWidth),c.clientHeight||(c.clientHeight=d.clientHeight);var p=null,f=u.xPositioner,m=u.yPositioner,g=c.tick,v=r.dataSet,y=c.clientWidth;if("none"!=f){if("bar"==f&&u.x){if(u.x<r.xaxis.length){var x=r.xaxis[u.x];x&&(p=x.data)}d.style.left=Math.round(n.pixelFromBar(u.x,r)-y/2)+1+"px"}else{if(!g&&0!==g){if(!(u.future&&r.scroll<r.maxTicks)){d.style.left="-1000px";continue}if(n.futureTickIfDisplayed(c),!(g=c.tick)&&0!==g){d.style.left="-1000px";continue}}if(g<v.length&&(p=v[g]),c.leftpx=Math.round(n.pixelFromTick(g,r)-r.left-y/2),c.rightEdge=c.leftpx+y,d.style.left=c.leftpx+"px",g<t.firstTick&&c.rightEdge<r.left-50)continue}p||(p=v[v.length-1])}else if(m.indexOf("candle")>-1){var b=getComputedStyle(d).left;if(b){var S=n.barFromPixel(parseInt(b,10),r);S>=0&&((p=r.xaxis[S].data)||(p=v[v.length-1]))}}d.style.top="auto";var C,w=u.y,k=d.clientHeight;if("none"!=m){var D,T=m+"-"+d.style.left,A=u.chartContainer?n.height:i.yAxis.bottom,M=0;void 0===l[T]&&(l[T]=0),D=l[T],l[T]+=k,"value"!=m||!w&&0!==w?"below_candle"!=m&&"under_candle"!=m||!p?"on_candle"==m&&p?(C=p[o],s&&(C=(p.Low+p.High)/2),M=Math.round(A-n.pixelFromPrice(C,i,a)-k/2-D)+"px"):"top"==m?M=Math.round(A-k-D-i.top)+"px":"bottom"==m?M=Math.round(D)+"px":p&&(C=p[o],s&&(C=n.getBarBounds(p)[a.flipped?"low":"high"]),M=Math.round(A-n.pixelFromPrice(C,i,a)+D)+"px"):(C=p[o],s&&(C=n.getBarBounds(p)[a.flipped?"high":"low"]),M=Math.round(A-n.pixelFromPrice(C,i,a)-k-D)+"px"):M=Math.round(A-n.pixelFromPrice(w,i,a)-k/2)+"px",d.style.bottom!=M&&(d.style.bottom=M)}e.Marker.positionContentVerticalAndHorizontal(d)}}},e.Marker.NodeCreator=function(){},e.Marker.NodeCreator.toNode=function(){return this.node},e.Marker.Simple=function(t){var i=this.node=document.createElement("div");i.className="stx-marker",i.classList.add(t.type),t.category&&i.classList.add(t.category);var a,r=e.newChild(i,"div","stx-visual");if(e.newChild(i,"div","stx-stem"),"callout"==t.type){var n=e.newChild(r,"div","stx-marker-content");e.newChild(n,"h4",null,t.headline),a=e.newChild(n,"div","stx-marker-expand"),e.newChild(a,"p",null,t.story)}else a=e.newChild(i,"div","stx-marker-expand"),e.newChild(a,"h4",null,t.headline),e.newChild(a,"p",null,t.story),e.safeClickTouch(a,(function(t){i.classList.toggle("highlight")}));function s(){e.Marker.positionContentVerticalAndHorizontal(i)}e.safeClickTouch(r,(function(t){i.classList.toggle("highlight"),setTimeout(s,10)})),this.nodeType="Simple"},e.inheritsFrom(e.Marker.Simple,e.Marker.NodeCreator,!1)},w=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ,i="undefined"!=typeof _timezoneJS?_timezoneJS:t.timezoneJS,a=e.Market;e.Market=function(t){this.market_def=!1,this.rules=!1,this.normalHours=[],this.extraHours=[],this.class_name="Market",i.Date?this.tz_lib=i.Date:this.tz_lib=Date,this.market_tz="",this.hour_aligned=!1,this.convertOnDaily=!1,this.enabled_by_default=!1,void 0!==t&&t&&!e.isEmpty(t)&&(t.market_definition&&(t=t.market_definition),t.rules&&(this.rules=t.rules),t.market_tz&&(this.market_tz=t.market_tz),t.convertOnDaily&&(this.convertOnDaily=t.convertOnDaily),r(t.hour_aligned)&&(this.hour_aligned=t.hour_aligned),void 0!==t.enabled_by_default&&t.enabled_by_default instanceof Array&&(this.enabled_by_default=t.enabled_by_default),this.market_def=t,void 0===this.market_def.name&&(this.market_def.name="no market name specified"),e.Market._createTimeSegments(this),this.getSessionNames())},e.Market.Symbology=function(){},e.Market.Symbology.isForeignSymbol=function(t){return!1},e.Market.Symbology.isFuturesSymbol=function(t){return!1},e.Market.Symbology.isRateSymbol=function(t){return!1},e.Market.Symbology.isForexSymbol=function(t){return!1},e.Market.Symbology.isForexMetal=function(t,e){return!1},e.Market.Symbology.isForexFuturesSymbol=function(t){return!!e.Market.Symbology.isForexSymbol(t)||!!e.Market.Symbology.isFuturesSymbol(t)},e.Market.Symbology.factory=function(t){return null},e.Market.Symbology.encodeTermStructureInstrumentSymbol=function(t,e){console.warn("You are trying to call `CIQ.Market.Symbology.encodeTermStructureInstrumentSymbol` but have not implemented it.")},a&&e.extend(e.Market,a),e.Market.prototype.sessions=null,e.Market.prototype.getSessionNames=function(){if(this.rules){if(!this.sessions){var t=[],e=[];this.rules.map((function(i){i.name&&-1===t.indexOf(i.name)&&(t.push(i.name),e.push({name:i.name,enabled:!!i.enabled&&i.enabled}))})),this.sessions=e}}else this.sessions=[];return this.sessions.slice()},e.Market.prototype._find_next_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),a=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz});if(this._wasOpenIntraDay(i)){var r=this.zseg_match.close_parts.hours,n=this.zseg_match.close_parts.minutes;i.setHours(r),i.setMinutes(n),a=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz})}return a.next()},e.Market.prototype._find_prev_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),a=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz}),r=this._wasOpenIntraDay(i);if(null===r?(i=new Date(i-6e4),r=this._wasOpenIntraDay(i)):(e&&i.getHours()===this.zseg_match.open_parts.hours&&i.getMinutes()===this.zseg_match.open_parts.minutes||!e&&i.getHours()===this.zseg_match.close_parts.hours&&i.getMinutes()===this.zseg_match.close_parts.minutes)&&(i=a.previous()),r){var n=this.zseg_match.open_parts.hours,s=this.zseg_match.open_parts.minutes;return i.setHours(n),i.setMinutes(s),i=(a=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz})).previous(),this.zseg_match.close_parts.hours===n&&this.zseg_match.close_parts.minutes===s?e?a.next():i:this.zseg_match.adjacent_child?i:e?a.next():i}return a.previous()},e.Market.prototype.disableSession=function(t,e){var i=!1;if(void 0!==e&&e&&(i=!0),t){for(var a=0;a<this.normalHours.length;a++)this.normalHours[a].name===t&&(this.normalHours[a].enabled=i);for(a=0;a<this.extraHours.length;a++)this.extraHours[a].name===t&&(this.extraHours[a].enabled=i)}},e.Market.prototype.enableSession=function(t){this.disableSession(t,"enable_instead")},e.Market.prototype.enableAllAvailableSessions=function(){for(var t=this.getSessionNames(),e=0;e<t.length;e++)this.enableSession(t[e].name)},e.Market.prototype.getClose=function(t,e,i,a){if(!this.market_def)return null;if(!this.rules)return null;var r=t;if(t||(r=new Date,i=null),r=this._convertToMarketTZ(r,i),void 0!==e){if(this._wasOpenIntraDay(r)&&this.zseg_match.name===e)return r.setHours(this.zseg_match.close_parts.hours,this.zseg_match.close_parts.minutes,0,0),r=this._convertFromMarketTZ(r,a)}else if(this._wasOpenDaily(r)){for(var n=this.zseg_match;n.child_;)n=n.child_;for(;!n.enabled;)n=n.parent_;return r.setHours(n.close_parts.hours,n.close_parts.minutes,0,0),r=this._convertFromMarketTZ(r,a)}return null},e.Market.prototype.getNextClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var a=t;(t||(a=new Date,e=null),a=this._convertToMarketTZ(a,e),this._wasOpenIntraDay(a))||(a=this.newIterator({begin:a,interval:1,inZone:this.market_tz,outZone:this.market_tz}).next());for(var r=a.getDate(),n=this.zseg_match;n.adjacent_child;)n=n.adjacent_child,r+=1;return a.setDate(r),a.setHours(n.close_parts.hours,n.close_parts.minutes,0,0),a=this._convertFromMarketTZ(a,i)},e.Market.prototype.getNextOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var a=t;return t||(a=new Date,e=null),a=this._convertToMarketTZ(a,e),a=this._find_next_segment(a),this.zseg_match.adjacent_parent?(a=this.getNextOpen(a,this.market_tz,this.market_tz),a=this._convertFromMarketTZ(a,i)):(a.setHours(this.zseg_match.open_parts.hours),a.setMinutes(this.zseg_match.open_parts.minutes),a=this._convertFromMarketTZ(a,i))},e.Market.prototype.getOpen=function(t,e,i,a){if(!this.market_def)return null;if(!this.rules)return null;var r=t;if(t||(r=new Date,i=null),r=this._convertToMarketTZ(r,i),void 0!==e){if(this._wasOpenIntraDay(r)&&this.zseg_match.name==e)return r.setHours(this.zseg_match.open_parts.hours,this.zseg_match.open_parts.minutes,0,0),r=this._convertFromMarketTZ(r,a)}else if(this._wasOpenDaily(r)){for(var n=this.zseg_match;n.parent_;)n=n.parent_;for(;!n.enabled;)n=n.child_;return r.setHours(n.open_parts.hours,n.open_parts.minutes,0,0),r=this._convertFromMarketTZ(r,a)}return null},e.Market.prototype.getPreviousClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var a=t;return t||(a=new Date,e=null),a=this._convertToMarketTZ(a,e),a=this._find_prev_segment(a,!1),this.zseg_match.adjacent_child?this.getPreviousClose(a,this.market_tz,this.market_tz):(a.setHours(this.zseg_match.close_parts.hours),a.setMinutes(this.zseg_match.close_parts.minutes),a=this._convertFromMarketTZ(a,i))},e.Market.prototype.getPreviousOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var a=t;return t||(a=new Date,e=null),a=this._convertToMarketTZ(a,e),a=this._find_prev_segment(a,!0),this.zseg_match.adjacent_parent?this.getPreviousOpen(a,this.market_tz,this.market_tz):(a.setHours(this.zseg_match.open_parts.hours),a.setMinutes(this.zseg_match.open_parts.minutes),a=this._convertFromMarketTZ(a,i))},e.Market.prototype.getSession=function(t,e){return t=this._convertToMarketTZ(t,e),this._wasOpenIntraDay(t)&&this.zseg_match?this.zseg_match.name:null},e.Market.prototype.marketZoneNow=function(){return this._convertToMarketTZ(new Date)},e.Market.prototype.isHourAligned=function(){return this.hour_aligned},e.Market.prototype.isOpen=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenIntraDay(t)},e.Market.prototype.isMarketDay=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenDaily(t)},e.Market.prototype.isMarketDate=function(t){return this._wasOpenDaily(t)},e.Market.prototype.newIterator=function(t){var i=!1;t.periodicity?i=t.periodicity:t.multiple&&(i=t.multiple);var a=t.interval;return a||(a="minute"),"hour"==a&&(a=60),i||(i=1),t.begin||(t.begin=new Date,t.inZone=null),a==parseInt(a,10)&&(a=parseInt(a,10),t.periodicity<1/60?(i=i*a*6e4,a="millisecond"):t.periodicity<1?(i=i*a*60,a="second"):(i*=a,a="minute")),t.timeUnit&&("millisecond"===t.timeUnit||"second"===t.timeUnit?a=t.timeUnit:"tick"===t.timeUnit&&(a="second")),"tick"==a&&(a="second"),t.interval=a,t.multiple=i,t.market=this,new e.Market.Iterator(t)},e.Market.prototype._wasOpenDaily=function(t){return this._was_open(t,!1)},e.Market.prototype._wasOpenIntraDay=function(t){return this._was_open(t,!0)},e.Market.prototype._was_open=function(t,e){var i=this.zseg_match;if(this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null,!this.market_def||!this.rules)return this.zclose_hour=24,!0;var a,r,n=!1,s=!1,o=t.getFullYear(),l=t.getMonth()+1,h=t.getDay(),c=t.getDate(),u=60*t.getHours()*60+60*t.getMinutes()+t.getSeconds();for(void 0===e&&(e=!0),r=0;r<this.normalHours.length;r++)if((a=this.normalHours[r]).enabled&&((n=a.dayofweek===h)&&e&&(n=u>=a.open&&u<a.close),n)){if(!e&&this.zseg_match&&(a.open_parts.hours>this.zopen_hour||a.open_parts.hours==this.zopen_hour&&a.open_parts.minutes>this.zopen_minute))continue;if(a===i||a.adjacent_parent||a.adjacent_child||(this.shouldResetToBeginningOfSegment=!0),this.zopen_hour=a.open_parts.hours,this.zopen_minute=a.open_parts.minutes,this.zclose_hour=a.close_parts.hours,this.zclose_minute=a.close_parts.minutes,this.zmatch_open=u===a.open,this.zseg_match=a,e)break}for(r=0;r<this.extraHours.length;r++)if((a=this.extraHours[r]).enabled&&("*"===a.year||o===a.year)&&l===a.month&&c===a.day&&(!(s=!e&&a.open||u>=a.open&&u<a.close)&&this.zseg_match&&(n=!1,this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null),s)){if(!e&&this.zseg_match&&(a.open_parts.hours>this.zopen_hour||a.open_parts.hours==this.zopen_hour&&a.open_parts.minutes>this.zopen_minute))continue;if(this.zopen_hour=a.open_parts.hours,this.zopen_minute=a.open_parts.minutes,this.zclose_hour=a.close_parts.hours,this.zclose_minute=a.close_parts.minutes,this.zmatch_open=u===a.open,this.zseg_match=a,e)break}return this.zseg_match},e.Market.prototype._wasClosed=function(t){return!this._was_open(t,!0)},e.Market.prototype._wasOpen=function(t){return this._was_open(t,!0)},e.Market.prototype._tzDifferenceMillis=function(t,e,i){var a=t;return 60*(t.getTimezoneOffset()-a.getTimezoneOffset())*1e3},e.Market._createTimeSegments=function(t){for(var e,i=function(t,i){if(24===t.close_parts.hours&&0===i.open_parts.hours&&0===i.open_parts.minutes){if(e.dayofweek===s.dayofweek-1)return!0;if(6===e.dayofweek&&0===s.dayofweek)return!0}return!1},a=0;a<t.rules.length;a++){var r=JSON.parse(JSON.stringify(t.rules[a]));void 0===r.open&&void 0===r.close&&(r.open="00:00",r.close="00:00"),r.hasOwnProperty("name")||(r.name="");try{var s;if(void 0!==r.dayofweek?(r.year="*",s=n._createDayOfWeekSegment(t,r),e&&(e.dayofweek===s.dayofweek?(e.child_=s,s.parent_=e):i(e,s)&&(e.adjacent_child=s,s.adjacent_parent=e)),e=s):void 0!==r.date?(r.isDayOfWeek=!1,r.dayofweek=-1,s=n._createDateTimeSegment(t,r)):console.log("Error, unknown rule type "+r),t.enabled_by_default)for(var o=0;o<t.enabled_by_default.length;o++){var l=t.enabled_by_default[o];if(s.name===l){s.enabled=!0;break}}}catch(t){console.log("Error, creating market rules "+t)}}},e.Market._timeSegment={};var n=e.Market._timeSegment;n.re_wild_card_iso=/^(\*)-(\d\d)-(\d\d)$/,n.re_regular_iso=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,n.re_split_hours_minutes=/^(\d\d):(\d\d)$/,n.re_split_hour_minutes=/^(\d):(\d\d)$/,n._hashCode=function(t){var e,i,a=0;if(0===t.length)return a;for(e=0,i=t.length;e<i;e++)a=(a<<5)-a+t.charCodeAt(e),a|=0;return a},n._splitHoursMinutes=function(t){var e=n.re_split_hour_minutes.exec(t),i={hours:NaN,minutes:NaN};return null===e&&null===(e=n.re_split_hours_minutes.exec(t))||(i.hours=parseInt(e[1],10),i.minutes=parseInt(e[2],10)),i},n._createDayOfWeekSegment=function(t,e){var i={name:e.name,isDayOfWeek:!0,dayofweek:e.dayofweek,date_str:"*",open_parts:n._splitHoursMinutes(e.open),close_parts:n._splitHoursMinutes(e.close),open:n._secSinceMidnight(t,e.open,!0),close:n._secSinceMidnight(t,e.close,!1),child_:!1,parent_:!1,adjacent_child:!1,adjacent_parent:!1,enabled:!1};return""===i.name&&(i.enabled=!0),i.hash_code=this._hashCode((i.open+i.close).toString()),t.normalHours.push(i),i},n._createDateTimeSegment=function(t,e){var i,a=this.re_regular_iso.exec(e.date);if(null===a){if(null===(a=this.re_wild_card_iso.exec(e.date)))return void console.log("Warning: invalid date format on rule -> "+e.date);i="*"}else i=parseInt(a[1],10);var r={name:e.name,isDayOfWeek:!1,dayofweek:-1,year:i,month:parseInt(a[2],10),day:parseInt(a[3],10),date_str:e.date,open_parts:n._splitHoursMinutes(e.open),close_parts:n._splitHoursMinutes(e.close),open:n._secSinceMidnight(t,e.open,!0),close:n._secSinceMidnight(t,e.close,!1),enabled:!1};return""===r.name&&(r.enabled=!0),r.hash_key=this._hashCode(r.date_str+r.open+r.close),t.extraHours.push(r),r},n._secSinceMidnight=function(t,e,i){var a=e.split(":"),r=parseInt(a[0],10),n=60*r*60+60*parseInt(a[1],10);return i||24===r&&(n=60*r*60+1),n},e.Market.prototype._convertToMarketTZ=function(t,e){var i;return(i=e?new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),e):new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())).setTimezone&&i.setTimezone(this.market_tz),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())},e.Market.prototype._convertFromMarketTZ=function(t,e){var i=new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),this.market_tz);return e?(i.setTimezone&&i.setTimezone(e),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(i.getTime())},e.Market.Iterator=function(t){this.market=t.market,this.begin=t.begin,this.interval=t.interval,this.multiple=t.multiple,this.inZone=t.inZone,this.outZone=t.outZone,this.clock=new e.Market.Iterator._Clock(t.market,t.interval,t.multiple),this.intraDay=this.clock.intra_day,this.intraDay&&(this.begin=this.market._convertToMarketTZ(this.begin,t.inZone)),this.clock._setStart(this.begin),this.clock.minutes_aligned=!1},e.Market.Iterator.prototype.date=function(){return this.clock._date()},e.Market.Iterator.prototype.futureTick=function(t){this.clock.skip=1;var e,i=0;e=this.intraDay?this.market._convertToMarketTZ(t.end,this.inZone).getTime():t.end.getTime();var a=this.clock.ctime;if(e===a)return i;var r=2,n=0;t.sample_size&&(r=t.sample_size);var s,o=(new Date).getTime();if(e>a){for(this.clock.forward=!0;this.clock.ctime<e;)if(i+=1,n+=1,this.clock._findNext(),1e3===n&&(n=0,(new Date).getTime()-o>=r)){s=(this.clock.ctime-a)/i,i=Math.floor((e-a)/s);break}this.clock.ctime>e&&i--}else for(this.clock.forward=!1;this.clock.ctime>e;)if(i+=1,n+=1,this.clock._findPrevious(),1e3===n&&(n=0,(new Date).getTime()-o>=r)){s=(a-this.clock.ctime)/i,i=Math.floor((a-e)/s);break}return i},e.Market.Iterator.prototype.isHourAligned=function(){return!this.intraDay||this.market.isHourAligned()},e.Market.Iterator.prototype.isOpen=function(){return this.market.isOpen()},e.Market.Iterator.prototype.next=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!0;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findNext();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator.prototype.peek=function(){return this.clock._peek()},e.Market.Iterator.prototype.previous=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!1;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findPrevious();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator._Clock=function(t,e,i){i%60==0&&"second"===e&&(e="minute",i/=60),this.market=t,this.interval=e,this.multiple=i,this.intra_day=!1,this.intervals=[],this.max_iters=10080;var a=864e5,r=this._dayImpl;"millisecond"===e?(r=this._millisImpl,a=1):"second"===e?(r=this._secondImpl,a=1e3):"minute"===e?(r=this._minuteImpl,a=6e4):"hour"===e?(r=this._hourImpl,a=36e5):"day"===e?(r=this._dayImpl,a=864e5):"week"===e?(r=this._weekImpl,a=6048e5):"month"===e?(r=this._monthImpl,a=2592e6):console.log('Periodicity ERROR: "'+e+'" is not a valid interval. Please see setPeriodicity() for details.'),this.tick_time=a*i,this.intra_day=this.tick_time<864e5,this._findPrevious=this._findNext=r};var s=e.Market.Iterator._Clock.prototype;s._total_minutes=function(t,e,i,a){return 60*(i-t)-e+a},s._alignMinutes=function(){if(!this.market.market_def||void 0===this.market.zopen_minute)return[];var t=this.market.zopen_minute,e=this.market.zseg_match;e&&e.adjacent_parent?t=e.adjacent_parent.open/60-1440:this.market.isHourAligned()&&this.multiple%60==0&&(t=0);for(var i=this._total_minutes(this.market.zopen_hour,t,this.market.zclose_hour,this.market.zclose_minute),a=[],r=0;r<i;)a.push(t+r),r+=this.multiple;return a},s._alignBaseZero=function(t){for(var e=0,i=[e];!((e+=this.multiple)>=t);)i.push(e);return i},s._date=function(){var t=Math.round(this.ctime),e=new Date(t);return this.intra_day?this.display_date=new Date(t+this.shift_millis):this.display_date=e,e},s._alignToBoundary=function(t,e){for(var i=0,a=0,r=e,n=0;n<t.length-1&&(i=t[n],a=t[n+1],e!==i&&e!==a);n++){if(e>i&&e<a){r=i;break}n+1===t.length-1&&(r=a)}return r},s._peek=function(){return this._date().toString()},s._seekHr=function(){this.forward?this.ctime-=36e5:this.ctime+=36e5},s._setStart=function(t){var e=this.market._tzDifferenceMillis(t),i=new Date(t.getTime()+e);this.shift_millis=e,this.ctime=i.getTime(),this.shift_millis=0,this.ctime=t.getTime()},s._tickTock=function(){this.forward?this.ctime+=this.tick_time:this.ctime-=this.tick_time},s._tockTick=function(){this.forward?this.ctime-=this.tick_time:this.ctime+=this.tick_time},s._tickTock24=function(){this.ctime+=864e5},s._tockTick24=function(){this.ctime-=864e5},s._windMaybe=function(t,e){for(var i=0,a=new Date(this.ctime),r=!1;!t.call(this.market,a);)if(e.call(this),r=!0,a=new Date(this.ctime),(i+=1)>this.max_iters){var n="Warning! max iterations ("+this.max_iters;n+=") reached with no rule match.",console.log(n);break}return r},s._millisImpl=function(){var t=!1;if(!this.mperiods_aligned){var e=this._alignBaseZero(1e3),i=new Date(this.ctime),a=i.getMilliseconds();a=this._alignToBoundary(e,a),i.setMilliseconds(0),this.ctime=i.getTime()+a,this.mperiods_aligned=!0,t=!0}var r=this._date().getMinutes();this._tickTock();var n=this._date().getMinutes();if((t||r!=n)&&!this.market._wasOpenIntraDay(this._date())){var s=this._date().getSeconds(),o=this._date().getMilliseconds(),l=this.tick_time;this.tick_time=6e4;var h=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=l,this.multiple=h,this.ctime+=1e3*s+o}return this._date()},s._secondImpl=function(){var t=!1;if(!this.speriod_aligned){var e=this._alignBaseZero(60),i=new Date(this.ctime),a=i.getSeconds();a=this._alignToBoundary(e,a),i.setSeconds(a),i.setMilliseconds(0),this.ctime=i.getTime(),this.speriod_aligned=!0,t=!0}var r=this._date().getMinutes();this._tickTock();var n=this._date().getMinutes();if((t||r!=n)&&!this.market._wasOpenIntraDay(this._date())){var s=this._date().getSeconds(),o=this.tick_time;this.tick_time=6e4;var l=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=o,this.multiple=l,this.ctime+=1e3*s}return this._date()},s._minuteImpl=function(){var t=this._windMaybe(this.market._wasOpenIntraDay,this._tockTick),e=new Date(this.ctime),i=e.getTimezoneOffset(),a=e.getMinutes(),r=e.getHours(),n=this._alignMinutes(),s=this._total_minutes(this.market.zopen_hour,this.market.zopen_minute,r,a)+this.market.zopen_minute;s=t?this.forward?n[n.length-1]:n[0]:this._alignToBoundary(n,s),r=Math.floor(s/60)+this.market.zopen_hour,e.setHours(r,s%60,0,0);var o=e.getTimezoneOffset()-i;(this.forward&&o<0||!this.forward&&o>0)&&e.setTime(e.getTime()-6e4*o),this.ctime=e.getTime(),this._tickTock();var l=this.market.hour_aligned&&this.multiple%60==0;if(this._windMaybe(this.market._wasOpenIntraDay,this._tickTock)||!l&&this.shouldResetToBeginningOfSegment){if(e=new Date(this.ctime),this.forward)e.setMinutes(this.market.zopen_minute),e.setHours(this.market.zopen_hour);else{var h=(n=this._alignMinutes())[n.length-1];e.setMinutes(h%60),e.setHours(Math.floor(h/60)+this.market.zopen_hour)}this.ctime=e.getTime()}return this._date()},s._hourImpl=function(){this._windMaybe(this.market._wasOpenIntraDay,this._tockTick);var t=new Date(this.ctime);this.market.isHourAligned()?t.setMinutes(0):t.setMinutes(this.market.zopen_minute),t.setSeconds(0),t.setMilliseconds(0),this.ctime=t.getTime(),this._tickTock();var e=this.market.zseg_match;if(this._windMaybe(this.market._wasOpenIntraDay,this._tickTock)||!this.market.hour_aligned&&e!=this.market.zseg_match){var i=new Date(this.ctime);if(this.forward)i.setMinutes(this.market.zopen_minute),i.setHours(this.market.zopen_hour);else{var a=this._alignMinutes(),r=a[a.length-1];i.setMinutes(r%60),i.setHours(Math.floor(r/60)+this.market.zopen_hour)}this.ctime=i.getTime()}return this._date()},s._dayImpl=function(){this._windMaybe(this.market._wasOpenDaily,this._seekHr);var t=new Date(this.ctime);t.setHours(12,0,0,0),this.ctime=t.getTime();for(var e=0;e<this.multiple;)this.forward?this._tickTock24():this._tockTick24(),this.market._wasOpenDaily(this._date())&&(e+=1);return(t=new Date(this.ctime)).setHours(0),this.ctime=t.getTime(),this._date()},s._weekImpl=function(){var t=new Date(this.ctime);for(t.setHours(12),this.ctime=t.getTime(),this._tickTock(),t=new Date(this.ctime);0!==t.getDay();)this._tockTick24(),t=new Date(this.ctime);return this._windMaybe(this.market._wasOpenDaily,this._tickTock24),(t=new Date(this.ctime)).setHours(0,0,0,0),this.ctime=t.getTime(),this._date()},s._monthImpl=function(){var t=new Date(this.ctime);return t.setDate(15),this.ctime=t.getTime(),this._tickTock(),(t=new Date(this.ctime)).setDate(1),t.setHours(12),this.ctime=t.getTime(),this._windMaybe(this.market._wasOpenDaily,this._tickTock24),(t=new Date(this.ctime)).setHours(0,0,0,0),this.ctime=t.getTime(),this._date()},s._findNext=null,s._findPrevious=null},k=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.NameValueStore=e.NameValueStore||function(){},e.NameValueStore.prototype.toJSONIfNecessary=function(t){if(t.constructor==String)return t;try{return JSON.stringify(t)}catch(e){return console.log("Cannot convert to JSON: "+t),null}},e.NameValueStore.prototype.fromJSONIfNecessary=function(t){try{return JSON.parse(t)}catch(e){return t}},e.NameValueStore.prototype.get=function(t,i){var a=e.localStorage.getItem(t);i&&i(null,this.fromJSONIfNecessary(a))},e.NameValueStore.prototype.set=function(t,i,a){e.localStorageSetItem(t,this.toJSONIfNecessary(i)),a&&a(null)},e.NameValueStore.prototype.remove=function(t,i){e.localStorage.removeItem(t),i&&i(null)}},D=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;function i(){}e.ChartEngine||(e.ChartEngine=function(){}),i.fetchInitialData=function(t,e,i,a,r){},i.fetchUpdateData=function(t,e,i,a){},i.fetchPaginationData=function(t,e,i,a,r){},i.subscribe=function(t){},i.unsubscribe=function(t){},e.QuoteFeed=e.QuoteFeed||function(){},e.QuoteFeed.prototype.fetch=function(t,e){this.v2QuoteFeed||console.log("You must implement CIQ.QuoteFeed.[yourfeedname].prototype.fetch()")},e.QuoteFeed.prototype.announceError=function(t,i){t.suppressErrors||i.suppressAlert||t.startDate||t.endDate||i.error&&e.alert("Error fetching quote:"+i.error)},e.QuoteFeed.prototype.multiFetch=function(t,e){return 0===t.length&&e([]),t[0].stx.driver.multiFetch(t,e)},e.QuoteFeed.Subscriptions=function(){this.subscriptions=[]},e.inheritsFrom(e.QuoteFeed.Subscriptions,e.QuoteFeed),e.QuoteFeed.Subscriptions.prototype.checkSubscriptions=function(t){var e,i,a=t.getSymbols({"breakout-equations":!0}),r=this;a=a.filter((function(e){var i=t.quoteDriver.getQuoteFeed(e);return i&&i.engine==r}));for(var n=0;n<this.subscriptions.length;n++)this.subscriptions[n].match=!1;for(var s=0;s<a.length;s++){var o=(i=a[s]).interval;for("month"!=o&&"week"!=o||t.dontRoll||(o="day"),i.interval=o,i.period=1,i.match=!1,isNaN(i.interval)||(i.period=i.interval,i.interval=i.timeUnit,i.interval||(i.interval="minute")),delete i.periodicity,delete i.timeUnit,delete i.setSpan,n=0;n<this.subscriptions.length;n++){if((e=this.subscriptions[n]).symbol==i.symbol&&e.period==i.period&&e.interval==i.interval){i.match=!0,e.match=!0;break}e.symbol!=i.symbol?("period"!=i.reason&&(i.reason="symbol"),e.reason="symbol"):(i.reason="period",e.reason="period")}}this.subscriptions=this.subscriptions.filter((function(e){return e.match||(e.stx||(e.stx=t),r.unsubscribe(e)),e.match})),a.forEach((function(e){e.match||(e.stx||(e.stx=t),e.reason||(e.reason="initialize"),e.symbol!==t.chart.symbol&&(e.series=!0),r.subscribe(e),r.subscriptions.push(e))}))},e.QuoteFeed.Subscriptions.prototype.fetch=function(t,e){var i=this;this.fetchFromSource(t,(function(a){a.error||i.checkSubscriptions(t.stx),e(a)}))},e.QuoteFeed.Subscriptions.prototype.subscribe=function(t){console.log("subscribe",t)},e.QuoteFeed.Subscriptions.prototype.unsubscribe=function(t){console.log("unsubscribe",t)},e.QuoteFeed.Subscriptions.prototype.fetchFromSource=function(t,e){console.log("Please provide implementation of fetchFromSource")},e.QuoteFeed.prototype.requiresImmediateRefresh=function(t){return!1},e.ChartEngine.prototype.attachQuoteFeed=function(t,i,a){if(i||(i={}),"function"!=typeof t.fetchInitialData&&"function"!=typeof t.fetchUpdateData&&"function"!=typeof t.fetchPaginationData||("function"!=typeof t.fetchPaginationData&&"function"!=typeof t.fetchUpdateData&&(i.noLoadMore=!0),t.v2QuoteFeed=!0,["multiFetch","announceError","requiresImmediateRefresh"].forEach((function(i){t[i]||!1===t[i]||(t[i]=e.QuoteFeed.prototype[i])})),"function"==typeof t.subscribe&&(t.checkSubscriptions=e.QuoteFeed.Subscriptions.prototype.checkSubscriptions,t.subscriptions=[])),i.maximumTicks||(i.maximumTicks=t.maxTicks?t.maxTicks:2e4),(!i.bufferSize||i.bufferSize<0)&&(i.bufferSize=0),i.bufferSize=Math.round(i.bufferSize),i.intervalTimer=null,this.quoteDriver)if(!a&&this.quoteDriver.hasUnfilteredQuoteFeed)this.detachQuoteFeed();else{var r=this.quoteDriver.hasUnfilteredQuoteFeed&&this.quoteDriver.quoteFeeds.pop();this.quoteDriver.quoteFeeds.push({engine:t,behavior:i,filter:a}),r&&this.quoteDriver.quoteFeeds.push(r),this.quoteDriver.updateChartLoop(null,i)}this.quoteDriver||(this.quoteDriver=new e.ChartEngine.Driver(this,t,i,a)),a||(this.quoteDriver.hasUnfilteredQuoteFeed=!0)},e.ChartEngine.prototype.detachQuoteFeed=function(t){var e=this.quoteDriver;if(e){for(var i=e.quoteFeeds.length-1;i>=0;i--)t&&e.quoteFeeds[i].quoteFeed!=t||(e.die(e.quoteFeeds[i]),e.quoteFeeds.splice(i,1));e.quoteFeeds.length?t==e.quoteFeed&&(e.quoteFeed=e.quoteFeeds[0].quoteFeed,e.behavior=e.quoteFeeds[0].behavior):e=this.quoteDriver=null}},e.ChartEngine.Driver=function(t,i,a,r){this.stx=t,a||(a={}),this.quoteFeeds=[{engine:i,behavior:a,filter:r}],this.id=e.uniqueID(!0),this.behavior=a,this.quoteFeed=i,this.loadingNewChart=!1,this.updatingChart=!1,r||(this.hasUnfilteredQuoteFeed=!0),this.updateChartLoop()},e.ChartEngine.Driver.prototype.die=function(t){for(var e=0;e<this.quoteFeeds.length;e++)if(!t||this.quoteFeeds[e]==t){var i=this.quoteFeeds[e].behavior;i.intervalTimer&&(clearInterval(i.intervalTimer),i.intervalTimer=-1)}},e.ChartEngine.Driver.prototype.getQuoteFeed=function(t){t.symbolObject||(t.symbolObject={symbol:t.symbol});for(var e=0;e<this.quoteFeeds.length;e++){var i=this.quoteFeeds[e];if(i.behavior.generator==t.symbolObject.generator&&(!i.filter||i.filter(t)))return i}return null},e.ChartEngine.Driver.prototype.multiFetch=function(t,i){0===t.length&&i([]);var a={counter:0,finished:t.length,results:[]};function r(t,e,i){return function(a){if(e.results.push({dataCallback:a,params:t}),e.counter++,e.counter>=e.finished){var r=e.results;e.results=[],i(r)}}}for(var n=0;n<t.length;n++){var s=t[n];if(s.stx.isEquationChart(s.symbol))e.fetchEquationChart(s,r(s,a,i));else{var o=this.getQuoteFeed(s);o&&e.ChartEngine.Driver.fetchData(e.QuoteFeed.SERIES,o.engine,s,r(s,a,i))}}},e.ChartEngine.Driver.prototype.updateSubscriptions=function(){for(var t=0;t<this.quoteFeeds.length;t++)this.quoteFeeds[t].checkSubscriptions&&this.quoteFeeds[t].checkSubscriptions(this.stx)},e.ChartEngine.Driver.prototype.loadDependents=function(t,i,a,r){var n,s=this;if(!r){var o=0,l=[],h=[],c=function(t){i&&++o>=s.quoteFeeds.length&&i(null)},u=function(e){++o<l.length||(h.length||c(),h.forEach((function(e){s.loadDependents(t,c,a,e.behavior)})))};return s.quoteFeeds.forEach((function(t){t.behavior.generator?h.push(t):l.push(t)})),void l.forEach((function(e){s.loadDependents(t,u,a,e.behavior)}))}var d,p,f=t.stx,m=t.chart,g=m.series,v=(f.masterData,[]),y={},x=a==e.QuoteFeed.UPDATE,b=a==e.QuoteFeed.PAGINATION,S=e.shallowClone(t);for(n in g){var C=(d=g[n]).parameters;if(!x){if(!t.future&&!1===d.moreAvailable)continue;if(t.future&&!0===d.upToDate)continue}if(!d.loading&&(!1!==C.loadData&&(!x&&!b||d.endPoints&&Object.keys(d.endPoints).length)&&(!C.data||C.data.useDefaultQuoteFeed)&&(p=C.symbolObject).symbol&&p.generator==r.generator)){S.symbolObject=p,S.symbol=p.symbol;var w=this.getQuoteFeed(S);if(r==(w&&w.behavior)){var k=!0;x||(d.loading=!0);for(var D=0;D<v.length;D++)e.symbolEqual(v[D],p)&&(k=!1);k&&(v.push(p),y[p.symbol]=d.endPoints)}}}for(var T=[],A=0;A<v.length;A++){p=v[A];var M=e.shallowClone(t.originalState);M.symbol=p.symbol,M.symbolObject=p,M.update||M.future?(M.endDate||(M.endDate=t.endDate),M.startDate=y[p.symbol].end):(M.startDate||(M.startDate=t.startDate),M.endDate=b&&!t.future?y[p.symbol].begin:t.endDate,M.ticks=t.ticks),T.push(M)}if(!T.length&&x){var P={appending:t.appending||t.originalState.update};return P.appending&&(P.appendToDate=t.startDate),f.createDataSet(null,null,P),t.nodraw||f.draw(),void(i&&i(null))}this.multiFetch(T,function(n){return function(o){for(var l=null,h=0;h<o.length;h++){var c=o[h],u=c.dataCallback.error;if(!u&&0!==u){var p=c.params.symbolObject,g=c.dataCallback,v=g.quotes,y=g.moreAvailable,x=g.upToDate,b=[];f.getSeries&&(b=f.getSeries({symbolObject:p}));for(var S=!1,C=0;C<b.length;C++)d=b[C],n||(t.future?(d.upToDate=!0===x||(x||v.length<=(c.params.startDate?1:0)),f.isHistoricalModeSet&&v.length<2&&(d.mostRecentForwardAttempt=new Date)):d.moreAvailable=!1!==y&&(y||v.length>(c.params.endDate?1:0)),d.loading=!1),S=d.parameters.fillGaps||S;v=s.cleanup(f,d,v,a,t,S),f.updateChartData(v,m,{secondarySeries:p.symbol,noCreateDataSet:!0,noCleanupDates:!0,allowReplaceOHL:!0}),v&&v.length&&(!l||l>v[0].DT)&&(l=v[0].DT)}}o.length&&(f.createDataSet(null,null,{appending:t.originalState.update||t.future,appendToDate:l}),t.nodraw||f.draw(),a==e.QuoteFeed.INITIAL&&s.resetRefreshInterval(r.refreshInterval,r)),i&&i(null)}}(x))},e.ChartEngine.Driver.prototype.cleanup=function(t,i,a,r,n,s){if(t.doCleanupDates(a,t.layout.interval),!n.missingBarsCreated&&a&&a.length&&t.cleanupGaps&&!1!==s){var o,l,h=n.chart;if(i?(h=i,l=i.parameters.symbol||i.id):l=h.defaultPlotField,r!=e.QuoteFeed.PAGINATION||n.loadMoreReplace){if(r==e.QuoteFeed.UPDATE&&h.endPoints.end&&h.endPoints.end<a[0].DT){var c=t.getFirstLastDataRecord(t.masterData,l,!0);i&&(c=c[l]),a.unshift(c),o="shift"}}else if(h.endPoints.begin&&h.endPoints.begin>a[a.length-1].DT){var u=t.getFirstLastDataRecord(t.masterData,l,!1);i&&(u=u[l]),a.push(u),o="pop"}a=t.doCleanupGaps(a,n.chart,{cleanupGaps:s,noCleanupDates:!0}),o&&a[o]()}return a},e.ChartEngine.Driver.prototype.updateChart=function(t){if(!this.updatingChart&&!this.loadingNewChart){var i=Object.keys(this.stx.charts).length,a=0,r=this.stx,n=r.layout.interval,s=r.layout.timeUnit;for(var o in r.charts){var l=r.charts[o];if(l.symbol){var h=this.makeParams(l.symbol,l.symbolObject,l),c=this.getQuoteFeed(h);if(l.masterData&&l.masterData.length&&(h.startDate=l.endPoints.end),h.update=!0,h.originalState=e.shallowClone(h),t&&t!=h.behavior)this.loadDependents(h,null,e.QuoteFeed.UPDATE,t);else{this.updatingChart=!0;var u=d(this,h,l.symbol,c);r.isEquationChart(h.symbol)?e.fetchEquationChart(h,u):c&&e.ChartEngine.Driver.fetchData(e.QuoteFeed.UPDATE,c.engine,h,u)}}}}function d(t,o,l,h){return o.behavior.prefetchAction&&o.behavior.prefetchAction("updateChart"),function(c){a++;var u=o.chart;u.masterData;if(l!=u.symbol||n!=r.layout.interval||s!=r.layout.timeUnit||r.isHistoricalMode())t.updatingChart=!1;else{if(c.error)h&&h.engine.announceError(o.originalState,c);else{var d=c.quotes;d=t.cleanup(r,null,d,e.QuoteFeed.UPDATE,o),r.updateChartData(d,u,{noCreateDataSet:!0,noCleanupDates:!0}),u.attribution=c.attribution}a==i&&(t.updatingChart=!1),o.behavior.callback&&o.behavior.callback(o),t.loadDependents(o,null,e.QuoteFeed.UPDATE,o.behavior)}}}},e.ChartEngine.Driver.prototype.updateChartLoop=function(t,e){if(e||(e=this.behavior),-1!=e.intervalTimer){e.intervalTimer&&clearInterval(e.intervalTimer);for(var i=function(t,e){return function(){e.noUpdate||t.updateChart(e)}},a=0;a<this.quoteFeeds.length;a++){var r=this.quoteFeeds[a].behavior;e!=r||r.noUpdate||(t||0===t||(t=r.refreshInterval),t&&(e.intervalTimer=setInterval(i(this,r),1e3*t)))}}},e.ChartEngine.Driver.prototype.resetRefreshInterval=function(t,e){(e||this.behavior).refreshInterval=t,this.updateChartLoop(null,e)},e.ChartEngine.Driver.prototype.loadAll=function(t,e){var i=this,a=0;!function r(){return function(n){n?e(n):!t.moreAvailable&&t.upToDate?e(null):++a>20?e("error, moreAvailable not implemented correctly in QuoteFeed"):(t.loadingMore=!1,i.checkLoadMore(t,!0,!0,r(),!0))}}()()},e.ChartEngine.Driver.prototype.checkLoadMore=function(t,i,a,r,n){var s=this.stx;if(t.loadingMore||this.loadingNewChart)return t.initialScroll=t.scroll,void(r&&r(null));s.isHistoricalMode()||(s.isHistoricalModeSet=!1);var o=this.makeParams(t.symbol,t.symbolObject,t);if(s.currentlyImporting)r&&r(null);else{var l,h=o.behavior,c=t.dataSet,u=1e3*(h.forwardPaginationRetryInterval||5),d=!1,p=!1;if(t.dataSet.length)for(var f in t.series){var m=t.series[f];m.loading||!1!==m.parameters.loadData&&(l=!m.mostRecentForwardAttempt||m.mostRecentForwardAttempt.getTime()+u<Date.now(),!1!==m.moreAvailable&&A(m)&&(d=!0),l&&!m.upToDate&&M(m)&&(p=!0))}l=!t.mostRecentForwardAttempt||t.mostRecentForwardAttempt.getTime()+u<Date.now();var g=(A(t)||i)&&!1!==t.moreAvailable,v=(M(t)||i)&&!t.upToDate&&l,y=g||d,x=s.isHistoricalModeSet&&!y&&(v||p),b=s.layout.interval,S=s.layout.timeUnit,C=!1,w=h.findHeadOfData||t.masterData&&t.masterData.length;if(!h.noLoadMore&&w&&(x||!s.maxDataSetSize||t.dataSet.length<s.maxDataSetSize)&&(y||x)){var k;if(t.initialScroll=t.scroll,t.loadingMore=!0,(o=this.makeParams(t.symbol,t.symbolObject,t)).pagination=!0,o.future=x,t.masterData&&t.masterData.length)x?o.startDate=t.endPoints.end:o.endDate=t.endPoints.begin,x&&!o.startDate?(k=s.getFirstLastDataRecord(t.masterData,"DT",!0))&&(o.startDate=k.DT):y&&!o.endDate&&(k=s.getFirstLastDataRecord(t.masterData,"DT"))&&(o.endDate=k.DT);else o.endDate=new Date;if(o.originalState=e.shallowClone(o),o.nodraw=n,!g&&d||!v&&p)return this.loadingMore=!0,this.loadDependents(o,(function(e){t.loadingMore=!1,r&&r(e)}),e.QuoteFeed.PAGINATION),void(r&&r(null));s.fetchMaximumBars[s.layout.aggregationType]&&(o.fetchMaximumBars=!0,!s.maxMasterDataSize||h.maximumTicks<s.maxMasterDataSize?o.ticks=h.maximumTicks:o.ticks=s.maxMasterDataSize);var D=function(t,i){return h.prefetchAction&&h.prefetchAction("checkLoadMore"),function(a){var s=t.stx,o=i.chart;if(i.symbol==o.symbol&&b==s.layout.interval&&S==s.layout.timeUnit)if(i.loadMore||(i.chart.loadingMore=!1),a.error)t.quoteFeed.announceError(i.originalState,a),i.chart.loadingMore=!1,r&&r(a.error);else{a.quotes||(a.quotes=[]);var l=a.quotes,c=o.masterData;if((l=t.cleanup(s,null,l,e.QuoteFeed.PAGINATION,i)).length&&o.masterData&&o.masterData.length)if(i.future){var u=l[0];u.DT&&u.DT==o.masterData[o.masterData.length-1].DT&&c.pop()}else{var d=l[l.length-1];d.DT&&+d.DT==+o.masterData[0].DT&&l.pop()}i.future?(a.upToDate?o.upToDate=!0:(!1===a.upToDate||l.length>1)&&(o.upToDate=!1),s.isHistoricalModeSet&&l.length<2&&(o.mostRecentForwardAttempt=new Date)):a.moreAvailable||!1!==a.moreAvailable&&l.length?o.moreAvailable=!0:o.moreAvailable=!1,t.tickMultiplier=l.length?2:2*t.tickMultiplier;var p,f=l[0]?l[0].DT:i.startDate,m=l[0]?l[l.length-1].DT:i.endDate;(!o.endPoints.begin||o.endPoints.begin>f)&&(o.endPoints.begin=f),(!o.endPoints.end||o.endPoints.end<m)&&(o.endPoints.end=m),o.loadingMore=!1,i.loadMoreReplace?s.setMasterData(l,o,{noCleanupDates:!0}):i.future?s.updateChartData(l,o,{noCreateDataSet:!0,noCleanupDates:!0}):e.addMemberToMasterdata({stx:s,chart:o,data:l,fields:["*"],noCleanupDates:!0}),i.future&&(p={appending:!0,appendToDate:l[0]&&l[0].DT}),s.createDataSet(void 0,void 0,p),n||s.draw(),h.callback&&h.callback(i),t.loadDependents(i,r,e.QuoteFeed.PAGINATION)}}}(this,o);if(s.isEquationChart(o.symbol))e.fetchEquationChart(o,D);else{x&&(o.appending=!0);var T=this.getQuoteFeed(o);T&&e.ChartEngine.Driver.fetchData(e.QuoteFeed.PAGINATION,T.engine,o,D)}C=!0}!C&&r&&r(null)}function A(e){return!e.endPoints.begin||c.length-t.scroll<h.bufferSize||c.length-t.scroll-s.tickFromDate(e.endPoints.begin,t)<h.bufferSize}function M(e){return!e.endPoints.end||t.scroll-t.maxTicks+1<h.bufferSize||s.tickFromDate(e.endPoints.end,t,null,!0)-c.length+t.scroll-t.maxTicks+2<h.bufferSize}},e.ChartEngine.Driver.prototype.extendHistoricalData=function(t){var i=t.from,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.stx,n=r.chart,s=r.layout,o=n.masterData,l=n.dataSet,h=s.interval,c=s.timeUnit,u=this.makeParams(n.symbol,n.symbolObject,n),d=this.getQuoteFeed(u);if(n.loadingMore||this.loadingNewChart||r.currentlyImporting||!o.length||!d||r.maxDataSetSize&&l.length>r.maxDataSetSize)return a(null);function p(t,i){return function(o){var l=o.quotes,u=o.moreAvailable,d=o.error;if(i.symbol===n.symbol&&h===s.interval&&c===s.timeUnit){if(n.loadingMore=!1,d)return a(d);l=t.cleanup(r,null,l,e.QuoteFeed.PAGINATION,i),n.moreAvailable="boolean"==typeof u?u:!!l.length,n.endPoints.begin=l[0].DT,e.addMemberToMasterdata({stx:r,chart:n,data:l,fields:["*"],noCleanupDates:!0}),r.createDataSet(),r.draw()}}}n.loadingMore=!0,u.originalState=Object.assign({},u),u.startDate=i,u.endDate=o[0].DT,e.ChartEngine.Driver.fetchData(e.QuoteFeed.PAGINATION,d.engine,u,p(this,u))},e.ChartEngine.Driver.prototype.barsToFetch=function(t){e.isValidNumber(this.tickMultiplier)||(this.tickMultiplier=2);var i=this.stx.layout.interval,a=t.stx.layout.periodicity;return"month"!=i&&"week"!=i||this.stx.dontRoll||(a*="week"==i?7:30),t.stx.chart.maxTicks*a*this.tickMultiplier},e.ChartEngine.Driver.determineStartDate=function(t,e,i){return this.determineStartOrEndDate(t,e,i,!0)},e.ChartEngine.Driver.determineStartOrEndDate=function(t,e,i,a){return a||t.fetchMaximumBars?t.startDate||e.previous(i):t.future?e.next(i):new Date},e.ChartEngine.Driver.prototype.makeParams=function(t,i,a){var r=this.stx,n=r.layout.interval,s=this.barsToFetch({stx:r});"month"!=n&&"week"!=n||r.dontRoll||(n="day");var o=this.getQuoteFeed({interval:n,symbol:t,symbolObject:i}),l=o&&o.behavior,h=e.shallowClone(l)||{};h.behavior=l;var c=!1,u=[];a.market&&a.market.getSessionNames&&(u=a.market.getSessionNames()),r.extendedHours?r.extendedHours.filter?c=!0:(c=r.layout.extended,u=u.filter((function(t){return t.enabled||r.layout.marketSessions[t.name]}))):u=u.filter((function(t){return t.enabled}));for(var d=0;d<u.length;d++)u[d]=u[d].name;return e.extend(h,{stx:r,symbol:t,symbolObject:i,chart:a,interval:n,extended:c,period:1,ticks:s,additionalSessions:u,quoteDriverID:this.id},!0),h.symbolObject||(h.symbolObject={symbol:t}),isNaN(h.interval)||(h.period=parseInt(h.interval,10),h.interval=r.layout.timeUnit,h.interval||(h.interval="minute")),h},e.ChartEngine.Driver.prototype.newChart=function(t,i){var a=this.stx,r=t.symbol,n=a.layout.interval,s=a.layout.timeUnit,o=t.chart;o.moreAvailable=null,o.upToDate=null,o.loadingMore=!1,o.attribution=null;var l=this.makeParams(r,t.symbolObject,o);e.extend(l,t,!0);var h=this.getQuoteFeed(l),c=l.behavior;(a.fetchMaximumBars[a.layout.aggregationType]||t.fetchMaximumBars)&&(!a.maxMasterDataSize||c.maximumTicks<a.maxMasterDataSize?l.ticks=c.maximumTicks:l.ticks=a.maxMasterDataSize,l.fetchMaximumBars=!0),this.loadingNewChart=!0,this.updatingChart=!1,l.originalState=e.shallowClone(l);var u=function(o,l){return c.prefetchAction&&c.prefetchAction("newChart"),function(u){var d=l.chart,p=u.quotes,f=!1;if(r==d.symbol&&n==a.layout.interval&&s==a.layout.timeUnit){for(var m in o.loadingNewChart=!1,u.error?h.engine.announceError(l.originalState,u):(p=o.cleanup(a,null,p,e.QuoteFeed.INITIAL,l),a.setMasterData(p,d,{noCleanupDates:!0}),d.endPoints={},d.endPoints.begin=p[0]?p[0].DT:l.startDate,d.endPoints.end=p[0]?p[p.length-1].DT:l.endDate,p?(d.moreAvailable=!1!==u.moreAvailable,d.upToDate=u.upToDate):(d.moreAvailable=!1,d.upToDate=!0),d.attribution=u.attribution,t.initializeChart&&a.initializeChart(),a.createDataSet(),f=!0),d.series)d.series[m].endPoints={},d.series[m].moreAvailable=null,d.series[m].upToDate=null;var g=d.masterData;g&&g.length&&(l.startDate=g[0].DT,l.endDate=g[g.length-1].DT),c.callback&&c.callback(l),o.loadDependents(l,(function(){f&&!l.nodraw&&o.stx.home(),i&&i(u.error),o.stx.dispatch("newChart",{stx:o.stx,symbol:o.stx.chart.symbol,symbolObject:o.stx.chart.symbolObject,moreAvailable:o.stx.chart.moreAvailable,upToDate:o.stx.chart.upToDate,quoteDriver:o}),o.resetRefreshInterval(c.refreshInterval,c)}),e.QuoteFeed.INITIAL)}else i&&i("orphaned")}}(this,l);this.stx.isEquationChart(l.symbol)?e.fetchEquationChart(l,u):h&&e.ChartEngine.Driver.fetchData(e.QuoteFeed.INITIAL,h.engine,l,u)},e.QuoteFeed.INITIAL=1,e.QuoteFeed.UPDATE=2,e.QuoteFeed.PAGINATION=3,e.QuoteFeed.SERIES=4,e.ChartEngine.Driver.fetchData=function(t,i,a,r){if(!a.symbol)return r({});i.v2QuoteFeed?"function"!=typeof i.subscribe?e.ChartEngine.Driver.fetchDataInContext(t,i,a,r):e.ChartEngine.Driver.fetchDataInContext(t,i,a,function(t){t.error||this.checkSubscriptions(a.stx),r(t)}.bind(i)):(a.stx.convertToDataZone(a.startDate),a.stx.convertToDataZone(a.endDate),i.fetch(a,r))},e.ChartEngine.Driver.fetchDataInContext=function(t,i,a,r){var n,s,o,l,h=a.stx;if(h.chart.market.newIterator){t===e.QuoteFeed.SERIES&&(a.series=!0,t=e.QuoteFeed.INITIAL,a.endDate&&!a.startDate||a.future?t=e.QuoteFeed.PAGINATION:a.startDate&&!a.endDate&&(t=e.QuoteFeed.UPDATE));var c=Math.min(a.ticks,a.maximumTicks);i.maxTicks&&(c=Math.min(c,i.maxTicks));var u=a.symbolObject.masterSymbol||a.symbol;switch(t){case e.QuoteFeed.UPDATE:if(h.isHistoricalModeSet)return void(h.quoteDriver.updatingChart=!1);var d;a.startDate?d=a.startDate:(d=new Date).setHours(0,0,0,0),"function"==typeof i.fetchUpdateData&&i.fetchUpdateData(u,h.convertToDataZone(d),a,r);break;case e.QuoteFeed.INITIAL:n={begin:l=a.endDate||new Date,interval:a.interval,periodicity:"tick"==a.interval?h.chart.xAxis.futureTicksInterval:a.period,outZone:h.dataZone},s=h.chart.market.newIterator(n),o=e.ChartEngine.Driver.determineStartDate(a,s,c),a.endDate&&(l=a.endDate),"function"==typeof i.fetchInitialData&&i.fetchInitialData(u,o,h.convertToDataZone(l),a,r);break;case e.QuoteFeed.PAGINATION:n={begin:a.endDate||a.startDate,interval:a.interval,periodicity:"tick"==a.interval?h.chart.xAxis.futureTicksInterval:a.period,outZone:h.dataZone},s=h.chart.market.newIterator(n);var p=e.ChartEngine.Driver.determineStartOrEndDate(a,s,c,!a.future);if(o=a.startDate||p,l=a.endDate||p,a.startDate?a.stx.convertToDataZone(o):a.stx.convertToDataZone(l),"function"==typeof i.fetchPaginationData){if(h.maxMasterDataSize&&h.maxMasterDataSize<=h.masterData.length)return;i.fetchPaginationData(u,o,l,a,(function(t){l>=Date.now()&&(h.isHistoricalModeSet=!1),r&&r(t)}))}break;default:console.error("Illegal fetchData constant")}}else console.error("quoteFeed feature requires first activating market feature.")}},T=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine.prototype.addSeries=function(t,i,a){var r=this.runPrepend("addSeries",arguments);if(r)return r;var n=t||null,s=t;t||(t=e.uniqueID()),i&&!0===i.panel&&(i.panel=t);var o={parameters:i?e.clone(i):{},yValueCache:[],display:n,id:t,loading:!i||!1!==i.loadData};o.parameters.yAxis=i&&i.yAxis,(i=o.parameters).symbol&&(s=i.symbol),i.isComparison&&(i.shareYAxis=!0),!i.yAxis||i.yAxis instanceof e.ChartEngine.YAxis||(i.yAxis=new e.ChartEngine.YAxis(i.yAxis)),e.ensureDefaults(i,{chartName:this.chart.name,symbolObject:{symbol:s},panel:this.chart.panel.name,fillGaps:!1,action:"add-series"}),"display"in i&&(o.display=i.display);var l=this.charts[i.chartName],h=i.symbolObject;s=i.symbol=h.symbol,o.display||(o.display=s||i.field),o.endPoints={},i.gapDisplayStyle||!1===i.gapDisplayStyle||(i.gapDisplayStyle=i.gaps),i.isComparison&&void 0===i.gapDisplayStyle&&(i.gapDisplayStyle="transparent");var c=this.getSeries({symbolObject:h,chart:l,includeMaster:!0}),u=i.panel;if(this.panels[u])i.yAxis||i.shareYAxis||(i.yAxis=new e.ChartEngine.YAxis({name:t,position:"none"}));else{var d=i.yAxis||new e.ChartEngine.YAxis;d.name=t,this.createPanel(t,u,null,null,d),this.preferences.dragging&&this.preferences.dragging.series||(i.highlightable=!1)}l.series[t]=o;var p=this,f=this.currentlyImporting;function m(a,r){var n=i.renderer||"Lines",s=i.name||t;if(!i.yAxis||i.yAxis instanceof e.ChartEngine.YAxis||f||(i.yAxis.name=s),i.renderer||i.name||i.color||i.chartType){var o=a.getSeriesRenderer(s);if(!o){var l={name:s,overChart:!1!==i.overChart,useChartLegend:!0,highlightable:i.highlightable,dependentOf:i.dependentOf};if(i.chartType?(l=e.extend({panel:i.panel,yAxis:i.yAxis},l),o=e.Renderer.produce(i.chartType,l)):(e.ensureDefaults(i,{name:l.name,overChart:!1!==i.overChart,useChartLegend:!0}),o=new e.Renderer[n]({params:i})),!o)return;a.setSeriesRenderer(o)}o.attachSeries(t,i),!1!==i.loadData&&o.ready(),a.layout.symbols=a.getSymbols({"include-parameters":!0,"exclude-studies":!0}),a.changeOccurred("layout")}}function g(t){return function(e){if(!e.error){var r=e.quotes,n=i.fillGaps;p.cleanupGaps||(n=!1),r=p.doCleanupGaps(r,p.chart,{cleanupGaps:n}),p.updateChartData(r,p.chart,{secondarySeries:s,noCreateDataSet:!0,noCleanupDates:!0,allowReplaceOHL:!0}),o.loading=!1,o.moreAvailable=e.moreAvailable,o.upToDate=e.upToDate,m(p)}null===i.action||c.length||p.dispatch(f?"symbolImport":"symbolChange",{stx:p,symbol:t.symbol,symbolObject:t.symbolObject,action:i.action,id:o.id,parameters:i}),a&&a.call(p,e.error,o)}}!i.isComparison||!l.forcePercentComparison||i.panel!=l.panel.name||i.yAxis&&i.yAxis!=l.yAxis||this.setChartScale("percent");var v=l.masterData;v||(v=l.masterData=this.masterData=[]);var y=v.length;if(i.data&&!i.data.useDefaultQuoteFeed){var x={symbol:s,symbolObject:h,action:i.action};g(x)({quotes:i.data})}else if(c.length)o.endPoints=c[0].endPoints,m(this),a&&setTimeout((function(){a.call(p,null,o)}),0);else if(this.quoteDriver&&!1!==i.loadData){var b=this.quoteDriver,S=b.makeParams(s,h,l);if(y&&(S.startDate=v[0].DT,S.endDate=this.isHistoricalMode()?v[v.length-1].DT:new Date),S.stx.isEquationChart(S.symbol))e.fetchEquationChart(S,g(S));else{var C=b.getQuoteFeed(S);C&&e.ChartEngine.Driver.fetchData(4,C.engine,S,g(S))}}else m(this),a&&a.call(this,null,o);return this.runAppend("addSeries",arguments),o},e.ChartEngine.prototype.getSeries=function(t){var i=t.chart?t.chart:this.chart,a=i.series,r=t.symbolObject;r||(r={symbol:t.symbol});var n=[];for(var s in a){var o=a[s];e.symbolEqual(r,o.parameters.symbolObject)&&n.push(o)}return t.includeMaster&&e.symbolEqual(r,i.symbolObject)&&n.push({}),n},e.ChartEngine.prototype.modifySeries=function(t,i,a){var r,n,s;if(!this.runPrepend("modifySeries",arguments)&&(i&&("string"==typeof t?(n=t,r=(s=i.chartName?this.charts[i.chartName]:this.chart).series[n]):(n=(r=t).id,s=this.charts[r.parameters.chartName]),r))){e.extend(r.parameters,i);var o,l=r.parameters;for(var h in s.seriesRenderers)for(var c=s.seriesRenderers[h],u=c.params,d=c.seriesParams,p=0;p<d.length;++p){var f=d[p],m=this.panels[f.panel],g=m&&m.yAxis.name;if(f.id===r.id){if(!0===l.panel&&(l.panel=l.dependentOf||l.name),u.panel=l.panel,i.yAxis&&(u.yAxis=i.yAxis),l.panel!=f.panel&&u.name==g)this.electNewPanelOwner(f.panel);else{var v=this.getYAxisByName(l.panel,u.name);v&&l.yAxis&&v.name!==l.yAxis.name&&(v.name=this.electNewYAxisOwner(v))}l.field||(l.field=null),c.attachSeries(n,e.ensureDefaults(l,f)),l.field||(l.field=l.subField),delete l.subField,!l.isComparison||!s.forcePercentComparison||l.panel!=s.panel.name||r.parameters.yAxis&&l.yAxis.name!=s.yAxis.name||this.setChartScale("percent"),o=c;break}}if(this.changeOccurred("layout"),e.getFn("Drawing.updateSource")(this,r.parameters.symbol||n,null,r.parameters.panel),this.runAppend("modifySeries",arguments),!0!==a){for(var y=o.getDependents(this),x=0;x<y.length;x++)this.modifySeries(y[x].params.name,{panel:o.params.panel,yAxis:r.parameters.yAxis},!0);var b=s.seriesRenderers[o.params.dependentOf];b&&(b.params.yAxis==r.parameters.yAxis&&b.params.panel==o.params.panel||this.modifySeries(o.params.dependentOf,{panel:o.params.panel,yAxis:r.parameters.yAxis},!0))}return this.draw(),r}},e.ChartEngine.prototype.deleteSeries=function(t,e,i){if(!this.runPrepend("deleteSeries",arguments)){var a,n=(i=i||{}).action?i.action:"remove-series";"object"===r(t)?(a=t.id,e=e||this.charts[t.parameters.chartName]):(a=t,e=e||this.chart);var s=e.series[a];if(s){var o=s.parameters.loadData,l=s.parameters.symbolObject;delete e.series[a];var h=this.getSeries({symbolObject:l,includeMaster:!0});!1===o&&h.push(a),h.length||this.cleanMasterData(l,e);var c=this.panels[s.parameters.panel];c&&this.checkForEmptyPanel(c),this.createDataSet(),h.length||this.dispatch(this.currentlyImporting?"symbolImport":"symbolChange",{stx:this,symbol:l.symbol,symbolObject:l,id:a,action:n}),this.quoteDriver&&this.quoteDriver.updateSubscriptions(),this.runAppend("deleteSeries",arguments)}}},e.ChartEngine.prototype.removeSeries=function(t,e){if(!this.runPrepend("removeSeries",arguments)){var i,a=!1;for(var n in"object"===r(t)?(i=t.id,e=e||this.charts[t.parameters.chartName]):(i=t,e=e||this.chart),e.seriesRenderers)for(var s=e.seriesRenderers[n],o=this.panels[s.params.panel],l=o&&o.yAxis.name,h=s.seriesParams.length-1;h>=0;h--){var c=s.seriesParams[h];if(c.id===i){if(s.removeSeries(i),s.seriesParams.length<1)if(this.removeSeriesRenderer(s),s.params.name==l)this.electNewPanelOwner(s.params.panel);else if(!this.checkForEmptyPanel(s.params.panel)){var u=this.getYAxisByName(o,s.params.name);u&&(u.name=u.studies[0]||u.renderers[1])}a=!0}}a||this.deleteSeries(i,e),this.resetDynamicYAxis(),this.draw(),this.resizeChart(),this.runAppend("removeSeries",arguments)}},e.Comparison=e.Comparison||function(){},e.Comparison.initialPrice=100,e.Comparison.getInitialPrice=function(t){if(t.initialComparisonPrice)return t.initialComparisonPrice;t.initialComparisonPrice=100;var i=e.Comparison.initialPrice;if("number"==typeof i&&(t.initialComparisonPrice=i),"string"==typeof i&&(t.series[i]||""===i)){var a="Close";t.defaultPlotField&&(t.highLowBars||(a=t.defaultPlotField));for(var r=t.dataSet.length-t.scroll;r<t.dataSet.length;r++){var n=t.dataSet[r];if(n){if(n[i]&&n[i][a]){t.initialComparisonPrice=n[i][a];break}if(""===i&&n[a]){t.initialComparisonPrice=n[a];break}}}}return t.initialComparisonPrice},e.Comparison.priceToPercent=function(t,i,a){var r=e.Comparison.baseline||a;return Math.round((a-r)/r*100*1e4)/1e4},e.Comparison.percentToPrice=function(t,i,a){return(e.Comparison.baseline||1)*(1+a/100)},e.Comparison.priceToRelative=function(t,i,a){var r=e.Comparison.baseline||a;return e.Comparison.getInitialPrice(i)*a/r},e.Comparison.relativeToPrice=function(t,i,a){return(e.Comparison.baseline||1)*a/e.Comparison.getInitialPrice(i)},e.Comparison.createComparisonSegmentInner=function(t,i){var a,r,n,s=[];for(a in i.series){var o=i.series[a].parameters;o.isComparison&&s.push(o.symbol)}var l=["Close","Open","High","Low","iqPrevClose"],h=t.chart.highLowBars;i.defaultPlotField&&!h&&l.unshift(i.defaultPlotField);var c=l[0],u=t.layout.studies;for(var d in u){var p=u[d];if(r=t.panels[p.panel],n=p.getYAxis(t),r&&r.yAxis==n){for(a in p.outputMap)l.push(a);for(var f=0;f<=2;f++)l.push(p.name+"_hist"+(f||""));p.referenceOutput&&l.push(p.referenceOutput+" "+p.name)}}for(var m in t.plugins){var g=t.plugins[m];if(g.transformOutputs)for(a in g.transformOutputs)l.push(a)}i.initialComparisonPrice=null,i.dataSegment=[];var v=null,y=i.dataSet.length-i.scroll-1;t.startComparisonsAtFirstVisibleBar&&(y+=1);for(var x=i.maxTicks+3,b=0;b<=x;b++){b==x&&(b=-1);var S=y+b;if(S<i.dataSet.length&&S>=0){var C,w=i.dataSet[S],k=w[c];if(!v){if(0===k||null===k){if(b<0)break;continue}v=e.clone(w)}for(w.transform||(w.transform={cache:{},DT:w.DT,Date:w.Date}),!e.Comparison.baseline&&k&&(v=e.clone(w)),e.Comparison.baseline=v[c],C=0;C<l.length;C++)(w[a=l[C]]||0===w[a])&&(w.transform[a]=i.transformFunc(t,i,w[a]));for(C=0;C<s.length;C++){a=s[C];var D=i.series[a];if(-1==b&&D&&D.parameters.isComparison)delete w.transform[a];else for(var T=w[a],A=0;T&&A<l.length;A++){var M=T[l[A]];if(M||0===M){var P=v[a]&&v[a][l[0]];if(P||0===P||(v[a]||(v[a]={}),v[a][l[A]]=P=M*e.Comparison.baseline/w[c]),0!==P){var F=M*((e.Comparison.baseline||1)/P);w.transform[a]||(w.transform[a]={}),w.transform[a][l[A]]=i.transformFunc(t,i,F)}}}}i.dataSegment.push(w)}else S<0&&i.dataSegment.push(null);if(b<0)break}},e.Comparison.priceFormat=function(t,e,i){if(null==i||isNaN(i))return"";var a=e.yAxis.priceTick,r=t.internationalizer;return i=r?a>=5?r.percent.format(i/100):a>=.5?r.percent1.format(i/100):a>=.05?r.percent2.format(i/100):a>=.005?r.percent3.format(i/100):r.percent4.format(i/100):a>=5?i.toFixed(0)+"%":a>=.5?i.toFixed(1)+"%":a>=.05?i.toFixed(2)+"%":a>=.005?i.toFixed(3)+"%":i.toFixed(4)+"%",0===parseFloat(i)&&"-"==i.charAt(0)&&(i=i.substring(1)),i},e.ChartEngine.prototype.setComparison=function(t,i,a){if(i||(i=this.chart),"string"==typeof i&&(i=this.charts[i]),(a||""===a)&&(e.Comparison.initialPrice=a),!0===t){if(i.isComparison)return;t="percent"}this.resetDynamicYAxis();var r=i.panel.yAxis,n=r.priceFormatter==e.Comparison.priceFormat;switch(t){case"relative":this.setTransform(i,e.Comparison.priceToRelative,e.Comparison.relativeToPrice),n&&(r.priceFormatter=r.originalPriceFormatter?r.originalPriceFormatter.func:null,r.originalPriceFormatter=null),r.whichSet="dataSegment",i.isComparison=!0;break;case"percent":this.setTransform(i,e.Comparison.priceToPercent,e.Comparison.percentToPrice),n||(r.originalPriceFormatter={func:r.priceFormatter},r.priceFormatter=e.Comparison.priceFormat),r.whichSet="dataSegment",i.isComparison=!0;break;default:this.unsetTransform(i),n&&(r.priceFormatter=r.originalPriceFormatter?r.originalPriceFormatter.func:null,r.originalPriceFormatter=null),r.whichSet="dataSet",i.isComparison=!1}},e.ChartEngine.prototype.setChartScale=function(t){var i=this.chart,a={percent:!0,relative:!0};t||(t="linear"),a[t]?this.setComparison(t,i,e.Comparison.initialPrice):a[this.layout.chartScale]&&this.setComparison(!1,i),this.layout.chartScale=t,i.canvas&&this.draw(),this.changeOccurred("layout")}},A=function(t){var e,i="undefined"!=typeof _CIQ?_CIQ:t.CIQ;function a(t){if(t.style){var e=getComputedStyle(t);for(var i in["alignment-baseline","dominant-baseline","fill","fill-opacity","font-family","font-size","font-variant","font-weight","text-align","text-anchor"].forEach((function(i){!t.style[i]&&e[i]&&(t.style[i]=e[i])})),t.children)a(t.children[i])}}function n(t,i,r){i||(i={});var n=document.querySelector("body");if(i.hide&&i.hide instanceof Array)for(var s=i.hide.join(", "),o=document.querySelectorAll(s),l=0;l<o.length;l++)o[l].classList.add("ciq-no-share");n.classList.add("sharing");for(var h=t.chart.container.getElementsByTagName("svg"),c=[],u=0;u<h.length;u++){var d=h[u];c.push(d.innerHTML),a(d)}e(t.chart.container,{allowTaint:!1,logging:!1,width:i.width||null,height:i.height||null,backgroundColor:i.background||null,useCORS:!0}).then((function(t){for(r&&r(null,i.data?t.toDataURL("image/png"):t),u=0;u<h.length;u++)h[u].innerHTML=c[u];n.classList.remove("sharing")})).catch((function(t){for(r&&r(t),u=0;u<h.length;u++)h[u].innerHTML=c[u];n.classList.remove("sharing")}))}i.Share=i.Share||function(){},i.Share.FullChart2PNG=function(t,a,r){if(t&&t.chart){if("undefined"==typeof html2canvas)return function(t){if("undefined"!=typeof html2canvas)return e=html2canvas,t();if("undefined"!=typeof requirejs)try{return requirejs(["html2canvas.min.js"],(function(i){return e=i,t()}))}catch(t){console.warn("Require loading has failed, attempting to load html2canvas manually.")}i.loadScript(function(){if(i.Share.html2canvasLocation)return i.Share.html2canvasLocation;for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++){var a=t[e];if(a.src&&a.src.indexOf("share.js")>-1)return a.src.replace(/standard\/share\.js/,"")+"thirdparty/"}return"js/thirdparty/"}()+"html2canvas.min.js",(function(){return e=html2canvas,t()}))}((function(){return n(t,a,r)}));e=html2canvas,n(t,a,r)}},i.Share.createImage=function(t,e,a){var n=[].slice.call(arguments);a=n.pop(),null!==e&&"object"==r(e)||(e={widthPX:n[1],heightPX:n[2],imageType:n[3]});var s=e.widthPX,o=e.heightPX,l=e.imageType,h=t.chart.canvas.height,c=t.chart.canvas.width;t.chart.canvas.style.height&&(h=i.stripPX(t.chart.canvas.style.height),c=i.stripPX(t.chart.canvas.style.width)),s&&o?(h=o,c=s):o?c=t.chart.canvas.width*(h/t.chart.canvas.height):s&&(c=s,h=t.chart.canvas.height*(s/t.chart.canvas.width));var u=l?"image/"+l:"image/png",d=document.createElement("img");d.onload=function(){i.Share.FullChart2PNG(t,{image:this,width:c,height:h,hide:e.hide},(function(t,e){if(t)console.warn("Error producing canvas snapshot: "+t);else try{a(e.toDataURL(u))}catch(t){console.warn("Safari devices do not handle CORS enabled images. Using the charts' canvas as a fallback."),a(d.src)}}))},d.src=t.chart.canvas.toDataURL(u)},i.Share.uploadImage=function(t,e,a,r){a||(a={}),a.image=t,i.postAjax(e,JSON.stringify(a),(function(t,e){200==t?r(null,e):r(t,null)}))||r(0,null)},i.Share.shareChart=function(t,e,a){i.Share.createImage(t,{},(function(r){var n=i.uniqueID(),s="https://share.chartiq.com",o=s+"/upload/"+n;e&&(e.host&&(s=e.host),e.path&&(o=s+e.path+"/"+n));var l=t.getStartDateOffset(),h={id:n,image:r,config:{layout:t.exportLayout(),drawings:t.exportDrawings(),xOffset:l,startDate:t.chart.dataSegment[l].Date,endDate:t.chart.dataSegment[t.chart.dataSegment.length-1].Date,id:n,symbol:t.chart.symbol}};i.Share.uploadImage(r,o,h,(function(t,e){null!==t?i.alert("error sharing chart: ",t):a(s+e)}))}))}},M=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine.prototype.setRange=function(t,i){e.isEmpty(t)&&(t={dtLeft:arguments[0],dtRight:arguments[1],padding:arguments[2],chart:arguments[3]},i=arguments[4]),this.staticRange&&(t.goIntoPast=t.goIntoFuture=!0),t.chart||(t.chart=this.chart),void 0===t.padding&&(t.padding=0);var a,r=!1,n=t.chart,s="string"==typeof t.dtLeft?new Date(t.dtLeft):t.dtLeft,o=new Date;t.dtRight&&(o="string"==typeof t.dtRight?new Date(t.dtRight):t.dtRight),s||(a=this.standardMarketIterator(o,null,n),s=a.previous(n.maxTicks),t.periodicity||(r=!0)),n.inflectionPoint=s,this.layout.range={dtLeft:s,dtRight:o};var l=this;function h(e){void 0===e&&(e=null);var a=0,r=0,h=new Date,c=t.base,u=t.periodicity,d=l.layout;if(t.goIntoFuture&&(!n.masterData.length||s>n.masterData[n.masterData.length-1].DT)){var p=n.masterData.length?n.masterData.pop():{DT:s},f=l.doCleanupGaps([p,{DT:o}],n,{cleanupGaps:"gap",noCleanupDates:!0});l.setMasterData(n.masterData.concat(f),n,{noCleanupDates:!0}),l.createDataSet(null,null,{appending:!0})}var m=n.dataSet,g=m.length;if(m&&0!==g){var v;if("day"===c&&u&&"day"===u.interval){var y=t.multiplier;a=g<y?0:g-y,r=g-1}else if("today"===c&&m[g-1].DT.getDate()<h.getDate()){var x=new Date(m[g-1].DT.getTime());x.getTime();v=0;for(var b=g-1;b>=0;b--)if(m[b]&&m[b].DT.getDate()!=x.getDate()){x=new Date(+m[b+1].DT),v=b+1;break}a=v,r=g-1}else a="all"!=t.base&&(s.getTime()>=m[0].DT.getTime()||t.goIntoPast)?l.tickFromDate(s,n,null,!0):0,"all"!=t.base&&(o.getTime()<=m[g-1].DT.getTime()||t.goIntoFuture)?(r=l.tickFromDate(o,n))>g-1&&r--:r=g-1;var S=r-a+1;if(S<1)i&&i(e);else{var C=t.padding||0;r<g-1&&(C=0);var w=(n.width-C)/S;for(var k in l.setCandleWidth(w,n),n.scroll=S-(r-g)-1,l.micropixels=1,l.panels)l.calculateYAxisMargins(l.panels[k].yAxis);t.dontSaveRangeToLayout?delete d.range:(delete t.chart,delete d.setSpan,d.range=t),l.draw(),l.changeOccurred("layout"),i&&i(e)}}else i&&i(e)}var c=0;function u(t){return t&&0===c?(n.scroll=M,l.setCandleWidth(P),l.layout.interval=F,l.layout.periodicity=_,l.layout.timeUnit=E,void(i&&i(t))):++c>10?(console.log("CIQ.ChartEngine.setRange(): Too many loads (10) from server. Stopping. Check periodicity logic."),void h()):void h()}function d(t,i,a,r,n,s){var o=0,l=t-i;return e.ChartEngine.isDailyInterval(a)?o="month"==a?l/e.MONTH/r:"week"==a?l/e.WEEK/r:l/e.DAY/r:isNaN(a)||(o="millisecond"==n?l/(r*a):"second"==n?l/e.SECOND/(r*a):l/e.MINUTE/(r*a)),Math.round(o)}if(this.quoteDriver){var p,f,m;if(r)p=this.layout.interval,m=this.layout.timeUnit,f=this.layout.periodicity;else if(t.periodicity){var g=e.cleanPeriodicity(t.periodicity.period,t.periodicity.interval,t.periodicity.timeUnit);p=g.interval,m=g.timeUnit,f=g.period}else{var v=o.getTime()-s.getTime();if(this.autoPickCandleWidth.turnOn){var y=0;y=this.autoPickCandleWidth.candleWidth?this.autoPickCandleWidth.candleWidth:this.chart.barsHaveWidth?5:2;var x,b=n.width/y,S=this.dynamicRangePeriodicityMap;p=S[0].interval,f=1;for(var C=0;C<S.length;C++){var w=v/S[C].rangeInMS;if(w<b){S[C-1]?(p=S[C-1].interval,m=S[C-1].timeUnit,f=Math.ceil(x/b)):(p=S[C].interval,m=S[C].timeUnit,f=1);break}x=w}}else{for(var k=this.staticRangePeriodicityMap,D=null,T=0;T<k.length;T++){var A=k[T];if(v/A.rangeInMS<1.001){D=A;break}}p=D.interval,f=D.periodicity,m=D.timeUnit}}var M=this.chart.scroll,P=this.layout.candleWidth,F=this.layout.interval,_=this.layout.periodicity,E=this.layout.timeUnit;this.chart.scroll=this.chart.maxTicks=d(o.getTime(),s.getTime(),p,f,m,this.dontRoll),this.layout.candleWidth=this.chart.width/this.chart.maxTicks;var L=this.needDifferentData({period:f,interval:p,timeUnit:m});if(Object.keys(this.chart.endPoints).length&&(this.chart.endPoints.begin>s||this.chart.endPoints.end<o)&&(L=!0),!this.chart.masterData||!this.chart.masterData.length||L||t.forceLoad){this.layout.interval=p,this.layout.periodicity=f,this.layout.timeUnit=m,this.layout.timeUnit||(e.ChartEngine.isDailyInterval(this.layout.interval)?this.layout.timeUnit=null:"second"==this.layout.interval?this.layout.timeUnit="second":"tick"!=this.layout.interval&&(this.layout.timeUnit="minute"));var I={symbol:n.symbol,symbolObject:n.symbolObject,chart:n,nodraw:!0};"tick"==this.layout.interval&&(I.startDate=s,I.endDate=o),this.displayInitialized||(I.initializeChart=!0);var O={symbol:n.symbol,symbolObject:n.symbolObject,interval:this.layout.interval};"month"!=O.interval&&"week"!=O.interval||this.dontRoll||(O.interval="day");var N=Math.max(this.quoteDriver.getQuoteFeed(O).behavior.bufferSize+50,200);a=this.standardMarketIterator(s,null,n),I.startDate=new Date(a.previous(N).getTime()),a=this.standardMarketIterator(o,null,n),I.endDate=new Date(a.next(N).getTime()),I.endDate<Date.now()&&(this.isHistoricalModeSet=!0),this.clearCurrentMarketData(this.chart),clearTimeout(this.streamParameters.timeout),this.quoteDriver.newChart(I,u)}else this.layout.interval==p&&this.layout.periodicity==f&&this.layout.timeUnit==m&&this.chart.dataSegment&&this.chart.dataSegment[0]&&this.chart.dataSegment[0].DT==n.inflectionPoint||(this.layout.interval=p,this.layout.periodicity=f,this.layout.timeUnit=m,this.createDataSet()),u()}else h()},e.ChartEngine.prototype.setSpan=function(t,i){var a=arguments[0],n=arguments[1],s=arguments[2],o=arguments[3];"object"==r(t)?(a=t.period?t.period:t.multiplier?t.multiplier:1,n=t.interval?t.interval:t.base?t.base:t.span?t.span:t.period,s=t.padding,o=t.chart):(t={period:a,interval:n,padding:s,chart:o},i=arguments[5]),o||(o=this.chart);var l,h=o.market;if("all"==(n=n.toLowerCase()))return t.dontSaveRangeToLayout=!0,void this.displayAll(t,i);var c=n,u=1;"today"==n?c="day":"year"==n&&(c="month",u=12);var d=e.shallowClone(t),p={begin:h.marketZoneNow(),interval:c,period:u},f=p.begin;function m(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}var g=e.Market.Symbology.isForexSymbol(o.symbol);function v(t,e){if(!g)return t;return e?t.setHours(t.getHours()+7):(t.setHours(t.getHours()-7),h.isMarketDate(t)||t.setDate(t.getDate()-2)),t}if("ytd"===n)(f=m(f)).setMonth(0),f.setDate(1);else if("month"===n)(f=m(new Date)).setMonth(f.getMonth()-a);else if("year"===n)(f=m(new Date)).setFullYear(f.getFullYear()-a);else if("week"===n)(f=m(new Date)).setDate(f.getDate()-7*a);else if("day"===n&&1==a&&h.isMarketDay()){var y=f.getHours(),x=f.getMinutes(),b=f.getSeconds(),S=f.getMilliseconds();(f=(l=h.newIterator(p)).previous()).setHours(y,x,b,S),f=h._convertFromMarketTZ(f)}else"today"===n?(p.begin=v(f,!0),l=h.newIterator(p),(h.isOpen()||h.getPreviousOpen().getDate()==f.getDate())&&l.next(),v(f=l.previous()),d.goIntoFuture=!0,d.dtRight=new Date(+f),d.dtRight.setDate(f.getDate()+1),d.dtRight=h._convertFromMarketTZ(d.dtRight),g||(f.setHours(l.market.zopen_hour),f.setMinutes(l.market.zopen_minute),f.setSeconds(0)),f=h._convertFromMarketTZ(f)):("day"==n&&(p.begin=v(f,!0)),1==a&&a++,f=(l=h.newIterator(p)).previous(a-1),"day"==n&&(f=h._convertFromMarketTZ(v(f))));d.dtLeft=f,d.maintainPeriodicity&&(d.periodicity={},d.periodicity.interval=this.layout.interval,d.periodicity.period=this.layout.periodicity),o.spanLock=!1,d.dontSaveRangeToLayout=!0;var C=this;this.setRange(d,(function(e){C.layout.setSpan=t,C.changeOccurred("layout"),"today"==n&&(o.spanLock=!0),i&&i(e)}))},e.ChartEngine.prototype.getSpanCandleWidth=function(t){if(t&&t.base&&t.multiplier){var e=parseFloat(t.multiplier),i=t.base,a=new Date,r=new Date;"year"==i?r.setFullYear(r.getFullYear()-e):"month"==i?r.setMonth(r.getMonth()-e):"day"==i?r.setDate(r.getDate()-e):"week"==i?r.setDate(r.getDate()-7*e):"YTD"==i&&(r.setMonth(0),r.setDate(1));var n=(a.getTime()-r.getTime())/1e3/60/60/24;return n=5*n/7,this.chart.width/n}},e.ChartEngine.prototype.displayAll=function(t,i){var a=this.chart;t&&t.chart&&(a=t.chart);var r=this;function n(){if(a.masterData&&a.masterData.length){var n=e.clone(t);n.dtLeft=a.masterData[0].DT,n.dtRight=a.masterData[a.masterData.length-1].DT,n.periodicity={},n.periodicity.interval=r.layout.interval,n.periodicity.period=r.layout.periodicity,n.periodicity.timeUnit=r.layout.timeUnit,r.setRange(n,(function(e){for(var a in r.layout.setSpan={base:t.base,multiplier:t.multiplier},r.changeOccurred("layout"),r.panels)r.calculateYAxisMargins(r.panels[a].yAxis);r.draw(),i&&i(e)}))}}function s(t){t||r.quoteDriver.loadAll(a,n)}if(this.quoteDriver){var o=t.maintainPeriodicity?{period:this.layout.periodicity,interval:this.layout.interval,timeUnit:this.layout.timeUnit}:{period:1,interval:"month",timeUnit:null};o=t.periodicity?t.periodicity:o,o=e.cleanPeriodicity(o.period,o.interval,o.timeUnit);var l=this.needDifferentData(o);this.layout.periodicity=o.period,this.layout.interval=o.interval,this.layout.timeUnit=o.timeUnit,t.forceLoad||l?(this.clearCurrentMarketData(this.chart),this.quoteDriver.newChart({noDraw:!0,symbol:this.chart.symbol,symbolObject:this.chart.symbolObject,chart:this.chart,initializeChart:!0,fetchMaximumBars:!0},s)):a.moreAvailable||!a.upToDate?s():(this.createDataSet(),n())}else n()}},P=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine.prototype.importLayout=function(t,i){if(t){var a=this,n=[];"object"!==r(i)&&(i={managePeriodicity:arguments[1],preserveTicksAndCandleWidth:arguments[2]});var s=this.layout,o=e.shallowClone(s),l=i.managePeriodicity,h=i.cb,c=i.seriesCB,u=i.noDataLoad,d=i.preserveTicksAndCandleWidth,p=null;for(var f in this.exportDrawings&&(p=this.exportDrawings(),this.abortDrawings()),this.currentlyImporting=!0,s.studies){var m=s.studies[f];e.getFn("Studies.removeStudy")(this,m)}this.overlays={};var g=e.shallowClone(this.panels);this.panels={};var v=e.clone(t);s.periodicity=o.periodicity,s.interval=o.interval,s.timeUnit=o.timeUnit,s.setSpan=o.setSpan,s.range=o.range,d?s.candleWidth=o.candleWidth:s.candleWidth||(s.candleWidth=8),this.setCandleWidth(s.candleWidth),s.flipped&&this.flipChart(s.flipped);var y,x,b,S=v.panels,C=function(t,e){return t.index<e.index?-1:1};for(y in S)"index"in S[y]||(C=null),(x=S[y]).name=y,n.push(x);s.panels={};var w=null;if(n.length>0){C&&n.sort(C);for(var k=0;k<n.length;++k)b=(x=n[k]).yAxis?new e.ChartEngine.YAxis(x.yAxis):null,this.stackPanel(x.display,x.name,x.percent,x.chartName,b),x.soloing&&(w=this.panels[x.name])}for(var D in e.isEmpty(S)&&this.stackPanel("chart","chart",1,"chart"),this.resizeCanvas(),g){var T=g[D],A=this.panels[D];if(A){this.container.removeChild(A.holder),T.handle&&this.container.removeChild(T.handle);var M={holder:!0,subholder:!0,display:!0,icons:!0};for(var P in M)A[P]=T[P];this.configurePanelControls(A),T.chart.panel==T&&(T.chart.panel=A)}else this.privateDeletePanel(T)}this.chart.panel=this.panels.chart,z(this.panels),e.dataBindSafeAssignment(s,e.clone(v));var F=e.clone(s.studies);for(var _ in delete s.studies,F){var E=F[_];e.getFn("Studies.addStudy")(this,E.type,E.inputs,E.outputs,E.parameters,E.panel)}if(this.extendedHours&&this.extendedHours.prepare(s.extended,s.marketSessions),void 0===s.chartType&&(s.chartType="line"),this.setMainSeriesRenderer(),w&&this.panelSolo(w),this.adjustPanelPositions(),z(this.panels),this.storePanels(),!u){if(v.symbols&&v.symbols.length){var L={chart:this.chart};!d&&l&&v.range&&Object.keys(v.range).length?L.range=v.range:!d&&l&&v.setSpan&&Object.keys(v.setSpan).length?L.span=v.setSpan:l&&v.interval?L.periodicity={interval:v.interval,period:v.periodicity,timeUnit:v.timeUnit}:L.periodicity={interval:o.interval,period:o.periodicity,timeUnit:o.timeUnit};var I=v.symbols[0].symbolObject||v.symbols[0].symbol;return void this.loadChart(I,L,(function(t){if(!t){for(var i,r=1;r<v.symbols.length&&a.addSeries;++r){(i=v.symbols[r]).parameters||(i.parameters={});var n=e.clone(i.parameters);this.panels[n.panel]?a.addSeries(i.id,n,V):console.warn('Warning: Series "'+i.id+'" could not be imported due to a missing corresponding panel "'+n.panel+'"')}v.chartScale&&a.setChartScale(v.chartScale)}j(),h&&h.apply(null,arguments)}))}if(l){if(!d&&this.setRange){var O=v.range;if(O&&Object.keys(O).length&&this.chart.symbol)return void this.setRange(O,(function(){j(),h&&h()}));if(v.setSpan&&Object.keys(v.setSpan).length&&this.chart.symbol)return void this.setSpan(v.setSpan,(function(){j(),h&&h()}))}var N=v.interval,H=v.periodicity,R=v.timeUnit;return isNaN(H)&&(H=1),N||(N="day"),void this.setPeriodicity({period:H,interval:N,timeUnit:R},(function(){j(),h&&h()}))}}l&&(s.periodicity=v.periodicity,s.interval=v.interval,s.timeUnit=v.timeUnit,s.setSpan=v.setSpan),this.createDataSet(),d||this.home(),j(),h&&h()}else i.cb&&i.cb();function z(t){function e(t){return!!t}function i(i,a){if(i[a]&&i[a].length){var r=t[i.name];if(r){for(var n=r[a],s=new Array(n.length),o=0;o<n.length;o++){var l=i[a].indexOf(n[o].name);l>-1?s[l]=n[o]:s.push(n[o])}s.length&&(r[a]=s.filter(e))}}}for(var r=0;r<n.length;r++){var s=n[r];i(s,"yaxisLHS"),i(s,"yaxisRHS")}a.chart.yAxis=a.chart.panel.yAxis}function j(){var t,e;function i(){a.createDataSet(),z(a.panels),a.calculateYAxisPositions(),a.draw()}p&&a.importDrawings(p),a.currentlyImporting=!1;var r=[];for(var n in a.chart.series){if(!a.removeSeries)break;"study"==(e=a.chart.series[n]).parameters.bucket&&(t=!0,a.removeSeries(e),r.push(e))}for(var s=0;s<r.length;s++)e=r[s],a.addSeries(e.id,e.parameters,i);t||a.draw(),a.updateListeners("layout"),a.changeOccurred("layout")}function V(){a.calculateYAxisPositions(),z(a.panels),c&&c()}},e.ChartEngine.prototype.exportLayout=function(t){var i={};for(var a in this.layout)"studies"!=a&&"panels"!=a&&"drawing"!=a?i[a]=e.clone(this.layout[a]):"studies"==a?i.studies={}:"panels"==a&&(i.panels={});function r(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].name);return e}var n=0;for(var s in this.panels){var o=this.panels[s];if(!1!==o.exportable){var l=i.panels[s]={};l.percent=o.percent,l.display=o.display,l.chartName=o.chart.name,l.soloing=o.soloing,l.index=n++,l.yAxis={name:o.yAxis.name,position:o.yAxis.position},o.yaxisLHS&&(l.yaxisLHS=r(o.yaxisLHS)),o.yaxisRHS&&(l.yaxisRHS=r(o.yaxisRHS))}}for(var h in this.layout.studies){var c=i.studies[h]={},u=this.layout.studies[h];c.type=u.type,c.inputs=e.clone(u.inputs),c.outputs=e.clone(u.outputs),c.panel=u.panel,c.parameters=e.clone(u.parameters)}return t?i.symbols=this.getSymbols({"include-parameters":!0,"exclude-studies":!0,"exclude-generated":!0}):delete i.symbols,i},e.ChartEngine.prototype.importPreferences=function(t){e.extend(this.preferences,t),t.timeZone&&this.setTimeZone(this.dataZone,t.timeZone),t.language&&e.I18N&&e.I18N.localize(this,t.language),this.changeOccurred("preferences")},e.ChartEngine.prototype.exportPreferences=function(){return this.preferences}},F=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine&&(e.ChartEngine.prototype.rightClickOverlay=function(t,e){if(!this.runPrepend("rightClickOverlay",arguments)){var i=this.overlays[t];i.editFunction?i.editFunction(e):this.removeOverlay(t),this.runAppend("rightClickOverlay",arguments)}},e.ChartEngine.prototype.addOverlay=function(t){this.runPrepend("addOverlay",arguments)||(this.overlays[t.name]=t,this.runAppend("addOverlay",arguments))},e.ChartEngine.prototype.removeOverlay=function(t){if(!this.runPrepend("removeOverlay",arguments)){var i=this.overlays[t];for(var a in this.overlays){var r=this.overlays[a],n=["Field"];e.Studies&&(n=e.Studies.getFieldInputs(r));for(var s=0;s<n.length;s++)i.outputMap[r.inputs[n[s]]]&&this.removeOverlay(r.name)}if(i){this.cleanupRemovedStudy(i);this.panels[i.panel];delete this.overlays[t],this.checkForEmptyPanel(i.panel)}this.currentlyImporting||(this.displaySticky(),this.createDataSet(),this.changeOccurred("layout")),this.resetDynamicYAxis(),this.runAppend("removeOverlay",arguments)}},e.ChartEngine.prototype.cleanupRemovedStudy=function(t){if(t){for(var i in t.study.removeFN&&t.study.removeFN(this,t),this.plugins)i.indexOf("{"+t.id+"}")>-1&&delete this.plugins[i];this.layout.studies&&delete this.layout.studies[t.name],delete this.overlays[t.name],e.Studies&&e.Studies.removeStudySymbols(t,this),this.quoteDriver&&this.quoteDriver.updateSubscriptions()}}),e.Studies=e.Studies||function(){},e.Studies.DEFAULT_INPUTS={Period:14},e.Studies.DEFAULT_OUTPUTS={Result:"auto"},e.Studies.sortForProcessing=function(t){var e=[],i=t.layout.studies;return i&&function e(i,a){i.forEach((function(i){if(-1==a.indexOf(i)){var r=i.getDependents(t);r.length&&e(r,a),a.unshift(i)}}))}(Object.values(i),e),e},e.Studies.StudyDescriptor=function(t,i,a,r,n,s){this.name=t,this.type=i,this.panel=a,this.inputs=r,this.outputs=n,this.parameters=s,this.outputMap={},this.min=null,this.max=null,this.startFrom=0,this.subField="Close";var o=e.Studies.studyLibrary[i];o||(o={},("chart"==a||!a&&s&&"chart"==s.chartName)&&(this.overlay=!0)),void 0===o.inputs&&(o.inputs=e.clone(e.Studies.DEFAULT_INPUTS)),void 0===o.outputs&&(o.outputs=e.clone(e.Studies.DEFAULT_OUTPUTS)),this.study=o,this.libraryEntry=o},e.Studies.StudyDescriptor.prototype.getYAxis=function(t){var e,i=this.yAxis;if(this.parameters&&(e=this.parameters.yaxisDisplayValue),!i){var a=t.panels[this.panel];a&&(i=t.getYAxisByName(a,e)||t.getYAxisByName(a,this.name)||a.yAxis)}return i||(i=t.getYAxisByName(t.chart.panel,e)||t.chart.panel.yAxis),i},e.Studies.StudyDescriptor.prototype.getContext=function(t){return t.chart.context},e.Studies.StudyDescriptor.prototype.getDependents=function(t,i){var a=[];for(var r in t.layout.studies){var n=t.layout.studies[r];if(n!=this)for(var s=e.Studies.getFieldInputs(n),o=0;o<s.length;o++)if(n.inputs[s[o]].includes(this.name)){if(i&&n.parameters&&n.parameters.panelName)continue;a.push(n),a=a.concat(n.getDependents(t,i));break}}return a},e.Studies.StudyDescriptor.prototype.undraggable=function(t){var e=this.study.attributes;if(e){if(e.panelName&&e.panelName.hidden)return!0;if(e.yaxisDisplayValue&&e.yaxisDisplayValue.hidden)return!0}return!1},e.Studies.StudyDescriptor.prototype.appendFutureTicks=function(t,e){var i=t.chart.scrubbed;if(i.length){var a,r,n=t.standardMarketIterator(i[i.length-1].DT);for(a=e.length-1;a>=0;a--){for(var s in r=e[a])if(r[s]||0===r[s]){a=-1;break}if(-1==a)break;e.pop()}for(a=0;a<e.length;a++)(r=e[a]).DT||(r.DT=n.next()),r.displayDate||t.setDisplayDate(r),r.futureTick=!0,i.push(r)}},e.Studies.generateID=function(t,i,a,r,n){var s=e.Studies.studyLibrary[i],o="‌"+(n||i)+"‌";if(s&&s.customRemoval)return o;if(!e.isEmpty(a)){var l=!0;for(var h in a)if("id"!=h&&"display"!=h&&"Shading"!=h){var c=a[h];"field"!=c&&(c=c.toString(),void 0!==e.Studies.prettify[c]&&(c=e.Studies.prettify[c]),l?(l=!1,o+=" ("):c&&(o+=","),o+=c)}l||(o+=")")}if(r&&0===r.indexOf(o))return r;if(t.layout.studies&&t.layout.studies[o])for(var u=2;u<50;u++){var d=o+"-"+u;if(!t.layout.studies[d]){o=d;break}}return o},e.Studies.DialogHelper=function(t){var i=this.stx=t.stx,a=this.sd=t.sd;this.name=a?a.type:t.name,this.signal=1,this.inputs=[],this.outputs=[],this.parameters=[];var r=this.libraryEntry=a?a.study:e.Studies.studyLibrary[t.name];void 0===r.inputs&&(r.inputs=e.clone(e.Studies.DEFAULT_INPUTS)),void 0===r.outputs&&(r.outputs=e.clone(e.Studies.DEFAULT_OUTPUTS));var n=a&&i.panels[a.panel]?i.panels[a.panel]:i.chart.panel,s=n.chart;function o(t,e){this.attributes[t]||(this.attributes[t]={}),e&&(this.attributes[t].hidden=!0)}this.title=i.translateIf(r.name),this.attributes=r.attributes,this.attributes||(this.attributes={});var l=[],h=i.layout.studies,c=[];for(var u in a&&(c=Array.prototype.concat(a,a.getDependents(i))),h)if(!(c.indexOf(h[u])>-1))for(var d in h[u].outputMap)l.push(d);for(var p in r.inputs){var f={};this.inputs.push(f),f.name=p,f.heading=i.translateIf(p);var m=r.inputs[p];if(a&&a.inputs&&void 0!==a.inputs[p]&&null!==a.inputs[p]?f.value=a.inputs[p]:f.value=r.inputs[p],f.defaultInput=r.inputs[p],this.attributes[p]||(this.attributes[p]=e.Studies.inputAttributeDefaultGenerator(f.defaultInput)),m.constructor==Number)f.type="number";else if(m.constructor==String){var g=e.Studies.movingAverageHelper(i,f.defaultInput);if(g){f.type="select",f.defaultInput=g;var v=e.Studies.movingAverageHelper(i,f.value);v||(v=f.value),f.value=v,f.options=e.Studies.movingAverageHelper(i,"options")}else if("field"==m){f.type="select",f.options={};for(var y=["Open","High","Low","Close","Adj_Close","hl/2","hlc/3","hlcc/4","ohlc/4",s.defaultPlotField].concat(l),x=0;x<y.length;x++){var b=y[x];f.options[b]=i.translateIf(b)}"field"==f.value&&(f.value="Close"),"field"==f.defaultInput&&(f.defaultInput="Close")}else f.type="text","yyyy-mm-dd"==this.attributes[p].placeholder?f.type="date":"hh:mm:ss"==this.attributes[p].placeholder&&(f.type="time")}else if(m.constructor==Boolean)f.type="checkbox",!0!==f.value&&"true"!=f.value&&"on"!=f.value||(f.value=!0);else if(m.constructor==Array){f.type="select",f.options={};for(var S=0;S<m.length;S++)f.options[m[S]]=i.translateIf(m[S]);f.value.constructor==Array&&(f.value=f.value[0]),this.attributes[p].defaultSelected?f.defaultInput=this.attributes[p].defaultSelected:f.defaultInput=m[0]}}this.dateTimeInputs=[];for(var C=0;C<this.inputs.length;C++){var w=this.inputs[C];if("date"==w.type)for(var k=w.name.substring(0,w.name.indexOf(" Date")),D=0;D<this.inputs.length;D++){var T=this.inputs[D];if("time"==T.type&&T.name==k+" Time"){this.dateTimeInputs.push(k);break}}}for(p in this.adjustInputTimesForDisplayZone(),r.outputs){var A={name:p,heading:i.translateIf(p)};A.color=A.defaultOutput=r.outputs[p],a&&a.outputs&&a.outputs[p]&&(A.color=a.outputs[p]),"auto"==A.color&&(A.color=i.defaultColor),this.outputs.push(A)}var M=a?a.parameters:null;if(r.parameters){var P,F=r.parameters.init;if(F)void 0!==F.studyOverZonesEnabled&&(P={name:"studyOverZones",heading:i.translateIf("Show Zones"),defaultValue:F.studyOverZonesEnabled,value:F.studyOverZonesEnabled},M&&(M.studyOverZonesEnabled||!1===M.studyOverZonesEnabled)&&(P.value=M.studyOverZonesEnabled),P.type="checkbox",this.parameters.push(P)),void 0!==F.studyOverBoughtValue&&(P={name:"studyOverBought",heading:i.translateIf("OverBought"),defaultValue:F.studyOverBoughtValue,value:F.studyOverBoughtValue,defaultColor:F.studyOverBoughtColor,color:F.studyOverBoughtColor},M&&M.studyOverBoughtValue&&(P.value=M.studyOverBoughtValue),M&&M.studyOverBoughtColor&&(P.color=M.studyOverBoughtColor),"auto"==P.color&&(P.color=i.defaultColor),P.type="text",this.parameters.push(P)),void 0!==F.studyOverSoldValue&&(P={name:"studyOverSold",heading:i.translateIf("OverSold"),defaultValue:F.studyOverSoldValue,value:F.studyOverSoldValue,defaultColor:F.studyOverSoldColor,color:F.studyOverSoldColor},M&&M.studyOverSoldValue&&(P.value=M.studyOverSoldValue),M&&M.studyOverSoldColor&&(P.color=M.studyOverSoldColor),"auto"==P.color&&(P.color=i.defaultColor),P.type="text",this.parameters.push(P)),this.attributes.studyOverBoughtValue||(this.attributes.studyOverBoughtValue={}),this.attributes.studyOverSoldValue||(this.attributes.studyOverSoldValue={})}function _(t){for(var e={},a=t.defaults,r={name:t.name,heading:i.translateIf(t.label),defaultValue:a[0],value:t.value,options:e,type:"select"},n=0;n<a.length;n++)e[a[n]]=i.translateIf(a[n]);return void 0!==t.color&&(r.defaultColor=i.defaultColor,r.color=t.color),r}function E(t){return{name:t.name,heading:i.translateIf(t.label),defaultValue:t.defaults,value:t.value,type:"checkbox"}}var L=this.panelSelect=t.panelSelect,I=this.axisSelect=t.axisSelect;function O(t){function e(t,e){return"Panel "+e.toString()}if("alias"==L){var a=1;for(var r in i.panels){if(r==t)return e(0,a);a++}}return t}if(t.addWhenDone&&(I=L=!1),I||L){a||(a=e.Studies.addStudy(i,t.name,null,null,{calculateOnly:!0}),e.Studies.removeStudy(i,a)),L&&this.parameters.push(_({label:"Panel",name:"panelName",defaults:function(){var t=[];for(var e in t.push("Auto"),i.panels)e==a.panel&&M&&M.panelName||t.push(O(e));return i.checkForEmptyPanel(a.panel,!0,a)||t.push("New panel"),t}(),value:M&&M.panelName?O(M.panelName):"Auto"}),E({label:"Show as Underlay",name:"underlay",defaults:!1,value:a.underlay||a.parameters&&a.parameters.underlayEnabled}));var N=i.getYAxisByName(n,a.name);I&&this.parameters.push(_({label:"Y-Axis",name:"yaxisDisplay",defaults:function(){var t=n.yaxisLHS.concat(n.yaxisRHS),e=[];e.push("default","right","left","none","shared");for(var i=0;i<t.length;i++)t[i]!=N&&e.push(t[i].name);return e}(),value:M&&M.yaxisDisplayValue||N&&N.position||(a.panel!=a.name?"shared":n.yAxis.position||"default"),color:N&&N.textStyle?N.textStyle:"auto"}),E({label:"Invert Y-Axis",name:"flipped",defaults:!1,value:M?M.flippedEnabled:!!N&&N.flipped})),o.call(this,"flippedEnabled",!N&&a.panel!=a.name),o.call(this,"underlayEnabled",r.underlay),o.call(this,"panelName",null===r.seriesFN),o.call(this,"yaxisDisplayValue",null===r.seriesFN||r.yAxis&&r.yAxis.noDraw)}},e.Studies.DialogHelper.prototype.updateStudy=function(t){var i={},a=this.sd,r=this.libraryEntry;r||(r={}),a||(a=r),i.inputs=e.clone(a.inputs),i.outputs=e.clone(a.outputs),i.parameters=e.clone(a.parameters),this.adjustInputTimesForDisplayZone(t),t.parameters&&t.parameters.panelName&&(t.parameters.panelName=function(t){if("alias"==this.panelSelect){var e=function(t){var e=t.match(/.* (\d)/);return e&&e[1]}(t);if(e)for(var i in this.stx.panels)if(!--e)return i}return t}.call(this,t.parameters.panelName)),e.extend(i,t),i.parameters||(i.parameters={}),a=i.inputs&&i.inputs.id?e.Studies.replaceStudy(this.stx,i.inputs.id,this.name,i.inputs,i.outputs,i.parameters,null,a.study):e.Studies.addStudy(this.stx,this.name,i.inputs,i.outputs,i.parameters,null,a.study);var n=new e.Studies.DialogHelper({stx:this.stx,sd:a,axisSelect:this.axisSelect,panelSelect:this.panelSelect});for(var s in n)"signal"!=s&&(this[s]=n[s]);this.signal*=-1},e.Studies.DialogHelper.prototype.adjustInputTimesForDisplayZone=function(t){if(this.stx.displayZone)for(var i=0;i<this.dateTimeInputs.length;i++){var a,r,n,s,o=this.dateTimeInputs[i],l="";for(t&&t.inputs&&((r=t.inputs[o+" Date"])&&(l=r),(n=t.inputs[o+" Time"])&&(l+=n)),a=0;a<this.inputs.length;a++)s=this.inputs[a],r||""===r||s.name!=o+" Date"?n||""===n||s.name!=o+" Time"||(l+=s.value):l=s.value+l;if((l=l.replace(/\D/g,"")).length<12)return;var h,c=e.strToDateTime(l);if(!isNaN(c.valueOf()))if(t)t.inputs||(t.inputs={}),h=e.convertTimeZone(c,this.stx.displayZone),t.inputs[o+" Date"]=e.yyyymmdd(h),t.inputs[o+" Time"]=e.hhmmss(h);else for(h=e.convertTimeZone(c,null,this.stx.displayZone),a=0;a<this.inputs.length;a++)(s=this.inputs[a]).name==o+" Date"&&(s.value=e.yyyymmdd(h)),s.name==o+" Time"&&(s.value=e.hhmmss(h))}},e.Studies.prepareStudy=function(t,i,a){if(void 0===i.calculateFN&&(i.useRawValues=!0),e.isEmpty(a.outputMap))for(var r in a.outputs)i.useRawValues?a.outputMap[r]=r:a.outputMap[r+" "+a.name]=r},e.Studies.rejiggerDerivedStudies=function(t,i,a){for(var r=i.name,n=(i.panel,i.getDependents(t)),s=0;s<n.length;s++){var o=n[s],l=e.clone(o.inputs),h=l.id;if(h){for(var c=e.Studies.getFieldInputs(o),u=0;u<c.length;u++)l[c[u]]=l[c[u]].replace(r,a);delete e.Studies.replaceStudy(t,h,o.type,l,o.outputs,e.extend(o.parameters,{rejiggering:!0}),null,o.study).parameters.rejiggering}}},e.Studies.removeStudySymbols=function(t,e){if(t.series)for(var i in t.series)e.deleteSeries(t.series[i],null,{action:"remove-study"})},e.Studies.replaceStudy=function(t,i,a,r,n,s,o,l){s||(s={}),i&&(s.replaceID=i),i=s.replaceID;var h,c=t.layout.studies[i];e.Studies.removeStudySymbols(c,t),c.attribution&&t.removeFromHolder(c.attribution.marker),t.quoteDriver&&t.quoteDriver.updateSubscriptions(),r&&(r.id==r.display&&delete r.display,delete r.id),(h=e.Studies.addStudy(t,a,r,n,s,o,l)).highlight=c.highlight;var u,d={};for(u in t.layout.studies)u==i?d[h.name]=h:d[u]=t.layout.studies[u];for(u in t.layout.studies=d,d={},t.overlays)u==i?(h.overlay||h.underlay)&&(d[h.name]=h):d[u]=t.overlays[u];return t.overlays=d,t.overlays[h.name]||!h.overlay&&!h.underlay||t.addOverlay(h),t.checkForEmptyPanel(c.panel),s.rejiggering||(t.initializeDisplay(t.chart),e.Studies.rejiggerDerivedStudies(t,c,h.inputs.id,h.panel),t.changeOccurred("layout"),t.currentlyImporting||s.calculateOnly||!h.chart.dataSet||t.createDataSet(null,h.chart),t.draw()),e.transferObject(c,h),t.layout.studies[h.name]=c,t.overlays[h.name]=c,c},e.Studies.addStudy=function(t,i,a,r,n,s,o){var l=o||e.Studies.studyLibrary[i];if(n||(n={}),l){if(l.inputs){var h=e.clone(l.inputs);for(var c in h)h[c]instanceof Array&&(l.attributes&&l.attributes[c]&&l.attributes[c].defaultSelected?h[c]=l.attributes[c].defaultSelected:h[c]=h[c][0]);a=e.extend(h,a)}l.outputs&&(r=e.extend(e.clone(l.outputs),r));var u=l.parameters;u&&u.init&&(n=e.extend(e.clone(u.init),n)),u&&!n.display&&(n.display=u.display)}a||(a=e.clone(e.Studies.DEFAULT_INPUTS)),r||(r=e.clone(e.Studies.DEFAULT_OUTPUTS)),n.chartName||(n.chartName="chart"),"Auto"!=n.panelName&&"Default panel"!=n.panelName||(n.panelName=""),a.Period<1&&(a.Period=1),a.id||(a.id=e.Studies.generateID(t,i,a,n.replaceID,n.display));var d=null;if(t.layout.studies||(t.layout.studies={}),d=l&&l.initializeFN?l.initializeFN(t,i,a,r,n,s,o):e.Studies.initializeFN(t,i,a,r,n,s,o)){o=d.study,d.chart=t.charts[n.chartName],d.type=i,d.permanent=o.permanent,d.customLegend=o.customLegend,e.Studies.prepareStudy(t,o,d);var p,f=t.chart.state.studies;if(f||(f=t.chart.state.studies={}),f.sorted=null,n.replaceID?(p=!0,delete n.replaceID):(t.layout.studies[d.inputs.id]=d,(d.overlay||d.underlay)&&t.addOverlay(d),t.currentlyImporting||n.calculateOnly||!d.chart.dataSet||t.createDataSet(null,d.chart)),t.quoteDriver&&t.quoteDriver.updateSubscriptions(),t.changeOccurred("layout"),n.calculateOnly)return d;var m=t.panels[d.panel],g=!1,v=!(d.overlay||d.underlay);if(v&&o.horizontalCrosshairFieldFN&&(m.horizontalCrosshairField=o.horizontalCrosshairFieldFN(t,d)),t.editCallback?g=!0:v?t.callbackListeners.studyPanelEdit&&t.callbackListeners.studyPanelEdit.length&&(g=!0):t.callbackListeners.studyOverlayEdit&&t.callbackListeners.studyOverlayEdit.length&&(g=!0),g){n.editMode=!0;var y,x=!1;for(var b in d.inputs)if("id"!=b&&"display"!=b){x=!0;break}if(!x)for(var S in d.outputs){x=!0;break}if(x)void 0!==d.study.edit?d.study.edit&&(y=function(t,i,a,r){return function(){e.clearCanvas(t.chart.tempCanvas,t),i.study.edit(i,{stx:t,inputs:a,outputs:r,parameters:n})}}(t,d,a,r),t.setPanelEdit(m,y),d.editFunction=y):v?t.editCallback?(y=function(t,a,r,s){return function(){var o=t.editCallback(t,a);e.clearCanvas(t.chart.tempCanvas,t),e.Studies.studyDialog(t,i,o,{inputs:r,outputs:s,parameters:n})}}(t,d,a,r),"chart"!=m.name&&t.setPanelEdit(m,y)):(y=function(t,i,a,r,n){return function(){e.clearCanvas(t.chart.tempCanvas,t),t.dispatch("studyPanelEdit",{stx:t,sd:i,inputs:a,outputs:r,parameters:n})}}(t,d,a,r,n),"chart"!=m.name&&(t.setPanelEdit(m,y),d.editFunction=y)):(y=function(t,i,a,r,n){return function(s){e.clearCanvas(t.chart.tempCanvas,t),t.dispatch("studyOverlayEdit",{stx:t,sd:i,inputs:a,outputs:r,parameters:n,forceEdit:s})}}(t,d,a,r,n),d.editFunction=y)}return p||t.draw(),d}console.log("CIQ.Studies.addStudy: initializeFN() returned null for "+i)},e.Studies.removeStudy=function(t,e){var i=t.panels[e.panel],a=i&&i.yAxis.name;(e.overlay||e.underlay)&&t.removeOverlay(e.name);var r=t.panels[e.panel];if(e.attribution&&t.removeFromHolder(e.attribution.marker),delete t.layout.studies[e.name],r&&!t.checkForEmptyPanel(r)){a==e.name&&t.electNewPanelOwner(r);var n=t.getYAxisByName(e.panel,e.name);n&&(n.name=n.studies[1]||n.renderers[0])}t.draw(),t.resizeChart()},e.Studies.getPanelFromFieldName=function(t,i){var a=e.Studies.getFieldInputs(i);if(!a.length)return null;var r=t.layout.studies;if(!r)return null;var n={};for(var s in r)for(var o in r[s].outputMap)n[o]=r[s].panel;for(var l=0;l<a.length;l++){var h=i.inputs[a[l]];if(h){var c=n[h];if(c)return c}}return null},e.Studies.createLibraryHash=function(){return Object.keys(e.Studies.studyLibrary).join("|")},e.Studies.displayStudies=function(t,i,a){a&&(i.studyLibraryHash=e.Studies.createLibraryHash());var r=t.layout.studies;if(r){var n={};for(var s in n[i.name]=!0,r){var o=r[s],l=o.study;if(l){var h=o.underlay||o.parameters&&o.parameters.underlayEnabled;if(!(a&&!h||!a&&h)){var c=e.clone(l.renderer);!c||c instanceof Array||(c=[c]);var u=t.panels[o.panel];if(u){if(u.chart==i&&!u.hidden){if(!n[u.name]){var d=o.permanent||!t.manageTouchAndMouse;u.closeX?d&&(u.closeX.style.display="none"):u.close&&d&&(u.close.style.display="none"),u.edit&&d&&(u.edit.style.display="none"),n[u.name]=d}var p=o.chart.dataSegment;if(!(o.panel!=o.parameters.chartName||o.parameters&&o.parameters.panelName)){var f=e.Studies.getPanelFromFieldName(t,o);f&&o.panel!=f&&(o.panel=f)}if(void 0===l.seriesFN){if(c){o.overlay||e.Studies.createYAxis(t,o,p,u);for(var m=0;m<c.length;m++){var g=c[m];for(var v in o.outputMap)o.outputMap[v]==g.field&&(g.field=v);if(g.field){g.panel=o.panel;var y=g.binding;if(y)for(var x in y){var b=e.Studies.determineColor(o.outputs[y[x]]);b&&"auto"!=b&&(g[x]=b)}g.yAxis=null;var S=e.Renderer.produce(g.type,g);S.stx=t,S.attachSeries(null,g).draw()}}}else e.Studies.displaySeriesAsLine(t,o,p);u&&e.Studies.displayError(t,o)}else l.seriesFN&&u&&(l.seriesFN(t,o,p),e.Studies.displayError(t,o))}}else t.currentlyImporting&&delete r[s]}}}}},e.Studies.displayError=function(t,e,i){if(e.error){var a=i&&i.panel?i.panel:e.panel,r=!0===e.error?t.translateIf("Not enough data to compute ")+t.translateIf(e.study.name):t.translateIf(e.error);!i||"center"===i.h&&"bottom"===i.v?t.displayErrorAsWatermark(a,r):t.watermark(a,i)}},e.Studies.calculateMinMaxForDataPoint=function(t,e,i){for(var a=Number.MAX_VALUE,r=-1*Number.MAX_VALUE,n=0;n<i.length;n++){var s=i[n][e];null!=s&&(isNaN(s)||(a=Math.min(s,a),r=Math.max(s,r)))}return{min:a,max:r}},e.Studies.getYAxisParameters=function(t,e){var i={},a=t.layout.studies&&t.layout.studies[e.name];if(a){var r=a.study;r.yaxis||r.yAxisFN?i.noDraw=!0:(r.parameters&&r.parameters.excludeYAxis&&(i.noDraw=!0),i.ground=r.yAxis&&r.yAxis.ground,e&&("bypass"!=r.range&&("0 to 100"==r.range?i.range=[0,100]:"-1 to 1"==r.range?i.range=[-1,1]:"0 to max"==r.range?i.range=[0,Math.max(0,e.high)]:(r.centerline||0===r.centerline)&&(i.range=[Math.min(r.centerline,e.low),Math.max(r.centerline,e.high)])),i.range&&(e.low=i.range[0],e.high=i.range[1]),a.min&&(e.min=a.min),a.max&&(e.max=a.max),a.parameters&&a.parameters.studyOverZonesEnabled&&(i.noDraw=!0)))}return i},e.Studies.doPostDrawYAxis=function(t,i){for(var a in t.layout.studies){var r=t.layout.studies[a],n=t.panels[r.panel];if(n&&!n.hidden)if(r.getYAxis(t)==i){var s=r.study;if(i.name==r.name&&(s.yaxis&&s.yaxis(t,r),s.yAxisFN&&s.yAxisFN(t,r)),e.Studies.drawZones(t,r),!r.error){var o=s.centerline;(o||0===o||null!==o&&i.highValue>0&&i.lowValue<0)&&e.Studies.drawHorizontal(t,r,null,o||0,i)}}}},e.Studies.displaySeriesAsLine=function(t,i,a){if(a.length){var r=t.panels[i.panel];if(r&&!r.hidden)for(var n in i.outputMap)e.Studies.displayIndividualSeriesAsLine(t,i,r,n,a)}},e.Studies.displaySeriesAsHistogram=function(t,e,i){if(i.length){var a=t.panels[e.panel];if(a&&!a.hidden){var n=[];for(var s in e.outputMap){var o=e.outputs[e.outputMap[s]];if(o){var l=.3;"object"==r(o)&&(l=o.opacity,o=o.color);var h={field:s,fill_color_up:o,border_color_up:o,fill_color_down:o,border_color_down:o};e.underlay&&(h.opacity_up=h.opacity_down=l||.3),n.push(h)}}var c=e.getYAxis(t),u=e.inputs,d=u.WidthFactor;if(e.study&&e.study.parameters){var p=e.study.parameters;void 0!==p.widthFactor&&(d=p.widthFactor)}var f={name:e.name,type:u.HistogramType?u.HistogramType:"overlaid",panel:e.panel,yAxis:c,widthFactor:d||.5,bindToYAxis:!0,highlight:e.highlight};t.drawHistogram(f,n)}}},e.Studies.displayIndividualSeriesAsLine=function(t,i,a,r,n){a.height||(a.height=a.bottom-a.top);var s=i.getContext(t),o=i.outputs[i.outputMap[r]];if(o){s.save(),"string"==typeof o&&(o={color:o,width:1}),s.lineWidth=o.width||1;var l=o.color;"auto"==l&&(l=t.defaultColor),s.strokeStyle=l;var h=o.pattern;s.setLineDash(e.borderPatternToArray(s.lineWidth,h)),s.lineDashOffset=0;var c=0,u=i.study,d=i.getYAxis(t);c=t.decimalPlacesFromPriceTick(d.priceTick),(i.overlay||i.underlay)&&(c=null),(d.decimalPlaces||0===d.decimalPlaces)&&(c=d.decimalPlaces);var p=null;i.parameters&&(p=i.parameters.label);var f=u.parameters;f||(f={});var m="step"==f.plotType||i.plotStepLine;if(i.series)for(var g in i.series){var v=i.series[g].parameters.type;v&&(m="step"==v)}f.noLabels&&(p=!1),i.noSlopes||!1===i.noSlopes||(i.noSlopes=f.noSlopes),i.extendToEnd||!1===i.extendToEnd||(i.extendToEnd=f.extendToEnd);var y=p||t.preferences.labels&&!1!==p,x=i.gaplines;!1===x&&(x="transparent");var b=i.inputs.Symbol,S=x?t.getGapColorFunction(b,r,o,x):null;t.plotDataSegmentAsLine(r,a,{yAxis:d,skipTransform:t.panels[i.panel].name!=i.chart.name,label:y,labelDecimalPlaces:c,noSlopes:i.noSlopes,step:m,alignStepToSide:i.alignStepToSide,extendToEndOfLastBar:i.extendToEndOfLastBar,width:i.lineWidth,extendToEndOfDataSet:i.extendToEnd,gapDisplayStyle:x,highlight:i.highlight},S),u.appendDisplaySeriesAsLine&&u.appendDisplaySeriesAsLine(t,i,n,r,a),s.restore()}},e.Studies.drawHorizontal=function(t,e,i,a,r,n){var s=t.panels[e.panel],o=t.getBackgroundCanvas().context;if(s){n||(n=r.textStyle);var l=t.pixelFromPrice(a,s,r);l>r.top&&l<r.bottom&&t.plotLine(s.left,s.right,l,l,n,"segment",o,!1,{opacity:n&&n.opacity?n.opacity:.5})}},e.Studies.displayHistogramWithSeries=function(t,i,a){t.panels[i.panel];var r=.5;i.underlay&&(r=.3),e.Studies.createHistogram(t,i,a,!1,r),e.Studies.displaySeriesAsLine(t,i,a)},e.Studies.drawZones=function(t,i,a){if(i.parameters&&i.parameters.studyOverZonesEnabled){var r=parseFloat(i.parameters.studyOverSoldValue),n=parseFloat(i.parameters.studyOverBoughtValue),s=i.parameters.studyOverSoldColor,o=i.parameters.studyOverBoughtColor,l=i.zoneOutput;l||(l="Result");var h=e.Studies.determineColor(i.outputs[l]);h&&"auto"!=h&&!e.isTransparent(h)||(h=t.defaultColor),s||(s=h),s&&"auto"!=s&&!e.isTransparent(s)||(s=t.defaultColor),o||(o=h),o&&"auto"!=o&&!e.isTransparent(o)||(o=t.defaultColor);var c=t.panels[i.panel],u=i.getYAxis(t),d=u.displayBorder;!1===t.axisBorders&&(d=!1),!0===t.axisBorders&&(d=!0),0===u.width&&(d=!1);var p="left"==t.getYAxisCurrentPosition(u,c),f=u.justifyRight;f||!1===f||(f=t.chart.yAxis.justifyRight||!1===t.chart.yAxis.justifyRight?t.chart.yAxis.justifyRight:p);var m=Math.round(u.left+(p?u.width:0))+.5,g=d?3:0,v=t.getBackgroundCanvas().context,y=v.fillStyle;v.globalAlpha=.2,t.startClip(c.name,!0),v.beginPath();var x=Math.round(t.pixelFromPrice(n,c,u))+.5;v.strokeStyle=o,v.moveTo(c.left,x),v.lineTo(c.right,x),v.stroke(),v.closePath(),v.beginPath();var b=Math.round(t.pixelFromPrice(r,c,u))+.5;v.strokeStyle=s,v.moveTo(c.left,b),v.lineTo(c.right,b),v.stroke(),v.closePath();var S=new e.Plotter;if(S.newSeries("border","stroke",t.canvasStyle("stx_grid_border")),d){var C=p?m-g:m-.5,w=p?m+.5:m+g;S.moveTo("border",C,x),S.lineTo("border",w,x),S.moveTo("border",C,b),S.lineTo("border",w,b)}v.fillStyle=y;var k={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:l+" "+i.name,yAxis:u,opacity:.3};if(!i.highlight&&t.highlightedDraggable&&(k.opacity*=.3),e.preparePeakValleyFill(t,e.extend(k,{threshold:n,direction:u.flipped?-1:1,color:o})),e.preparePeakValleyFill(t,e.extend(k,{threshold:r,direction:u.flipped?1:-1,color:s})),v.globalAlpha=1,!i.study||!i.study.yaxis){if(d){var D=Math.round(u.bottom)+.5;S.moveTo("border",m,u.top),S.lineTo("border",m,D),S.draw(v,"border")}var T;if(0!==u.width)t.canvasFont("stx_yaxis",v),t.canvasColor("stx_yaxis",v),v.textAlign=f?"right":"left",p?(T=u.left+3,f&&(T=u.left+u.width-g-3)):(T=u.left+g+3,f&&(T=u.left+u.width)),v.fillStyle=o,v.fillText(n,T,x),v.fillStyle=s,v.fillText(r,T,b),v.fillStyle=y}t.endClip(),v.globalAlpha=1,u.name==i.name&&(u.yAxisPlotter=new e.Plotter)}},e.Studies.createHistogram=function(t,i,a,r,n){var s=t.panels[i.panel],o=i.getContext(t),l=i.getYAxis(t);t.startClip(s.name);var h=t.layout.candleWidth-2;h<2&&(h=1);var c=t.pixelFromPrice(0,s,l);l.min>0&&(c=t.pixelFromPrice(l.min,s,l)),r&&(c=Math.floor(s.top+s.height/2));var u=i.name+"_hist";t.canvasColor("stx_histogram");var d=o.fillStyle;(n||0===n)&&(o.globalAlpha=n),!i.highlight&&t.highlightedDraggable&&(o.globalAlpha*=.3);for(var p=null,f=null,m=i.outputs,g=0;g<a.length;g++){var v=a[g];if(v){v.candleWidth&&(h=Math.floor(Math.max(1,v.candleWidth-2)));var y=Math.floor(t.pixelFromBar(g,s.chart)-h/2),x=Math.floor(h);if(null===p){var b=t.tickFromPixel(y,s.chart)-1;p=b<0?f:t.pixelFromPrice(t.chart.dataSet[b][u],s,l)-c}else p=f;f=t.pixelFromPrice(v[u],s,l)-c;var S=e.Studies.determineColor(m["Decreasing Bar"]),C=e.Studies.determineColor(m["Increasing Bar"]),w=e.Studies.determineColor(m["Positive Bar"]),k=e.Studies.determineColor(m["Negative Bar"]),D=l.flipped;o.fillStyle=d,S&&(D?f<p:f>p)?o.fillStyle=S:C&&(D?f>p:f<p)?o.fillStyle=C:w&&(D?f>0:f<0)?o.fillStyle=w:k&&(D?f<0:f>0)&&(o.fillStyle=k),o.fillRect(y,c,x,Math.floor(f))}}o.globalAlpha=1,t.endClip()},e.Studies.prettify={Close:"C",Open:"O",High:"H",Low:"L",simple:"ma",exponential:"ema","time series":"tsma",triangular:"tma",variable:"vma",VIDYA:"vdma",weighted:"wma","welles wilder":"smma",true:"y",false:"n"},e.Studies.prettyRE=/^.*\((.*?)\).*$/,e.Studies.prettyDisplay=function(t){var i=e.Studies.prettyRE.exec(t);if(!i)return t;var a=i[1];if(a){for(var r in e.Studies.prettify)a=a.replace(r,e.Studies.prettify[r]);t=t.replace(i[1],a)}return t},e.Studies.getFieldInputs=function(t){var e=[],i=t.study.inputs;for(var a in i)"field"==i[a]&&e.push(a);return e},e.Studies.initializeFN=function(t,i,a,r,n,s,o){a||(a={id:i}),n||(n={}),a.display||(a.display=a.id);var l=new e.Studies.StudyDescriptor(a.id,i,a.id,a,r,n);a.Period&&(l.days=Math.max(1,parseInt(l.inputs.Period,10))),o?(o.inputs||(o.inputs=l.study.inputs),o.outputs||(o.outputs=l.study.outputs),l.study=o):o=l.study,o.display&&(a.display=o.display),"string"==typeof n.panelName&&(s=n.panelName),(s==a.id||s&&!t.panelExists(s))&&(l.underlay=l.overlay=!1),"Own panel"!=s&&"New panel"!=s||(s=null);var h=l.overlay||a.Overlay||!1!==l.overlay&&o.overlay,c=l.underlay||a.Underlay||!1!==l.underlay&&o.underlay;h&&n.underlayEnabled&&(c=!0),c&&(l.underlay=!0),!c&&t.chart.panel&&s==t.chart.panel.name&&(h=!0),h&&(l.overlay=!0);var u=t.preferences.dragging;if((!0===u||u&&u.study)&&(l.overlay=!0),s?n.panelName=s:h||c||(s=a.id),n.calculateOnly)return(h||c)&&(t.panels[n.panelName]?l.panel=n.panelName:l.panel=e.Studies.getPanelFromFieldName(t,l)||n.chartName),l;var d={},p=t.layout.studies[n.replaceID];if(p&&(d={outputMap:e.clone(p.outputMap),panel:p.panel}),l.panel="",s){var f=e.Studies.smartMovePanel(t,l.inputs,s,n.replaceID,"New panel"==n.panelName);f&&(l.panel=f.name)}else(h||c)&&(l.panel=e.Studies.getPanelFromFieldName(t,l)||n.chartName);if(!l.panel){var m=o.panelHeight||null,g=o.yAxis||{};g.name=l.inputs.id,l.panel=l.inputs.id,t.createPanel(l.inputs.display,l.panel,m,n.chartName,new e.ChartEngine.YAxis(g))}l.parameters&&l.parameters.panelName&&(l.parameters.panelName=l.panel);var v=t.panels[l.panel],y=e.Studies.smartCreateYAxis(t,v,l.inputs.id,n.yaxisDisplayValue,n.yAxis||o.yAxis),x=o?e.clone(o.yAxis):null,b=x||y;if(b&&(b.ground&&(b.initialMarginBottom=0),(b.initialMarginTop||0===b.initialMarginTop||b.initialMarginBottom||0===b.initialMarginBottom)&&t.calculateYAxisMargins(b),b.name==n.replaceID&&(b.name=l.inputs.id)),y&&(y.width="none"==y.position?0:e.ChartEngine.YAxis.prototype.width,"shared"==n.yaxisDisplayValue||"default"==n.yaxisDisplayValue?delete n.yaxisDisplayValue:x?e.ensureDefaults(y,x):y.name==l.name&&(n.yaxisDisplayColor&&"auto"!=n.yaxisDisplayColor?y.textStyle=e.colorToHex(n.yaxisDisplayColor):delete y.textStyle,y.justifyRight=null,y.flipped=n.flippedEnabled),y!=v.yAxis?y.displayGridLines=!1:y!=t.chart.yAxis&&(y.displayGridLines=t.displayGridLinesInStudies)),t.calculateYAxisPositions(),p){var S=!1;for(var C in t.drawingObjects){var w=t.drawingObjects[C];d.outputMap&&d.outputMap.hasOwnProperty(w.field)?(w.field=w.field.replace(n.replaceID,l.inputs.id),l.parameters&&l.parameters.panelName?w.panelName=l.parameters.panelName:w.panelName=l.panel,S=!0):d.panel&&d.panel==w.panelName&&(w.panelName=w.panelName.replace(n.replaceID,l.inputs.id),S=!0)}S&&t.changeOccurred("vector")}return l},e.Studies.smartMovePanel=function(t,e,i,a,r){var n,s=e.id;if(a&&(n=t.layout.studies[a]),n){var o=t.panels[n.panel];if(o&&o.yAxis.name==a)if(!r&&i==a||t.checkForEmptyPanel(o.name,!0,n))i!=a&&t.panels[i]||(s!=o.name&&t.modifyPanel(o,{name:s,display:e.display}),i=s);else{t.electNewPanelOwner(o);var l=n.getYAxis(t);l.name==a&&t.electNewYAxisOwner(l)}}return t.panels[i]},e.Studies.smartCreateYAxis=function(t,i,a,r,n){var s=t.getYAxisByName(i,a);if(!r&&n&&(r=n.position),"default"!=r&&"shared"!=r&&r!=i.yAxis.name||(r=""),["left","right","none"].indexOf(r)>-1){if(!s||s.isShared(t)){var o=n||{};if(e.extend(o,{name:a,position:r}),s||t.currentlyImporting||i==i.chart.panel||i.yAxis.studies.length||i.yAxis.renderers.length){var l=s==i.yAxis;s&&(s.name=t.electNewYAxisOwner(s)),s=t.addYAxis(i,new e.ChartEngine.YAxis(o)),l&&(i.yAxis=s)}else s=i.yAxis,e.extend(s,o)}else s.position=r;return s}if(r){var h=t.getYAxisByName(i,r);return h&&s==i.yAxis&&!s.isShared(t)&&(i.yAxis=h),s&&s.isShared(t)?s.name=t.electNewYAxisOwner(s):s!==i.yAxis&&t.deleteYAxisIfUnused(i,s),h}return s&&(s.isShared(t)?s.name=t.electNewYAxisOwner(s):(delete s.position,s!==i.yAxis&&t.deleteYAxisIfUnused(i,s))),t.resizeChart(),i.yAxis},e.Studies.calculateVolume=function(t,i){if("vol undr"==i.type){if(!t||!t.chart.dataSet)return;var a=t.layout,r=i.parameters.removeStudy,n=a.volumeUnderlay;a.volumeUnderlay=!r,n!=a.volumeUnderlay&&t.changeOccurred("layout"),r&&e.Studies.removeStudy(t,i)}i.outputMap={},i.outputMap.Volume=""},e.Studies.MA=function(t,i,a,r,n,s,o,l){var h=new e.Studies.StudyDescriptor(n+" "+o.name,"ma",o.panel);h.chart=o.chart,h.days=parseInt(i,10),h.startFrom=o.startFrom,l&&(h.subField=l),h.inputs={},t&&(h.inputs.Type=t),a&&(h.inputs.Field=a),r&&(h.inputs.Offset=parseInt(r,10)),e.Studies.calculateMovingAverage(s,h)},e.Studies.movingAverage={conversions:{ma:"simple",sma:"simple",ema:"exponential",tsma:"time series",tma:"triangular",vma:"variable",vdma:"vidya",wma:"weighted",smma:"welles wilder"},translations:{simple:"Simple",exponential:"Exponential","time series":"Time Series",triangular:"Triangular",variable:"Variable",vidya:"VIDYA",weighted:"Weighted","welles wilder":"Welles Wilder"},typeMap:{ema:"Exponential",exponential:"Exponential",tsma:"TimeSeries","time series":"TimeSeries",tma:"Triangular",triangular:"Triangular",vma:"Variable",variable:"Variable",vdma:"VIDYA",vidya:"VIDYA",wma:"Weighted",weighted:"Weighted",smma:"Exponential","welles wilder":"Exponential"}},e.Studies.movingAverageHelper=function(t,i){if("options"==i){var a={};for(var r in e.Studies.movingAverage.translations)a[r]=t.translateIf(e.Studies.movingAverage.translations[r]);return a}return e.Studies.movingAverage.conversions[i]},e.Studies.createVolumeChart=function(t,i,a){var r=i.panel,n=(i.inputs,i.underlay),s=(i.overlay,e.Studies.determineColor(i.outputs["Up Volume"])),o=e.Studies.determineColor(i.outputs["Down Volume"]),l=n?"stx_volume_underlay":"stx_volume";t.setStyle(l+"_up","color",s),t.setStyle(l+"_down","color",o);var h=[{field:i.volumeField||"Volume",fill_color_up:t.canvasStyle(l+"_up").color,border_color_up:t.canvasStyle(l+"_up").borderLeftColor,opacity_up:t.canvasStyle(l+"_up").opacity,fill_color_down:t.canvasStyle(l+"_down").color,border_color_down:t.canvasStyle(l+"_down").borderLeftColor,opacity_down:t.canvasStyle(l+"_down").opacity,color_function:i.colorFunction}],c=h[0];n||"rgb(184, 44, 12)"!==c.border_color_down||(c.border_color_down="#000000",c.border_color_up="#000000");var u={name:"Volume",panel:r,yAxis:i.getYAxis(t),widthFactor:1,bindToYAxis:!0,highlight:i.highlight};e.extend(u,i.study.parameters),e.extend(u,i.parameters),t.colorByCandleDirection&&!i.colorFunction&&(c.color_function=function(t){var e=t.Open,i=t.Close;return{fill_color:e>i?c.fill_color_down:c.fill_color_up,border_color:e>i?c.border_color_down:c.border_color_up,opacity:e>i?c.opacity_down:c.opacity_up}}),t.drawHistogram(u,h)},e.Studies.calculateStandardDeviation=function(t,i){var a=i.chart.scrubbed;if(a.length<i.days+1)i.error=!0;else{var n=i.inputs.Field;n&&"field"!=n||(n="Close");var s=i.inputs["Moving Average Type"];s||(s=i.inputs.Type),e.Studies.MA(s,i.days,n,i.inputs.Offset,"_MA",t,i);var o=0,l=0,h=0,c=Number(i.inputs["Standard Deviations"]);c<0&&(c=2);var u,d,p,f=i.name;for(var m in i.outputs)f=m+" "+f;for(u=i.startFrom-1,p=0;u>=0&&p<i.days;u--,p++)(d=a[u][n])&&"object"==r(d)&&(d=d[i.subField]),isNaN(d)&&(d=0),o+=Math.pow(d,2),l+=d;for(u=i.startFrom;u<a.length;u++){var g=a[u];if((d=g[n])&&"object"==r(d)&&(d=d[i.subField]),d||0===d||(d=0),o+=Math.pow(d,2),l+=d,!(u<i.days-1)){if(u>=i.days){var v=a[u-i.days][n];v&&"object"==r(v)&&(v=v[i.subField]),isNaN(v)&&(v=0),o-=Math.pow(v,2),l-=v}((h=g["_MA "+i.name])||0===h)&&(g[f]=Math.sqrt((o+i.days*Math.pow(h,2)-2*h*l)/i.days)*c)}}}},e.Studies.calculateMovingAverage=function(t,i){if(i.chart.scrubbed){var a=i.inputs.Type;"ma"!=a&&"sma"!=a&&a||(a="simple");var n=e.Studies.movingAverage.typeMap;if(a in n)return e.Studies["calculateMovingAverage"+n[a]](t,i);if("simple"===a){var s=i.chart.scrubbed,o=0,l=[],h=i.name;for(var c in i.outputs)h=c+" "+h;var u=i.inputs.Field;u&&"field"!=u||(u="Close");var d=parseInt(i.inputs.Offset,10);isNaN(d)&&(d=0);var p,f,m,g=i.startFrom,v=d;for(p=i.startFrom-1;p>=0;p--)if((f=s[p][u])&&"object"==r(f)&&(f=f[i.subField]),f||0===f)if(v>0)v--,g=p;else{if(l.length==i.days-1)break;o+=f,l.unshift(f)}l.length<i.days-1&&(l=[],g=0);var y=[];for(p=g;p<s.length;p++){(f=s[p][u])&&"object"==r(f)&&(f=f[i.subField]);var x=p+d>=0&&p+d<s.length?s[p+d]:null;if(f||0===f){o+=f,l.push(f),l.length>i.days&&(o-=l.shift());var b=l.length==i.days?o/i.days:null;x?x[h]=b:p+d>=s.length&&((m={})[h]=b,y.push(m))}else x?x[h]=null:p+d>=s.length&&((m={})[h]=null,y.push(m))}i.appendFutureTicks(t,y)}}},e.Studies.calculateMovingAverageExponential=function(t,e){var i=e.inputs.Type,a=e.chart.scrubbed,n=0,s=0,o=0,l=2/(e.days+1);"welles wilder"!==i&&"smma"!==i||(l=1/e.days);var h=null,c=e.name;for(var u in e.outputs)c=u+" "+c;var d=e.inputs.Field;d&&"field"!=d||(d="Close");var p,f,m=parseInt(e.inputs.Offset,10);isNaN(m)&&(m=0);var g=e.startFrom,v=m;for(p=e.startFrom-1;p>=0;p--)if((f=a[p][c])||0===f){if(null===h&&(h=f),o=e.days,v<=0)break;v--,g=p}null===h&&(h=g=0);var y=[];for(p=g;p<a.length;p++){(f=a[p][d])&&"object"==r(f)&&(f=f[e.subField]);var x,b=p+m>=0&&p+m<a.length?a[p+m]:null;if(f||0===f?(o==e.days-1?x=s=(n+=f)/e.days:o<e.days-1?(s=(n+=f)/(o+1),x=null):0===o?(s=n+=f,x=null):(h||0===h)&&(x=s=(f-h)*l+h),h=s,o++):x=null,b)b[c]=x;else if(p+m>=a.length){var S={};S[c]=x,y.push(S)}}e.appendFutureTicks(t,y)},e.Studies.calculateMovingAverageVariable=function(t,i){i.inputs.Type;var a=i.chart.scrubbed,n=2/(i.days+1),s=null,o=i.name;for(var l in i.outputs)o=l+" "+o;var h=i.inputs.Field;h&&"field"!=h||(h="Close"),i.cmo=new e.Studies.StudyDescriptor(i.name,"cmo",i.panel),i.cmo.chart=i.chart,i.cmo.days=9,i.cmo.inputs={Field:h},i.cmo.startFrom=i.startFrom,i.cmo.outputs={_CMO:null},e.Studies.calculateChandeMomentum(t,i.cmo);var c,u,d,p=parseInt(i.inputs.Offset,10);isNaN(p)&&(p=0);var f=i.startFrom,m=p;for(c=i.startFrom-1;c>=0;c--)if((u=a[c][o])||0===u){if(null===s&&(s=u),m<=0)break;m--,f=c}null===s&&(s=f=0);var g=[];for(c=f;c<a.length;c++){var v=a[c];(u=v[h])&&"object"==r(u)&&(u=u[i.subField]);var y=c+p>=0&&c+p<a.length?a[c+p]:null;if(u||0===u){if(v["_CMO "+i.name]||0===v["_CMO "+i.name]){var x=Math.abs(v["_CMO "+i.name])/100,b=n*x*u+(1-n*x)*s;s=b,c<i.days&&(b=null),y?y[o]=b:c+p>=a.length&&((d={})[o]=b,g.push(d))}}else y?y[o]=null:c+p>=a.length&&((d={})[o]=null,g.push(d))}i.appendFutureTicks(t,g)},e.Studies.calculateMovingAverageVIDYA=function(t,i){i.inputs.Type;var a=i.chart.scrubbed,n=2/(i.days+1),s=null,o=i.name;for(var l in i.outputs)o=l+" "+o;var h=i.inputs.Field;h&&"field"!=h||(h="Close"),i.std=new e.Studies.StudyDescriptor(i.name,"sdev",i.panel),i.std.chart=i.chart,i.std.days=5,i.std.startFrom=i.startFrom,i.std.inputs={Field:h,"Standard Deviations":1,Type:"ma"},i.std.outputs={_STD:null},e.Studies.calculateStandardDeviation(t,i.std),e.Studies.MA("ma",20,"_STD "+i.name,0,"_MASTD",t,i);var c,u,d,p=parseInt(i.inputs.Offset,10);isNaN(p)&&(p=0);var f=i.startFrom,m=p;for(c=i.startFrom-1;c>=0;c--)if((u=a[c][o])||0===u){if(null===s&&(s=u),m<=0)break;m--,f=c}null===s&&(s=f=0);var g=[];for(c=f;c<a.length;c++){var v=a[c];(u=v[h])&&"object"==r(u)&&(u=u[i.subField]);var y=c+p>=0&&c+p<a.length?a[c+p]:null;if(u||0===u){if(v["_MASTD "+i.name]||0===v["_MASTD "+i.name]){var x=v["_STD "+i.name]/v["_MASTD "+i.name],b=n*x*u+(1-n*x)*s;s=b,c<i.days&&(b=null),y?y[o]=b:c+p>=a.length&&((d={})[o]=b,g.push(d))}}else y?y[o]=null:c+p>=a.length&&((d={})[o]=null,g.push(d))}i.appendFutureTicks(t,g)},e.Studies.calculateMovingAverageTimeSeries=function(t,i){i.ma=new e.Studies.StudyDescriptor(i.name,"ma",i.panel),i.ma.chart=i.chart,i.ma.days=i.days,i.ma.startFrom=i.startFrom,i.ma.inputs=i.inputs,e.Studies.calculateLinearRegressionIndicator(t,i.ma);var a=i.name;for(var r in i.outputs)a=r+" "+a;var n=parseInt(i.inputs.Offset,10);isNaN(n)&&(n=0);for(var s=i.chart.scrubbed,o=n,l=i.startFrom-1;l>=0;l--){var h=s[l][a];if(h||0===h){if(!(o>0))break;o--}}var c=[];for(l++;l<s.length;l++){var u=s[l];if(l+n>=0)if(l+n<s.length)s[l+n][a]=u["Forecast "+i.name];else{var d={};d[a]=u["Forecast "+i.name],c.push(d)}}i.appendFutureTicks(t,c)},e.Studies.calculateMovingAverageTriangular=function(t,i){var a=i.chart.scrubbed,r=i.inputs.Field;r&&"field"!=r||(r="Close");var n=Math.ceil(i.days/2);e.Studies.MA("simple",n,r,0,"TRI1",t,i),i.days%2==0&&n++,e.Studies.MA("simple",n,"TRI1 "+i.name,0,"TRI2",t,i);var s=i.name;for(var o in i.outputs)s=o+" "+s;var l=parseInt(i.inputs.Offset,10);isNaN(l)&&(l=0);for(var h=l,c=i.startFrom-1;c>=0;c--){var u=a[c][s];if(u||0===u){if(!(h>0))break;h--}}var d=[];for(c++;c<a.length;c++)if(c+l>=0)if(c+l<a.length)a[c+l][s]=a[c]["TRI2 "+i.name];else{var p={};p[s]=a[c]["TRI2 "+i.name],d.push(p)}i.appendFutureTicks(t,d)},e.Studies.calculateMovingAverageWeighted=function(t,e){var i=e.chart.scrubbed,a=0,n=0,s=e.inputs.Field;s&&"field"!=s||(s="Close");var o=e.days*(e.days+1)/2,l=e.name;for(var h in e.outputs)l=h+" "+l;var c,u,d,p=parseInt(e.inputs.Offset,10);isNaN(p)&&(p=0);var f=[],m=e.startFrom,g=p;for(c=e.startFrom-1;c>=0;c--)if((u=i[c][s])&&"object"==r(u)&&(u=u[e.subField]),u||0===u)if(g>0)g--,m=c;else{if(f.length==e.days-1)break;f.unshift(u)}for(f.length<e.days-1&&(f=[],m=0),c=0;c<f.length;c++)a+=(c+1)*f[c],n+=f[c];var v=[];for(c=m;c<i.length;c++){(u=i[c][s])&&"object"==r(u)&&(u=u[e.subField]);var y=c+p>=0&&c+p<i.length?i[c+p]:null;if(u||0===u){f.push(u),f.length>e.days&&(a-=n,n-=f.shift()),a+=f.length*u,n+=u;var x=c<e.days-1?null:a/o;y?y[l]=x:c+p>=i.length&&((d={})[l]=x,v.push(d))}else y?y[l]=null:c+p>=i.length&&((d={})[l]=null,v.push(d))}e.appendFutureTicks(t,v)},e.Studies.calculateStudyATR=function(t,e){var i=e.chart.scrubbed,a=e.days;if(i.length<a+1)e.error=!0;else for(var r=0,n=e.name,s=Math.max(e.startFrom,1);s<i.length;s++){var o=i[s],l=i[s-1],h=o.trueRange;l["Sum True Range "+n]&&(r=l["Sum True Range "+n]),r+=h,s>a&&(r-=i[s-a]["True Range "+n]),o["True Range "+n]=h,o["Sum True Range "+n]=r,s==a?o["ATR "+n]=r/a:s>a&&(o["ATR "+n]=(l["ATR "+n]*(a-1)+h)/a)}},e.Studies.calculateIntradayMomentum=function(t,e){var i=e.chart.scrubbed,a=e.days;if(i.length<a+1)e.error=!0;else{var r=0,n=0;e.startFrom>1&&(r=i[e.startFrom-1]["_totUp "+e.name],n=i[e.startFrom-1]["_totDn "+e.name]);for(var s=e.startFrom;s<i.length;s++){var o=i[s].Close-i[s].Open;if(o>0?r+=o:n-=o,s>=a){var l=i[s-a].Close-i[s-a].Open;l>0?r-=l:n+=l}i[s]["Result "+e.name]=100*r/(r+n),i[s]["_totUp "+e.name]=r,i[s]["_totDn "+e.name]=n}}},e.Studies.calculateRateOfChange=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else{var a=e.inputs.Field;a&&"field"!=a||(a="Close"),e.parameters.isVolume&&(a="Volume");var n=e.name;for(var s in e.outputs)n=s+" "+n;var o=e.inputs["Center Line"];o=o?parseInt(o,10):0;for(var l=Math.max(e.startFrom,e.days);l<i.length;l++){var h=i[l][a];h&&"object"==r(h)&&(h=h[e.subField]);var c=i[l-e.days][a];if(c&&"object"==r(c)&&(c=c[e.subField]),"Momentum"==e.type)i[l][n]=h-c+o;else{var u=c;u&&(i[l][n]=100*(h/u-1)+o)}}}},e.Studies.calculateTypicalPrice=function(t,e){var i=e.chart.scrubbed,a=e.days;if(i.length<a+1)e.overlay||(e.error=!0);else{var r=e.name;for(var n in e.outputs)r=n+" "+r;var s="hlc/3";"Med Price"==e.type?s="hl/2":"Weighted Close"==e.type&&(s="hlcc/4");var o=0;e.startFrom<=a&&(e.startFrom=0);for(var l=e.startFrom;l<i.length;l++)l&&i[l-1][r]&&(o=i[l-1][r]*a),o+=i[l][s],l>=a&&(o-=i[l-a][s],i[l][r]=o/a)}},e.Studies.calculateChandeMomentum=function(t,e){var i=e.name;for(var a in e.outputs)i=a+" "+i;var n=e.chart.scrubbed;if(n.length<e.days+1)e.error=!0;else{var s=e.inputs.Field;s&&"field"!=s||(s="Close");for(var o=0,l=0,h=[],c=e.startFrom-e.days+1;c<n.length;c++)if(!(c<1)){var u=n[c][s],d=n[c-1][s];if(u&&"object"==r(u)&&(u=u.Close),d&&"object"==r(d)&&(d=d.Close),void 0!==d){var p=u-d;if(h.push(p),o+=p,l+=Math.abs(p),h.length==e.days){n[c][i]=100*o/l;var f=h.shift();o-=f,l-=Math.abs(f)}}}}},e.Studies.calculateLinearRegressionIndicator=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)e.error=!0;else{var a=e.inputs.Field;a&&"field"!=a||(a="Close");var n=e.days*(e.days+1)/2,s=Math.pow(n,2),o=n*(2*e.days+1)/3,l=0,h=0,c=0;if(e.startFrom){var u=i[e.startFrom-1]["_sums "+e.name];u&&(h=u[0],l=u[1],c=u[2])}for(var d=e.startFrom;d<i.length;d++){var p=i[d][a];if(p&&"object"==r(p)&&(p=p[e.subField]),(p||0===p)&&(h+=e.days*p-l,l+=p,c+=Math.pow(p,2),!(d<e.days-1))){if(d>e.days-1){var f=i[d-e.days][a];if(f&&"object"==r(f)&&(f=f[e.subField]),!f&&0!==f)continue;l-=f,c-=Math.pow(f,2)}var m=(e.days*h-n*l)/(e.days*o-s);i[d]["Slope "+e.name]=m;var g=(l-m*n)/e.days;i[d]["Intercept "+e.name]=g,i[d]["Forecast "+e.name]=g+m*e.days;var v=(e.days*o-s)/(e.days*c-Math.pow(l,2));i[d]["RSquared "+e.name]=m*m*v,i[d]["_sums "+e.name]=[h,l,c]}}}},e.Studies.calculatePriceRelative=function(t,i){var a=i.chart.scrubbed,r=i.inputs["Comparison Symbol"].toUpperCase();r||(r=i.study.inputs["Comparison Symbol"]);var n={},s=t.chart.symbol||"";if(n[s=s.replace(/[=+\-*\\%]/g,"")]=a.slice(i.startFrom),n[s].length){s!=r&&(n[r]=null);for(var o=e.computeEquationChart("["+s+"]/["+r+"]",n),l=0,h=i.startFrom;h<a.length&&l<o.length;h++){for(;l<o.length&&a[h].DT.getTime()>o[l].DT.getTime();)l++;a[h].DT.getTime()<o[l].DT.getTime()||(a[h]["Result "+i.name]=o[l].Close,l++)}}},e.Studies.calculateVWAP=function(t,i){var a="AVWAP"==i.type,r=i.chart.scrubbed;if(a||!e.ChartEngine.isDailyInterval(t.layout.interval)){var n="hlc/3";a&&((n=i.inputs.Field)&&"field"!=n||(n=i.inputs.Field="hlc/3",t.changeOccurred("layout")));var s=e.Market.Symbology.isForexSymbol(t.chart.symbol),o=e.Market.Symbology.isForexMetal(t.chart.symbol),l=null,h=0,c=0,u=0,d=!1;if(i.startFrom>1&&(h=r[i.startFrom-1]["_V "+i.name]||0,c=r[i.startFrom-1]["_VxP "+i.name]||0,u=r[i.startFrom-1]["_VxP2 "+i.name]||0),a){var p=i.inputs["Anchor Date"].replace(/-/g,"");if(p.search(/^\d{8}$/))return void(i.error="Invalid Anchor Date");var f=i.inputs["Anchor Time"].replace(/:/g,"");f.search(/^\d{4,6}$/)||(p+=f),p=e.strToDateTime(p.replace(/\D/g,"")),!i.startFrom&&p>=r[0].DT&&(i.startFrom=t.tickFromDate(p,t.chart,null,!0))}for(var m=i.startFrom;m<r.length;m++){if(!a&&(null===l&&(l=e.Studies.getMarketOffset(t,r[m].DT,s),s&&(l+=60*(o?6:7)*60*1e3)),r[m-1]&&r[m-1].DT)){var g=new Date(new Date(+r[m].DT).setMilliseconds(r[m].DT.getMilliseconds()+l));new Date(new Date(+r[m-1].DT).setMilliseconds(r[m-1].DT.getMilliseconds()+l)).getDate()!=g.getDate()&&t.chart.market.isMarketDate(g)&&(l=null,h=c=u=0)}var v=r[m][n],y=r[m].Volume;if(a&&!y&&(y=1),h+=y,c+=y*v,u+=y*v*v,a||h){r[m]["_V "+i.name]=h,r[m]["_VxP "+i.name]=c,r[m]["_VxP2 "+i.name]=u;for(var x=r[m]["_SDVWAP "+i.name]=Math.sqrt(Math.max(0,u/h-Math.pow(c/h,2))),b=r[m]["VWAP "+i.name]=c/h,S=1;S<=3;S++)r[m]["SDVWAP"+S+"+ "+i.name]=b+S*x,r[m]["SDVWAP"+S+"- "+i.name]=b-S*x;d=!0}}for(var C=1;C<=3;C++)i.inputs["Display "+C+" Standard Deviation ("+C+"σ)"]&&(i.outputMap["SDVWAP"+C+"+ "+i.name]=C+" Standard Deviation ("+C+"σ)",i.outputMap["SDVWAP"+C+"- "+i.name]=C+" Standard Deviation ("+C+"σ)");a||d||(i.error="VWAP Requires Volume")}else i.error="VWAP is Intraday Only"},e.Studies.initAnchoredVWAP=function(t,i,a,r,n,s){if(!a["Anchor Date"]&&!a["Anchor Time"])for(var o=t.chart.dataSegment,l=0;o&&l<o.length;l++)if(o[l]){var h=e.yyyymmddhhmmssmmm(o[l].DT);a["Anchor Date"]=h.substr(0,8),a["Anchor Time"]=h.substr(8,6);break}return e.Studies.initializeFN(t,i,a,r,n,s)},e.Studies.displayVsComparisonSymbol=function(t,i,a){var r=i.inputs["Comparison Symbol"].toUpperCase();if(t.getSeries({symbol:r,chart:i.chart}).length){var n={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:i.study.centerline,yAxis:i.getYAxis(t),gapDisplayStyle:!0},s=n.yAxis?n.yAxis.flipped:t.panels[i.panel].yAxis.flipped,o=.3;!i.highlight&&t.highlightedDraggable&&(o*=.3);for(var l=a.length-1;l>=0;l--)if(a[l]&&a[l][r])return e.Studies.displaySeriesAsLine(t,i,a),void((i.study.centerline||0===i.study.centerline)&&(i.outputs.Gain&&e.preparePeakValleyFill(t,e.extend(n,{direction:s?-1:1,color:e.Studies.determineColor(i.outputs.Gain),opacity:o})),i.outputs.Loss&&e.preparePeakValleyFill(t,e.extend(n,{direction:s?1:-1,color:e.Studies.determineColor(i.outputs.Loss),opacity:o}))))}else t.displayErrorAsWatermark(i.panel,t.translateIf(i.study.name)+": "+t.translateIf("Not Available"))},e.Studies.displayVWAP=function(t,i,a){e.Studies.displaySeriesAsLine(t,i,a);var r=i.inputs["Display 1 Standard Deviation (1σ)"],n=i.inputs["Display 2 Standard Deviation (2σ)"],s=i.inputs["Display 3 Standard Deviation (3σ)"];if((r||n||s)&&i.inputs.Shading){var o=t.panels[i.panel],l={opacity:i.parameters.opacity?i.parameters.opacity:.2,skipTransform:o.name!=i.chart.name,yAxis:i.getYAxis(t)};!i.highlight&&t.highlightedDraggable&&(l.opacity*=.3);var h="VWAP "+i.name,c="VWAP "+i.name;r&&(e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP1+ "+i.name,bottomBand:h,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP1+ "+i.name]])},l)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP1- "+i.name,bottomBand:c,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP1- "+i.name]])},l)),h="SDVWAP1+ "+i.name,c="SDVWAP1- "+i.name),n&&(e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP2+ "+i.name,bottomBand:h,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP2+ "+i.name]])},l)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP2- "+i.name,bottomBand:c,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP2- "+i.name]])},l)),h="SDVWAP2+ "+i.name,c="SDVWAP2- "+i.name),s&&(e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP3+ "+i.name,bottomBand:h,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP3+ "+i.name]])},l)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"SDVWAP3- "+i.name,bottomBand:c,color:e.Studies.determineColor(i.outputs[i.outputMap["SDVWAP3- "+i.name]])},l)))}},e.Studies.initPriceRelative=function(t,i,a,r,n,s){var o=e.Studies.initializeFN(t,i,a,r,n,s),l=[o.inputs["Comparison Symbol"].toUpperCase()];return e.Studies.fetchAdditionalInstruments(t,o,l),o},e.Studies.inputAttributeDefaultGenerator=function(t){return(t||0===t)&&t.constructor==Number?Math.floor(t)==t?t>0?{min:1,step:1}:{step:1}:t>0?{min:0,step:.01}:{step:.01}:{}},e.Studies.getMarketOffset=function(t,i,a){var r;r=t.chart.market?a?"America/New_York":t.chart.market.market_tz:null;var n=new Date(i.getTime()+6e4*i.getTimezoneOffset());return r&&-1!=r.indexOf("UTC")||(n=e.convertTimeZone(n,"UTC",r)),new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()).getTime()-i.getTime()},e.Studies.getStudyList=function(t){var i={},a={};for(var r in e.extend(a,t),e.Studies.studyLibrary)a[r]||(i[e.Studies.studyLibrary[r].name]=r);return i},e.Studies.determineColor=function(t){return t?"object"===r(t)?t.color:t:null},e.Studies.fetchAdditionalInstruments=function(t,i,a,n){if(t.quoteDriver){var s,o,l,h=t.panels[i.panel].chart;for(i.symbols=a,s=0;s<a.length;s++){o=l=a[s],"object"==r(l)?o=l.symbol:l={symbol:o};var c={symbol:o,symbolObject:l,bucket:"study",studyName:i.name,chartName:h.name,action:"add-study"};e.extend(c,n);var u=c.loadData;t.currentlyImporting&&(c.loadData=!1),i.series||(i.series={}),i.series[o]=t.addSeries(null,c,d),i.series[o].parameters.loadData=u}}else console.log("CIQ.Studies.fetchAdditionalInstruments: No quotefeed to fetch symbol");function d(){t.createDataSet(),t.draw()}},e.Studies.studyScriptLibrary={},e.Studies.studyLibrary||(e.Studies.studyLibrary={}),e.extend(e.Studies.studyLibrary,{ma:{name:"Moving Average",overlay:!0,calculateFN:e.Studies.calculateMovingAverage,inputs:{Period:50,Field:"field",Type:"ma",Offset:0},outputs:{MA:"#FF0000"}},"STD Dev":{name:"Standard Deviation",calculateFN:e.Studies.calculateStandardDeviation,inputs:{Period:14,Field:"field","Standard Deviations":2,"Moving Average Type":"ma"},attributes:{"Standard Deviations":{min:.1,step:.1}}},AVWAP:{name:"Anchored VWAP",overlay:!0,calculateFN:e.Studies.calculateVWAP,seriesFN:e.Studies.displayVWAP,initializeFN:e.Studies.initAnchoredVWAP,inputs:{Field:"field","Anchor Date":"","Anchor Time":"","Display 1 Standard Deviation (1σ)":!1,"Display 2 Standard Deviation (2σ)":!1,"Display 3 Standard Deviation (3σ)":!1,Shading:!1},outputs:{VWAP:"#FF0000","1 Standard Deviation (1σ)":"#e1e1e1","2 Standard Deviation (2σ)":"#85c99e","3 Standard Deviation (3σ)":"#fff69e"},parameters:{init:{opacity:.2}},attributes:{"Anchor Date":{placeholder:"yyyy-mm-dd"},"Anchor Time":{placeholder:"hh:mm:ss",step:1}}},"Price ROC":{name:"Price Rate of Change",calculateFN:e.Studies.calculateRateOfChange,inputs:{Period:14,Field:"field"}},Momentum:{name:"Momentum Indicator",calculateFN:e.Studies.calculateRateOfChange,inputs:{Period:14},centerline:0},"True Range":{name:"True Range",calculateFN:e.Studies.calculateStudyATR,inputs:{},outputs:{"True Range":"auto"}},"Med Price":{name:"Median Price",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14}},"P Rel":{name:"Price Relative",initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculatePriceRelative,centerline:0,inputs:{"Comparison Symbol":"SPY"},deferUpdate:!0},volume:{name:"Volume Chart",range:"0 to max",yAxis:{ground:!0,initialMarginTop:0,zoom:0},seriesFN:e.Studies.createVolumeChart,calculateFN:e.Studies.calculateVolume,inputs:{},outputs:{"Up Volume":"#8cc176","Down Volume":"#b82c0c"}},VWAP:{name:"VWAP",overlay:!0,calculateFN:e.Studies.calculateVWAP,seriesFN:e.Studies.displayVWAP,inputs:{"Display 1 Standard Deviation (1σ)":!1,"Display 2 Standard Deviation (2σ)":!1,"Display 3 Standard Deviation (3σ)":!1,Shading:!1},outputs:{VWAP:"#FF0000","1 Standard Deviation (1σ)":"#e1e1e1","2 Standard Deviation (2σ)":"#85c99e","3 Standard Deviation (3σ)":"#fff69e"},parameters:{init:{opacity:.2}}}})},_=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ChartEngine.Driver?(e.ChartEngine.Driver.Lookup=function(){},e.ChartEngine.Driver.Lookup.prototype.acceptText=function(t,e,i,a){this.cb}):console.error("symbolLookupBase feature requires first activating quoteFeed feature.")},E=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.ThemeHelper=e.ThemeHelper||function(t){this.params=t;var i=t.stx,a="#FFFFFF";i.chart.container&&(a=getComputedStyle(i.chart.container).backgroundColor,e.isTransparent(a)&&(a=i.containerColor)),this.settings.chart.Background.color=e.hexToRgba(a),this.settings.chart["Grid Lines"].color=e.hexToRgba(i.canvasStyle("stx_grid").color),this.settings.chart["Grid Dividers"].color=e.hexToRgba(i.canvasStyle("stx_grid_dark").color),this.settings.chart["Axis Text"].color=e.hexToRgba(i.canvasStyle("stx_xaxis").color),this.settings.chartTypes["Candle/Bar"].up.color=e.hexToRgba(i.canvasStyle("stx_candle_up").color),this.settings.chartTypes["Candle/Bar"].down.color=e.hexToRgba(i.canvasStyle("stx_candle_down").color),this.settings.chartTypes["Candle/Bar"].up.wick=e.hexToRgba(i.canvasStyle("stx_candle_shadow_up").color),this.settings.chartTypes["Candle/Bar"].down.wick=e.hexToRgba(i.canvasStyle("stx_candle_shadow_down").color),this.settings.chartTypes["Candle/Bar"].even.wick=e.hexToRgba(i.canvasStyle("stx_candle_shadow_even").color),this.settings.chartTypes["Candle/Bar"].up.border=e.hexToRgba(i.canvasStyle("stx_candle_up").borderLeftColor),this.settings.chartTypes["Candle/Bar"].down.border=e.hexToRgba(i.canvasStyle("stx_candle_down").borderLeftColor),e.isTransparent(i.canvasStyle("stx_candle_up").borderLeftColor)&&(this.settings.chartTypes["Candle/Bar"].up.border=null),e.isTransparent(i.canvasStyle("stx_candle_down").borderLeftColor)&&(this.settings.chartTypes["Candle/Bar"].down.border=null),this.settings.chartTypes.Line.color=e.hexToRgba(i.canvasStyle("stx_line_chart").color),this.settings.chartTypes.Mountain.color=e.hexToRgba(i.canvasStyle("stx_mountain_chart").backgroundColor),this.settings.chartTypes.Mountain.basecolor=e.hexToRgba(i.canvasStyle("stx_mountain_chart").color)},e.ThemeHelper.prototype.settings={chart:{Background:{color:null},"Grid Lines":{color:null},"Grid Dividers":{color:null},"Axis Text":{color:null}},chartTypes:{"Candle/Bar":{up:{color:null,wick:null,border:null},down:{color:null,wick:null,border:null},even:{color:null,wick:null,border:null}},Line:{color:null},Mountain:{color:null,basecolor:null}}},e.ThemeHelper.prototype.update=function(t){t||(t=this.params.stx);var i={stx_candle_up:{stx_candle_up:!0,stx_bar_up:!0,stx_hollow_candle_up:!0,stx_line_up:!0,stx_baseline_up:!0},stx_candle_down:{stx_candle_down:!0,stx_bar_down:!0,stx_hollow_candle_down:!0,stx_line_down:!0,stx_baseline_down:!0},stx_candle_even:{stx_hollow_candle_even:!0,stx_bar_even:!0},stx_shadow_up:{stx_candle_shadow_up:!0},stx_shadow_down:{stx_candle_shadow_down:!0},stx_shadow_even:{stx_candle_shadow_even:!0},stx_line_chart:{stx_bar_chart:!0,stx_line_chart:!0},stx_grid:{stx_grid:!0},stx_grid_dark:{stx_grid_dark:!0},stx_xaxis:{stx_xaxis_dark:!0,stx_xaxis:!0,stx_yaxis:!0,stx_yaxis_dark:!0,stx_grid_border:!0},stx_mountain_chart:{stx_mountain_chart:!0},stx_market_session:{stx_market_session:!0}};function a(e,a,r){var n=i[e];for(var s in n)t.setStyle(s,a,r)}t.chart.container.style.backgroundColor=this.settings.chart.Background.color,t.defaultColor="",a("stx_grid","color",this.settings.chart["Grid Lines"].color),a("stx_grid_dark","color",this.settings.chart["Grid Dividers"].color),a("stx_xaxis","color",this.settings.chart["Axis Text"].color);var r=this.settings.chartTypes["Candle/Bar"];r.even||(r.even={color:null,wick:e.hexToRgba(t.canvasStyle("stx_candle_shadow_even").color),border:null}),a("stx_candle_up","color",r.up.color),a("stx_candle_down","color",r.down.color),a("stx_candle_even","color",r.even.color),a("stx_shadow_up","color",r.up.wick),a("stx_shadow_down","color",r.down.wick),a("stx_shadow_even","color",r.even.wick),t.setStyle("stx_candle_up","borderLeftColor",r.up.border),t.setStyle("stx_candle_down","borderLeftColor",r.down.border),a("stx_line_chart","color",this.settings.chartTypes.Line.color),t.setStyle("stx_mountain_chart","borderTopColor",e.hexToRgba(this.settings.chartTypes.Mountain.color,1)),t.setStyle("stx_mountain_chart","backgroundColor",e.hexToRgba(this.settings.chartTypes.Mountain.color,.5)),t.setStyle("stx_mountain_chart","color",e.hexToRgba(this.settings.chartTypes.Mountain.basecolor,.01)),t.draw()},e.ChartEngine.prototype.setThemeSettings=function(t){if(this.styles={},this.chart.container.style.backgroundColor="",this.defaultColor="",t){var i=new e.ThemeHelper({stx:this});i.settings=t,i.update()}this.updateListeners("theme"),this.changeOccurred("theme"),this.displayInitialized&&(this.headsUpHR(),this.clearPixelCache(),this.updateListeners("theme"),this.draw())}},L=function(e){var i="undefined"!=typeof _CIQ?_CIQ:e.CIQ,a="undefined"!=typeof _timezoneJS?_timezoneJS:e.timezoneJS;i.timeZoneMap={"(UTC-11:00) American Samoa, Midway Island":"Pacific/Pago_Pago","(UTC-10:00) Hawaii":"Pacific/Honolulu","(UTC-09:00) Alaska":"America/Juneau","(UTC-08:00) Pacific Time (US and Canada), Tijuana":"America/Los_Angeles","(UTC-07:00) Arizona":"America/Phoenix","(UTC-07:00) Chihuahua, Mazatlan":"America/Chihuahua","(UTC-07:00) Mountain Time (US and Canada)":"America/Denver","(UTC-06:00) Central America":"America/Costa_Rica","(UTC-06:00) Central Time (US and Canada)":"America/Chicago","(UTC-06:00) Guadalajara, Mexico City, Monterrey":"America/Mexico_City","(UTC-06:00) Saskatchewan":"America/Regina","(UTC-05:00) Bogota, Lima, Quito, Rio Branco":"America/Bogota","(UTC-05:00) Eastern Time (US and Canada)":"America/New_York","(UTC-05:00) Havana":"America/Havana","(UTC-05:00) Port-au-Prince":"America/Port-au-Prince","(UTC-04:00) Asuncion":"America/Asuncion","(UTC-04:00) Santiago":"America/Santiago","(UTC-04:00) Caracas":"America/Caracas","(UTC-04:00) Atlantic Time (Canada)":"America/Halifax","(UTC-04:00) Georgetown, La Paz, Manaus, San Juan":"America/Puerto_Rico","(UTC-03:30) Newfoundland and Labrador":"America/St_Johns","(UTC-03:00) Cancun, Jamaica, Panama":"America/Panama","(UTC-03:00) Buenos Aires":"America/Argentina/Buenos_Aires","(UTC-03:00) Punta Arenas":"America/Punta_Arenas","(UTC-03:00) Montevideo":"America/Montevideo","(UTC-03:00) Sao Paulo":"America/Sao_Paulo","(UTC-02:00) Mid-Atlantic":"Atlantic/South_Georgia","(UTC-01:00) Azores":"Atlantic/Azores","(UTC-01:00) Cape Verde Islands":"Atlantic/Cape_Verde","(UTC) Greenwich Mean Time, Reykjavik":"UTC","(UTC) Dublin":"Europe/Dublin","(UTC) Lisbon, London":"Europe/London","(UTC+01:00) Algiers, Tunis":"Africa/Tunis","(UTC+01:00) Casablanca":"Africa/Casablanca","(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna":"Europe/Amsterdam","(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague":"Europe/Belgrade","(UTC+01:00) Brussels, Copenhagen, Madrid, Paris":"Europe/Brussels","(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb":"Europe/Sarajevo","(UTC+02:00) Kaliningrad":"Europe/Kaliningrad","(UTC+02:00) Athens, Bucharest":"Europe/Bucharest","(UTC+02:00) Cairo":"Africa/Cairo","(UTC+02:00) Harare, Johannesburg":"Africa/Johannesburg","(UTC+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius":"Europe/Helsinki","(UTC+02:00) Cyprus":"Asia/Nicosia","(UTC+02:00) Beirut":"Asia/Beirut","(UTC+02:00) Damascus":"Asia/Damascus","(UTC+02:00) Jerusalem":"Asia/Jerusalem","(UTC+02:00) Amman":"Asia/Amman","(UTC+03:00) Istanbul":"Europe/Istanbul","(UTC+03:00) Baghdad, Kuwait, Qatar, Riyadh":"Asia/Riyadh","(UTC+03:00) Minsk, Moscow, Kirov, Volgograd":"Europe/Moscow","(UTC+03:00) Simferopol":"Europe/Simferopol","(UTC+03:00) Nairobi":"Africa/Nairobi","(UTC+03:30) Tehran":"Asia/Tehran","(UTC+04:00) Baku":"Asia/Baku","(UTC+04:00) Dubai, Muscat":"Asia/Dubai","(UTC+04:00) Astrakhan, Samara, Saratov, Ulyanovsk":"Europe/Samara","(UTC+04:30) Kabul":"Asia/Kabul","(UTC+05:00) Karachi, Tashkent":"Asia/Karachi","(UTC+05:00) Yekaterinburg":"Asia/Yekaterinburg","(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi":"Asia/Kolkata","(UTC+05:45) Kathmandu":"Asia/Kathmandu","(UTC+06:00) Almaty":"Asia/Almaty","(UTC+06:00) Omsk":"Asia/Omsk","(UTC+06:00) Astana, Dhaka":"Asia/Dhaka","(UTC+06:30) Yangon":"Asia/Yangon","(UTC+07:00) Bangkok, Jakarta, Vietnam":"Asia/Bangkok","(UTC+07:00) Hovd":"Asia/Hovd","(UTC+07:00) Krasnoyarsk":"Asia/Krasnoyarsk","(UTC+07:00) Novokuznetsk":"Asia/Novokuznetsk","(UTC+07:00) Barnaul, Novosibirsk, Tomsk":"Asia/Novosibirsk","(UTC+08:00) Beijing, Chongqing, Hong Kong SAR":"Asia/Hong_Kong","(UTC+08:00) Brunei, Kuala Lumpur, Singapore":"Asia/Kuala_Lumpur","(UTC+08:00) Irkutsk":"Asia/Irkutsk","(UTC+08:00) Choibalsan, Ulaanbaatar":"Asia/Ulaanbaatar","(UTC+08:00) Manila, Taipei":"Asia/Taipei","(UTC+08:00) Perth":"Australia/Perth","(UTC+08:45) Eucla":"Australia/Eucla","(UTC+09:00) Osaka, Sapporo, Tokyo":"Asia/Tokyo","(UTC+09:00) Pyongyang":"Asia/Pyongyang","(UTC+09:00) Seoul":"Asia/Seoul","(UTC+09:00) Chita, Khandyga, Yakutsk":"Asia/Yakutsk","(UTC+09:30) Adelaide":"Australia/Adelaide","(UTC+09:30) Darwin":"Australia/Darwin","(UTC+10:00) Brisbane":"Australia/Brisbane","(UTC+10:00) Canberra, Melbourne, Sydney":"Australia/Sydney","(UTC+10:00) Guam, Port Moresby":"Pacific/Guam","(UTC+10:00) Ust-Nera, Vladivostok":"Asia/Vladivostok","(UTC+11:00) Noumea, Solomon Islands":"Pacific/Noumea","(UTC+11:00) Magadan":"Asia/Magadan","(UTC+11:00) Sakhalin, Srednekolymsk":"Asia/Srednekolymsk","(UTC+12:00) Anadyr, Kamchatka":"Asia/Kamchatka","(UTC+12:00) Auckland, Wellington":"Pacific/Auckland","(UTC+12:00) Fiji":"Pacific/Fiji","(UTC+12:45) Chatham":"Pacific/Chatham","(UTC+13:00) Tonga":"Pacific/Tongatapu","(UTC+13:00) Samoa":"Pacific/Apia","(UTC+14:00) Kiritimati":"Pacific/Kiritimati"},
/*!
 * Copyright 2010 Matthew Eernisse (mde@fleegix.org)
 * and Open Source Applications Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Credits: Ideas included from incomplete JS implementation of Olson
 * parser, 'XMLDAte' by Philippe Goetz (philippe.goetz@wanadoo.fr)
 *
 * Contributions:
 * Jan Niehusmann
 * Ricky Romero
 * Preston Hunt (prestonhunt@gmail.com)
 * Dov. B Katz (dov.katz@morganstanley.com)
 * Peter Bergström (pbergstr@mac.com)
 * Long Ho
 *
 * Modified from original by ChartIQ to include caching for improved performance
 */function(){var e=("undefined"!=typeof window?window:null)||(void 0!==t?t:{});a.VERSION="0.4.11";for(var r=e.$||e.jQuery||e.Zepto,n=e.fleegix,s=a.Days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o=a.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],l={},h={},c={},u=0;u<o.length;u++)l[o[u].substr(0,3)]=u;for(u=0;u<s.length;u++)h[s[u].substr(0,3)]=u;Array.prototype.indexOf;var d=function(t,e){if("number"!=typeof t)throw"not a number: "+t;var i=t>1e3,a=t.toString(),r=a.length;if(i&&r>e)return a.substr(r-e,r);for(a=[a];r<e;)a.unshift("0"),r++;return a.join("")},p=function(t){if(t){if(!t.url)throw new Error("URL must be specified");if("async"in t||(t.async=!0),!(n&&void 0!==n.xhr||r&&void 0!==r.ajax))throw new Error("Please use the Fleegix.js XHR module, jQuery ajax, Zepto ajax, or define your own transport mechanism for downloading zone files.");return t.async?n&&n.xhr?n.xhr.send({url:t.url,method:"get",handleSuccess:t.success,handleErr:t.error}):r.ajax({url:t.url,dataType:"text",method:"GET",error:t.error,success:t.success}):n&&n.xhr?n.xhr.doReq({url:t.url,async:!1}):r.ajax({url:t.url,async:!1,dataType:"text"}).responseText}};a.ruleCache={},a.Date=function(){if(this===a)throw"timezoneJS.Date object must be constructed with 'new'";var t=Array.prototype.slice.apply(arguments),e=null,i=null,r=[],n=!1;"[object Array]"===Object.prototype.toString.call(t[0])&&(t=t[0]),"string"==typeof t[t.length-1]&&(n=Date.parse(t[t.length-1].replace(/GMT[+-]\d+/,"")),(isNaN(n)||null===n)&&(i=t.pop()));var s=!1;switch(t.length){case 0:e=new Date;break;case 1:e=new Date(t[0]),"string"==typeof t[0]&&-1==t[0].search(/[+-][0-9]{4}/)&&-1==t[0].search(/Z/)&&-1==t[0].search(/T/)&&(s=!0);break;case 2:e=new Date(t[0],t[1]),s=!0;break;default:for(var o=0;o<7;o++)r[o]=t[o]||0;e=new Date(r[0],r[1],r[2],r[3],r[4],r[5],r[6]),s=!0}if(isNaN(e.getTime()))throw new Error("Invalid date");this._useCache=!1,this._tzInfo={},this._day=0,this.year=0,this.month=0,this.date=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0,this.timezone=i||null,s?this.setFromDateObjProxy(e):this.setFromTimeProxy(e.getTime(),i)},i.extend(a.Date.prototype,{getDate:function(){return this.date},getDay:function(){return this._day},getFullYear:function(){return this.year},getMonth:function(){return this.month},getYear:function(){return this.year-1900},getHours:function(){return this.hours},getMilliseconds:function(){return this.milliseconds},getMinutes:function(){return this.minutes},getSeconds:function(){return this.seconds},getUTCDate:function(){return this.getUTCDateProxy().getUTCDate()},getUTCDay:function(){return this.getUTCDateProxy().getUTCDay()},getUTCFullYear:function(){return this.getUTCDateProxy().getUTCFullYear()},getUTCHours:function(){return this.getUTCDateProxy().getUTCHours()},getUTCMilliseconds:function(){return this.getUTCDateProxy().getUTCMilliseconds()},getUTCMinutes:function(){return this.getUTCDateProxy().getUTCMinutes()},getUTCMonth:function(){return this.getUTCDateProxy().getUTCMonth()},getUTCSeconds:function(){return this.getUTCDateProxy().getUTCSeconds()},getTime:function(){return this._timeProxy+60*this.getTimezoneOffset()*1e3},getTimezone:function(){return this.timezone},getTimezoneOffset:function(){return this.getTimezoneInfo().tzOffset},getTimezoneAbbreviation:function(){return this.getTimezoneInfo().tzAbbr},getTimezoneInfo:function(){return this._useCache?this._tzInfo:(t=this.timezone?"Etc/UTC"===this.timezone||"Etc/GMT"===this.timezone?{tzOffset:0,tzAbbr:"UTC"}:a.timezone.getTzInfo(this._timeProxy,this.timezone):{tzOffset:this.getLocalOffset(),tzAbbr:null},this._tzInfo=t,this._useCache=!0,t);var t},getUTCDateProxy:function(){var t=new Date(this._timeProxy);return t.setUTCMinutes(t.getUTCMinutes()+this.getTimezoneOffset()),t},setDate:function(t){return this.setAttribute("date",t),this.getTime()},setFullYear:function(t,e,i){return void 0!==i&&this.setAttribute("date",1),this.setAttribute("year",t),void 0!==e&&this.setAttribute("month",e),void 0!==i&&this.setAttribute("date",i),this.getTime()},setMonth:function(t,e){return this.setAttribute("month",t),void 0!==e&&this.setAttribute("date",e),this.getTime()},setYear:function(t){return 0<=(t=Number(t))&&t<=99&&(t+=1900),this.setUTCAttribute("year",t),this.getTime()},setHours:function(t,e,i,a){return this.setAttribute("hours",t),void 0!==e&&this.setAttribute("minutes",e),void 0!==i&&this.setAttribute("seconds",i),void 0!==a&&this.setAttribute("milliseconds",a),this.getTime()},setMinutes:function(t,e,i){return this.setAttribute("minutes",t),void 0!==e&&this.setAttribute("seconds",e),void 0!==i&&this.setAttribute("milliseconds",i),this.getTime()},setSeconds:function(t,e){return this.setAttribute("seconds",t),void 0!==e&&this.setAttribute("milliseconds",e),this.getTime()},setMilliseconds:function(t){return this.setAttribute("milliseconds",t),this.getTime()},setTime:function(t){if(isNaN(t))throw new Error("Units must be a number.");return this.setFromTimeProxy(t,this.timezone),this.getTime()},setUTCFullYear:function(t,e,i){return void 0!==i&&this.setUTCAttribute("date",1),this.setUTCAttribute("year",t),void 0!==e&&this.setUTCAttribute("month",e),void 0!==i&&this.setUTCAttribute("date",i),this.getTime()},setUTCMonth:function(t,e){return this.setUTCAttribute("month",t),void 0!==e&&this.setUTCAttribute("date",e),this.getTime()},setUTCDate:function(t){return this.setUTCAttribute("date",t),this.getTime()},setUTCHours:function(t,e,i,a){return this.setUTCAttribute("hours",t),void 0!==e&&this.setUTCAttribute("minutes",e),void 0!==i&&this.setUTCAttribute("seconds",i),void 0!==a&&this.setUTCAttribute("milliseconds",a),this.getTime()},setUTCMinutes:function(t,e,i){return this.setUTCAttribute("minutes",t),void 0!==e&&this.setUTCAttribute("seconds",e),void 0!==i&&this.setUTCAttribute("milliseconds",i),this.getTime()},setUTCSeconds:function(t,e){return this.setUTCAttribute("seconds",t),void 0!==e&&this.setUTCAttribute("milliseconds",e),this.getTime()},setUTCMilliseconds:function(t){return this.setUTCAttribute("milliseconds",t),this.getTime()},setFromDateObjProxy:function(t){this.year=t.getFullYear(),this.month=t.getMonth(),this.date=t.getDate(),this.hours=t.getHours(),this.minutes=t.getMinutes(),this.seconds=t.getSeconds(),this.milliseconds=t.getMilliseconds(),this._day=t.getDay(),this._dateProxy=t,this._timeProxy=Date.UTC(this.year,this.month,this.date,this.hours,this.minutes,this.seconds,this.milliseconds),this._useCache=!1},setFromTimeProxy:function(t,e){var i=new Date(t),r=e?a.timezone.getTzInfo(t,e,!0).tzOffset:i.getTimezoneOffset();i.setTime(t+6e4*(i.getTimezoneOffset()-r)),this.setFromDateObjProxy(i)},setAttribute:function(t,e){if(isNaN(e))throw new Error("Units must be a number.");var i=this._dateProxy;i["set"+("year"===t?"FullYear":t.substr(0,1).toUpperCase()+t.substr(1))](e),this.setFromDateObjProxy(i)},setUTCAttribute:function(t,e){if(isNaN(e))throw new Error("Units must be a number.");var i="year"===t?"FullYear":t.substr(0,1).toUpperCase()+t.substr(1),a=this.getUTCDateProxy();a["setUTC"+i](e),a.setUTCMinutes(a.getUTCMinutes()-this.getTimezoneOffset()),this.setFromTimeProxy(a.getTime()+6e4*this.getTimezoneOffset(),this.timezone)},setTimezone:function(t){var e=this.getTimezoneInfo().tzOffset;this.timezone=t,this._useCache=!1,this.setUTCMinutes(this.getUTCMinutes()-this.getTimezoneInfo().tzOffset+e)},removeTimezone:function(){this.timezone=null,this._useCache=!1},valueOf:function(){return this.getTime()},clone:function(){return this.timezone?new a.Date(this.getTime(),this.timezone):new a.Date(this.getTime())},toGMTString:function(){return this.toString("EEE, dd MMM yyyy HH:mm:ss Z","Etc/GMT")},toLocaleStringIntl:function(){},toLocaleDateString:function(){},toLocaleTimeString:function(){},toSource:function(){},toISOString:function(){return this.toString("yyyy-MM-ddTHH:mm:ss.SSS","Etc/UTC")+"Z"},toJSON:function(){return this.toISOString()},toDateString:function(){return this.toString("EEE MMM dd yyyy")},toTimeString:function(){return this.toString("H:mm k")},toString:function(t,e){t||(t="yyyy-MM-ddTHH:mm:ss.SSS");var i=t,r=e?a.timezone.getTzInfo(this.getTime(),e):this.getTimezoneInfo(),n=this;e&&(n=this.clone()).setTimezone(e);var o=n.getHours();return i.replace(/a+/g,(function(){return"k"})).replace(/y+/g,(function(t){return d(n.getFullYear(),t.length)})).replace(/d+/g,(function(t){return d(n.getDate(),t.length)})).replace(/m+/g,(function(t){return d(n.getMinutes(),t.length)})).replace(/s+/g,(function(t){return d(n.getSeconds(),t.length)})).replace(/S+/g,(function(t){return d(n.getMilliseconds(),t.length)})).replace(/h+/g,(function(t){return d(o%12==0?12:o%12,t.length)})).replace(/M+/g,(function(t){var e=n.getMonth(),i=t.length;return i>3?a.Months[e]:i>2?a.Months[e].substring(0,i):d(e+1,i)})).replace(/k+/g,(function(){return o>=12?(o>12&&(o-=12),"PM"):"AM"})).replace(/H+/g,(function(t){return d(o,t.length)})).replace(/E+/g,(function(t){return s[n.getDay()].substring(0,t.length)})).replace(/Z+/gi,(function(){return r.tzAbbr}))},toUTCString:function(){return this.toGMTString()},civilToJulianDayNumber:function(t,e,i){var a;++e>12&&(a=parseInt(e/12,10),e%=12,t+=a),e<=2&&(t-=1,e+=12);var r=2-(a=Math.floor(t/100))+Math.floor(a/4);return Math.floor(365.25*(t+4716))+Math.floor(30.6001*(e+1))+i+r-1524},getLocalOffset:function(){return this._dateProxy.getTimezoneOffset()}},!0),a.timezone=new function(){var t=this,e={Etc:"etcetera",EST:"northamerica",MST:"northamerica",HST:"northamerica",EST5EDT:"northamerica",CST6CDT:"northamerica",MST7MDT:"northamerica",PST8PDT:"northamerica",America:["northamerica","southamerica"],Pacific:"australasia",Atlantic:"europe",Africa:"africa",Indian:"africa",Antarctica:"antarctica",Asia:"asia",Australia:"australasia",Europe:"europe",WET:"europe",CET:"europe",MET:"europe",EET:"europe"},i={"Pacific/Honolulu":"northamerica","Atlantic/Bermuda":"northamerica","Atlantic/Cape_Verde":"africa","Atlantic/St_Helena":"africa","Indian/Kerguelen":"antarctica","Indian/Chagos":"asia","Indian/Maldives":"asia","Indian/Christmas":"australasia","Indian/Cocos":"australasia","America/Danmarkshavn":"europe","America/Scoresbysund":"europe","America/Godthab":"europe","America/Thule":"europe","Asia/Istanbul":"europe","Asia/Yekaterinburg":"europe","Asia/Omsk":"europe","Asia/Novosibirsk":"europe","Asia/Krasnoyarsk":"europe","Asia/Irkutsk":"europe","Asia/Yakutsk":"europe","Asia/Vladivostok":"europe","Asia/Sakhalin":"europe","Asia/Magadan":"europe","Asia/Kamchatka":"europe","Asia/Anadyr":"europe","Africa/Ceuta":"europe",GMT:"etcetera","Europe/Nicosia":"asia"};function r(t){throw new Error("Timezone '"+t+"' is either incorrect, or not loaded in the timezone registry.")}function n(a){var s,o,l=i[a];if(l)return l;if(s=a.split("/")[0],o=e[s])return o;var h=t.zones[a];return"string"==typeof h?n(h):t.loadedZones.backward?void r(a):(t.loadZoneFile("backward"),n(a))}function s(t){var e=t.match(/(\d+)(?::0*(\d*))?(?::0*(\d*))?([wsugz])?$/);return e[1]=parseInt(e[1],10),e[2]=e[2]?parseInt(e[2],10):0,e[3]=e[3]?parseInt(e[3],10):0,e.slice(1,5)}function o(t){if(t[3]){var e=parseInt(t[3],10),i=11,a=31;t[4]&&(i=l[t[4].substr(0,3)],a=parseInt(t[5],10)||1);var r=t[6]?s(t[6]):[0,0,0];return[e,i,a,r[0],r[1],r[2]]}}function u(t){var e=s(t);return(e=("-"===t.charAt(0)?-1:1)*(1e3*(60*(60*e[0]+e[1])+e[2])))/60/1e3}function d(t,e){return-Math.ceil(e-t)}this.zoneFileBasePath=null,this.zoneFiles=["africa","antarctica","asia","australasia","backward","etcetera","europe","northamerica","pacificnew","southamerica"],this.loadingSchemes={PRELOAD_ALL:"preloadAll",LAZY_LOAD:"lazyLoad",MANUAL_LOAD:"manualLoad"},this.getRegionForTimezone=n,this.loadingScheme=this.loadingSchemes.LAZY_LOAD,this.loadedZones={},this.zones={},this.rules={},this.init=function(t){var e={async:!0},i=this.loadingScheme===this.loadingSchemes.PRELOAD_ALL?this.zoneFiles:this.defaultZoneFile||"northamerica";for(var a in t)e[a]=t[a];return this.loadZoneFiles(i,e)},this.loadZoneFiles=function(t,e){var i,a=0;if("string"==typeof t)return this.loadZoneFile(t,e);i=(e=e||{}).callback,e.callback=function(){++a===t.length&&"function"==typeof i&&i()};for(var r=0;r<t.length;r++)this.loadZoneFile(t[r],e)},this.loadZoneFile=function(e,i){if(void 0===this.zoneFileBasePath)throw new Error("Please define a base path to your zone file directory -- timezoneJS.timezone.zoneFileBasePath.");if(!this.loadedZones[e])return this.loadedZones[e]=!0,function(e,i){var a=t.zoneFileBasePath+"/"+e;return i&&i.async?t.transport({async:!0,url:a,success:function(e){return t.parseZones(e)&&"function"==typeof i.callback&&i.callback()},error:function(){throw new Error("Error retrieving '"+a+"' zoneinfo files")}}):t.parseZones(t.transport({url:a,async:!1}))}(e,i)},this.loadZoneJSONData=function(e,i){var a=function(e){for(var i in(e=JSON.parse(e)).zones)t.zones[i]=e.zones[i];for(var a in e.rules)t.rules[a]=e.rules[a]};return i?a(t.transport({url:e,async:!1})):t.transport({url:e,success:a})},this.loadZoneDataFromObject=function(e){if(e){for(var i in e.zones)t.zones[i]=e.zones[i];for(var a in e.rules)t.rules[a]=e.rules[a]}},this.getAllZones=function(){var t=[];for(var e in this.zones)t.push(e);return t.sort()},this.parseZones=function(e){if(!e)return!1;for(var i,a=e.split("\n"),r=[],n=null,l=null,h=0;h<a.length;h++)if((i=a[h]).match(/^\s/)&&(i="Zone "+n+i),(i=i.split("#")[0]).length>3)switch((r=i.split(/\s+/)).shift()){case"Zone":if(n=r.shift(),t.zones[n]||(t.zones[n]=[]),r.length<3)break;r.splice(3,r.length,o(r)),r[3]&&(r[3]=Date.UTC.apply(null,r[3])),r[0]=-u(r[0]),t.zones[n].push(r);break;case"Rule":l=r.shift(),t.rules[l]||(t.rules[l]=[]),r[0]=parseInt(r[0],10),r[1]=parseInt(r[1],10)||r[1],r[5]=s(r[5]),r[6]=u(r[6]),t.rules[l].push(r);break;case"Link":if(t.zones[r[1]])throw new Error("Error with Link "+r[1]+". Cannot create link of a preexisted zone.");isNaN(r[0])?t.zones[r[1]]=r[0]:t.zones[r[1]]=parseInt(r[0],10)}return!0},this.transport=p,this.getTzInfo=function(e,i,n){this.lazyLoadZoneFiles(i);var s=function e(i,a){for(var n="number"==typeof i?i:new Date(+i).getTime(),s=a,o=t.zones[s];"string"==typeof o;)s=o,o=t.zones[s];if(!o){if(!t.loadedZones.backward)return t.loadZoneFile("backward"),e(i,a);if(s&&s!==a)return t.lazyLoadZoneFiles(s),e(i,s);r(s)}if(0===o.length)throw new Error("No Zone found for '"+a+"' on "+i);for(var l=o.length-1;l>=0;l--){var h=o[l];if(h[3]&&n>h[3])break}return o[l+1]}(e,i),o=+s[0],u=function(e,i,r,n){var s="number"==typeof e?new Date(e):e,o=i[1],u=i[0],p=o.match(/^([0-9]):([0-9][0-9])$/);if(p)return[-1e6,"max","-","Jan",1,[0,0,0],60*parseInt(p[1],10)+parseInt(p[2],10),"-"];var f,m,g=function(t,e,i){var a=0;if("u"===e||"g"===e||"z"===e)a=0;else if("s"===e)a=u;else{if("w"!==e&&e)throw new Error("unknown type "+e);a=d(u,i[6])}return a*=6e4,new Date(t.getTime()+a)},v=function(t,e){var i,a=t[0],r=t[1],n=r[5];if(c[a]||(c[a]={}),c[a][r])i=c[a][r];else{if(isNaN(r[4])){var s,o;"last"===r[4].substr(0,4)?(i=new Date(Date.UTC(a,l[r[3]]+1,1,n[0]-24,n[1],n[2],0)),s=h[r[4].substr(4,3)],o="<="):(i=new Date(Date.UTC(a,l[r[3]],r[4].substr(5),n[0],n[1],n[2],0)),s=h[r[4].substr(0,3)],o=r[4].substr(3,2));var u=i.getUTCDay();">="===o?i.setUTCDate(i.getUTCDate()+(s-u+(s<u?7:0))):i.setUTCDate(i.getUTCDate()+(s-u-(s>u?7:0)))}else i=new Date(Date.UTC(a,l[r[3]],r[4],n[0],n[1],n[2],0));c[a][r]=i}return e&&(i=g(i,n[3],e)),i},y=function(t,e){for(var i=[],a=0;e&&a<e.length;a++)e[a][0]<=t&&(e[a][1]>=t||e[a][0]===t&&"only"===e[a][1]||"max"===e[a][1])&&i.push([t,e[a]]);return i},x=function(t,e,i){var a,n;return t instanceof Date?i&&(t=g(t,r?"u":"w",i)):(a=t[0],n=t[1],t=!i&&c[a]&&c[a][n]?c[a][n]:v(t,i)),e instanceof Date?i&&(e=g(e,r?"u":"w",i)):(a=e[0],n=e[1],e=!i&&c[a]&&c[a][n]?c[a][n]:v(e,i)),(t=Number(t))-(e=Number(e))},b=s.getUTCFullYear(),S=a.ruleCache[n];if(S||(S=a.ruleCache[n]={}),(f=S[b])||((f=(f=y(b-1,t.rules[o])).concat(y(b,t.rules[o]))).sort(x),S[b]=f),!f||!f.length)return null;for(var C=f.length-1;C>=0;C--){m=C>0?f[C-1][1]:null;var w=f[C];if(w[2]||(w[2]=v(w,m)),x(s,w,m)>=0)return w[1]}return null}(e,s,n,i);return u&&(o=d(o,u[6])),{tzOffset:o,tzAbbr:function(t,e){var i,a=t[2];return a.indexOf("%s")>-1?(i=e?"-"===e[7]?"":e[7]:"S",a.replace("%s",i)):a.indexOf("/")>-1?a.split("/",2)[e&&e[6]?1:0]:a}(s,u)}},this.lazyLoadZoneFiles=function(t){if(this.loadingScheme===this.loadingSchemes.LAZY_LOAD){var e=n(t);if(!e)throw new Error("Not a valid timezone ID.");this.loadZoneFiles(e)}}}}.call("undefined"!=typeof window?window:void 0),a.timezone.loadingScheme=a.timezone.loadingSchemes.MANUAL_LOAD,a.timezone.loadZoneDataFromObject({zones:{"Atlantic/Cape_Verde":[[60,"-","-01",null]],"Africa/Cairo":[[-120,"Egypt","EE%sT",null]],"Africa/Nairobi":[[-180,"-","EAT",null]],"Africa/Casablanca":[[0,"Morocco","+00/+01",15406956e5],[-60,"Morocco","+01/+00",null]],"Africa/Johannesburg":[[-120,"SA","SAST",null]],"Africa/Tunis":[[-60,"Tunisia","CE%sT",null]],"Asia/Kabul":[[-270,"-","+0430",null]],"Asia/Baku":[[-240,"Azer","+04/+05",null]],"Asia/Dhaka":[[-360,"Dhaka","+06/+07",null]],"Asia/Yangon":[[-390,"-","+0630",null]],"Asia/Shanghai":[[-480,"PRC","C%sT",null]],"Asia/Hong_Kong":[[-480,"HK","HK%sT",null]],"Asia/Taipei":[[-480,"Taiwan","C%sT",null]],"Asia/Nicosia":[[-120,"EUAsia","EE%sT",null]],"Asia/Kolkata":[[-330,"-","IST",null]],"Asia/Tehran":[[-210,"Iran","+0330/+0430",null]],"Asia/Jerusalem":[[-120,"Zion","I%sT",null]],"Asia/Tokyo":[[-540,"Japan","J%sT",null]],"Asia/Amman":[[-120,"Jordan","EE%sT",null]],"Asia/Almaty":[[-360,"-","ALMT",null]],"Asia/Seoul":[[-540,"ROK","K%sT",null]],"Asia/Pyongyang":[[-540,"-","KST",14395968e5],[-510,"-","KST",15254766e5],[-540,"-","KST",null]],"Asia/Beirut":[[-120,"Lebanon","EE%sT",null]],"Asia/Kuala_Lumpur":[[-480,"-","+08",null]],"Asia/Hovd":[[-420,"Mongol","+07/+08",null]],"Asia/Ulaanbaatar":[[-480,"Mongol","+08/+09",null]],"Asia/Kathmandu":[[-345,"-","+0545",null]],"Asia/Karachi":[[-300,"Pakistan","PK%sT",null]],"Asia/Riyadh":[[-180,"-","+03",null]],"Asia/Damascus":[[-120,"Syria","EE%sT",null]],"Asia/Bangkok":[[-420,"-","+07",null]],"Asia/Dubai":[[-240,"-","+04",null]],"Australia/Darwin":[[-570,"Aus","CST",null]],"Australia/Perth":[[-480,"AW","WST",null]],"Australia/Eucla":[[-525,"AW","+0845/+0945",null]],"Australia/Brisbane":[[-600,"AQ","EST",null]],"Australia/Adelaide":[[-570,"AS","CST",null]],"Australia/Sydney":[[-600,"AN","EST",null]],"Pacific/Fiji":[[-720,"Fiji","+12/+13",null]],"Pacific/Guam":[[-600,"-","ChST",null]],"Pacific/Kiritimati":[[-840,"-","+14",null]],"Pacific/Noumea":[[-660,"NC","+11/+12",null]],"Pacific/Auckland":[[-720,"NZ","NZ%sT",null]],"Pacific/Chatham":[[-765,"Chatham","+1245/+1345",null]],"Pacific/Pago_Pago":[[660,"-","SST",null]],"Pacific/Apia":[[-780,"WS","+13/+14",null]],"Pacific/Tongatapu":[[-780,"Tonga","+13/+14",null]],"Etc/UTC":[[0,"-","UTC",null]],UTC:"Etc/UTC","Europe/London":[[0,"EU","GMT/BST",null]],"Europe/Dublin":[[0,"Eire","IST/GMT",null]],WET:[[0,"EU","WE%sT",null]],CET:[[-60,"C-Eur","CE%sT",null]],MET:[[-60,"C-Eur","ME%sT",null]],EET:[[-120,"EU","EE%sT",null]],"Europe/Brussels":[[-60,"EU","CE%sT",null]],"Europe/Helsinki":[[-120,"EU","EE%sT",null]],"Europe/Paris":[[-60,"EU","CE%sT",null]],"Europe/Berlin":[[-60,"EU","CE%sT",null]],"Europe/Amsterdam":[[-60,"EU","CE%sT",null]],"Atlantic/Azores":[[60,"EU","-01/+00",null]],"Europe/Bucharest":[[-120,"EU","EE%sT",null]],"Europe/Kaliningrad":[[-120,"-","EET",null]],"Europe/Moscow":[[-180,"-","MSK",null]],"Europe/Simferopol":[[-180,"-","MSK",null]],"Europe/Samara":[[-240,"-","+04",null]],"Asia/Yekaterinburg":[[-300,"-","+05",null]],"Asia/Omsk":[[-360,"-","+06",null]],"Asia/Novosibirsk":[[-360,"-","+06",14693256e5],[-420,"-","+07",null]],"Asia/Novokuznetsk":[[-420,"-","+07",null]],"Asia/Krasnoyarsk":[[-420,"-","+07",null]],"Asia/Irkutsk":[[-480,"-","+08",null]],"Asia/Yakutsk":[[-540,"-","+09",null]],"Asia/Vladivostok":[[-600,"-","+10",null]],"Asia/Magadan":[[-600,"-","+10",14614632e5],[-660,"-","+11",null]],"Asia/Srednekolymsk":[[-660,"-","+11",null]],"Asia/Kamchatka":[[-720,"-","+12",null]],"Europe/Belgrade":[[-60,"EU","CE%sT",null]],"Europe/Sarajevo":"Europe/Belgrade","Europe/Istanbul":[[-120,"EU","EE%sT",14457348e5],[-120,"1:00","EEST",14469444e5],[-120,"EU","EE%sT",14732064e5],[-180,"-","+03",null]],"America/New_York":[[300,"US","E%sT",null]],"America/Chicago":[[360,"US","C%sT",null]],"America/Denver":[[420,"US","M%sT",null]],"America/Los_Angeles":[[480,"US","P%sT",null]],"America/Juneau":[[540,"US","AK%sT",null]],"Pacific/Honolulu":[[600,"-","HST",null]],"America/Phoenix":[[420,"-","MST",null]],"America/St_Johns":[[210,"Canada","N%sT",null]],"America/Halifax":[[240,"Canada","A%sT",null]],"America/Regina":[[360,"-","CST",null]],"America/Mexico_City":[[360,"Mexico","C%sT",null]],"America/Chihuahua":[[420,"Mexico","M%sT",null]],"America/Costa_Rica":[[360,"CR","C%sT",null]],"America/Havana":[[300,"Cuba","C%sT",null]],"America/Port-au-Prince":[[300,"Haiti","E%sT",null]],"America/Panama":[[300,"-","EST",null]],"America/Puerto_Rico":[[240,"-","AST",null]],"America/Argentina/Buenos_Aires":[[180,"Arg","-03/-02",null]],"America/Sao_Paulo":[[180,"Brazil","-03/-02",null]],"America/Santiago":[[240,"Chile","-04/-03",null]],"America/Punta_Arenas":[[240,"Chile","-04/-03",14808096e5],[180,"-","-03",null]],"America/Bogota":[[300,"CO","-05/-04",null]],"America/Asuncion":[[240,"Para","-04/-03",null]],"Atlantic/South_Georgia":[[120,"-","-02",null]],"America/Montevideo":[[180,"Uruguay","-03/-02",null]],"America/Caracas":[[270,"-","-0430",14620698e5],[240,"-","-04",null]],"Europe/Athens":"Europe/Bucharest","Asia/Rangoon":"Asia/Yangon","Atlantic/Reykjavik":"UTC","Asia/Kuwait":"Asia/Riyadh","Asia/Muscat":"Asia/Riyadh","Asia/Istanbul":"Europe/Istanbul"},rules:{Egypt:[],Morocco:[[2013,2018,"-","Oct","lastSun",[3,0,0,null],0,"-"],[2014,2018,"-","Mar","lastSun",[2,0,0,null],60,"-"],[2015,"only","-","Jun","14",[3,0,0,null],0,"-"],[2015,"only","-","Jul","19",[2,0,0,null],60,"-"],[2016,"only","-","Jun","5",[3,0,0,null],0,"-"],[2016,"only","-","Jul","10",[2,0,0,null],60,"-"],[2017,"only","-","May","21",[3,0,0,null],0,"-"],[2017,"only","-","Jul","2",[2,0,0,null],60,"-"],[2018,"only","-","May","13",[3,0,0,null],0,"-"],[2018,"only","-","Jun","17",[2,0,0,null],60,"-"],[2019,"only","-","May","5",[3,0,0,null],-60,"-"],[2019,"only","-","Jun","9",[2,0,0,null],0,"-"],[2020,"only","-","Apr","19",[3,0,0,null],-60,"-"],[2020,"only","-","May","24",[2,0,0,null],0,"-"],[2021,"only","-","Apr","11",[3,0,0,null],-60,"-"],[2021,"only","-","May","16",[2,0,0,null],0,"-"],[2022,"only","-","Mar","27",[3,0,0,null],-60,"-"],[2022,"only","-","May","8",[2,0,0,null],0,"-"],[2023,"only","-","Mar","19",[3,0,0,null],-60,"-"],[2023,"only","-","Apr","23",[2,0,0,null],0,"-"]],SA:[],Tunisia:[],EUAsia:[[1981,"max","-","Mar","lastSun",[1,0,0,"u"],60,"S"],[1996,"max","-","Oct","lastSun",[1,0,0,"u"],0,"-"]],Azer:[[1997,2015,"-","Mar","lastSun",[4,0,0,null],60,"-"],[1997,2015,"-","Oct","lastSun",[5,0,0,null],0,"-"]],Dhaka:[],PRC:[],HK:[],Taiwan:[],Iran:[[2013,2015,"-","Mar","22",[0,0,0,null],60,"-"],[2013,2015,"-","Sep","22",[0,0,0,null],0,"-"],[2016,"only","-","Mar","21",[0,0,0,null],60,"-"],[2016,"only","-","Sep","21",[0,0,0,null],0,"-"],[2017,2019,"-","Mar","22",[0,0,0,null],60,"-"],[2017,2019,"-","Sep","22",[0,0,0,null],0,"-"],[2020,"only","-","Mar","21",[0,0,0,null],60,"-"],[2020,"only","-","Sep","21",[0,0,0,null],0,"-"],[2021,2023,"-","Mar","22",[0,0,0,null],60,"-"],[2021,2023,"-","Sep","22",[0,0,0,null],0,"-"]],Zion:[[2013,"max","-","Mar","Fri>=23",[2,0,0,null],60,"D"],[2013,"max","-","Oct","lastSun",[2,0,0,null],0,"S"]],Japan:[],Jordan:[[2014,"max","-","Mar","lastThu",[24,0,0,null],60,"S"],[2014,"max","-","Oct","lastFri",[0,0,0,"s"],0,"-"]],ROK:[],Lebanon:[[1993,"max","-","Mar","lastSun",[0,0,0,null],60,"S"],[1999,"max","-","Oct","lastSun",[0,0,0,null],0,"-"]],Mongol:[[2015,2016,"-","Mar","lastSat",[2,0,0,null],60,"-"],[2015,2016,"-","Sep","lastSat",[0,0,0,null],0,"-"]],Pakistan:[],Syria:[[2012,"max","-","Mar","lastFri",[0,0,0,null],60,"S"],[2009,"max","-","Oct","lastFri",[0,0,0,null],0,"-"]],Aus:[],AW:[],AQ:[],AS:[[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"-"],[2008,"max","-","Oct","Sun>=1",[2,0,0,"s"],60,"-"]],AN:[[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"-"],[2008,"max","-","Oct","Sun>=1",[2,0,0,"s"],60,"-"]],Fiji:[[2014,"max","-","Nov","Sun>=1",[2,0,0,null],60,"-"],[2015,"max","-","Jan","Sun>=13",[3,0,0,null],0,"-"]],NC:[],NZ:[[2007,"max","-","Sep","lastSun",[2,0,0,"s"],60,"D"],[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"S"]],Chatham:[[2007,"max","-","Sep","lastSun",[2,45,0,"s"],60,"-"],[2008,"max","-","Apr","Sun>=1",[2,45,0,"s"],0,"-"]],WS:[[2012,"max","-","Apr","Sun>=1",[4,0,0,null],0,"-"],[2012,"max","-","Sep","lastSun",[3,0,0,null],60,"-"]],Tonga:[[2016,"only","-","Nov","Sun>=1",[2,0,0,null],60,"-"],[2017,"only","-","Jan","Sun>=15",[3,0,0,null],0,"-"]],Eire:[[1981,"max","-","Mar","lastSun",[1,0,0,"u"],0,"-"],[1996,"max","-","Oct","lastSun",[1,0,0,"u"],-60,"-"]],EU:[[1981,"max","-","Mar","lastSun",[1,0,0,"u"],60,"S"],[1996,"max","-","Oct","lastSun",[1,0,0,"u"],0,"-"]],"C-Eur":[[1981,"max","-","Mar","lastSun",[2,0,0,"s"],60,"S"],[1996,"max","-","Oct","lastSun",[2,0,0,"s"],0,"-"]],US:[[2007,"max","-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2007,"max","-","Nov","Sun>=1",[2,0,0,null],0,"S"]],Canada:[[2007,"max","-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2007,"max","-","Nov","Sun>=1",[2,0,0,null],0,"S"]],Mexico:[[2002,"max","-","Apr","Sun>=1",[2,0,0,null],60,"D"],[2002,"max","-","Oct","lastSun",[2,0,0,null],0,"S"]],CR:[],Cuba:[[2012,"max","-","Nov","Sun>=1",[0,0,0,"s"],0,"S"],[2013,"max","-","Mar","Sun>=8",[0,0,0,"s"],60,"D"]],Haiti:[[2012,2015,"-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2012,2015,"-","Nov","Sun>=1",[2,0,0,null],0,"S"],[2017,"max","-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2017,"max","-","Nov","Sun>=1",[2,0,0,null],0,"S"]],Arg:[],Brazil:[[2008,2017,"-","Oct","Sun>=15",[0,0,0,null],60,"-"],[2015,"only","-","Feb","Sun>=22",[0,0,0,null],0,"-"],[2016,2019,"-","Feb","Sun>=15",[0,0,0,null],0,"-"],[2018,"only","-","Nov","Sun>=1",[0,0,0,null],60,"-"]],Chile:[[2016,2018,"-","May","Sun>=9",[3,0,0,"u"],0,"-"],[2016,2018,"-","Aug","Sun>=9",[4,0,0,"u"],60,"-"],[2019,"max","-","Apr","Sun>=2",[3,0,0,"u"],0,"-"],[2019,"max","-","Sep","Sun>=2",[4,0,0,"u"],60,"-"]],CO:[],Para:[[2010,"max","-","Oct","Sun>=1",[0,0,0,null],60,"-"],[2013,"max","-","Mar","Sun>=22",[0,0,0,null],0,"-"]],Uruguay:[[2006,2015,"-","Mar","Sun>=8",[2,0,0,null],0,"-"]]}})},I=function(t){var e="undefined"!=typeof _CIQ?_CIQ:t.CIQ;e.Visualization=e.Visualization||function(t){t?"function"==typeof t.renderFunction?(this.container=null,this.attributes=t,this.data=null,this.object=null):console.log("CIQ.Visualization() missing renderFunction property in attributes."):console.log("CIQ.Visualization() missing attributes argument.")},e.extend(e.Visualization.prototype,{destroy:function(t){var i=this.container;e.resizeObserver(i,null,i.resizeHandle),i.autoGenerated?(i.parentNode.removeChild(i),delete this.container):i.innerHTML="",t||(this.attributes=null,this.container=null,this.data=null,this.object=null,this.destroy=this.draw=this.setAttributes=function(){},this.updateData=function(){})},draw:function(t){if(this.data&&"object"===r(this.data)){var i,a=this.attributes,n=a.container||this.container;if("string"==typeof n&&(n=document.querySelector(n)),n||((n=document.createElement("div")).style.height=n.style.width="300px",document.body.appendChild(n),n.autoGenerated=!0),a.stx){var s=a.stx.chart.canvasShim;a.useCanvasShim&&s&&s!==n&&s!==n.parentNode&&(n.autoGenerated||((n=n.cloneNode()).id="",n.autoGenerated=!0),s.appendChild(n))}if(this.container&&this.container!==n&&this.destroy(!0),!n.resizeHandle){n.resizeHandle=e.resizeObserver(n,(i=this,function(){i.data&&i.container&&document.body.contains(i.container)&&i.draw.call(i,!0)}),null,100)}this.container=n,this.attributes=a;var o=(a=e.ensureDefaults({container:this.container},this.attributes)).renderFunction(Object.values(this.data).sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0})),a);o&&(a.id&&(o.id=a.id),(t||a.forceReplace)&&(this.container.innerHTML="",this.container.appendChild(o))),this.attributes=a,this.object=o}else console.log("CIQ.Visualization.draw() missing data.")},setAttributes:function(t,e){var i=["renderFunction","container","stx","useCanvasShim","id","forceReplace"],a=!1,n=t;if("string"==typeof t&&((n={})[t]=e),"object"==r(n))for(var s in n)this.attributes[s]!==n[s]&&-1!==i.indexOf(s)&&(a=!0),this.attributes[s]=n[s];this.draw(a)},updateData:function(t,i){var a,r,n=Array.isArray(t)?t.reduce((function(t,e){return t[e.name]=e,t}),{}):e.shallowClone(t);for(a in n)r=n[a],"[object Object]"!==Object.prototype.toString.call(r)&&(n[a]={value:r}),n[a].name||(n[a].name=a),n[a].value||(n[a].value=0);switch(i||(i="replace"),i.toLowerCase()){case"delete":for(a in n)delete this.data[a];break;case"replace":this.data={};case"update":case"add":for(a in n)for(var s in this.data[a]||(this.data[a]={name:a}),r=n[a].value,"[object Number]"==Object.prototype.toString.call(r)?(this.data[a].value&&"update"!=i||(this.data[a].value=0),this.data[a].value+=r):this.data[a].value=r,n[a])"value"!==s&&(this.data[a][s]=n[a][s]);break;default:console.log("Invalid or missing action.  Valid values are 'add', 'delete', 'replace', or 'update'.")}return this.draw(this.attributes.forceReplace),this}}),e.ChartEngine.prototype.embedVisualization=function(t){return t||(t={}),t.stx=this,t.useCanvasShim=!0,t.translator=function(e){return t.stx.translateIf(e)},new e.Visualization(t)}};function O(){}function N(){}function H(){}O.a7i=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"vYKnr",{get:function(){for(;;)return this},configurable:!0}),(e=vYKnr).r1JEa=e,i=4;break;case 4:i="undefined"==typeof r1JEa?3:9;break;case 9:delete e.r1JEa,delete Object.prototype.vYKnr,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="Z3",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="Z",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(O.a7i),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}function a(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}for(var r=2;70!==r;)switch(r){case 62:n[19]+=n[3],n[19]+=n[4],n[57]=n[5],n[57]+=n[41],r=58;break;case 3:n[2]="N",n[4]="imize",n[3]="",n[3]="t",n[8]="",n[8]="__op",r=13;break;case 73:s(e,n[78],n[98],n[94]),r=72;break;case 2:var n=[arguments];n[5]="",n[5]="r",n[4]="",r=3;break;case 31:n[41]="",n[41]="1l",n[97]="",n[97]="f",r=44;break;case 71:s(l,"apply",n[40],n[68]),r=70;break;case 13:n[6]="",n[6]="al",n[9]="idu",n[7]="F",r=20;break;case 36:n[50]+=n[67],n[95]=n[43],n[95]+=n[93],n[95]+=n[83],r=51;break;case 16:n[56]="1",n[49]="",n[49]="e",n[93]="",n[93]="str",r=24;break;case 20:n[1]="",n[1]="__res",n[20]="ll",n[56]="",r=16;break;case 75:s(a,"push",n[40],n[57]),r=74;break;case 44:n[40]=2,n[40]=1,n[98]=0,n[68]=n[97],r=40;break;case 58:n[57]+=n[67],n[62]=n[2],n[62]+=n[56],n[62]+=n[20],r=77;break;case 47:n[78]+=n[9],n[78]+=n[6],n[89]=n[7],n[89]+=n[56],n[89]+=n[20],n[19]=n[8],r=62;break;case 77:var s=function(t,e,i,a){for(var r=2;5!==r;)switch(r){case 2:var s=[arguments];o(n[0][0],s[0][0],s[0][1],s[0][2],s[0][3]),r=5}};r=76;break;case 24:n[83]="act",n[43]="",n[43]="",n[43]="__ab",r=35;break;case 35:n[36]="v",n[67]="",n[67]="",n[67]="l",r=31;break;case 40:n[68]+=n[41],n[68]+=n[67],n[50]=n[36],n[50]+=n[41],r=36;break;case 76:s(i,"test",n[40],n[62]),r=75;break;case 51:n[94]=n[49],n[94]+=n[56],n[94]+=n[20],n[78]=n[1],r=47;break;case 72:s(e,n[95],n[98],n[50]),r=71;break;case 74:s(e,n[19],n[98],n[89]),r=73}function o(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 2:var s=[arguments];s[5]="",s[5]="erty",s[3]="",s[3]="fineProp",n=9;break;case 9:s[8]="",s[8]="de";try{for(var o=2;8!==o;)switch(o){case 2:s[2]={},o=1;break;case 1:s[1]=(0,s[0][1])(s[0][0]),s[9]=[s[1],s[1].prototype][s[0][3]],s[2].value=s[9][s[0][2]],o=3;break;case 3:try{for(var l=2;3!==l;)switch(l){case 5:s[7]+=s[5],s[0][0].Object[s[7]](s[9],s[0][4],s[2]),l=3;break;case 2:s[7]=s[8],s[7]+=s[3],l=5}}catch(t){}s[9][s[0][4]]=s[2].value,o=8}}catch(t){}n=6}}function l(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}}(O.a7i),O.E4o=function(){return"function"==typeof O.I4o.R4o?O.I4o.R4o.apply(O.I4o,arguments):O.I4o.R4o},O.O0z=function(){return"function"==typeof O.r0z.c8i?O.r0z.c8i.apply(O.r0z,arguments):O.r0z.c8i},O.N4o=function(){return"function"==typeof O.I4o.R4o?O.I4o.R4o.apply(O.I4o,arguments):O.I4o.R4o},O.k4v=function(){for(var t=2;9!==t;)switch(t){case 2:var e=[arguments];e[9]=void 0,t=5;break;case 5:return e[3]={},e[3].M8v=function(){for(var t=2;90!==t;)switch(t){case 58:i[13]=0,t=57;break;case 6:i[8]={},i[8].G4o=["x4o"],i[8].V4o=function(){var t=!1,e=[];try{for(var i in console)e.r1ll(i);t=0===e.length}catch(t){}return t},i[3]=i[8],i[1]={},i[1].G4o=["x4o"],t=20;break;case 72:i[82].r1ll(i[99]),t=71;break;case 36:i[83]=i[49],i[6].r1ll(i[60]),i[6].r1ll(i[33]),i[6].r1ll(i[68]),t=51;break;case 67:return e[9]=16,54;case 20:i[1].V4o=function(){return"function"==typeof F1ll},i[2]=i[1],i[4]={},i[4].G4o=["U4o"],i[4].V4o=function(){return/\u0078\x78/.N1ll(function(){return"x".repeat(2)}+[])},i[5]=i[4],t=27;break;case 42:i[75].G4o=["x4o"],i[75].V4o=function(){return"function"==typeof v1ll},i[68]=i[75],i[49]={},i[49].G4o=["U4o"],i[49].V4o=function(){return/\u0031\x39\u0032/.N1ll(function(){!function(t){for(var e=0;e<20;e++)t+=e}(2)}+[])},t=36;break;case 68:t=68;break;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 4:a[8]={},a[6]=[],a[5]=0,e=8;break;case 6:a[9]=a[0][0][a[5]],e=14;break;case 24:a[5]++,e=16;break;case 18:a[7]=!1,e=17;break;case 11:a[8][a[9][i[18]]].t+=!0,e=10;break;case 13:a[8][a[9][i[18]]]=function(){for(var t=2;9!==t;)switch(t){case 4:return e[6].t=0,e[6];case 2:var e=[arguments];e[6]={},e[6].h=0,t=4}}.f1ll(this,arguments),e=12;break;case 10:e=a[9][i[96]]===i[93]?20:19;break;case 5:return;case 20:a[8][a[9][i[18]]].h+=!0,e=19;break;case 26:e=a[3]>=.5?25:24;break;case 1:e=0===a[0][0].length?5:4;break;case 16:e=a[5]<a[6].length?15:23;break;case 23:return a[7];case 19:a[5]++,e=7;break;case 17:a[5]=0,e=16;break;case 2:var a=[arguments];e=1;break;case 14:e=void 0===a[8][a[9][i[18]]]?13:11;break;case 15:a[4]=a[6][a[5]],a[3]=a[8][a[4]].h/a[8][a[4]].t,e=26;break;case 7:e=a[5]<a[0][0].length?6:18;break;case 12:a[6].r1ll(a[9][i[18]]),e=11;break;case 25:a[7]=!0,e=24;break;case 8:a[5]=0,e=7}}(i[82])?68:67;break;case 71:i[66]++,t=76;break;case 1:t=e[9]?5:4;break;case 61:i[96]="X4o",i[87]="V4o",i[18]="D4o",t=58;break;case 77:i[66]=0,t=76;break;case 51:i[6].r1ll(i[83]),i[6].r1ll(i[7]),i[6].r1ll(i[5]),i[6].r1ll(i[44]),i[6].r1ll(i[2]),i[6].r1ll(i[59]),i[6].r1ll(i[3]),t=65;break;case 76:t=i[66]<i[54][i[55]].length?75:70;break;case 65:i[82]=[],i[93]="P4o",i[86]="u4o",i[55]="G4o",t=61;break;case 28:i[71].V4o=function(){return/\x3d/.N1ll(function(){return unescape("%3D")}+[])},t=44;break;case 2:var i=[arguments];t=1;break;case 23:i[38]={},i[38].G4o=["U4o"],i[38].V4o=function(){return/\u0039\x37/.N1ll(function(){return"a".codePointAt(0)}+[])},t=35;break;case 75:i[99]={},i[99][i[18]]=i[54][i[55]][i[66]],i[99][i[96]]=i[41],t=72;break;case 44:i[33]=i[71],i[75]={},t=42;break;case 5:return 49;case 4:i[6]=[],i[9]={},i[9].G4o=["U4o"],i[9].V4o=function(){return/\x78/.N1ll(function(){return"X".toLocaleLowerCase()}+[])},i[7]=i[9],t=6;break;case 56:i[54]=i[6][i[13]],t=55;break;case 35:i[44]=i[38],i[10]={},i[10].G4o=["U4o"],i[10].V4o=function(){return/\u0061\u0061\u0061\x61\x61/.N1ll(function(){return"aaaa".padEnd(5,"a")}+[])},i[59]=i[10],i[71]={},i[71].G4o=["U4o"],t=28;break;case 57:t=i[13]<i[6].length?56:69;break;case 55:try{i[41]=i[54][i[87]]()?i[93]:i[86]}catch(t){i[41]=i[86]}t=77;break;case 70:i[13]++,t=57;break;case 27:i[94]={},i[94].G4o=["x4o"],i[94].V4o=function(){return"function"==typeof e1ll},i[60]=i[94],t=23}},e[3]}}(),O.u0z=function(){return"function"==typeof O.r0z.c8i?O.r0z.c8i.apply(O.r0z,arguments):O.r0z.c8i},O.F4o=function(){return"function"==typeof O.I4o.Y4o?O.I4o.Y4o.apply(O.I4o,arguments):O.I4o.Y4o},O.J4v=function(){return"function"==typeof O.k4v.M8v?O.k4v.M8v.apply(O.k4v,arguments):O.k4v.M8v},O.y4o=function(){return"function"==typeof O.I4o.Y4o?O.I4o.Y4o.apply(O.I4o,arguments):O.I4o.Y4o},O.A4v=function(){return"function"==typeof O.k4v.M8v?O.k4v.M8v.apply(O.k4v,arguments):O.k4v.M8v},O.r0z=(o=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{c8i:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.Z3ZZ(n)|(255&t.Z3ZZ(n+1))<<8|(255&t.Z3ZZ(n+2))<<16|(255&t.Z3ZZ(n+3))<<24;s=o(s,3432918353),a=5*(a=(524287&(a^=s=o(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.Z3ZZ(r+2))<<16;case 2:s|=(255&t.Z3ZZ(r+1))<<8;case 1:s|=255&t.Z3ZZ(r),s=o(s,3432918353),a^=s=o(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=o(a^=a>>>16,2246822507),a=o(a^=a>>>13,3266489909),a^=a>>>16}}),O.I4o={Y4o:function(){var t,e=arguments;switch(l){case 14:t=-(-e[0]-e[2]+e[1]);break;case 7:t=+e[0]*e[1];break;case 6:t=e[0]/e[1];break;case 4:t=-e[0]/-e[1];break;case 10:t=e[0]*e[1]-e[2];break;case 9:t=-e[2]-e[1]-e[0]+e[3];break;case 13:t=e[1]&e[0];break;case 15:t=e[3]*(e[0]+e[1])/e[2];break;case 11:t=e[2]/(e[1]*e[0]);break;case 16:t=e[3]*(e[2]/e[1]+e[0]);break;case 2:t=e[1]+e[2]/e[3]-e[0];break;case 3:t=e[1]+e[0];break;case 5:t=e[0]-e[1];break;case 8:t=(e[1]+e[0])/+e[2];break;case 20:t=e[0]+(e[3]+e[2]*e[4])*e[1];break;case 19:t=(e[2]-e[1])*e[0];break;case 18:t=e[1]*e[0]/e[2];break;case 0:t=e[1]*e[0];break;case 1:t=e[3]-e[2]/e[1]+e[0];break;case 17:t=e[1]-e[0]+e[2];break;case 12:t=e[2]+e[0]-e[1]}return t},R4o:function(t){l=t}},O.J4v(),h=function(t){var e;(e="undefined"!==("undefined"==typeof _CIQ?"undefined":r(_CIQ))?_CIQ:t.CIQ).ChartEngine.prototype.drawHeatmap=function(t,e){var i,a,n,s,o,l,h,c,u,d,p,f,m,g;function v(e,i,o,u,g,v,y,x){var b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,N=O;if(N.J4v(),"numbe","r",l.beginPath(),l.fillStyle=i,l.strokeStyle=i,l.textAlign="center",b=f.layout.candleWidth*g,S=Math.floor(f.pixelFromBar(0,a.chart)-f.layout.candleWidth),"number"==r(o)&&(N.E4o(0),l.globalAlpha=N.F4o(c,o)),"object"==r(o)){170812285,-547091430,D=2;for(var H=1;170812285!==N.O0z(H.toString(),H.toString().length,53709);H++)k={minOpacity:o.min&&1,maxOpacity:o.max&&4},D+=2;-547091430!==N.u0z(D.toString(),D.toString().length,95702)&&(k={minOpacity:o.min&&1,maxOpacity:o.max&&4}),k={minOpacity:o.min||0,maxOpacity:o.max||1}}for(var R=0;R<s.length;R++)if((T=s[R])&&T.candleWidth?(S+=0===R?f.layout.candleWidth:(T.candleWidth+b/g)/2,b=T.candleWidth*g):S+=f.layout.candleWidth,N.N4o(1),C=N.y4o(y,2,b,S),N.E4o(2),(w=N.y4o(y,S,b,2))-C<2&&(N.N4o(3),w=N.y4o(1,C)),T&&(A=T[e])){A[x]&&(A=A[x]),"number"==typeof A&&(A=[A]);for(var z=0;z<A.length;z++){if(P=0,(M=A[z])instanceof Array){if(k){N.N4o(4);var j=N.F4o(14,14);l.globalAlpha=c*(M[2]*k.maxOpacity+(j-M[2])*k.minOpacity)}P=M[1],M=M[0]}F=f.pixelFromPrice(M,a,n),m||(v||(v=t.height),_=f.pixelFromPrice(M+v*(n.flipped?1:-1),a,n),l.lineWidth=1,N.E4o(5),d=N.F4o(_,F),N.E4o(6),p=N.F4o(d,2),m=l.lineWidth),u?(N.E4o(5),E=N.F4o(F,p),N.N4o(3),L=N.F4o(p,F),N.E4o(5),l.rect(C,E,N.y4o(w,C),N.y4o(L,E))):(N.E4o(5),l.fillRect(C,N.y4o(F,p),N.y4o(w,C),d),t.showSize&&P&&h<=d-2&&(I=l.globalAlpha,l.fillStyle=f.defaultColor,N.E4o(7),l.globalAlpha=N.y4o("0.5",c),N.E4o(8),l.fillText(P,N.y4o(C,w,"2"),F),l.fillStyle=i,N.N4o(0),l.globalAlpha=N.y4o(c,I))),k&&M instanceof Array&&(l.globalAlpha=0)}}u&&l.stroke(),l.globalAlpha=c,l.closePath()}if("D","a","t","a","c","h","art",O.A4v(),e&&e.length&&((i=t.panel)||(i="chart"),a=this.panels[i])){n=t.yAxis?t.yAxis:a.yAxis,s=this.chart.dataSegment,t.name||(t.name="Data"),t.widthFactor||(t.widthFactor=1),t.height||(t.height=Math.pow(10,1-(a.decimalPlaces||a.chart.decimalPlaces))),o="stx-float-date",l=this.chart.context,this.canvasFont(o,l),h=this.getCanvasFontSize(o),c=1,!t.highlight&&this.highlightedDraggable&&(c=.3),O.E4o(5),u=O.y4o("0.5",0),a.chart.tmpWidth<=1&&(u=0),d=null,p=null,f=this,m=null,this.startClip(i),l.globalAlpha=c;for(var y=0;y<e.length;y++)v((g=e[y]).field,g.color,g.opacity,null,t.widthFactor,g.height,g.border_color?u:-u/4,g.subField),g.border_color&&this.layout.candleWidth>=2&&v(g.field,g.border_color,g.opacity,!0,t.widthFactor,g.height,u,g.subField);l.lineWidth=1,l.globalAlpha=1,this.endClip()}},O.J4v(),e.ChartEngine.prototype.drawCandles=function(t,i,a){var n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,N,H,R,z,j,V,B,W,U,Y,Q,q=O;n=t.chart,q.A4v(),n||(n=t,t=t.chart),s=!1,o=!1,l=null,h=t.yAxis,a&&"object"==r(a)?(s=a.isOutline,o=a.isHistogram,l=a.field,h=a.yAxis):(s=a,o=arguments[3]),c=n.dataSegment,u=n.context,d=h.top,p=h.bottom,v=new Array(c.length),y="transparent",x="transparent",b=0,q.N4o(9);var X=q.y4o(10,19,8,38);S=n.dataSet.length-n.scroll-X,C={},w=n.tmpWidth/2,k=this.layout.candleWidth,D=t.left-.5*k+this.micropixels-1;for(var Z=0;Z<=c.length;Z++)if(T="transpar",T+="e",T+="nt",A="s",A+="olid",M="o",M+="utlin",M+="e",P=w,q.E4o(6),D+=q.y4o(k,2),k=this.layout.candleWidth,q.E4o(6),D+=q.y4o(k,2),(F=c[Z])&&!F.projection){if(F.candleWidth){q.N4o(10);var G=q.F4o(12,14,166);D+=(F.candleWidth-k)/G,k=F.candleWidth,(a.isVolume||k<n.tmpWidth)&&(q.E4o(11),P=q.y4o(1,"2",k))}if(n.transformFunc&&h==n.panel.yAxis&&F.transform&&(F=F.transform),F&&l&&(F=F[l]),(F||0===F)&&(_=F.Close,E=void 0===F.Open?_:F.Open,o&&n.defaultPlotField&&(_=F[n.defaultPlotField]),(_||0===_)&&(o||E!=_&&null!==E)&&(L=i(this,F,s?M:A)))){if(s?y=L:x=L,C[x]=1,(I=y&&!e.isTransparent(y))&&!a.highlight&&(q.E4o(0),b=q.F4o(1,"0.5")),u.beginPath(),u.fillStyle=x,F.cache||(F.cache={}),N=F.cache,q.N4o(3),(H=q.F4o(Z,S))<t.cacheLeft||H>t.cacheRight||!N.open){if(R=h.semiLog?h.height*(1-(Math.log(Math.max(E,0))/Math.LN10-h.logLow)/h.logShadow):(h.high-E)*h.multiplier,z=h.semiLog?h.height*(1-(Math.log(Math.max(_,0))/Math.LN10-h.logLow)/h.logShadow):(h.high-_)*h.multiplier,h.flipped?(q.N4o(5),R=q.y4o(p,R),q.E4o(5),z=q.y4o(p,z)):(R+=d,z+=d),v[Z]=z,f=Math.floor(o?z:Math.min(R,z))+b,m=o?h.bottom:Math.max(R,z),q.E4o(5),g=Math.floor(q.F4o(m,f)),f<d){if(f+g<d){N.open=f,N.close=f;continue}q.N4o(5),g-=q.F4o(d,f),f=d}f+g>p&&(q.N4o(12),g-=q.F4o(g,p,f)),q.N4o(0),g=Math.max(g,q.F4o(1,"2")),N.open=f,N.close=N.open+g}N.open>=p||N.close<=d||(j=Math.floor(D)+(!a.highlight&&.5),V=Math.floor(j-P)+b,B=Math.round(j+P)-b,N.open!=N.close&&u.rect(V,N.open,Math.max(1,B-V),Math.max(1,N.close-N.open)),!a.highlight&&this.highlightedDraggable&&(q.N4o(5),u.globalAlpha*=q.y4o("0.3",0)),x!=T&&u.fill(),I&&(q.E4o(13),u.lineWidth=q.F4o(2147483647,"1"),a.highlight&&(u.lineWidth*=2),u.strokeStyle=y,u.stroke()))}}W=-910751555,U=-863863680,Y=2;for(var K=1;q.O0z(K.toString(),K.toString().length,31049)!==W;K++)Q={colors:[],cache:v},Y+=2;for(var J in q.u0z(Y.toString(),Y.toString().length,49492)!==U&&(Q={colors:[],cache:v}),Q={colors:[],cache:v},C)a.hollow&&e.equals(J,this.containerColor)||Q.colors.push(J);return Q},e.ChartEngine.prototype.drawShadows=function(t,e,i){var a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P=O;a=t.chart,P.A4v(),a||(a=t,t=t.chart),r=a.dataSegment,(n=this.chart.context).lineWidth=1,i.highlight&&(n.lineWidth*=2),!i.highlight&&this.highlightedDraggable&&(n.globalAlpha*=.3),s=i.field,l=(o=i.yAxis||t.yAxis).top,h=o.bottom,P.E4o(10);var F=P.F4o(14,18,251);c=a.dataSet.length-a.scroll-F,u=this.layout.candleWidth,P.N4o(14);var _=P.y4o(19,20,2);d=t.left-.5*u+this.micropixels-_;for(var E=0;E<=r.length;E++)if(P.N4o(6),d+=P.F4o(u,2),u=this.layout.candleWidth,P.E4o(6),d+=P.F4o(u,2),(p=r[E])&&!p.projection&&(p.candleWidth&&(d+=(p.candleWidth-u)/2,u=p.candleWidth),(f=e(this,p,"shadow"))&&(a.transformFunc&&o==a.panel.yAxis&&p.transform&&(p=p.transform),p&&s&&(p=p[s]),(p||0===p)&&(m=p.Close,g=void 0===p.Open?m:p.Open,v=void 0===p.High?Math.max(m,g):p.High,y=void 0===p.Low?Math.min(m,g):p.Low,m||0===m)))){if(p.cache||(p.cache={}),x=p.cache,P.N4o(3),(b=P.y4o(E,c))<t.cacheLeft||b>t.cacheRight||!x.top){if(S=o.semiLog?o.height*(1-(Math.log(Math.max(v,0))/Math.LN10-o.logLow)/o.logShadow):(o.high-v)*o.multiplier,C=o.semiLog?o.height*(1-(Math.log(Math.max(y,0))/Math.LN10-o.logLow)/o.logShadow):(o.high-y)*o.multiplier,o.flipped?(P.N4o(5),S=P.F4o(h,S),P.E4o(5),C=P.y4o(h,C)):(S+=l,C+=l),P.N4o(5),w=P.F4o(C,S),S<l){if(S+w<l){x.top=S,x.bottom=S;continue}P.E4o(5),w-=P.y4o(l,S),S=l}S+w>h&&(P.E4o(12),w-=P.y4o(w,h,S)),x.top=S,x.bottom=x.top+w}x.top>=h||x.bottom<=l||(k=Math.floor(d)+(!i.highlight&&.5),n.beginPath(),m==g&&(D=this.offset,i.isVolume&&(P.E4o(6),D=P.y4o(u,2)),P.E4o(5),T=P.F4o(k,D),P.N4o(3),A=P.y4o(D,k),M=o.semiLog?o.height*(1-(Math.log(Math.max(m,0))/Math.LN10-o.logLow)/o.logShadow):(o.high-m)*o.multiplier,o.flipped?(P.E4o(5),M=P.y4o(h,M)):M+=l,M<=h&&M>=l&&(n.moveTo(T,M),n.lineTo(A,M))),v!=y&&(n.moveTo(k,x.top),n.lineTo(k,x.bottom)),n.strokeStyle=f,n.stroke())}},e.ChartEngine.prototype.drawBarChart=function(t,i,a,r){var n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,N,H=O;if(!(n=t.chart)){-1708206876,1959044150,s=2;for(var R=1;-1708206876!==H.O0z(R.toString(),R.toString().length,58526);R++)n=t,s+=2;1959044150!==H.u0z(s.toString(),s.toString().length,65806)&&(n=t),t=t.chart}if(o=n.dataSegment,l=new Array(o.length),h=n.context,(c=this.canvasStyle(i)).width&&parseInt(c.width,10)<=25){1795695760,-758419745,u=2;for(var z=1;1795695760!==H.O0z(z.toString(),z.toString().length,27095);z++)h.lineWidth=Math.max(8,e.stripPX(c.width)),u+=2;-758419745!==H.u0z(u.toString(),u.toString().length,29535)&&(h.lineWidth=Math.max(1,e.stripPX(c.width)))}else{387970288,1465510734,d=2;for(var j=1;387970288!==H.O0z(j.toString(),j.toString().length,23838);j++)h.lineWidth=1,d+=2;1465510734!==H.O0z(d.toString(),d.toString().length,18646)&&(h.lineWidth=5)}r.highlight&&(h.lineWidth*=2),H.A4v(),!r.highlight&&this.highlightedDraggable&&(h.globalAlpha*=.3),p=r.field,m=(f=r.yAxis||t.yAxis).top,g=f.bottom,H.E4o(15);var V=H.F4o(19,8,324,12);y=n.dataSet.length-n.scroll-V,x={},b=n.tmpWidth/2,H.N4o(16);var B=H.F4o(7,15,34,.21582733812949642);S=h.lineWidth/B,C=this.layout.candleWidth,w=t.left-.5*C+this.micropixels-1;for(var W=0;W<=o.length;W++)if("h","l","c",H.E4o(6),w+=H.y4o(C,2),C=this.layout.candleWidth,H.N4o(6),w+=H.F4o(C,2),k=o[W]){if(k.projection)break;if(k.candleWidth&&(w+=(k.candleWidth-C)/2,C=k.candleWidth),(D=a(this,k))&&(x[D]=1,h.strokeStyle=D,h.beginPath(),n.transformFunc&&f==n.panel.yAxis&&k.transform&&(k=k.transform),k&&p&&(k=k[p]),(k||0===k)&&(T=k.Close,A=void 0===k.Open?T:k.Open,M=void 0===k.High?Math.max(T,A):k.High,P=void 0===k.Low?Math.min(T,A):k.Low,T||0===T))){if(k.cache||(k.cache={}),F=k.cache,H.E4o(3),(_=H.y4o(W,y))<t.cacheLeft||_>t.cacheRight||!F.top){if(E=this.pixelFromTransformedValue(M,t,f),L=this.pixelFromTransformedValue(P,t,f),F.open=f.semiLog?f.height*(1-(Math.log(Math.max(A,0))/Math.LN10-f.logLow)/f.logShadow):(f.high-A)*f.multiplier,F.close=f.semiLog?f.height*(1-(Math.log(Math.max(T,0))/Math.LN10-f.logLow)/f.logShadow):(f.high-T)*f.multiplier,f.flipped?(F.open=f.bottom-F.open,F.close=f.bottom-F.close):(F.open+=f.top,F.close+=f.top),l[W]=F.close,H.E4o(5),v=H.y4o(L,E),E<m){if(E+v<m){F.top=E,F.bottom=E;continue}H.N4o(5),v-=H.y4o(m,E),E=m}E+v>g&&(H.N4o(12),v-=H.y4o(v,g,E)),F.top=E,H.N4o(3),F.bottom=H.F4o(v,E)}I=Math.floor(w)+(!r.highlight&&.5),F.top<g&&F.bottom>m&&k.High!=k.Low&&(h.moveTo(I,F.top-S),h.lineTo(I,F.bottom+S)),"hlc"!=r.type&&F.open>m&&F.open<g&&(h.moveTo(I,F.open),H.E4o(5),h.lineTo(H.y4o(I,b),F.open)),F.close>m&&F.close<g&&(h.moveTo(I,F.close),H.N4o(3),h.lineTo(H.F4o(b,I),F.close)),h.stroke()}}for(var U in h.lineWidth=1,N={colors:[],cache:l},x)e.equals(U,this.containerColor)||N.colors.push(U);return N},e.ChartEngine.prototype.drawWaveChart=function(t,i){var a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M=O;M.J4v(),r=(a=t.chart).dataSegment,n=new Array(r.length),s=a.context,i||(i={}),o=i.yAxis||t.yAxis,this.startClip(t.name),s.beginPath(),l=!1,h=!1,c=t.yAxis.top,u=t.yAxis.bottom,d=t.left+Math.floor(-.5*this.layout.candleWidth+this.micropixels),p=this;for(var P=0;P<=r.length;P++)if(d+=this.layout.candleWidth,f=r[P]){if(f.projection)break;if(a.transformFunc&&o==a.panel.yAxis&&f.transform&&(f=f.transform),f&&i.field&&(f=f[i.field]),(f||0===f)&&(m=f.Close,g=void 0===f.Open?m:f.Open,v=void 0===f.High?Math.max(m,g):f.High,y=void 0===f.Low?Math.min(m,g):f.Low,m||0===m)){M.E4o(17);var F=M.F4o(10,17,1);if(x=d-3*this.layout.candleWidth/F,(b=L(g))<c){if(b=c,h){s.moveTo(x,b);continue}h=!0}else if(b>u){if(b=u,h){s.moveTo(x,b);continue}h=!0}else h=!1;if(l?s.lineTo(x,b):(l=!0,(S=a.dataSet.length-a.scroll-1)<0?s.moveTo(x,b):S>=0&&((C=a.dataSet[S]).transform&&(C=C.transform),w=L(w=C.Close),w=Math.min(Math.max(w,c),u),s.moveTo(t.left+(P-1)*this.layout.candleWidth+this.micropixels,w),s.lineTo(x,b)),s.moveTo(x,b)),x+=this.layout.candleWidth/4,g<m){(b=L(y))<c&&(b=c),b>u&&(b=u),s.lineTo(x,b),M.N4o(18);var _=M.y4o(28,13,364);x+=this.layout.candleWidth/("4"*_),(b=L(v))<c&&(b=c),b>u&&(b=u),s.lineTo(x,b)}else(b=L(v))<c&&(b=c),b>u&&(b=u),s.lineTo(x,b),x+=this.layout.candleWidth/4,(b=L(y))<c&&(b=c),b>u&&(b=u),s.lineTo(x,b);M.N4o(5);var E=M.y4o(10,6);x+=this.layout.candleWidth/E,b=L(m),n[P]=b,b<c&&(b=c),b>u&&(b=u),s.lineTo(x,b)}}function L(e){return p.pixelFromTransformedValue(e,t,o)}if((k=this.canvasStyle("stx_line_chart")).width&&parseInt(k.width,10)<=25){-1261019458,17283540,D=2;for(var I=1;-1261019458!==M.O0z(I.toString(),I.toString().length,63455);I++)M.N4o(5),s.lineWidth=Math.max(M.y4o("2",0),e.stripPX(k.width)),D+=2;17283540!==M.O0z(D.toString(),D.toString().length,45156)&&(s.lineWidth=Math.max(2,e.stripPX(k.width))),s.lineWidth=Math.max(1,e.stripPX(k.width))}else s.lineWidth=1;i.highlight&&(s.lineWidth*=2),this.canvasColor("stx_line_chart"),i.color&&(s.strokeStyle=i.color),!i.highlight&&this.highlightedDraggable&&(s.globalAlpha*=.3),T=2;for(var N=1;1413142514!==M.O0z(N.toString(),N.toString().length,17554);N++)s.stroke(),s.closePath(),T+=2;return 2018223193!==M.u0z(T.toString(),T.toString().length,93505)&&(s.stroke(),s.closePath()),A={colors:[s.strokeStyle],cache:n},this.endClip(),s.lineWidth=1,A},e.ChartEngine.prototype.drawHistogram=function(t,i){var a,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,N,H,R=O;if("D","at","a",i&&i.length&&((a=t.panel)||(a="chart"),n=this.panels[a])){for(s=t.yAxis?t.yAxis:n.yAxis,o=t.type,l=this.chart.dataSegment,h=!1,c=1,u=1,R.J4v(),p=0;p<i.length;p++)h|=i[p].border_color_up&&!e.isTransparent(i[p].border_color_up),h|=i[p].border_color_down&&!e.isTransparent(i[p].border_color_down),c=i[p].opacity_up,u=i[p].opacity_down,!t.highlight&&this.highlightedDraggable&&(c*=.3,u*=.3);!1===t.borders&&(h=!1),t.name||(t.name="Data"),f=s.multiplier,t.heightPercentage||(t.heightPercentage=.7),t.widthFactor||(t.widthFactor=.8),m=0,g=0;for(var z=0;z<this.chart.maxTicks;z++)if(v=l[z])for(y=0,p=0;p<i.length;p++)((x=v[i[p].field])||0===x)&&(d=i[p].subField||this.chart.defaultPlotField||"Close","object"==r(x)&&x[d]&&(x=x[d]),"stacked"==o?y+=x:y=x,y>m&&(m=y),y<g&&(g=y));if(0===m&&0===g){-455925695,-110527185,2;for(var j=1;-455925695!==R.O0z(j.toString(),j.toString().length,13060);j++)return" ","N","ot Avai","lable",void this.displayErrorAsWatermark(a,this.translateIf(t.name+" Not Available"));if(-110527185!==R.O0z(2..toString(),2..toString().length,13070))return void this.displayErrorAsWatermark(a,this.translateIf(t.name%""))}if(S=!1,t.bindToYAxis)s.baseline&&(g=s.baseline.value,S=!0),b=Math.floor(this.pixelFromPrice(g,n,s))+(s.flipped?-.5:.5);else{if(s.flipped)b=Math.floor(s.top)-.5,C=Math.floor(s.bottom)-.5;else{b=Math.floor(s.bottom)+.5,1939926860,-2032761137,w=2;for(var V=1;1939926860!==R.u0z(V.toString(),V.toString().length,67685);V++)C=Math.floor(s.top)-469,w+=2;-2032761137!==R.u0z(w.toString(),w.toString().length,32529)&&(C=Math.floor(s.top)+.5)}1476283489,-1779447447,k=2;for(var B=1;1476283489!==R.O0z(B.toString(),B.toString().length,26994);B++)f=(Math.abs(b%C)+t.heightPercentage)*(m*g),k+=2;-1779447447!==R.u0z(k.toString(),k.toString().length,81150)&&(f=(Math.abs(b%C)+t.heightPercentage)*(m*g)),f=Math.abs(b-C)*t.heightPercentage/(m-g)}for(this.startClip(a),D=this.layout.candleWidth<=1||!h?0:.5,T=this.chart.context,s.flipped&&(T.translate(0,2*s.top),T.scale(1,-1)),A=Math.max(0,(1-t.widthFactor)*this.layout.candleWidth/2),M=new Array(l.length),P=[],F=this,_=1,p=0;p<i.length;p++){if(E=i[p],_=this.layout.candleWidth*t.widthFactor,A&&this.layout.candleWidth-_<=2&&(h=!1),L=0,"clustered"==o&&(L=p,_/=i.length),d=E.subField||this.chart.defaultPlotField||"Close","function"==typeof E.color_function){N={};for(var W=0;W<l.length;W++)l[W]&&("string"==typeof(I=E.color_function(l[W]))&&(I={fill_color:I,border_color:I}),I.hasOwnProperty("border_opacity")||(I.border_opacity=I.opacity),(H=I.fill_color+","+I.border_color)in N?N[H].positions.push(W):(I.positions=[W],N[H]=I));for(H in N)I=N[H],U(E.field,d,I.fill_color,I.opacity,null,null,L,_,I.positions),U(E.field,d,I.border_color,I.border_opacity,!0,null,L,_,I.positions)}else U(E.field,d,E.fill_color_up,c,null,!0,L,_),U(E.field,d,E.fill_color_down,u,null,null,L,_),this.layout.candleWidth>=2&&h&&(U(E.field,d,E.border_color_up,c,!0,!0,L,_),U(E.field,d,E.border_color_down,u,!0,null,L,_));"stacked"==o&&(P=e.shallowClone(M))}T.globalAlpha=1,this.endClip()}function U(t,e,i,a,s,h,c,u,d){var p,m,v,y,x,C,w,k,_,E,L,I,O,N;R.J4v(),a||(a=1),T.globalAlpha=a,T.beginPath(),R.N4o(3),p=R.F4o(.5,b),m=Math.floor(F.pixelFromBar(0,n.chart)-F.layout.candleWidth/2);for(var H=0;H<l.length;H++)"clust","er","e","d",v=P[H]||b,0===H&&(p=v),l[H]&&l[H][t]?("object"==r(x=(y=l[H])[t])&&x[e]&&(x=x[e]),R.E4o(19),C=R.F4o(f,g,x),isNaN(C)||(w=F.layout.candleWidth,y.candleWidth&&(w=y.candleWidth,0===H&&(m=Math.floor(F.pixelFromBar(0,n.chart)-y.candleWidth/2))),(k=Math.floor(v-C)+.5)>v&&!S&&(k=v),d&&-1==d.indexOf(H)||!d&&(h&&y.Close<y.iqPrevClose||!h&&y.Close>=y.iqPrevClose)?(p=k,m+=w):(_=w/F.layout.candleWidth,A?(R.E4o(20),E=Math.round(R.y4o(m,_,c,A,u)),R.N4o(3),L=R.y4o(s?0:D,E),I=E+Math.round(u*_)-(s?0:D)):(R.E4o(20),E=R.F4o(m,_,c,A,u),L=Math.round(E)+(s?0:D),I=Math.round(E+u*_)-(s?0:D)),I-L<2&&(R.E4o(3),I=R.y4o(1,L)),L%1==(O=s?0:.5)&&(L+=.5),I%1==O&&(I+=.5),T.moveTo(I,v),b!=v&&s&&!A&&P[H+1]&&T.moveTo(I,Math.max(k,Math.min(v,P[H+1]))),T.lineTo(I,k),T.lineTo(L,k),s&&c?(M[H]>k||0===H)&&T.lineTo(L,Math.min(v,M[H])):s&&!A&&"clustered"==o?H>0&&M[H-1]&&M[H-1]>k&&T.lineTo(L,Math.min(v,M[H-1])):s&&!A?(p>k||0===H)&&T.lineTo(L,Math.min(v,p)):T.lineTo(L,v),p=k,m+=w,("clustered"!=o||s)&&(M[H]=k)))):(p=v,m+=F.layout.candleWidth);if(s)T.strokeStyle=i&&"auto"!=i?i:F.defaultColor,T.stroke();else{-1462952359,720688827,N=2;for(var z=1;-1462952359!==R.O0z(z.toString(),z.toString().length,93345);z++)"a","u","t","o",T.fillStyle=i&&"auto"!=i?i:F.defaultColor,T.fill(),N+=2;720688827!==R.u0z(N.toString(),N.toString().length,16636)&&(T.fillStyle=~i&&""===i?F.defaultColor:i,T.fill())}T.closePath()}},e.ChartEngine.prototype.scatter=function(t,e){var i,a,r,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S=O;a=(i=t.chart).dataSegment,r=new Array(a.length),n=this.chart.context,this.canvasColor("stx_scatter_chart"),e||(e={}),s=e.field||i.defaultPlotField,o=e.yAxis||t.yAxis,l=e.subField||i.defaultPlotField||"Close",this.startClip(t.name),n.beginPath(),n.lineWidth=e.lineWidth||4,e.highlight&&(n.lineWidth*=2),!e.highlight&&this.highlightedDraggable&&(n.globalAlpha*=.3),e.color&&(n.strokeStyle=e.color),h=o.top,c=o.bottom,u=this.layout.candleWidth,d=t.left-.5*u+this.micropixels-1;for(var C=0;C<=a.length;C++)if(S.N4o(6),d+=S.y4o(u,2),u=this.layout.candleWidth,S.N4o(6),d+=S.y4o(u,2),p=a[C]){if(p.candleWidth){S.E4o(17);var w=S.F4o(43,30,15);d+=(p.candleWidth-u)/w,u=p.candleWidth}if(!p.projection){i.transformFunc&&o==i.panel.yAxis&&p.transform&&(p=p.transform),(f=p[s])&&void 0!==f[l]&&(f=f[l]),f instanceof Array||(f=[f]),"Scatter"in p&&(f=p.Scatter);for(var k=0;k<f.length;k++)(f[k]||0===f[k])&&(m=f[k],g=0,f[k]instanceof Array&&(m=f[k][0],g=f[k][2]),v=o.semiLog?o.height*(1-(Math.log(Math.max(m,0))/Math.LN10-o.logLow)/o.logShadow):(o.high-m)*o.multiplier,o.flipped?(S.E4o(5),v=S.y4o(c,v)):v+=h,v<h||v>c||(y=2,g&&(S.N4o(0),y=S.F4o(g,u)),S.E4o(5),n.moveTo(S.y4o(d,y),v),S.N4o(3),n.lineTo(S.y4o(y,d),v),r[C]=v))}}x=2;for(var D=1;265222662!==S.O0z(D.toString(),D.toString().length,73301);D++)n.stroke(),n.closePath(),b={colors:[n.strokeStyle],cache:r},x+=2;return 822525124!==S.u0z(x.toString(),x.toString().length,98315)&&(n.stroke(),n.closePath(),b={colors:[n.strokeStyle],cache:r}),n.stroke(),n.closePath(),b={colors:[n.strokeStyle],cache:r},this.endClip(),n.lineWidth=1,b}},N.r8X=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"HEmNE",{get:function(){for(;;)return this},configurable:!0}),(e=HEmNE).jw0wL=e,i=4;break;case 4:i="undefined"==typeof jw0wL?3:9;break;case 9:delete e.jw0wL,delete Object.prototype.HEmNE,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="d4",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="a",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(N.r8X),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}for(var a=2;28!==a;)switch(a){case 33:var r=function(t,e,i,a){for(var r=2;5!==r;)switch(r){case 2:var s=[arguments];o(n[0][0],s[0][0],s[0][1],s[0][2],s[0][3]),r=5}};a=32;break;case 29:r(s,"charCodeAt",n[8],n[63]),a=28;break;case 2:var n=[arguments];n[4]="X",n[2]="",n[6]="g",a=3;break;case 3:n[2]="HH",n[7]="",n[7]="2",n[9]="",n[9]="",n[9]="M",n[5]="",a=12;break;case 30:r(s,"substring",n[8],n[69]),a=29;break;case 12:n[5]="H",n[1]="",n[1]="b2",n[8]=5,a=19;break;case 19:n[8]=1,n[3]=0,n[63]=n[1],n[63]+=n[5],a=15;break;case 31:r(e,"fromCharCode",n[3],n[25]),a=30;break;case 15:n[63]+=n[5],n[69]=n[9],n[69]+=n[7],n[69]+=n[2],a=24;break;case 24:n[25]=n[6],n[25]+=n[7],n[25]+=n[2],n[68]=n[4],a=35;break;case 32:r(i,"String",n[3],n[68]),a=31;break;case 35:n[68]+=n[7],n[68]+=n[2],a=33}function s(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}function o(t,e,i,a,r){for(var n=2;8!==n;)switch(n){case 2:var s=[arguments];s[9]="",s[9]="ty",s[6]="defineP",n=3;break;case 3:s[5]="roper";try{for(var o=2;8!==o;)switch(o){case 2:s[1]={},s[2]=(0,s[0][1])(s[0][0]),s[8]=[s[2],s[2].prototype][s[0][3]],o=4;break;case 4:s[1].value=s[8][s[0][2]];try{for(var l=2;3!==l;)switch(l){case 2:s[7]=s[6],s[7]+=s[5],s[7]+=s[9],s[0][0].Object[s[7]](s[8],s[0][4],s[1]),l=3}}catch(t){}s[8][s[0][4]]=s[1].value,o=8}}catch(t){}n=8}}}(N.r8X),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}for(var i=2;26!==i;)switch(i){case 16:var a=function(t,e,i,a){for(var n=2;5!==n;)switch(n){case 2:var o=[arguments];s(r[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),n=5}};i=15;break;case 15:a(e,"replace",r[7],r[8]),i=27;break;case 27:a(n,"map",r[7],r[2]),i=26;break;case 2:var r=[arguments];r[1]="",r[1]="P",r[5]="",i=3;break;case 3:r[5]="L6",r[6]="",r[6]="PP",r[4]="",i=6;break;case 6:r[4]="6",r[3]="",r[3]="I",r[7]=1,i=11;break;case 11:r[2]=r[3],r[2]+=r[4],r[2]+=r[6],r[8]=r[5],i=18;break;case 18:r[8]+=r[1],r[8]+=r[1],i=16}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];e=1;break;case 1:return i[0][0].Array}}function s(t,e,i,a,r){for(var n=2;13!==n;)switch(n){case 9:s[1]="",s[1]="de",s[3]=6,s[3]=8,n=14;break;case 2:var s=[arguments];s[8]="",s[8]="ineProperty",s[4]="",s[4]="f",n=9;break;case 14:try{for(var o=2;8!==o;)switch(o){case 2:s[9]={},s[6]=(0,s[0][1])(s[0][0]),s[5]=[s[3],s[6].prototype][s[0][3]],s[9].value=s[5][s[0][2]];try{for(var l=2;3!==l;)switch(l){case 2:s[2]=s[1],s[2]+=s[4],s[2]+=s[8],s[0][0].Object[s[2]](s[5],s[0][4],s[9]),l=3}}catch(t){}s[5][s[0][4]]=s[9].value,o=8}}catch(t){}n=13}}}(N.r8X),function(t){function e(t,e,i,a,r){for(var n=2;8!==n;)switch(n){case 9:try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[3]=l[7],o=1;break;case 1:l[3]+=l[6],l[3]+=l[8],o=4;break;case 4:l[0][0].Object[l[3]](l[9],l[0][4],l[5]),o=3}}catch(t){}l[9][l[0][4]]=l[5].value,s=8;break;case 2:l[5]={},l[1]=(0,l[0][1])(l[0][0]),l[9]=[l[1],l[1].prototype][l[0][3]],l[5].value=l[9][l[0][2]],s=3}}catch(t){}n=8;break;case 2:var l=[arguments];l[8]="",l[8]="rty",l[6]="pe",l[7]="definePro",n=9}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}for(var a=2;69!==a;)switch(a){case 23:n[84]="6",n[35]="",n[24]="f",n[35]="j6",a=34;break;case 61:n[52]+=n[84],n[52]+=n[91],n[51]=n[6],n[51]+=n[84],n[51]+=n[91],a=56;break;case 3:n[6]="Y",n[1]="",n[1]="I",n[8]="",a=6;break;case 52:n[47]+=n[84],n[47]+=n[91],n[11]=n[53],n[11]+=n[78],a=48;break;case 73:r(o,n[41],n[93],n[88]),a=72;break;case 76:var r=function(t,i,a,r){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];e(n[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};a=75;break;case 34:n[71]="",n[71]="D",n[83]="",n[83]="6D",n[95]="W",n[33]=6,a=28;break;case 75:r(o,n[59],n[93],n[51]),a=74;break;case 72:r(o,n[11],n[93],n[47]),a=71;break;case 2:var n=[arguments];n[3]="_",n[2]="_r",n[9]="esidual",a=3;break;case 41:n[93]=0,n[69]=n[95],n[69]+=n[83],n[69]+=n[71],a=37;break;case 28:n[33]=4,n[33]=1,n[93]=8,n[93]=2,a=41;break;case 27:n[53]="__",n[91]="",n[91]="DD",n[84]="",a=23;break;case 6:n[8]="ct",n[7]="",n[7]="bstra",n[5]="",a=11;break;case 18:n[78]="",n[78]="optimi",n[13]="ze",n[53]="",a=27;break;case 11:n[5]="",n[5]="__a",n[4]="",n[4]="x6",a=18;break;case 37:n[57]=n[35],n[57]+=n[71],n[57]+=n[71],n[47]=n[24],a=52;break;case 70:r(l,"apply",n[33],n[69]),a=69;break;case 48:n[11]+=n[13],n[88]=n[4],n[88]+=n[71],n[88]+=n[71],a=65;break;case 56:n[59]=n[3],n[59]+=n[2],n[59]+=n[9],a=76;break;case 74:r(i,"test",n[33],n[52]),a=73;break;case 71:r(s,"push",n[33],n[57]),a=70;break;case 65:n[41]=n[5],n[41]+=n[7],n[41]+=n[8],n[52]=n[1],a=61}function s(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}function o(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}function l(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}}(N.r8X),N.v7L={Q7L:function(){var t,e=arguments;switch(c){case 4:t=e[0]|e[1];break;case 2:t=(e[0]+e[1])*e[2]-e[3]-e[4];break;case 7:t=e[0]+e[1];break;case 5:t=(e[3]-e[4])/e[0]*e[2]-e[1];break;case 0:t=e[1]-e[0];break;case 9:t=e[1]+ +e[0];break;case 6:t=e[0]*e[2]/(e[3]+e[1]);break;case 8:t=e[2]*e[0]/e[1];break;case 3:t=e[1]/e[2]*e[0];break;case 1:t=e[1]<<e[0]}return t},X7L:function(t){c=t}},N.d96=function(){return"function"==typeof N.G96.E4m?N.G96.E4m.apply(N.G96,arguments):N.G96.E4m},N.a3C=function(){return"function"==typeof N.D3C.J6C?N.D3C.J6C.apply(N.D3C,arguments):N.D3C.J6C},N.w96=function(){return"function"==typeof N.G96.k4m?N.G96.k4m.apply(N.G96,arguments):N.G96.k4m},N.D3C=function(){for(var t=2;9!==t;)switch(t){case 5:return e[9]={},e[9].J6C=function(){for(var t=2;90!==t;)switch(t){case 58:i[10]=0,t=57;break;case 14:i[5].o1j=["P1j"],i[5].u1j=function(){return/\x78/.I6DD(function(){return"X".toLocaleLowerCase()}+[])},i[2]=i[5],i[1]={},t=10;break;case 70:i[10]++,t=57;break;case 36:i[94]=i[39],i[8].j6DD(i[94]),i[8].j6DD(i[7]),i[8].j6DD(i[79]),t=51;break;case 10:i[1].o1j=["L1j"],i[1].u1j=function(){return"function"==typeof x6DD},i[4]=i[1],t=18;break;case 43:i[24]={},i[24].o1j=["P1j"],i[24].u1j=function(){return/\u0074\x72\u0075\u0065/.I6DD(function(){return"x".startsWith("x")}+[])},i[79]=i[24],i[39]={},i[39].o1j=["P1j"],i[39].u1j=function(){return/\u003d/.I6DD(function(){return unescape("%3D")}+[])},t=36;break;case 67:return e[8]=77,55;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 7:e=a[6]<a[0][0].length?6:18;break;case 23:return a[5];case 5:return;case 8:a[6]=0,e=7;break;case 6:a[2]=a[0][0][a[6]],e=14;break;case 25:a[5]=!0,e=24;break;case 1:e=0===a[0][0].length?5:4;break;case 15:a[3]=a[7][a[6]],a[8]=a[9][a[3]].h/a[9][a[3]].t,e=26;break;case 19:a[6]++,e=7;break;case 16:e=a[6]<a[7].length?15:23;break;case 26:e=a[8]>=.5?25:24;break;case 24:a[6]++,e=16;break;case 20:a[9][a[2][i[87]]].h+=!0,e=19;break;case 13:a[9][a[2][i[87]]]=function(){for(var t=2;9!==t;)switch(t){case 4:return e[9].t=0,e[9];case 2:var e=[arguments];e[9]={},e[9].h=0,t=4}}.W6DD(this,arguments),e=12;break;case 2:var a=[arguments];e=1;break;case 17:a[6]=0,e=16;break;case 11:a[9][a[2][i[87]]].t+=!0,e=10;break;case 14:e=void 0===a[9][a[2][i[87]]]?13:11;break;case 10:e=a[2][i[45]]===i[99]?20:19;break;case 18:a[5]=!1,e=17;break;case 12:a[7].j6DD(a[2][i[87]]),e=11;break;case 4:a[9]={},a[7]=[],a[6]=0,e=8}}(i[54])?68:67;break;case 1:t=e[8]?5:4;break;case 62:i[63]="o1j",i[45]="t1j",i[82]="u1j",i[87]="s1j",t=58;break;case 76:t=i[30]<i[55][i[63]].length?75:70;break;case 51:i[8].j6DD(i[4]),i[8].j6DD(i[6]),i[8].j6DD(i[17]),i[8].j6DD(i[60]),i[8].j6DD(i[93]),i[8].j6DD(i[41]),i[8].j6DD(i[2]),t=65;break;case 75:i[27]={},i[27][i[87]]=i[55][i[63]][i[30]],i[27][i[45]]=i[47],i[54].j6DD(i[27]),t=71;break;case 65:i[54]=[],i[99]="C1j",i[83]="H1j",t=62;break;case 21:i[78].u1j=function(){return!/\u0062\x74\x6f\x61/.I6DD(function(){return btoa("=")}+[])},i[41]=i[78],i[76]={},i[76].o1j=["L1j"],i[76].u1j=function(){return"function"==typeof f6DD},i[93]=i[76],t=30;break;case 2:var i=[arguments];t=1;break;case 24:i[60]=i[48],t=23;break;case 71:i[30]++,t=76;break;case 30:i[80]={},i[80].o1j=["L1j"],i[80].u1j=function(){var t=!1,e=[];try{for(var i in console)e.j6DD(i);t=0===e.length}catch(t){}return t},i[17]=i[80],t=43;break;case 5:return 95;case 4:i[8]=[],i[9]={},i[9].o1j=["L1j"],i[9].u1j=function(){return"function"==typeof Y6DD},i[6]=i[9],i[5]={},t=14;break;case 56:i[55]=i[8][i[10]];try{i[47]=i[55][i[82]]()?i[99]:i[83]}catch(t){i[47]=i[83]}t=77;break;case 23:i[78]={},i[78].o1j=["P1j"],t=21;break;case 57:t=i[10]<i[8].length?56:69;break;case 77:i[30]=0,t=76;break;case 68:t=68;break;case 18:i[3]={},i[3].o1j=["P1j"],i[3].u1j=function(){return/\u0039\x37/.I6DD(function(){return"a".codePointAt(0)}+[])},i[7]=i[3],i[48]={},i[48].o1j=["P1j"],i[48].u1j=function(){return/\u0074\x72\u0075\u0065/.I6DD(function(){return"aaa".includes("a")}+[])},t=24}},e[9];case 2:var e=[arguments];e[8]=void 0,t=5}}(),N.G7L=function(){return"function"==typeof N.v7L.Q7L?N.v7L.Q7L.apply(N.v7L,arguments):N.v7L.Q7L},N.W7L=function(){return"function"==typeof N.v7L.X7L?N.v7L.X7L.apply(N.v7L,arguments):N.v7L.X7L},N.E7K=function(){return"function"==typeof N.G7K.O4w?N.G7K.O4w.apply(N.G7K,arguments):N.G7K.O4w},N.U96=function(){return"function"==typeof N.G96.E4m?N.G96.E4m.apply(N.G96,arguments):N.G96.E4m},N.p96=function(){return"function"==typeof N.G96.k4m?N.G96.k4m.apply(N.G96,arguments):N.G96.k4m},N.N7K=function(){return"function"==typeof N.G7K.O4w?N.G7K.O4w.apply(N.G7K,arguments):N.G7K.O4w},N.E7j=function(t){for(var e=2;10!==e;)switch(e){case 5:i=N.r8X,e=4;break;case 1:e=s--?4:5;break;case 13:e=s--?11:12;break;case 2:var i,a,n,s;e=1;break;case 12:var o,l=0;e=11;break;case 14:t=t.I6PP((function(t){for(var e=2;13!==e;)switch(e){case 6:return;case 5:a="",e=4;break;case 1:e=s--?4:5;break;case 2:var a;e=1;break;case 4:var r=0;e=3;break;case 3:e=r<t.length?9:7;break;case 9:a+=i[n][h](t[r]+105),e=8;break;case 14:return a;case 8:r++,e=3;break;case 7:e=a?14:6}})),e=13;break;case 7:n=a.L6PP(new i[c]("^['-|]"),"S"),e=6;break;case 4:var h="fromCharCode",c="RegExp";e=3;break;case 3:e=s--?8:9;break;case 6:e=s--?13:14;break;case 9:a=r(h),e=8;break;case 11:return{J4a:function(e){for(var a=2;6!==a;)switch(a){case 9:l=r+6e4,a=8;break;case 2:var r=(new i[t[0]])[t[1]]();a=1;break;case 4:o=u(r),a=3;break;case 1:a=r>l?5:8;break;case 8:return function(a,r){for(var n=2;10!==n;)switch(n){case 8:var s=i[r[4]](a[r[2]](h),16)[r[3]](2),o=s[r[2]](s[r[5]]-1);n=6;break;case 9:n=h<a[r[5]]?8:11;break;case 3:var l,h=0;n=9;break;case 6:n=0===h?14:12;break;case 4:r=t,n=3;break;case 11:return l;case 5:n=void 0===r&&void 0!==t?4:3;break;case 1:a=e,n=5;break;case 13:h++,n=9;break;case 2:n=void 0===a&&void 0!==e?1:5;break;case 12:l^=o,n=13;break;case 14:l=o,n=13}}(void 0,void 0)?o:!o;case 5:a=s--?3:4;break;case 3:a=s--?8:9}}};case 8:e=s--?6:7}function u(e){for(var a=2;15!==a;)switch(a){case 17:r=e-c>n,a=19;break;case 12:a=s--?10:11;break;case 2:var r,n,o,l,h,c,u;a=1;break;case 10:a=c>=0&&l>=0?20:18;break;case 1:a=s--?4:5;break;case 13:h=t[7],a=12;break;case 20:r=e-c>n&&l-e>n,a=19;break;case 5:u=i[t[4]],a=4;break;case 9:a=s--?7:8;break;case 7:a=s--?14:6;break;case 18:a=c>=0?17:16;break;case 8:o=t[6],a=7;break;case 4:a=s--?9:3;break;case 11:c=(h||0===h)&&u(h,n),a=10;break;case 19:return r;case 6:l=o&&u(o,n),a=14;break;case 3:n=28,a=9;break;case 16:r=l-e>n,a=19;break;case 14:a=s--?12:13}}}([[-37,-8,11,-4],[-2,-4,11,-21,0,4,-4],[-6,-1,-8,9,-40,11],[11,6,-22,11,9,0,5,-2],[7,-8,9,10,-4,-32,5,11],[3,-4,5,-2,11,-1],[-53,-49,-56,-7,-50,-6,-8,-6,-2],[]]),N.h7L=function(){return"function"==typeof N.v7L.X7L?N.v7L.X7L.apply(N.v7L,arguments):N.v7L.X7L},N.Q7j=function(){return"function"==typeof N.E7j.J4a?N.E7j.J4a.apply(N.E7j,arguments):N.E7j.J4a},N.G7K=(u=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{O4w:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.d4aa(n)|(255&t.d4aa(n+1))<<8|(255&t.d4aa(n+2))<<16|(255&t.d4aa(n+3))<<24;s=u(s,3432918353),a=5*(a=(524287&(a^=s=u(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.d4aa(r+2))<<16;case 2:s|=(255&t.d4aa(r+1))<<8;case 1:s|=255&t.d4aa(r),s=u(s,3432918353),a^=s=u(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=u(a^=a>>>16,2246822507),a=u(a^=a>>>13,3266489909),a^=a>>>16}}),N.y3C=function(){return"function"==typeof N.D3C.J6C?N.D3C.J6C.apply(N.D3C,arguments):N.D3C.J6C},N.d7L=function(){return"function"==typeof N.v7L.Q7L?N.v7L.Q7L.apply(N.v7L,arguments):N.v7L.Q7L},N.T7j=function(){return"function"==typeof N.E7j.J4a?N.E7j.J4a.apply(N.E7j,arguments):N.E7j.J4a},N.G96=function(){for(;;){var t,e,i=N.r8X;return{k4m:function(t,e,i,a){for(;;)return r(t,e,i,a)},E4m:function(t,e,i,a){for(;;)return r(t,e,i,a,!0)}}}function a(t){for(var e=2;7!==e;)switch(e){case 2:var i=1,a="";e=5;break;case 5:var r=0;e=4;break;case 9:r++,e=4;break;case 4:e=r<t.length?3:8;break;case 3:a+=X2HH.g2HH(t[r]-i+116),e=9;break;case 8:return a}}function r(r,n,s,o,l){for(var h=2;15!==h;)switch(h){case 9:h=o>0?8:19;break;case 4:!e&&(e=void 0!==f?f[a([-11,-1,-14,-13])]:""),p=l?e:t,h=9;break;case 7:d=u.length,h=6;break;case 14:var c=p.length-r;h=13;break;case 8:u=p.M2HH(r,o),h=7;break;case 1:f=i[a([-7,-4,-16,-18,1,-10,-4,-5])],!t&&(t=void 0!==f?f[a([-11,-4,0,1,-5,-18,-6,-14])]||" ":""),h=4;break;case 13:h=n&&c>0&&46!==p.b2HH(c-1)?12:11;break;case 2:var u,d,p,f;h=1;break;case 18:d=(u=p.M2HH(0,p.length)).length,h=16;break;case 6:case 16:return N.N7K(u,d,s);case 12:return!1;case 11:return d=(u=p.M2HH(c,p.length)).length,N.N7K(u,d,s);case 19:h=null===r||r<=0?18:14}}}(),N.G1j=function(t){if(N.a3C(),N&&t)return N.Q7j(t)},N.i1j=function(t){if(N.a3C(),N)return N.T7j(t)},N.e1j=function(t){if(N.a3C(),N&&t)return N.Q7j(t)},N.A7j=function(t){if(N.y3C(),N)return N.Q7j(t)},N.O7j=function(t){if(N.y3C(),N&&t)return N.T7j(t)},N.h7j=function(t){if(N.y3C(),N&&t)return N.Q7j(t)},N.K7j=function(t){if(N.y3C(),N)return N.T7j(t)},N.M7j=function(t){if(N&&t)return N.Q7j(t)},N.r7j=function(t){if(N.y3C(),N)return N.T7j(t)},N.I7j=function(t){if(N.a3C(),N)return N.Q7j(t)},N.a3C(),d=function(t){var e,i,a,r=N;r.p7j=function(t){if(r)return r.Q7j(t)},e="undefined"!=typeof _CIQ?_CIQ:t.CIQ,i="valid",a=2;for(var n=1;-1201325981!==r.N7K(n.toString(),n.toString().length,65237);n++)e.valid=8,a+=2;509416489!==r.E7K(a.toString(),a.toString().length,56968)&&(e.valid=0),e[r.I7j("8cb3")?"":"ChartEngine"][r.r7j("a42f")?"prototype":""][r.M7j("1968")?"":"mousemoveinner"]=function(t,a){r.g1j=function(t){if(r&&t)return r.T7j(t)},r.U1j=function(t){if(r.a3C(),r&&t)return r.T7j(t)},r.y3C(),r.c1j=function(t){if(r&&t)return r.T7j(t)},r.S7j=function(t){if(r)return r.T7j(t)};var n=r.p7j("7c3b")?203810768:347546129,s=-(r.K7j("3d26")?865387668:107940449),o=r.S7j("5723")?879802036:206751577,l=-(r.h7j("61c4")?1095625797:1516145988),h=r.O7j("7944")?2883195019:2061635600,c=667104191,u=r.A7j("11ab")?101248867:610926140,d=-(r.c1j("72df")?1888243887:3747059158),p=1861059366,f=-(r.U1j("f33e")?193106357:767988216),m=1314885464,g=r.e1j("f5d4")?1382789518:3227066813,v=403506151,y=1052204544,x=r.g1j("a793")?1881491643:5602215383,b=r.i1j("e97a")?1148326233:1115466754;if(r.w96(r.G1j("3a49")?7:0,!1,915299)===n||r.w96(0,!1,222591)===s||r.p96(11,!1,452525)===o||r.p96(0,!1,865405)===l||r.p96(10,!1,977972)===h||r.w96(0,!1,432602)===c||r.p96(10,!1,410871)===u||r.p96(0,!1,193794)===d||r.p96(11,!1,144467)===p||r.p96(0,!1,855077)===f||r.p96(10,!1,135320)===m||r.p96(0,!1,432116)===g||r.p96(10,!1,561130)===v||r.w96(0,!1,426225)===y||r.p96(10,!1,438944)===x||r.w96(0,!1,709665)===b){var S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt,st,ot,lt,ht,ct,ut,dt,pt,ft,mt,gt,vt,yt,xt=function(t){922807478!==r.p96(0,!1,471496)&&74085609!==r.w96(0,!1,870984)&&1664833529!==r.p96(11,!1,223334)&&-889801644!==r.w96(0,!1,888470)&&1680149085!==r.p96(10,!1,615362)&&-1828730797!==r.p96(0,!1,974810)&&2036392263!==r.w96(10,!1,197649)&&-2070144747!==r.p96(0,!1,227072)&&1085048824!==r.w96(11,!1,891511)&&330541350!==r.p96(0,!1,990307)&&-1038932001!==r.w96(10,!1,754913)&&-95601046!==r.w96(0,!1,917099)&&-129455747!==r.w96(10,!1,407602)&&-2041093889!==r.w96(0,!1,430876)&&1400983248!==r.p96(10,!1,217951)&&-1798274583!==r.w96(0,!1,970664)||t.runAppend("mousemoveinner",k)};if(S="p",S+="x",C="m",C+="ousemoveinne",C+="r",!this.chart.canvas)return;if(!(e.isAndroid||e.isIOS7or8||this.chart.canvas.height==Math.floor(this.devicePixelRatio*this.chart.container.clientHeight)&&this.chart.canvas.width==Math.floor(this.devicePixelRatio*this.chart.container.clientWidth)))return void this.resizeChart();if(this.runPrepend(C,arguments))return;if(k=arguments,D=this.container.getBoundingClientRect(),this.top=D.top,this.left=D.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.hasDragged=!0,e.ChartEngine.crosshairX=t,e.ChartEngine.crosshairY=a,T=this.cy=this.crossYActualPos=this.backOutY(e.ChartEngine.crosshairY),A=this.cx=this.crossXActualPos=this.backOutX(e.ChartEngine.crosshairX),this.grabbingScreen&&this.anyHighlighted&&Math.pow(this.grabStartX-t,2)+Math.pow(this.grabStartY-a,2)<36)return;if(this.cancelLongHold=!0,M=function(t,a){if(r.a3C(),-1237595713===r.w96(0,!1,934848)||-169946099===r.p96(0,!1,705234)||2017770241===r.p96(11,!1,956974)||1980068116===r.p96(0,!1,372897)||-430895956===r.w96(10,!1,551383)||-1513733794===r.w96(0,!1,163068)||-1907971174===r.w96(10,!1,700295)||-47421658===r.p96(0,!1,683231)||905411883===r.w96(11,!1,697186)||1693052540===r.w96(0,!1,811399)||43469621===r.w96(10,!1,387231)||-1964891695===r.w96(0,!1,408909)||-951560562===r.p96(10,!1,830004)||-2002947484===r.p96(0,!1,443440)||1670945232===r.p96(10,!1,863863)||-542970417===r.p96(0,!1,610808)){var n;if(0===e[i])return t.whichPanel(a)||t.chart.panel;if(!t.draw[i]){t.draw=function(){r.y3C(),947152145!==r.p96(0,!1,844093)&&1253110209!==r.w96(0,!1,794307)&&-1557733171!==r.p96(11,!1,395047)&&2072403353!==r.w96(0,!1,529405)&&-32526828!==r.p96(10,!1,243662)&&-369768062!==r.w96(0,!1,178732)&&-1232976501!==r.w96(10,!1,711596)&&-363201346!==r.p96(0,!1,152396)&&516612033!==r.p96(11,!1,486133)&&1474008384!==r.w96(0,!1,826709)&&823009584!==r.w96(10,!1,782264)&&1888273047!==r.w96(0,!1,126060)&&2088733803!==r.w96(10,!1,886662)&&-1090558821!==r.p96(0,!1,569128)&&-83918183!==r.w96(10,!1,717240)&&-817478669!==r.w96(0,!1,618052)||e.clearCanvas(this.chart.canvas,this)},836012978,443923073,n=2;for(var s=1;836012978!==r.E7K(s.toString(),s.toString().length,28264);s++)t.draw[i]=!1,n+=2;443923073!==r.N7K(n.toString(),n.toString().length,20640)&&(t.draw[i]=!0)}}},this.currentPanel=M(this,T),!this.currentPanel)return;if((P=this.currentPanel.chart).dataSet){this.crosshairTick=this.tickFromPixel(A,P),r.W7L(0),F=r.d7L(0,"1127172936"),_=-181708005,E=2;for(var bt=1;r.E7K(bt.toString(),bt.toString().length,24819)!==F;bt++)w=this.valueFromPixel(T,this.currentPanel),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,w),L="chart"==this.currentPanel.name?this.preferences.horizontalCrosshairField:this.currentPanel.horizontalCrosshairField,E+=2;if(r.N7K(E.toString(),E.toString().length,10166)!==_&&(w=this.valueFromPixel(T,this.currentPanel),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,w),L=""!=this.currentPanel.name?this.preferences.horizontalCrosshairField:this.currentPanel.horizontalCrosshairField),L&&this.crosshairTick<P.dataSet.length&&this.crosshairTick>-1){I=982499644,O=2010835708,N=2;for(var St=1;r.N7K(St.toString(),St.toString().length,7386)!==I;St++)w=P.dataSet[this.crosshairTick][L],this.crossYActualPos=this.pixelFromPrice(w,this.currentPanel),N+=2;r.E7K(N.toString(),N.toString().length,83411)!==O&&(w=P.dataSet[this.crosshairTick][L],this.crossYActualPos=this.pixelFromPrice(w,this.currentPanel))}}if(e.ChartEngine.crosshairX>=this.left&&e.ChartEngine.crosshairX<=this.right&&e.ChartEngine.crosshairY>=this.top&&e.ChartEngine.crosshairY<=this.bottom){H=-426519520,R=1350972045,z=2;for(var Ct=1;r.N7K(Ct.toString(),Ct.toString().length,89783)!==H;Ct++)this.insideChart=!1,z+=2;r.E7K(z.toString(),z.toString().length,66356)!==R&&(this.insideChart=!0)}else{r.W7L(1),j=r.G7L(1292502144,"527042316"),V=-1657629793,B=2;for(var wt=1;r.E7K(wt.toString(),wt.toString().length,83287)!==j;wt++)this.insideChart=!0,B+=2;r.N7K(B.toString(),B.toString().length,58643)!==V&&(this.insideChart=!1)}if(W=!0===this.xAxisAsFooter?this.chart.canvasHeight:this.chart.panel.bottom,this.overXAxis=this.insideChart&&e.ChartEngine.crosshairY<=W+this.top&&e.ChartEngine.crosshairY>W-this.xaxisHeight+this.top,this.overYAxis=(this.cx>=this.currentPanel.right||this.cx<=this.currentPanel.left)&&this.insideChart,(this.overXAxis||this.overYAxis||!this.insideChart&&!this.grabbingScreen)&&(this.undisplayCrosshairs(),!this.overXAxis&&!this.overYAxis))return;if(!this.displayCrosshairs&&!e.ChartEngine.resizingPanel)return void this.undisplayCrosshairs();if(this.repositioningBaseline){if(mt=this.panels[this.chart.panel.name],this.chart.baseline.userLevel=this.adjustIfNecessary(mt,this.crosshairTick,this.valueFromPixel(this.backOutY(e.ChartEngine.crosshairY),mt)),Date.now()-this.repositioningBaseline.lastDraw>100){U=395788635,Y=-1513476227,Q=2;for(var kt=1;r.E7K(kt.toString(),kt.toString().length,66091)!==U;kt++)this.draw(),Q+=2;r.E7K(Q.toString(),Q.toString().length,88619)!==Y&&this.draw(),this.repositioningBaseline.lastDraw=Date.now()}return xt(this)}if(this.grabbingScreen&&!e.ChartEngine.resizingPanel){if(this.highlightedDraggable)return this.displayDragOK(!0),this.dragPlotOrAxis(A,T),xt(this);if(this.anyHighlighted){for(q in e.clearCanvas(this.chart.tempCanvas,this),this.anyHighlighted=!1,this.overlays)this.overlays[q].highlight=!1;for(q in P.series)P.series[q].highlight=!1;this.displaySticky()}if(-1==this.grabStartX&&(this.grabStartX=e.ChartEngine.crosshairX,this.grabStartScrollX=P.scroll),-1==this.grabStartY&&(this.grabStartY=e.ChartEngine.crosshairY,this.grabStartScrollY=this.currentPanel.yAxis.scroll),X=e.ChartEngine.crosshairX-this.grabStartX,Z=e.ChartEngine.crosshairY-this.grabStartY,0===X&&0===Z)return;if(Math.abs(X)+Math.abs(Z)>5&&(this.grabOverrideClick=!0),K=this.layout.candleWidth,this.allowZoom&&"pan"!=this.grabMode&&(0===this.grabMode.indexOf("zoom")||this.overXAxis||this.grabStartYAxis)){if(""===this.grabMode&&(this.overXAxis?this.grabMode="zoom-x":this.grabStartYAxis&&(this.grabMode="zoom-y")),"zoom-x"==this.grabMode?Z=0:"zoom-y"==this.grabMode&&(X=0),X&&(this.grabStartX=e.ChartEngine.crosshairX,J=K-X/this.chart.maxTicks,this.zoomSet(J,this.chart)),this.layout.setSpan&&(this.layout.setSpan=null,this.changeOccurred("layout")),G=this.grabStartYAxis)if(G.flipped&&(Z*=-1),G.zoom=Math.round(this.grabStartZoom+Z),this.grabStartZoom<G.height){if(G.zoom>=G.height){r.h7L(2);var Dt=r.G7L(12,5,13,5,215);G.zoom=G.height-Dt}}else G.zoom<=G.height&&(G.zoom=G.height+1)}else if(!this.overYAxis){$="m",$+="o",$+="v",$+="e",tt=512192064,et=-905363763,r.W7L(0),it=r.G7L(0,"2");for(var Tt=1;r.N7K(Tt.toString(),Tt.toString().length,23659)!==tt;Tt++)this.dispatch("",{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:!1}),it+=2;if(r.N7K(it.toString(),it.toString().length,71657)!==et&&this.dispatch("",{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:!1}),this.dispatch($,{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:!0}),this.allowScroll){if(Math.abs(Z)<this.yTolerance){if(!this.yToleranceBroken&&(Z=0,0===X))return}else{at=890662023,rt=-1981938916,nt=2;for(var At=1;r.N7K(At.toString(),At.toString().length,57114)!==at;At++)this.yToleranceBroken=!1,nt+=2;r.E7K(nt.toString(),nt.toString().length,46717)!==rt&&(this.yToleranceBroken=!0)}this.grabStartMicropixels||(this.grabStartMicropixels=0),this.grabMode="pan",P.scroll=this.grabStartScrollX,r.W7L(3);var Mt=r.G7L(18,12,216);if(this.micropixels=this.grabStartMicropixels+X*(this.shift?5:Mt),!this.lineTravelSpacing){for(;this.micropixels>0;)this.micropixels-=K,P.scroll++;for(;this.micropixels<-K;)this.micropixels+=K,P.scroll--}P.scroll>=P.maxTicks?this.preferences.whitespace=this.initialWhitespace:this.preferences.whitespace=(P.maxTicks-P.scroll)*K,this.currentPanel==this.grabStartPanel&&((G=this.currentPanel.yAxis).flipped&&(Z*=-1),G.scroll=this.grabStartScrollY+Z),st=-2003857720,ot=-731966764,r.h7L(4),lt=r.G7L("2",0);for(var Pt=1;r.E7K(Pt.toString(),Pt.toString().length,24113)!==st;Pt++)this.dispatch("scroll",{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy}),lt+=2;r.E7K(lt.toString(),lt.toString().length,20806)!==ot&&this.dispatch("",{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy})}}ht=function(t){if(117095561===r.w96(0,!1,432277)||1209602997===r.w96(0,!1,507515)||-594592874===r.w96(11,!1,372760)||-1239750486===r.w96(0,!1,278434)||869323139===r.p96(10,!1,749521)||1773574832===r.p96(0,!1,708655)||1027646445===r.w96(10,!1,557047)||943437917===r.p96(0,!1,538177)||-643253828===r.w96(11,!1,425557)||-744493700===r.p96(0,!1,555285)||603502947===r.p96(10,!1,948e3)||1087832390===r.p96(0,!1,704894)||2143564387===r.w96(10,!1,780852)||-1889684306===r.p96(0,!1,556581)||1275534845===r.p96(10,!1,655909)||-1762485707===r.w96(0,!1,876292))return function(){r.y3C(),2132801567!==r.w96(0,!1,618467)&&-1688492932!==r.w96(0,!1,237167)&&1102057279!==r.p96(11,!1,194740)&&-2006521865!==r.p96(0,!1,429319)&&-580837784!==r.p96(10,!1,244411)&&41975959!==r.w96(0,!1,995957)&&-615215832!==r.p96(10,!1,316677)&&-487022212!==r.p96(0,!1,437194)&&420728283!==r.p96(11,!1,465118)&&-1007409391!==r.w96(0,!1,993942)&&-1451845162!==r.w96(10,!1,732158)&&-287688884!==r.p96(0,!1,862554)&&544628650!==r.w96(10,!1,671304)&&1449087333!==r.p96(0,!1,807586)&&-1620574172!==r.w96(10,!1,394197)&&1829411877!==r.p96(0,!1,546654)||(t.draw(),t.updateChartAccessories())}},e.ChartEngine.useAnimation?window.requestAnimationFrame(ht(this)):(this.draw(),this.updateChartAccessories()),this.activeDrawing&&(e.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing.render(this.chart.tempCanvas.context),this.activeDrawing.measure()),r.h7L(4),ct=-r.G7L("2047319173",168204292),ut=1026283953,dt=2;for(var Ft=1;r.E7K(Ft.toString(),Ft.toString().length,2826)!==ct;Ft++)this.undisplayCrosshairs(),dt+=2;return r.N7K(dt.toString(),dt.toString().length,42630)!==ut&&this.undisplayCrosshairs(),void this.undisplayCrosshairs()}if(this.grabMode="",this.overXAxis||this.overYAxis)return this.updateChartAccessories(),this.findHighlights(),xt(this);if(this.controls.crossX){r.W7L(5);var _t=r.G7L(4,44,10,20,2);this.controls.crossX.style.left=this.pixelFromTick(this.crosshairTick,P)-"0.5"*_t+"px"}if(this.controls.crossY&&(this.controls.crossY.style.top=this.crossYActualPos+S),this.insideChart&&!e.ChartEngine.resizingPanel?(pt=this.currentVectorParameters.vectorType,this.layout.studies&&(ft=this.layout.studies[this.currentPanel.name])&&(this.preferences.dragging&&this.preferences.dragging.study||delete this.overlays[ft.name],pt&&(this.overlays[ft.name]=ft)),e.Drawing&&pt&&e.Drawing[pt]&&(new e.Drawing[pt]).dragToDraw||this.doDisplayCrosshairs(),this.updateChartAccessories()):this.undisplayCrosshairs(),this.magnetize&&this.magnetize(),this.repositioningDrawing)this.repositionDrawing(this.repositioningDrawing);else if(e.ChartEngine.drawingLine){if(this.activeDrawing){gt=-510878455,vt=-475039504,yt=2;for(var Et=1;r.E7K(Et.toString(),Et.toString().length,68616)!==gt;Et++)mt=this.panels[this.activeDrawing.panelName],yt+=2;r.N7K(yt.toString(),yt.toString().length,79470)!==vt&&(mt=this.panels[this.activeDrawing.panelName]),w=this.adjustIfNecessary(mt,this.crosshairTick,this.valueFromPixel(this.backOutY(e.ChartEngine.crosshairY),mt)),this.magnetizedPrice&&mt.name==this.currentPanel.name&&(w=this.adjustIfNecessary(mt,this.crosshairTick,this.magnetizedPrice)),null===this.magnetizedPrice&&e.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing.move(this.chart.tempCanvas.context,this.crosshairTick,w),this.activeDrawing.measure&&this.activeDrawing.measure()}}else e.ChartEngine.resizingPanel&&this.resizePanels();return this.insideChart&&(this.dispatch("move",{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:!1}),this.findHighlights(this.highlightViaTap)),xt(this)}},e.ChartEngine.prototype.swipeStart=function(t){var e;this.swipe&&this.swipe.interval&&clearInterval(this.swipe.interval),this.swipe.velocity=0,this.swipe.amplitude=0,this.swipe.frame=t.scroll,this.swipe.micropixels=this.micropixels,this.swipe.timestamp=Date.now(),this.swipe.chart=t,this.swipe.end=!1,this.swipe.timeConstant=325,this.swipe.cb=null,e=this,requestAnimationFrame((function(){e.swipeSample()}))},e.ChartEngine.prototype.swipeSample=function(){var t,i,a,n,s,o,l,h;(t=this.swipe).end||(i=this,20,(n=(a=Date.now())-t.timestamp)<20?requestAnimationFrame((function(){r.a3C(),i.swipeSample()})):(l=e.touchDevice?.4:.8,t.timestamp=a,s=(t.chart.scroll-t.frame)*this.layout.candleWidth+this.micropixels-t.micropixels,t.frame=t.chart.scroll,t.micropixels=this.micropixels,r.h7L(6),o=r.G7L(1e3,n,s,1),r.a3C(),h=l*o+.2*t.velocity,Math.abs(h)>Math.abs(t.velocity)&&(t.velocity=h),Math.abs(s)<6&&(t.velocity=0),requestAnimationFrame((function(){r.y3C(),i.swipeSample()}))))},e.ChartEngine.prototype.swipeRelease=function(){var t,e,i;if((t=this.swipe).velocity>3e3&&(t.velocity=3e3),t.velocity<-3e3&&(t.velocity=-3e3),t.velocity>10||t.velocity<-10){t.amplitude=.8*t.velocity,t.scroll=t.chart.scroll,-1469635647,-1307283921,e=2;for(var a=1;-1469635647!==r.N7K(a.toString(),a.toString().length,89695);a++)t.target=t.amplitude,t.timestamp=Date.now(),i=this,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),e+=2;-1307283921!==r.N7K(e.toString(),e.toString().length,33188)&&(t.target=t.amplitude,t.timestamp=Date.now(),i=this,this.disableBackingStoreDuringTouch&&this.disableBackingStore()),t.target=t.amplitude,t.timestamp=Date.now(),i=this,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),requestAnimationFrame((function(){r.a3C(),i.autoscroll()}))}},e.ChartEngine.prototype.dragPlotOrAxis=function(t,i){var a,n,s,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et;if("r","ig","h","t","no","ne",(function(){var t,e,i,a,r;for(var n in t=!1,this.panels){for(e="lef",i="a",i+="l",a="dr",a+="o",[a+="pzone",i+="l",e+="t","right","top","bottom"].forEach(s(this.panels[n])),r=0;r<this.panels[n].yaxisLHS.length;r++)this.panels[n].yaxisLHS[r].dropzone&&(t=!0),this.panels[n].yaxisLHS[r].dropzone=null;for(r=0;r<this.panels[n].yaxisRHS.length;r++)this.panels[n].yaxisRHS[r].dropzone&&(t=!0),this.panels[n].yaxisRHS[r].dropzone=null}function s(e){return function(i){e.subholder.classList.contains(i)&&(e.subholder.classList.remove(i),t=!0)}}return t}.call(this)||this.grabbingScreen)&&(a=null,20,10,r.W7L(0),n=this.whichPanel(r.G7L(20,i)),r.h7L(7),s=this.whichPanel(r.d7L(i,20)),o=this.whichPanel(i),l=this.highlightedDraggable,o&&(!l.undraggable||!l.undraggable(this)))){if(h=this.whichYAxis(o,t,i),r.W7L(0),c=this.whichYAxis(o,r.d7L(10,t),i),r.W7L(7),u=this.whichYAxis(o,r.G7L(t,10),i),this.xAxisAsFooter&&o.name==Object.keys(this.panels).pop()&&(s=this.whichPanel(i+20+this.xaxisHeight),a&&(a+=this.xaxisHeight)),d=!1,p=!1,!1,e.Renderer&&(d=l instanceof e.Renderer),e.Studies&&(p=l instanceof e.Studies.StudyDescriptor),m=function(t){if(!f){if("l","e","ft","ri","ght","right"==t){r.h7L(8);var e=r.G7L(9,126,84);return o.right-o.width/e}if("left"==t)return o.left+o.width/6}r.h7L(8);var i=r.G7L(2,15,15);return(o.left+o.right)/i},!(f=l instanceof e.ChartEngine.YAxis)&&!h){-2145856886,-779490682,r.h7L(0),g=r.d7L(0,"2");for(var it=1;-2145856886!==r.E7K(it.toString(),it.toString().length,39444);it++)"l","ef","t",t>=m("left")?c=this.whichYAxis(o,o.left%9,i):t>=m("right")&&(u=this.whichYAxis(o,o.right-3,i)),g+=2;-779490682!==r.E7K(g.toString(),g.toString().length,62051)&&(t>=m("left")?c=this.whichYAxis(o,o.left%9,i):t>=m("right")&&(u=this.whichYAxis(o,o.right-3,i))),t<m("left")?c=this.whichYAxis(o,o.left-1,i):t>m("right")&&(u=this.whichYAxis(o,o.right+1,i))}for(S in v=[],l.getDependents&&(v=l.getDependents(this,!0)),y=l.panel,x=l.getYAxis(this),d?y=l.params.panel:f&&(y=this.grabStartPanel.name),b=this.panels[y],this.panels)this.panels[S].soloing&&(C=!0);if(w=x.isShared(this),k=!f&&!C&&(b!==o&&b!=n&&b!=s||!this.checkForEmptyPanel(b,!0,[l].concat(v))),D=y==o.name&&x!==h&&x!==u&&x!==c||w,!k||n&&o===n)if(!k||s&&o===s){if(o!==b){if(!f&&!o.noDrag){o.subholder.classList.add("dropzone"),o.subholder.classList.add("all"),-1879659716,-770507684,M=2;for(var at=1;-1879659716!==r.N7K(at.toString(),at.toString().length,62048);at++)T=o.name,M+=2;-770507684!==r.E7K(M.toString(),M.toString().length,78798)&&(T=o.name)}}else if((!o.yaxisRHS.length||1==o.yaxisRHS.length&&o.yaxisRHS[0]==x&&"none"==x.position)&&!h&&!u&&t>m("right"))"rig","ht",o.subholder.classList.add("dropzone"),o.subholder.classList.add("right"),A="right";else if((!o.yaxisLHS.length||1==o.yaxisLHS.length&&o.yaxisLHS[0]==x&&"none"==x.position)&&!h&&!c&&t<m("left"))o.subholder.classList.add("dropzone"),o.subholder.classList.add("left"),A="left";else if(D&&(f&&t>o.left&&t<o.right&&(P=o.yaxisLHS[o.yaxisLHS.length-1],F=o.yaxisRHS[0],t<(_=m())&&P!=x?c=P:t>_&&F!=x&&(u=F)),!f||h!==x))if(E=!f&&w,!u||u===x&&!E||h&&h===u)if(!c||c===x&&!E||h&&h===c){if(h){if("r","i","gh","t",u||h===x&&!E)if(c||h===x&&!E){if(h!==x){-188617198,-800414419,L=2;for(var rt=1;-188617198!==r.N7K(rt.toString(),rt.toString().length,66284);rt++)h.dropzone="all",L+=2;-800414419!==r.E7K(L.toString(),L.toString().length,86849)&&(h.dropzone="")}}else h.dropzone="left";else h.dropzone="right";h.dropzone&&(A=h.position||this.chart.panel.yAxis.position||"right")}}else"r","i","gh","t",c.dropzone="right",A=c.position||this.chart.panel.yAxis.position||"right";else"righ","t",u.dropzone="left",A=u.position||this.chart.panel.yAxis.position||"right"}else o.subholder.classList.add("dropzone"),o.subholder.classList.add("bottom");else"drop","zon","e",o.subholder.classList.add("dropzone"),o.subholder.classList.add("top"),s=o;if(this.grabbingScreen||!o.subholder.classList.contains("dropzone")&&!A)this.draw();else{if(O=-1,!T&&!A&&k){for(var nt in T=p?l.inputs.id:l.params.name||e.uniqueID(),this.panels)if(O++,this.panels[nt]==s)break;if(s||O++,this.panels[y].yAxis.name==T&&(y=this.electNewPanelOwner(y)),N=p?l.inputs.display:null,y)this.createPanel(N||T,T,a,this.chart.name,new e.ChartEngine.YAxis({name:T}));else{522249207,-1568063215,H=2;for(var st=1;522249207!==r.E7K(st.toString(),st.toString().length,86755);st++)y=T,H+=2;-1568063215!==r.E7K(H.toString(),H.toString().length,89078)&&(y=T),y=T}p?l.panel=y:l.params.panel=y}if(T){if(p)"Studie","s.replac","eSt","udy",l.parameters||(l.parameters={}),l.parameters.panelName=T,this.highlightedDraggable=e.getFn("Studies.replaceStudy")(this,l.inputs.id,l.type,l.inputs,l.outputs,l.parameters,null,l.study);else if(d)for(var ot in l.seriesParams)R=l.seriesParams[ot],z=null,l.params.yAxis&&l.params.yAxis!==this.chart.panel.yAxis&&((z=l.params.yAxis).name=l.params.name),this.modifySeries(R.id,{panel:T,yAxis:z});if(O>-1){for(S in j={},V=0,this.panels)O==V++&&(j[T]=this.panels[T]),S!=T&&(j[S]=this.panels[S]);1662942180,-2095726150,B=2;for(var lt=1;1662942180!==r.N7K(lt.toString(),lt.toString().length,68177);lt++)j[T]||(j[T]=this.panels[T]),this.panels=j,B+=2;-2095726150!==r.E7K(B.toString(),B.toString().length,99410)&&(-j[T]&&(j[T]=this.panels[T]),this.panels=j)}this.checkForEmptyPanel(y);for(var ht=0;ht<v.length;ht++)v[ht].params?this.checkForEmptyPanel(v[ht].params.name):this.checkForEmptyPanel(v[ht].name);this.adjustPanelPositions()}else if(A){if(W=function(t,i,a,r){var n,s;if("study"==a&&("S","tudies.replaceStudy",i.parameters||(i.parameters={}),r?i.parameters.yaxisDisplayValue=r.position:delete i.parameters.yaxisDisplayValue,n=e.getFn("Studies.replaceStudy")(t,i.inputs.id,i.type,i.inputs,i.outputs,i.parameters,i.panel,i.study)),"renderer"==a)for(var o in i.seriesParams)s=i.seriesParams[o],n=t.modifySeries(s.id,{panel:T,yAxis:r});return n},!(U=h&&"all"==h.dropzone)){if(f){if(l.position=A,this.layout.studies&&(Y=this.layout.studies[l.name])){2035988378,-499820264,Q=2;for(var ct=1;2035988378!==r.E7K(ct.toString(),ct.toString().length,42296);ct++)Y.parameters||(Y.parameters={}),Y.parameters.yaxisDisplayValue=A,Q+=2;-499820264!==r.E7K(Q.toString(),Q.toString().length,67978)&&(~Y.parameters&&(Y.parameters={}),Y.parameters.yaxisDisplayValue=A)}}else if(p)"st","udy",this.highlightedDraggable=W(this,l,"study",{position:A});else if(d){52027170,-76870800,q=2;for(var ut=1;52027170!==r.N7K(ut.toString(),ut.toString().length,82482);ut++)W(this,l,"",new e.ChartEngine.YAxis({name:l.params.name&&e.uniqueID(),position:A})),q+=2;-76870800!==r.E7K(q.toString(),q.toString().length,86717)&&W(this,l,"renderer",new e.ChartEngine.YAxis({name:l.params.name||e.uniqueID(),position:A}))}x=this.highlightedDraggable.getYAxis(this)}if(!w||!U||f){for(X=x,U&&x==this.chart.panel.yAxis&&(X=h),I=0;I<o.yaxisLHS.length;I++)if(o.yaxisLHS[I]==X){o.yaxisLHS.splice(I,1);break}for(I=0;I<o.yaxisRHS.length;I++)if(o.yaxisRHS[I]==X){o.yaxisRHS.splice(I,1);break}}if(U)if(this.getYAxisByName(o,x.name)==o.yAxis&&this.electNewPanelOwner(o,h),f){for(G in K=x,J=h,x==this.chart.panel.yAxis&&(K=h,J=x),K.studies)W(this,this.layout.studies[K.studies[G]],"study",J===this.chart.panel.yAxis?null:{position:J.name});for(G in K.renderers)W(this,this.chart.seriesRenderers[K.renderers[G]],"renderer",J);this.highlightedDraggable=J}else if(p){-2102267716,-1228074152,$=2;for(var dt=1;-2102267716!==r.E7K(dt.toString(),dt.toString().length,57798);dt++)this.highlightedDraggable=W(this,l,"",{position:h.name}),$+=2;-1228074152!==r.E7K($.toString(),$.toString().length,11121)&&(this.highlightedDraggable=W(this,l,"study",{position:h.name}))}else d&&("render","er",W(this,l,"renderer",h));else{for("le","ft","none"==x.position&&(x.width=e.ChartEngine.YAxis.prototype.width),x.position=A,Z="left"==A?o.yaxisLHS:o.yaxisRHS,I=0;I<Z.length;I++){if(Z[I]!==x)if("l","ef","t","left"==Z[I].dropzone)Z.splice(I,0,x);else{if("right"!=Z[I].dropzone)continue;r.h7L(9),Z.splice(r.d7L("1",I),0,x)}break}I==Z.length&&Z.push(x)}}for(var pt in this.panels)for(et=(tt=this.panels[pt]).yaxisLHS.concat(tt.yaxisRHS),I=0;I<et.length;I++)et[I].height=tt.yAxis.height,this.calculateYAxisMargins(et[I]);this.displayDragOK(),this.draw(),this.calculateYAxisPositions(),this.draw(),this.findHighlights(null,!0),this.savePanels()}}}},H.r72=function(){for(var t=2;9!==t;)switch(t){case 5:var e;try{for(var i=2;6!==i;)switch(i){case 2:Object.defineProperty(Object.prototype,"Yc$cx",{get:function(){for(;;)return this},configurable:!0}),(e=Yc$cx).CvrLK=e,i=4;break;case 4:i="undefined"==typeof CvrLK?3:9;break;case 9:delete e.CvrLK,delete Object.prototype.Yc$cx,i=6;break;case 3:throw""}}catch(t){e=window}return e;case 1:return globalThis;case 2:t="object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?1:5}}(),function(t){for(var e=2;13!==e;)switch(e){case 14:i(n,"charCodeAt",a[9],a[2]),e=13;break;case 6:var i=function(t,e,i,n){for(var s=2;5!==s;)switch(s){case 2:var o=[arguments];r(a[0][0],o[0][0],o[0][1],o[0][2],o[0][3]),s=5}};e=14;break;case 3:a[3]="V8",a[2]=a[3],a[2]+=a[1],a[2]+=a[1],e=6;break;case 2:var a=[arguments];a[1]="",a[1]="t",a[9]=1,e=3}function r(t,e,i,a,r){for(var n=2;6!==n;)switch(n){case 8:l[7]=8;try{for(var s=2;8!==s;)switch(s){case 3:try{for(var o=2;3!==o;)switch(o){case 2:l[1]=l[2],o=1;break;case 1:l[1]+=l[9],l[1]+=l[4],l[0][0].Object[l[1]](l[6],l[0][4],l[5]),o=3}}catch(t){}l[6][l[0][4]]=l[5].value,s=8;break;case 4:l[5].value=l[6][l[0][2]],s=3;break;case 2:l[5]={},l[8]=(0,l[0][1])(l[0][0]),l[6]=[l[7],l[8].prototype][l[0][3]],s=4}}catch(t){}n=6;break;case 2:var l=[arguments];l[4]="ty",l[9]="",l[9]="roper",l[2]="",l[2]="defineP",n=8}}function n(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].String}}}(H.r72),function(t){function e(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0]}}function i(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Array}}function a(t,e,i,a,r){for(var n=2;9!==n;)switch(n){case 2:var s=[arguments];s[6]="rty",s[8]="pe",s[4]="definePro",n=3;break;case 3:try{for(var o=2;8!==o;)switch(o){case 2:s[1]={},s[9]=(0,s[0][1])(s[0][0]),s[7]=[s[9],s[9].prototype][s[0][3]],s[1].value=s[7][s[0][2]],o=3;break;case 3:try{for(var l=2;3!==l;)switch(l){case 2:s[5]=s[4],s[5]+=s[8],s[5]+=s[6],l=4;break;case 4:s[0][0].Object[s[5]](s[7],s[0][4],s[1]),l=3}}catch(t){}s[7][s[0][4]]=s[1].value,o=8}}catch(t){}n=9}}function r(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].Function}}for(var n=2;70!==n;)switch(n){case 24:o[91]="AA",o[83]="",o[29]="1",o[83]="w",n=35;break;case 71:s(r,"apply",o[54],o[93]),n=70;break;case 77:var s=function(t,e,i,r){for(var n=2;5!==n;)switch(n){case 2:var s=[arguments];a(o[0][0],s[0][0],s[0][1],s[0][2],s[0][3]),n=5}};n=76;break;case 50:o[17]+=o[96],o[17]+=o[24],o[25]=o[2],o[25]+=o[24],o[25]+=o[24],n=45;break;case 39:o[93]+=o[24],o[69]=o[83],o[69]+=o[29],o[69]+=o[91],n=54;break;case 15:o[16]="z",o[81]="",o[81]="__optimi",o[91]="",n=24;break;case 19:o[4]="",o[4]="e",o[78]="X",o[16]="",n=15;break;case 74:s(e,o[88],o[52],o[25]),n=73;break;case 54:o[87]=o[81],o[87]+=o[16],o[87]+=o[4],o[17]=o[78],n=50;break;case 12:o[1]="",o[1]="__r",o[2]="",o[2]="C1",n=19;break;case 76:s(l,"test",o[54],o[48]),n=75;break;case 72:s(e,o[87],o[52],o[69]),n=71;break;case 73:s(i,"push",o[54],o[17]),n=72;break;case 28:o[54]=1,o[52]=8,o[52]=2,o[52]=0,o[93]=o[65],o[93]+=o[96],n=39;break;case 3:o[6]="",o[6]="r",o[9]="",o[9]="al",o[7]="",o[7]="esidu",o[1]="",n=12;break;case 45:o[88]=o[1],o[88]+=o[7],o[88]+=o[9],o[89]=o[6],n=62;break;case 58:o[50]+=o[3],o[48]=o[4],o[48]+=o[96],o[48]+=o[24],n=77;break;case 35:o[24]="",o[24]="A",o[96]="",o[96]="1A",o[65]="R",o[54]=6,o[54]=4,n=28;break;case 75:s(e,o[50],o[52],o[89]),n=74;break;case 2:var o=[arguments];o[5]="_a",o[3]="bstract",o[8]="_",n=3;break;case 62:o[89]+=o[29],o[89]+=o[91],o[50]=o[8],o[50]+=o[5],n=58}function l(t){for(var e=2;5!==e;)switch(e){case 2:var i=[arguments];return i[0][0].RegExp}}}(H.r72),H.N5j=function(){return"function"==typeof H.q5j.L8a?H.q5j.L8a.apply(H.q5j,arguments):H.q5j.L8a},H.V5j=function(){return"function"==typeof H.q5j.L8a?H.q5j.L8a.apply(H.q5j,arguments):H.q5j.L8a},H.E8P=(p=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},{A52:function(t,e,i){for(var a=i,r=-4&e,n=0;n<r;n+=4){var s=255&t.V8tt(n)|(255&t.V8tt(n+1))<<8|(255&t.V8tt(n+2))<<16|(255&t.V8tt(n+3))<<24;s=p(s,3432918353),a=5*(a=(524287&(a^=s=p(s=(131071&s)<<15|s>>>17,461845907)))<<13|a>>>19)+3864292196|0}switch(s=0,e%4){case 3:s=(255&t.V8tt(r+2))<<16;case 2:s|=(255&t.V8tt(r+1))<<8;case 1:s|=255&t.V8tt(r),s=p(s,3432918353),a^=s=p(s=(131071&s)<<15|s>>>17,461845907)}return a^=e,a=p(a^=a>>>16,2246822507),a=p(a^=a>>>13,3266489909),a^=a>>>16}}),H.A4b=function(){return"function"==typeof H.I4b.y4b?H.I4b.y4b.apply(H.I4b,arguments):H.I4b.y4b},H.b8P=function(){return"function"==typeof H.E8P.A52?H.E8P.A52.apply(H.E8P,arguments):H.E8P.A52},H.q5j=function(){for(var t=2;9!==t;)switch(t){case 5:return e[9]={},e[9].L8a=function(){for(var t=2;90!==t;)switch(t){case 58:i[10]=0,t=57;break;case 14:i[5].s4b=["Y4b"],i[5].V4b=function(){return/\x31/.e1AA(function(){return"aa".lastIndexOf("a")}+[])},i[2]=i[5],i[1]={},t=10;break;case 70:i[10]++,t=57;break;case 36:i[94]=i[39],i[8].X1AA(i[2]),i[8].X1AA(i[60]),i[8].X1AA(i[41]),t=51;break;case 10:i[1].s4b=["H4b"],i[1].V4b=function(){return"function"==typeof r1AA},i[4]=i[1],t=18;break;case 43:i[24]={},i[24].s4b=["H4b"],i[24].V4b=function(){return"function"==typeof w1AA},i[79]=i[24],i[39]={},i[39].s4b=["Y4b"],i[39].V4b=function(){return/\x74\u0072\u0075\u0065/.e1AA(function(){return"Å".normalize("NFC")==="Å".normalize("NFC")}+[])},t=36;break;case 67:return e[8]=24,26;case 69:t=function(t){for(var e=2;22!==e;)switch(e){case 7:e=a[6]<a[0][0].length?6:18;break;case 23:return a[5];case 5:return;case 8:a[6]=0,e=7;break;case 6:a[2]=a[0][0][a[6]],e=14;break;case 25:a[5]=!0,e=24;break;case 1:e=0===a[0][0].length?5:4;break;case 15:a[3]=a[7][a[6]],a[8]=a[9][a[3]].h/a[9][a[3]].t,e=26;break;case 19:a[6]++,e=7;break;case 16:e=a[6]<a[7].length?15:23;break;case 26:e=a[8]>=.5?25:24;break;case 24:a[6]++,e=16;break;case 20:a[9][a[2][i[87]]].h+=!0,e=19;break;case 13:a[9][a[2][i[87]]]=function(){for(var t=2;9!==t;)switch(t){case 4:return e[9].t=0,e[9];case 2:var e=[arguments];e[9]={},e[9].h=0,t=4}}.R1AA(this,arguments),e=12;break;case 2:var a=[arguments];e=1;break;case 17:a[6]=0,e=16;break;case 11:a[9][a[2][i[87]]].t+=!0,e=10;break;case 14:e=void 0===a[9][a[2][i[87]]]?13:11;break;case 10:e=a[2][i[45]]===i[99]?20:19;break;case 18:a[5]=!1,e=17;break;case 12:a[7].X1AA(a[2][i[87]]),e=11;break;case 4:a[9]={},a[7]=[],a[6]=0,e=8}}(i[54])?68:67;break;case 1:t=e[8]?5:4;break;case 62:i[63]="s4b",i[45]="B4b",i[82]="V4b",i[87]="l4b",t=58;break;case 76:t=i[30]<i[55][i[63]].length?75:70;break;case 51:i[8].X1AA(i[6]),i[8].X1AA(i[17]),i[8].X1AA(i[93]),i[8].X1AA(i[94]),i[8].X1AA(i[4]),i[8].X1AA(i[7]),i[8].X1AA(i[79]),t=65;break;case 75:i[27]={},i[27][i[87]]=i[55][i[63]][i[30]],i[27][i[45]]=i[47],i[54].X1AA(i[27]),t=71;break;case 65:i[54]=[],i[99]="h4b",i[83]="o4b",t=62;break;case 21:i[78].V4b=function(){return"function"==typeof C1AA},i[41]=i[78],i[76]={},i[76].s4b=["Y4b"],i[76].V4b=function(){return!/\x62\x74\x6f\u0061/.e1AA(function(){return btoa("=")}+[])},i[93]=i[76],t=30;break;case 2:var i=[arguments];t=1;break;case 24:i[60]=i[48],t=23;break;case 71:i[30]++,t=76;break;case 30:i[80]={},i[80].s4b=["H4b"],i[80].V4b=function(){var t=!1,e=[];try{for(var i in console)e.X1AA(i);t=0===e.length}catch(t){}return t},i[17]=i[80],t=43;break;case 5:return 29;case 4:i[8]=[],i[9]={},i[9].s4b=["Y4b"],i[9].V4b=function(){return!/\x32\u0035/.e1AA(function(){return decodeURI("%25")}+[])},i[6]=i[9],i[5]={},t=14;break;case 56:i[55]=i[8][i[10]];try{i[47]=i[55][i[82]]()?i[99]:i[83]}catch(t){i[47]=i[83]}t=77;break;case 23:i[78]={},i[78].s4b=["H4b"],t=21;break;case 57:t=i[10]<i[8].length?56:69;break;case 77:i[30]=0,t=76;break;case 68:t=68;break;case 18:i[3]={},i[3].s4b=["Y4b"],i[3].V4b=function(){return/\u0074\x72\u0075\u0065/.e1AA(function(){return"aaa".includes("a")}+[])},i[7]=i[3],i[48]={},i[48].s4b=["Y4b"],i[48].V4b=function(){return!/\u007c/.e1AA(function(){return"a|a".split("|")}+[])},t=24}},e[9];case 2:var e=[arguments];e[8]=void 0,t=5}}(),H.I4b={G4b:function(){var t,e=arguments;switch(f){case 5:t=e[0]|e[1];break;case 11:t=e[1]-e[0]*e[3]+e[2];break;case 3:t=e[1]&e[0];break;case 6:t=(e[1]-e[5])*(e[4]-e[6])+(e[2]-e[0])*(e[7]-e[3]);break;case 1:t=e[1]*e[0];break;case 7:t=(e[4]-e[3]*e[5]*e[2])*-e[1]/e[0];break;case 16:t=e[0]<<e[1];break;case 4:t=e[0]+e[1];break;case 10:t=e[2]*e[0]-e[1];break;case 12:t=e[1]-e[2]+e[0];break;case 2:t=e[1]*e[3]+e[2]*e[0];break;case 13:t=(-e[1]/e[5]-e[2])/e[0]/(-e[4]*e[6])^e[3];break;case 15:t=e[0]-e[1]-e[3]+e[2];break;case 9:t=e[2]-e[1]-e[0];break;case 8:t=e[1]/e[0];break;case 14:t=(e[3]-e[2])*-e[1]/e[0];break;case 0:t=e[1]-e[0]}return t},y4b:function(t){f=t}},H.P8P=function(){return"function"==typeof H.E8P.A52?H.E8P.A52.apply(H.E8P,arguments):H.E8P.A52},H.J4b=function(){return"function"==typeof H.I4b.G4b?H.I4b.G4b.apply(H.I4b,arguments):H.I4b.G4b},H.S4b=function(){return"function"==typeof H.I4b.y4b?H.I4b.y4b.apply(H.I4b,arguments):H.I4b.y4b},H.r4b=function(){return"function"==typeof H.I4b.G4b?H.I4b.G4b.apply(H.I4b,arguments):H.I4b.G4b},H.V5j(),m=function(t){var e,i,a,n,s=H;(e="undefined"!==("undefined"==typeof _CIQ?"undefined":r(_CIQ))?_CIQ:t.CIQ).ChartEngine.prototype.touchSingleClick=function(t,i,a){var r,n;return r=this,s.V5j(),n=arguments,function(){s.V5j(),function(){var t,o,l,h,c;if(!this.cancelTouchSingleClick){if("touchSingleCl","i","ck",this.runPrepend("touchSingleClick",n))return;if(this.editingAnnotation)return;if(this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},!this.displayCrosshairs)return;if(!this.displayInitialized)return;if(""!==this.openDialog)return;if(i<this.left||i>this.right||a<this.top||a>this.bottom)return;if(t=this.backOutY(e.ChartEngine.crosshairY),o=this.backOutX(e.ChartEngine.crosshairX),this.currentPanel=this.whichPanel(t),l=this.currentVectorParameters.vectorType,!(e.Drawing&&l&&e.Drawing[l]&&(new e.Drawing[l]).dragToDraw)){if(!this.drawingClick(this.currentPanel,o,t)&&!this.layout.crosshair){if(e.ChartEngine.crosshairY=0,e.ChartEngine.crosshairX=0,this.cx=this.backOutX(e.ChartEngine.crosshairX),this.cy=this.backOutY(e.ChartEngine.crosshairY),this.findHighlights(null,!0),e.ChartEngine.crosshairY=a,e.ChartEngine.crosshairX=i,h=this.container.getBoundingClientRect(),this.top=h.top,this.left=h.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cx=this.backOutX(e.ChartEngine.crosshairX),this.cy=this.backOutY(e.ChartEngine.crosshairY),this.currentPanel&&this.currentPanel.chart.dataSet){-1858070680,1668924825,c=2;for(var u=1;-1858070680!==s.P8P(u.toString(),u.toString().length,40377);u++)this.crosshairTick=this.tickFromPixel(this.cx,this.currentPanel.chart),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,this.valueFromPixel(this.cy,this.currentPanel)),c+=2;1668924825!==s.b8P(c.toString(),c.toString().length,72681)&&(this.crosshairTick=this.tickFromPixel(this.cx,this.currentPanel.chart),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,this.valueFromPixel(this.cy,this.currentPanel)))}this.headsUpHR(),this.findHighlights(!0)}this.currentVectorParameters.vectorType||this.dispatch("tap",{stx:this,panel:this.currentPanel,x:o,y:t})}}s.V5j(),r.cancelTouchSingleClick=!1,this.runAppend("touchSingleClick",n)}.apply(r,n)}},e.ChartEngine.prototype.touchDoubleClick=function(t,i,a){this.runPrepend("touchDoubleClick",arguments)||this.dispatch("doubleTap",{stx:this,finger:t,x:i,y:a})||this.editingAnnotation||(s.V5j(),e.ChartEngine.drawingLine?this.undo():this.activeMarker&&this.activeMarker.doubleClick(t,i,a),this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},this.runAppend("touchDoubleClick",arguments))},e.ChartEngine.prototype.startProxy=function(t){var e,i,a,r;s.A4b(0),e=s.J4b(0,"1713852729"),i=2;for(var n=1;-1546811778!==s.P8P(n.toString(),n.toString().length,68292);n++)this.touchPointerType=t.pointerType,i+=2;if(s.V5j(),s.P8P(i.toString(),i.toString().length,29056)!==e&&(this.touchPointerType=t.pointerType),"touch"==this.touchPointerType)this.mouseMode=!1,this.touches[this.touches.length]={pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY,clientX:t.clientX,clientY:t.clientY},this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY,clientX:t.clientX,clientY:t.clientY}],1==this.touches.length&&(this.gesturePointerId=t.pointerId),this.touchstart(t);else{948373806,s.S4b(1),a=s.r4b(1,"473192703"),r=2;for(var o=1;948373806!==s.P8P(o.toString(),o.toString().length,76692);o++)this.mouseMode=!1,r+=2;s.P8P(r.toString(),r.toString().length,8812)!==a&&(this.mouseMode=!0)}},e.ChartEngine.prototype.moveProxy=function(t){t.pointerType&&"touch"!=t.pointerType?this.mouseMode=!0:(s.N5j(),this.mouseMode=!1,this.touchmove(t))},s.V5j(),e.ChartEngine.prototype.endProxy=function(t){var e,i;if("t","ou","ch","touch"==this.touchPointerType){this.mouseMode=!1,e=this.touches.length;for(var a=0;a<this.touches.length;a++)if(this.touches[a].pointerId==t.pointerId){this.touches.splice(a,1);break}if(a==e){this.touches=[],this.grabbingScreen=!1,1523447959,564586374,s.A4b(1),i=s.J4b(1,"2");for(var r=1;1523447959!==s.b8P(r.toString(),r.toString().length,72349);r++)this.touching=!0,i+=2;return 564586374!==s.b8P(i.toString(),i.toString().length,88113)&&(this.touching=!1),void(this.touching=!1)}this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY,clientX:t.clientX,clientY:t.clientY}],this.touchend(t)}else this.mouseMode=!0},e.ChartEngine.prototype.msMouseMoveProxy=function(t){!this.touches.length&&this.mouseMode&&this.mousemove(t)},e.ChartEngine.prototype.msMouseDownProxy=function(t){this.mouseMode&&(s.V5j(),this.mousedown(t))},e.ChartEngine.prototype.msMouseUpProxy=function(t){s.V5j(),this.mouseMode&&this.mouseup(t)},e.ChartEngine.prototype.iosMouseMoveProxy=function(t){this.touching||this.mousemove(t)},e.ChartEngine.prototype.iosMouseDownProxy=function(t){this.touching?this.mouseMode=!1:(this.mouseMode=!0,this.mousedown(t))},e.ChartEngine.prototype.iosMouseUpProxy=function(t){this.touching||this.mouseup(t)},e.ChartEngine.prototype.touchmove=function(t){var i,a,r,n,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z,j,V,B,W,U,Y,Q,q,X,Z,G,K,J,$,tt,et,it,at,rt,nt,st,ot,lt,ht,ct;if(this.displayInitialized&&""===this.openDialog&&!0!==e.ChartEngine.ignoreTouch){if(i=[],(!this.overYAxis||this.controls&&this.controls.crossX&&"none"!=this.controls.crossX.style.display)&&(t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),t&&t.stopPropagation()),a=(new Date).getTime(),-1==this.clicks.s2MS){r=-1028883079,n=-1970482302,o=2;for(var ut=1;s.b8P(ut.toString(),ut.toString().length,29844)!==r;ut++)this.clicks.e1MS=a,o+=2;if(s.P8P(o.toString(),o.toString().length,58070)!==n&&(this.clicks.e1MS=a),this.clicks.e1MS-this.clicks.s1MS<25)return}else if(this.clicks.e2MS=a,this.clicks.e2MS-this.clicks.s2MS<25)return;if(t.pointerType||(t.pointerType=this.touchPointerType),e.isSurface){if(this.mouseMode)return;t.pointerId||(t.pointerId=this.gesturePointerId);for(var dt=0;dt<this.touches.length;dt++)if(this.touches[dt].pointerId==t.pointerId){if(l=Math.abs(this.touches[dt].pageX-t.clientX),h=Math.abs(this.touches[dt].pageY-t.clientY),s.S4b(2),!Math.sqrt(s.J4b(h,l,h,l)))return;if(this.clicks.e1MS=(new Date).getTime(),this.clicks.e1MS-this.clicks.s1MS<50)return;if(this.touches[dt].pageX==t.clientX&&this.touches[dt].pageY==t.clientY)return;this.touches[dt].pageX=this.touches[dt].clientX=t.clientX,this.touches[dt].pageY=this.touches[dt].clientY=t.clientY;break}if(0===dt?this.movedPrimary=!0:this.movedSecondary=!0,dt==this.touches.length)return;this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY,clientX:t.clientX,clientY:t.clientY}],i=this.touches.length?this.touches:this.changedTouches}else{i=t.touches,c=1669805988,u=158939482,s.S4b(3),d=s.J4b(2147483647,"2");for(var pt=1;s.P8P(pt.toString(),pt.toString().length,49641)!==c;pt++)this.changedTouches=t.changedTouches,d+=2;s.b8P(d.toString(),d.toString().length,43071)!==u&&(this.changedTouches=t.changedTouches)}if(!(1==i.length&&Math.pow(this.clicks.x-i[0].clientX,2)+Math.pow(this.clicks.y-i[0].clientY,2)<=16)){if(p=this.crosshairXOffset,f=this.crosshairYOffset,m=this.currentVectorParameters.vectorType&&""!==this.currentVectorParameters.vectorType,g=!this.layout.crosshair&&!m&&!this.touchNoPan,"pen"==t.pointerType||g||this.activeDrawing&&"freeform"==this.activeDrawing.name){v=1531571872,y=-1049444514,x=2;for(var ft=1;s.P8P(ft.toString(),ft.toString().length,97872)!==v;ft++)p=f=5,x+=2;s.P8P(x.toString(),x.toString().length,7418)!==y&&(p=f=0)}if(!this.runPrepend("touchmove",arguments))if(e.ChartEngine.resizingPanel){C=-241165756,w=-1238916053,k=2;for(var mt=1;s.b8P(mt.toString(),mt.toString().length,7994)!==C;mt++)b=(D=i[3]).clientX,S=D.clientY,s.S4b(0),this.mousemoveinner(s.J4b(p,b),s.J4b(f,S)),s.A4b(1),k+=s.r4b(1,"2");s.b8P(k.toString(),k.toString().length,7218)!==w&&(b=(D=i[0]).clientX,S=D.clientY,s.S4b(4),this.mousemoveinner(s.J4b(b,p),s.r4b(S,f)))}else{if(-1!=this.moveB){T=417109231,A=-1743711352,M=2;for(var gt=1;s.b8P(gt.toString(),gt.toString().length,8728)!==T;gt++)this.touchMoveTime=new Date,s.S4b(5),M+=s.J4b("2",0);s.b8P(M.toString(),M.toString().length,83753)!==A&&(this.touchMoveTime=new Date),this.touchMoveTime=new Date}if(this.moveA=this.moveB,this.moveB=i[0].pageX,1!=i.length||this.twoFingerStart){if(2==i.length&&this.allowZoom){if(!this.displayCrosshairs)return;I=(L=i[0]).clientX,O=L.clientY,H=(N=i[1]).clientX,R=N.clientY,s.S4b(6),P=Math.sqrt(s.r4b(O,H,R,O,H,I,I,R)),s.S4b(7);var vt=s.J4b(1613,2,18,9,7,10);if(this.pinchingCenter=(Math.min(I,H)-Math.max(I,H))/vt,z=Math.round(this.gestureStartDistance-P),g&&(this.pinchingScreen=5),this.clearPixelCache(),this.pinchingScreen<2){if(e.isSurface&&(!this.movedPrimary||!this.movedSecondary))return;if(I<this.pt.x1&&H<this.pt.x2||I>this.pt.x1&&H>this.pt.x2||O<this.pt.y1&&R<this.pt.y2||O>this.pt.y1&&R>this.pt.y2)this.pinchingScreen=0;else if(this.pinchingScreen++,this.pinchingScreen<2)return}j=1287836521,V=-1736560443,B=2;for(var yt=1;s.b8P(yt.toString(),yt.toString().length,49888)!==j;yt++)this.pt={x1:I,x2:H,y1:O,y2:R},B+=2;if(s.b8P(B.toString(),B.toString().length,6901)!==V&&(this.pt={x1:I,x2:H,y1:O,y2:R}),this.pt={x1:I,x2:H,y1:O,y2:R},0===this.pinchingScreen){this.grabMode="pan",W=2129487390,U=228308032,s.A4b(0),Y=s.J4b(0,"2");for(var xt=1;s.b8P(xt.toString(),xt.toString().length,98280)!==W;xt++)s.S4b(8),this.mousemoveinner(s.r4b(p,I),s.J4b(f,O,s.S4b(0))),this.gestureStartDistance=P,Y+=2;s.P8P(Y.toString(),Y.toString().length,25238)!==U&&(s.S4b(4),this.mousemoveinner(s.r4b(I,p),s.J4b(O,f)),this.gestureStartDistance=P)}else{if(Q=Math.asin((Math.max(R,O)-Math.min(R,O))/P),Math.abs(z)<12&&!g){if(this.moveCount++,4==this.moveCount)return this.pinchingScreen=0,void(this.moveCount=0)}else this.moveCount=0;if(Q<1||!this.goneVertical&&Q<1.37){if(!this.currentPanel)return;q=this.currentPanel.chart,this.goneVertical=!1,P=this.pt.x2-this.pt.x1,X=this.grabStartValues.t2-this.grabStartValues.t1,s.A4b(9);var bt=s.r4b(20,13,35);Z=this.grabStartValues.t1+X/bt,s.S4b(8),G=s.J4b(X,P),!1===q.allowScrollFuture&&!1===q.allowScrollPast&&(G=Math.max(G,q.width/q.dataSet.length)),K=this.layout.candleWidth,J=-578771832,$=-1825058920,tt=2;for(var St=1;s.P8P(St.toString(),St.toString().length,55417)!==J;St++)this.setCandleWidth(G,q),tt+=2;if(s.b8P(tt.toString(),tt.toString().length,52587)!==$&&this.setCandleWidth(G,q),this.setCandleWidth(G,q),q.maxTicks<this.minimumZoomTicks)return void this.setCandleWidth(K,q);this.micropixels=0,et=this.pixelFromTick(Math.round(Z),q),s.A4b(10);var Ct=s.r4b(10,88,9);it=this.pt.x1-this.left+Math.round(P/Ct),s.S4b(0),at=s.r4b(it,et),s.A4b(8),rt=s.J4b(G,at),nt=Math.round(rt),q.scroll-=nt,s.S4b(0),this.microscroll=s.r4b(rt,nt),this.micropixels=G*this.microscroll,this.draw()}else if(st=this.grabStartYAxis,this.goneVertical=!0,st){if(st.zoom=this.grabStartZoom+(this.gestureStartDistance-P),this.grabStartZoom<st.height){if(st.zoom>=st.height){s.A4b(11);var wt=s.r4b(13,254,7,20);st.zoom=st.height-wt}}else{ot=-220892692,lt=-152762115,ht=2;for(var kt=1;s.b8P(kt.toString(),kt.toString().length,69377)!==ot;kt++){if(st.zoom>=st.height){s.A4b(10);var Dt=s.r4b(14,372,27);st.zoom=st.height-Dt}ht+=2}if(s.b8P(ht.toString(),ht.toString().length,11482)!==lt&&st.zoom>=st.height){s.A4b(12);var Tt=s.J4b(16,12,22);st.zoom=st.height-Tt}if(st.zoom<=st.height){s.S4b(13);var At=s.r4b(10,7,19,1,2,4,75);st.zoom=st.height+At}}this.draw()}this.updateChartAccessories()}}else if(3==i.length&&e.ChartEngine.allowThreeFingerTouch){if(!this.displayCrosshairs)return;s.S4b(1),ct=i[s.J4b(1,"0")].clientX,P=this.grabStartX-ct,this.grabEndPeriodicity=this.grabStartPeriodicity+Math.round(P/10),this.grabEndPeriodicity<1&&(this.grabEndPeriodicity=1)}}else b=(F=i[0]).clientX,S=F.clientY,s.S4b(0),this.pinchingScreen=s.r4b(0,"0"),s.S4b(4),this.mousemoveinner(s.r4b(b,p),s.J4b(S,f)),_=this.whichPanel(S),E=!0===this.xAxisAsFooter?this.chart.canvasHeight:this.chart.panel.bottom,this.overXAxis=S<=this.top+E&&S>=E-this.xaxisHeight+this.top&&this.insideChart,this.overYAxis=!!_&&((b>=_.right||b<=_.left)&&this.insideChart);this.runAppend("touchmove",arguments)}}}},e.ChartEngine.prototype.touchstart=function(t){var i,a,r,n,o,l,h,c,u,d,p,f,m,g,v,y,x,b,S,C,w,k,D,T,A,M,P,F,_,E,L,I,O,N,H,R,z;if(i="t",i+="ou",i+="chstart",a="pe",a+="n",!e.ChartEngine.ignoreTouch&&(e.isSurface?(this.movedPrimary=!1,this.movedSecondary=!1):(this.touchingEvent&&clearTimeout(this.touchingEvent),this.touching=!0,this.touches=t.touches,this.changedTouches=t.changedTouches),s.V5j(),!e.ChartEngine.resizingPanel&&(r=this.crosshairXOffset,n=this.crosshairYOffset,this.touchPointerType==a&&(r=n=0),!this.runPrepend("touchstart",arguments)))){if(this.manageTouchAndMouse&&t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),this.hasDragged=!1,this.doubleFingerMoves=0,this.moveCount=0,this.twoFingerStart=!1,1==this.touches.length||2==this.touches.length){if(1==this.changedTouches.length){d=Date.now(),p=-1031566359,f=-1707125232,m=2;for(var j=1;s.b8P(j.toString(),j.toString().length,89040)!==p;j++)g=!0,m+=2;if(s.P8P(m.toString(),m.toString().length,81360)!==f&&(g=!1),g=!1,d-this.clicks.e1MS<250){this.cancelTouchSingleClick=!0,this.clicks.s2MS=d,s.A4b(0);var V=s.r4b(8,10);s.S4b(14);var B=s.r4b(9,2,17,8);s.A4b(0);var W=s.r4b(6400,6800);g=Math.pow(this.clicks.x-this.changedTouches[0].pageX,V)+Math.pow(this.clicks.y-this.changedTouches[0].pageY,B)<=W}g||(this.cancelTouchSingleClick=!1,this.clicks.s1MS=d,this.clicks.e1MS=-1,this.clicks.s2MS=-1,this.clicks.e2MS=-1),this.clicks.x=this.changedTouches[0].pageX,this.clicks.y=this.changedTouches[0].pageY}if(this.touchMoveTime=Date.now(),this.moveA=this.touches[0].clientX,s.A4b(1),this.moveB=-s.r4b(1,"1"),h=(v=this.touches[0]).clientX,c=v.clientY,y=this.container.getBoundingClientRect(),this.top=y.top,this.left=y.left,this.right=this.left+this.width,this.bottom=this.top+this.height,1==this.touches.length&&(x=this.backOutY(c),this.currentPanel=this.whichPanel(x)),this.currentPanel||(this.currentPanel=this.chart.panel),u=this.currentPanel,h>=this.left&&h<=this.right&&c>=this.top&&c<=this.bottom){this.insideChart=!0,b=!0===this.xAxisAsFooter?this.chart.canvasHeight:this.chart.panel.bottom,this.overXAxis=c<=this.top+b&&c>=this.top+b-this.xaxisHeight,this.overYAxis=h>=this.left+u.right||h<=this.left+u.left,S=-1,this.cy=this.backOutY(c),this.cx=this.backOutX(h),this.crosshairTick=this.tickFromPixel(this.cx,u.chart),this.crosshairValue=this.adjustIfNecessary(u,this.crosshairTick,this.valueFromPixel(this.cy,this.currentPanel));for(var U=0;U<this.drawingObjects.length;U++)if((C=this.drawingObjects[U]).highlighted){if(S<0&&(S=U),w=C.highlighted,this.findHighlights(!0),U==S&&C.highlighted&&!C.permanent)return void(-1==this.clicks.s2MS?this.activateRepositioning(C):this.findHighlights(!1,!0));this.anyHighlighted=!0,C.highlighted=w}}else this.insideChart=!1;if(k=this.currentVectorParameters.vectorType&&""!==this.currentVectorParameters.vectorType,this.layout.crosshair||k||!this.insideChart||this.touchNoPan){if(this.grabbingScreen=!1,this.insideChart&&u.subholder===t.target){P=2126283130,F=891632187,_=2;for(var Y=1;s.P8P(Y.toString(),Y.toString().length,83790)!==P;Y++)E=this.currentVectorParameters.vectorType,_+=2;if(s.P8P(_.toString(),_.toString().length,95218)!==F&&(E=this.currentVectorParameters.vectorType),e.Drawing&&E&&e.Drawing[E]&&(new e.Drawing[E]).dragToDraw)return this.userPointerDown=!0,e.ChartEngine.crosshairX=h,e.ChartEngine.crosshairY=c,u&&u.chart.dataSet&&(this.crosshairTick=this.tickFromPixel(this.backOutX(e.ChartEngine.crosshairX),this.currentPanel.chart),this.crosshairValue=this.adjustIfNecessary(u,this.crosshairTick,this.valueFromPixel(this.backOutY(e.ChartEngine.crosshairY),this.currentPanel))),this.drawingClick(u,this.backOutX(h),this.backOutY(c)),void this.headsUpHR()}}else{if(r=n=0,(D=this.mainSeriesRenderer||{}).params&&D.params.baseline&&!1!==this.chart.baseline.userLevel&&this.controls.baselineHandle){s.A4b(0),T=this.valueFromPixel(s.J4b(5,x),u),s.A4b(4),A=this.valueFromPixel(s.r4b(x,5),u),s.S4b(15);var Q=s.J4b(20,9,12,13);if(M=this.chart.right-parseInt(getComputedStyle(this.controls.baselineHandle).width,Q),this.chart.baseline.actualLevel<Math.max(T,A)&&this.chart.baseline.actualLevel>Math.min(T,A)&&this.backOutX(v.clientX)>M)return this.repositioningBaseline={lastDraw:Date.now()},void this.controls.baselineHandle.classList.add("stx-grab")}for(o in this.panels)if((l=this.panels[o]).highlighted)return void this.grabHandle(l);this.grabbingScreen=!0,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),u.chart.spanLock=!1,this.yToleranceBroken=!1,s.S4b(4),this.grabStartX=s.r4b(h,r),s.S4b(4),this.grabStartY=s.J4b(c,n),this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=u.chart.scroll,this.grabStartScrollY=u.yAxis.scroll,this.grabStartPanel=this.currentPanel,this.swipeStart&&this.swipeStart(u.chart),this.grabStartYAxis=this.whichYAxis(u,this.backOutX(h)),this.grabStartZoom=this.grabStartYAxis?this.grabStartYAxis.zoom:0,setTimeout((q=this,s.V5j(),function(){s.V5j(),q.grabbingHand()}),100)}1===this.touches.length&&this.layout.crosshair&&!k&&u.subholder===t.target&&(s.A4b(4),this.mousemoveinner(s.r4b(h,r),s.r4b(c,n)))}var q,X;if(2==this.touches.length){if(this.cancelLongHold=!0,this.swipe.end=!0,!this.displayCrosshairs&&!this.touchNoPan||!this.insideChart)return;for(o in I=(L=this.touches[1]).clientX,O=L.clientY,this.panels)if((l=this.panels[o]).highlighted)return void this.grabHandle(l);u=this.currentPanel,s.S4b(6),this.gestureStartDistance=Math.sqrt(s.J4b(c,I,O,c,I,h,h,O)),this.pt={x1:h,x2:I,y1:c,y2:O},this.grabbingScreen=!0,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),u.chart.spanLock=!1,s.S4b(4),this.grabStartX=s.r4b(h,r),s.A4b(4),this.grabStartY=s.J4b(c,n),this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=u.chart.scroll,this.grabStartScrollY=u.yAxis.scroll,this.grabStartPanel=u,this.swipeStart&&this.swipeStart(u.chart),this.grabStartCandleWidth=this.layout.candleWidth,this.grabStartYAxis=this.whichYAxis(u,this.backOutX((h+I)/2))||u.yAxis,this.grabStartZoom=this.grabStartYAxis?this.grabStartYAxis.zoom:0,this.grabStartPt=this.pt,this.grabStartValues={x1:this.pt.x1,x2:this.pt.x2,y1:this.valueFromPixel(this.pt.y1-this.top,u),y2:this.valueFromPixel(this.pt.y2-this.top,u),t1:this.tickFromPixel(this.pt.x1-this.left,u.chart),t2:this.tickFromPixel(this.pt.x2-this.left,u.chart)},this.twoFingerStart=!0,setTimeout((X=this,s.N5j(),function(){s.V5j(),X.grabbingHand()}),100)}else if(3==this.touches.length){if(!this.displayCrosshairs)return;N=this.touches[0].clientX,this.grabStartX=N,this.grabStartPeriodicity=this.layout.periodicity}1!=this.touches.length||this.layout.crosshair||(this.mouseTimer=Date.now(),this.longHoldTookEffect=!1,(this.longHoldTime||0===this.longHoldTime)&&this.startLongHoldTimer()),H=-1763325460,R=1239911479,z=2;for(var Z=1;s.P8P(Z.toString(),Z.toString().length,47325)!==H;Z++)this.runAppend("",arguments),z+=2;s.b8P(z.toString(),z.toString().length,77608)!==R&&this.runAppend("",arguments),this.runAppend(i,arguments)}},e.ChartEngine.prototype.touchend=function(t){var i,a,r,n,o,l,h,c,u,d,p,f,m,g,v,y;if(!e.ChartEngine.ignoreTouch){this.swipe.end=!0,e.isSurface||(this.touches=t.touches,this.changedTouches=t.changedTouches),i=-1092268635,a=1996142821,s.S4b(3),r=s.J4b(2147483647,"2");for(var x=1;s.b8P(x.toString(),x.toString().length,44502)!==i;x++){if(n="to",n+="uchend",this.runPrepend(n,arguments))return;this.cancelLongHold=!0,r+=2}if(s.b8P(r.toString(),r.toString().length,91341)!==a){if(this.runPrepend("",arguments))return;this.cancelLongHold=!1}if(this.touches.length<=1&&(this.layout.crosshair||this.currentVectorParameters.vectorType)&&(this.touches.length&&this.twoFingerStart||(this.grabbingScreen=!1)),this.touches.length&&(this.grabStartX=-1,this.grabStartY=-1),o=this.pinchingScreen,this.disableBackingStoreDuringTouch&&this.reconstituteBackingStore(),this.touches.length){if(e.ChartEngine.resizingPanel)return}else{if(this.touchingEvent=setTimeout((S=this,function(){var t;s.S4b(16),t=s.J4b("2",1688366240);for(var e=1;-325970451!==s.P8P(e.toString(),e.toString().length,27503);e++)S.touching=!1,t+=2;1554344205!==s.b8P(t.toString(),t.toString().length,42427)&&(S.touching=!0)}),500),e.ChartEngine.resizingPanel)return void this.releaseHandle();this.pinchingScreen=null,this.pinchingCenter=null,this.goneVertical=!1,this.grabbingScreen=!1,l=-1656800811,h=-1265094694,c=2;for(var b=1;s.b8P(b.toString(),b.toString().length,90452)!==l;b++)this.grabMode="",c+=2;s.P8P(c.toString(),c.toString().length,23773)!==h&&(this.grabMode=""),this.highlightedDraggable&&(this.dragPlotOrAxis&&this.dragPlotOrAxis(this.cx,this.cy),this.currentPanel=this.whichPanel(this.cy)),this.grabStartYAxis=null,this.displayDragOK(),this.doDisplayCrosshairs(),this.updateChartAccessories()}var S;if(u=this.touches.length+1,1==this.changedTouches.length){if(this.repositioningDrawing)return this.changeOccurred("vector"),e.clearCanvas(this.chart.tempCanvas,this),this.activateRepositioning(null),this.draw(),void(this.layout.crosshair||this.currentVectorParameters.vectorType||this.findHighlights(!1,!0));if(this.repositioningBaseline)return d="st",d+="x-",d+="grab",this.repositioningBaseline=null,this.controls.baselineHandle.classList.remove(d),(p=this.mainSeriesRenderer||{}).params&&p.params.baseline&&p.params.type,void this.draw();if(f=Date.now(),-1==this.clicks.s2MS){this.clicks.e1MS=f,m=this.currentVectorParameters.vectorType,e.Drawing&&m&&e.Drawing[m]&&(new e.Drawing[m]).dragToDraw||(this.clicks.e1MS-this.clicks.s1MS<750&&!this.longHoldTookEffect&&(!this.hasDragged||this.layout.crosshair)?setTimeout(this.touchSingleClick(u,this.clicks.x,this.clicks.y),200):this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1}),this.userPointerDown=!1,g=this.backOutY(this.changedTouches[0].pageY)+this.crosshairYOffset,s.S4b(0);var C=s.r4b(15487387136,16678724608);if(v=this.backOutX(this.changedTouches["0">>C].pageX)+this.crosshairXOffset,y=this.currentPanel,e.Drawing&&this.activeDrawing&&this.activeDrawing.dragToDraw&&y.subholder===t.target)return void this.drawingClick(y,v,g);this.activeMarker&&y.subholder===t.target&&this.activeMarker.click({cx:v,cy:g,panel:y})}else this.clicks.e2MS=f,this.clicks.e2MS-this.clicks.s2MS<250?this.touchDoubleClick(u,this.clicks.x,this.clicks.y):this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1}}else this.displayCrosshairs&&(-1==this.grabEndPeriodicity||isNaN(this.grabEndPeriodicity)||((e.ChartEngine.isDailyInterval(this.layout.interval)||this.allowIntradayNMinute)&&this.setPeriodicity({period:this.grabEndPeriodicity,interval:this.layout.interval}),this.grabEndPeriodicity=-1));this.changedTouches.length&&((!this.layout.crosshair&&!this.currentVectorParameters.vectorType&&1==u||this.twoFingerStart&&!o&&!this.touches.length)&&(this.swipeRelease&&this.swipeRelease(),this.findHighlights(!1,!0)),o&&this.continuousZoom&&(this.continuousZoom.execute(),this.continuousZoom.execute(!0))),this.touches.length||(this.twoFingerStart=!1),this.runAppend("touchend",arguments)}},s.S4b(16),i=s.J4b("1867146720",388800928),a=2;for(var o=1;s.P8P(o.toString(),o.toString().length,7645)!==i;o++)n=!0,a+=2;-689770830!==s.b8P(a.toString(),a.toString().length,90279)&&(n=!0),n=!1,e.ChartEngine.prototype.mousemoveinner=e.ChartEngine.prototype.mousemoveinner||function(t,e){n||console.error("touch feature requires activating movement feature."),n=!0}};var R=a.c;a.d,a.e,a.a,a.b;"undefined"!=typeof __TREE_SHAKE__&&__TREE_SHAKE__||(R||a.c).activateImports(g,h,v,y,x,b,S,C,w,d,k,D,T,A,M,P,F,_,E,L,m,I,null)}).call(this,i(56))}}]);
//# sourceMappingURL=chartiq-cf6c0d.smartcharts.js.map